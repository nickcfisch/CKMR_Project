Pred_btc<-simplex(btc$Close, lib=lib, pred=pred, stats_only = FALSE, E=3,tp=1)
Pred_btc$model_output[[1]]$Predictions
length(btc$Close)
tail(btc$Close)
length(Pred_btc$model_output[[1]]$Predictions)
lines(1215:1826,Pred_btc$model_output[[1]]$Predictions, col=2)
lines(1216:1826,Pred_btc$model_output[[1]]$Predictions, col=2)
lines(1217:1826,Pred_btc$model_output[[1]]$Predictions, col=2)
runif(1,1,3)
sample(1:3,1)
sample(1:2,1)
sample(1:3,1)
sample(c(1,3),1)
78.47/3
8.18/3
451.69/3
log(0.1)
exp(-1.89)
log(0.25)
exp(17)
exp(16)
exp(20)
seq(0,100,5)
seq(2.5,100,5)
length(seq(2.5,100,5))
1:20*2+0.5
1:20*2.5
0:19*5+2.5
log(50)
log(120)
log(0.1)
log(90)
log(0.01)
Size_mdpts<-seq(2.5,97.5,5)
Size_bins<-seq(1,20)
K<-0.1
(Linf-Size_mdpts)*(1-exp(-K))
Linf<-90
K<-0.1
(Linf-Size_mdpts)*(1-exp(-K))
Exp_delta_size<-ifelse(Exp_delta_size<0, 0.1, Exp_delta_size)
Exp_delta_size<-(Linf-Size_mdpts)*(1-exp(-K))
Exp_delta_size<-ifelse(Exp_delta_size<0, 0.1, Exp_delta_size)
CV_delta_size<-0.5
sd_delta_size<-CV_delta_size*Exp_delta_size
sd_delta_size
Linf<-90
K<-0.2
Exp_delta_size<-(Linf-Size_mdpts)*(1-exp(-K))
Exp_delta_size<-ifelse(Exp_delta_size<0, 0.1, Exp_delta_size)
CV_delta_size<-0.5
sd_delta_size<-CV_delta_size*Exp_delta_size
Exp_delta_size
sd_delta_size
K<-0.3
Exp_delta_size<-(Linf-Size_mdpts)*(1-exp(-K))
Exp_delta_size<-ifelse(Exp_delta_size<0, 0.1, Exp_delta_size)
CV_delta_size<-0.5
sd_delta_size<-CV_delta_size*Exp_delta_size
Exp_delta_size
sd_delta_size
Size_tran[i,1]<-pnorm(Size_mdpts[1]+2.5,mean=Exp_delta_size[i], sd=sd_delta_size[i])
for (i in 1:20){
Size_tran<-matrix(NA, nrow=20, ncol=20)
for (i in 1:20){
Size_tran[i,1]<-pnorm(Size_mdpts[1]+2.5,mean=Exp_delta_size[i], sd=sd_delta_size[i])
for (j in 1:20){
Size_tran[i,j]<-pnorm(Size_mdpts[j]+2.5,mean=Exp_delta_size[i], sd=sd_delta_size[i])-pnorm(Size_mdpts[j]-2.5,mean=Exp_delta_size[i], sd=sd_delta_size[i])
}
}
Size_tran<-matrix(NA, nrow=20, ncol=20)
for (i in 1:20){
Size_tran[i,1]<-pnorm(Size_mdpts[1]+2.5,mean=Exp_delta_size[i], sd=sd_delta_size[i])
for (j in 2:20){
Size_tran[i,j]<-pnorm(Size_mdpts[j]+2.5,mean=Exp_delta_size[i], sd=sd_delta_size[i])-pnorm(Size_mdpts[j]-2.5,mean=Exp_delta_size[i], sd=sd_delta_size[i])
}
}
Size_tran
round(Size_tran,3)
Exp_delta_size
sd_delta_size
Size_mdpts
Size_tran<-matrix(NA, nrow=20, ncol=20)
for (i in 1:20){
Size_tran[i,1]<-pnorm(Size_mdpts[1]+2.5,mean=size_midpts[i]+Exp_delta_size[1], sd=sd_delta_size[1])
for (j in 2:20){
Size_tran[i,j]<-pnorm(Size_mdpts[j]+2.5,mean=Size_mdpts[i]+Exp_delta_size[i], sd=sd_delta_size[i])-pnorm(Size_mdpts[j]-2.5,mean=Size_mdpts[i]+Exp_delta_size[i], sd=sd_delta_size[i])
}
}
Size_tran<-matrix(NA, nrow=20, ncol=20)
for (i in 1:20){
Size_tran[i,1]<-pnorm(Size_mdpts[1]+2.5,mean=size_mdpts[i]+Exp_delta_size[1], sd=sd_delta_size[1])
for (j in 2:20){
Size_tran[i,j]<-pnorm(Size_mdpts[j]+2.5,mean=Size_mdpts[i]+Exp_delta_size[i], sd=sd_delta_size[i])-pnorm(Size_mdpts[j]-2.5,mean=Size_mdpts[i]+Exp_delta_size[i], sd=sd_delta_size[i])
}
}
Size_tran<-matrix(NA, nrow=20, ncol=20)
for (i in 1:20){
Size_tran[i,1]<-pnorm(Size_mdpts[1]+2.5,mean=Size_mdpts[i]+Exp_delta_size[1], sd=sd_delta_size[1])
for (j in 2:20){
Size_tran[i,j]<-pnorm(Size_mdpts[j]+2.5,mean=Size_mdpts[i]+Exp_delta_size[i], sd=sd_delta_size[i])-pnorm(Size_mdpts[j]-2.5,mean=Size_mdpts[i]+Exp_delta_size[i], sd=sd_delta_size[i])
}
}
round(Size_tran,3)
rowSums(Size_tran)
Size_tran<-matrix(NA, nrow=20, ncol=20)
for (i in 1:20){
Size_tran[i,1]<-pnorm(Size_mdpts[1]+2.5,mean=Size_mdpts[i]+Exp_delta_size[1], sd=sd_delta_size[1])
for (j in 2:19){
Size_tran[i,j]<-pnorm(Size_mdpts[j]+2.5,mean=Size_mdpts[i]+Exp_delta_size[i], sd=sd_delta_size[i])-pnorm(Size_mdpts[j]-2.5,mean=Size_mdpts[i]+Exp_delta_size[i], sd=sd_delta_size[i])
}
}
Size_tran
Size_tran<-matrix(NA, nrow=20, ncol=20)
for (i in 1:20){
Size_tran[i,1]<-pnorm(Size_mdpts[1]+2.5,mean=Size_mdpts[i]+Exp_delta_size[1], sd=sd_delta_size[1])
for (j in 2:19){
Size_tran[i,j]<-pnorm(Size_mdpts[j]+2.5,mean=Size_mdpts[i]+Exp_delta_size[i], sd=sd_delta_size[i])-pnorm(Size_mdpts[j]-2.5,mean=Size_mdpts[i]+Exp_delta_size[i], sd=sd_delta_size[i])
}
Size_tran[i,20]<-pnorm(150,mean=Size_mdpts[i]+Exp_delta_size[1], sd=sd_delta_size[1])-pnorm(95,mean=Size_mdpts[i]+Exp_delta_size[1], sd=sd_delta_size[1])
}
round(Size_tran,3)
Size_tran<-matrix(NA, nrow=20, ncol=20)
for (i in 1:20){
Size_tran[i,1]<-pnorm(Size_mdpts[1]+2.5,mean=Size_mdpts[i]+Exp_delta_size[1], sd=sd_delta_size[1])
for (j in 2:19){
Size_tran[i,j]<-pnorm(Size_mdpts[j]+2.5,mean=Size_mdpts[i]+Exp_delta_size[i], sd=sd_delta_size[i])-pnorm(Size_mdpts[j]-2.5,mean=Size_mdpts[i]+Exp_delta_size[i], sd=sd_delta_size[i])
}
Size_tran[i,20]<-pnorm(150,mean=Size_mdpts[i]+Exp_delta_size[1], sd=sd_delta_size[1])-pnorm(95,mean=Size_mdpts[i]+Exp_delta_size[1], sd=sd_delta_size[1])
}
round(Size_tran,3)
Size_tran<-matrix(NA, nrow=20, ncol=20)
for (i in 1:20){
Size_tran[i,1]<-pnorm(Size_mdpts[1]+2.5,mean=Size_mdpts[i]+Exp_delta_size[1], sd=sd_delta_size[1])
for (j in 2:19){
Size_tran[i,j]<-pnorm(Size_mdpts[j]+2.5,mean=Size_mdpts[i]+Exp_delta_size[i], sd=sd_delta_size[i])-pnorm(Size_mdpts[j]-2.5,mean=Size_mdpts[i]+Exp_delta_size[i], sd=sd_delta_size[i])
}
Size_tran[i,20]<-pnorm(150,mean=Size_mdpts[i]+Exp_delta_size[20], sd=sd_delta_size[20])-pnorm(95,mean=Size_mdpts[i]+Exp_delta_size[20], sd=sd_delta_size[20])
}
round(Size_tran,3)
Exp_delta_size<-(Linf-Size_mdpts)*(1-exp(-K))
Exp_delta_size<-ifelse(Exp_delta_size<0, 0.1, Exp_delta_size)
CV_delta_size<-2
sd_delta_size<-CV_delta_size*Exp_delta_size
Exp_delta_size
sd_delta_size
Size_tran<-matrix(NA, nrow=20, ncol=20)
for (i in 1:20){
Size_tran[i,1]<-pnorm(Size_mdpts[1]+2.5,mean=Size_mdpts[i]+Exp_delta_size[1], sd=sd_delta_size[1])
for (j in 2:19){
Size_tran[i,j]<-pnorm(Size_mdpts[j]+2.5,mean=Size_mdpts[i]+Exp_delta_size[i], sd=sd_delta_size[i])-pnorm(Size_mdpts[j]-2.5,mean=Size_mdpts[i]+Exp_delta_size[i], sd=sd_delta_size[i])
}
Size_tran[i,20]<-pnorm(150,mean=Size_mdpts[i]+Exp_delta_size[20], sd=sd_delta_size[20])-pnorm(95,mean=Size_mdpts[i]+Exp_delta_size[20], sd=sd_delta_size[20])
}
round(Size_tran,3)
Exp_delta_size<-(Linf-Size_mdpts)*(1-exp(-K))
Exp_delta_size<-ifelse(Exp_delta_size<0, 0.1, Exp_delta_size)
CV_delta_size<-5
sd_delta_size<-CV_delta_size*Exp_delta_size
Exp_delta_size
sd_delta_size
Size_tran<-matrix(NA, nrow=20, ncol=20)
for (i in 1:20){
Size_tran[i,1]<-pnorm(Size_mdpts[1]+2.5,mean=Size_mdpts[i]+Exp_delta_size[1], sd=sd_delta_size[1])
for (j in 2:19){
Size_tran[i,j]<-pnorm(Size_mdpts[j]+2.5,mean=Size_mdpts[i]+Exp_delta_size[i], sd=sd_delta_size[i])-pnorm(Size_mdpts[j]-2.5,mean=Size_mdpts[i]+Exp_delta_size[i], sd=sd_delta_size[i])
}
Size_tran[i,20]<-pnorm(150,mean=Size_mdpts[i]+Exp_delta_size[20], sd=sd_delta_size[20])-pnorm(95,mean=Size_mdpts[i]+Exp_delta_size[20], sd=sd_delta_size[20])
}
round(Size_tran,3)
Linf<-90
K<-0.3
Exp_delta_size<-(Linf-Size_mdpts)*(1-exp(-K))
Exp_delta_size<-ifelse(Exp_delta_size<0, 0.1, Exp_delta_size)
CV_delta_size<-30
sd_delta_size<-CV_delta_size*Exp_delta_size
Exp_delta_size
sd_delta_size
Size_tran<-matrix(NA, nrow=20, ncol=20)
for (i in 1:20){
Size_tran[i,1]<-pnorm(Size_mdpts[1]+2.5,mean=Size_mdpts[i]+Exp_delta_size[1], sd=sd_delta_size[1])
for (j in 2:19){
Size_tran[i,j]<-pnorm(Size_mdpts[j]+2.5,mean=Size_mdpts[i]+Exp_delta_size[i], sd=sd_delta_size[i])-pnorm(Size_mdpts[j]-2.5,mean=Size_mdpts[i]+Exp_delta_size[i], sd=sd_delta_size[i])
}
Size_tran[i,20]<-pnorm(150,mean=Size_mdpts[i]+Exp_delta_size[20], sd=sd_delta_size[20])-pnorm(95,mean=Size_mdpts[i]+Exp_delta_size[20], sd=sd_delta_size[20])
}
round(Size_tran,3)
Linf<-90
K<-0.3
Exp_delta_size<-(Linf-Size_mdpts)*(1-exp(-K))
Exp_delta_size<-ifelse(Exp_delta_size<0, 0.1, Exp_delta_size)
CV_delta_size<-1
sd_delta_size<-CV_delta_size*Exp_delta_size
Exp_delta_size
sd_delta_size
Size_tran<-matrix(NA, nrow=20, ncol=20)
for (i in 1:20){
Size_tran[i,1]<-pnorm(5,mean=Size_mdpts[i]+Exp_delta_size[1], sd=sd_delta_size[1])
for (j in 2:19){
Size_tran[i,j]<-pnorm(Size_mdpts[j]+2.5,mean=Size_mdpts[i]+Exp_delta_size[i], sd=sd_delta_size[i])-pnorm(Size_mdpts[j]-2.5,mean=Size_mdpts[i]+Exp_delta_size[i], sd=sd_delta_size[i])
}
Size_tran[i,20]<-pnorm(150,mean=Size_mdpts[i]+Exp_delta_size[20], sd=sd_delta_size[20])-pnorm(95,mean=Size_mdpts[i]+Exp_delta_size[20], sd=sd_delta_size[20])
}
round(Size_tran,3)
Size_tran<-matrix(NA, nrow=20, ncol=20)
for (i in 1:20){
Size_tran[i,1]<-pnorm(5,mean=Size_mdpts[i]+Exp_delta_size[i], sd=sd_delta_size[i])
for (j in 2:19){
Size_tran[i,j]<-pnorm(Size_mdpts[j]+2.5,mean=Size_mdpts[i]+Exp_delta_size[i], sd=sd_delta_size[i])-pnorm(Size_mdpts[j]-2.5,mean=Size_mdpts[i]+Exp_delta_size[i], sd=sd_delta_size[i])
}
Size_tran[i,20]<-pnorm(150,mean=Size_mdpts[i]+Exp_delta_size[20], sd=sd_delta_size[20])-pnorm(95,mean=Size_mdpts[i]+Exp_delta_size[20], sd=sd_delta_size[20])
}
round(Size_tran,3)
Exp_delta_size<-(Linf-Size_mdpts)*(1-exp(-K))
Exp_delta_size<-ifelse(Exp_delta_size<0, 0.1, Exp_delta_size)
CV_delta_size<-30
sd_delta_size<-CV_delta_size*Exp_delta_size
Exp_delta_size
sd_delta_size
Size_tran<-matrix(NA, nrow=20, ncol=20)
for (i in 1:20){
Size_tran[i,1]<-pnorm(5,mean=Size_mdpts[i]+Exp_delta_size[i], sd=sd_delta_size[i])
for (j in 2:19){
Size_tran[i,j]<-pnorm(Size_mdpts[j]+2.5,mean=Size_mdpts[i]+Exp_delta_size[i], sd=sd_delta_size[i])-pnorm(Size_mdpts[j]-2.5,mean=Size_mdpts[i]+Exp_delta_size[i], sd=sd_delta_size[i])
}
Size_tran[i,20]<-pnorm(150,mean=Size_mdpts[i]+Exp_delta_size[20], sd=sd_delta_size[20])-pnorm(95,mean=Size_mdpts[i]+Exp_delta_size[20], sd=sd_delta_size[20])
}
round(Size_tran,3)
Linf<-90
K<-0.3
Exp_delta_size<-(Linf-Size_mdpts)*(1-exp(-K))
Exp_delta_size<-ifelse(Exp_delta_size<0, 0.1, Exp_delta_size)
CV_delta_size<-10
sd_delta_size<-CV_delta_size*Exp_delta_size
Exp_delta_size
sd_delta_size
Size_tran<-matrix(NA, nrow=20, ncol=20)
for (i in 1:20){
Size_tran[i,1]<-pnorm(5,mean=Size_mdpts[i]+Exp_delta_size[i], sd=sd_delta_size[i])
for (j in 2:19){
Size_tran[i,j]<-pnorm(Size_mdpts[j]+2.5,mean=Size_mdpts[i]+Exp_delta_size[i], sd=sd_delta_size[i])-pnorm(Size_mdpts[j]-2.5,mean=Size_mdpts[i]+Exp_delta_size[i], sd=sd_delta_size[i])
}
Size_tran[i,20]<-pnorm(150,mean=Size_mdpts[i]+Exp_delta_size[20], sd=sd_delta_size[20])-pnorm(95,mean=Size_mdpts[i]+Exp_delta_size[20], sd=sd_delta_size[20])
}
round(Size_tran,3)
rowSums(Size_tran)
Exp_delta_size<-(Linf-Size_mdpts)*(1-exp(-K))
Exp_delta_size<-ifelse(Exp_delta_size<0, 0.1, Exp_delta_size)
CV_delta_size<-10
sd_delta_size<-CV_delta_size*Exp_delta_size
Exp_delta_size
sd_delta_size
Size_tran<-matrix(NA, nrow=20, ncol=20)
for (i in 1:20){
Size_tran[i,1]<-pnorm(5,mean=Size_mdpts[i]+Exp_delta_size[i], sd=sd_delta_size[i])
for (j in 2:19){
Size_tran[i,j]<-pnorm(Size_mdpts[j]+2.5,mean=Size_mdpts[i]+Exp_delta_size[i], sd=sd_delta_size[i])-pnorm(Size_mdpts[j]-2.5,mean=Size_mdpts[i]+Exp_delta_size[i], sd=sd_delta_size[i])
}
Size_tran[i,20]<-pnorm(150,mean=Size_mdpts[i]+Exp_delta_size[20], sd=sd_delta_size[20])-pnorm(95,mean=Size_mdpts[i]+Exp_delta_size[20], sd=sd_delta_size[20])
}
round(Size_tran,3)
rowSums(Size_tran)
Linf<-90
K<-0.3
Exp_delta_size<-(Linf-Size_mdpts)*(1-exp(-K))
Exp_delta_size<-ifelse(Exp_delta_size<0, 0.1, Exp_delta_size)
CV_delta_size<-2
sd_delta_size<-CV_delta_size*Exp_delta_size
Exp_delta_size
sd_delta_size
Size_tran<-matrix(NA, nrow=20, ncol=20)
for (i in 1:20){
Size_tran[i,1]<-pnorm(5,mean=Size_mdpts[i]+Exp_delta_size[i], sd=sd_delta_size[i])
for (j in 2:19){
Size_tran[i,j]<-pnorm(Size_mdpts[j]+2.5,mean=Size_mdpts[i]+Exp_delta_size[i], sd=sd_delta_size[i])-pnorm(Size_mdpts[j]-2.5,mean=Size_mdpts[i]+Exp_delta_size[i], sd=sd_delta_size[i])
}
Size_tran[i,20]<-pnorm(150,mean=Size_mdpts[i]+Exp_delta_size[20], sd=sd_delta_size[20])-pnorm(95,mean=Size_mdpts[i]+Exp_delta_size[20], sd=sd_delta_size[20])
}
round(Size_tran,3)
rowSums(Size_tran)
Linf<-90
K<-0.3
Exp_delta_size<-(Linf-Size_mdpts)*(1-exp(-K))
Exp_delta_size<-ifelse(Exp_delta_size<0, 0.1, Exp_delta_size)
CV_delta_size<-1
sd_delta_size<-CV_delta_size*Exp_delta_size
Exp_delta_size
sd_delta_size
Size_tran<-matrix(NA, nrow=20, ncol=20)
for (i in 1:20){
Size_tran[i,1]<-pnorm(5,mean=Size_mdpts[i]+Exp_delta_size[i], sd=sd_delta_size[i])
for (j in 2:19){
Size_tran[i,j]<-pnorm(Size_mdpts[j]+2.5,mean=Size_mdpts[i]+Exp_delta_size[i], sd=sd_delta_size[i])-pnorm(Size_mdpts[j]-2.5,mean=Size_mdpts[i]+Exp_delta_size[i], sd=sd_delta_size[i])
}
Size_tran[i,20]<-pnorm(150,mean=Size_mdpts[i]+Exp_delta_size[20], sd=sd_delta_size[20])-pnorm(95,mean=Size_mdpts[i]+Exp_delta_size[20], sd=sd_delta_size[20])
}
round(Size_tran,3)
rowSums(Size_tran)
Exp_delta_size
Linf<-90
K<-0.1
Exp_delta_size<-(Linf-Size_mdpts)*(1-exp(-K))
Exp_delta_size<-ifelse(Exp_delta_size<0, 0.1, Exp_delta_size)
CV_delta_size<-0.5
sd_delta_size<-CV_delta_size*Exp_delta_size
Exp_delta_size
sd_delta_size
Size_tran<-matrix(NA, nrow=20, ncol=20)
for (i in 1:20){
Size_tran[i,1]<-pnorm(5,mean=Size_mdpts[i]+Exp_delta_size[i], sd=sd_delta_size[i])
for (j in 2:19){
Size_tran[i,j]<-pnorm(Size_mdpts[j]+2.5,mean=Size_mdpts[i]+Exp_delta_size[i], sd=sd_delta_size[i])-pnorm(Size_mdpts[j]-2.5,mean=Size_mdpts[i]+Exp_delta_size[i], sd=sd_delta_size[i])
}
Size_tran[i,20]<-pnorm(150,mean=Size_mdpts[i]+Exp_delta_size[20], sd=sd_delta_size[20])-pnorm(95,mean=Size_mdpts[i]+Exp_delta_size[20], sd=sd_delta_size[20])
}
round(Size_tran,3)
Size_tran<-matrix(NA, nrow=20, ncol=20)
for (i in 1:20){
Size_tran[i,1]<-plnorm(5,meanlog=log(Size_mdpts[i]+Exp_delta_size[i]), sdlog=sd_delta_size[i])
for (j in 2:19){
Size_tran[i,j]<-plnorm(Size_mdpts[j]+2.5,meanlog=log(Size_mdpts[i]+Exp_delta_size[i]), sdlog=sd_delta_size[i])-plnorm(Size_mdpts[j]-2.5,meanlog=log(Size_mdpts[i]+Exp_delta_size[i]), sdlog=sd_delta_size[i])
}
Size_tran[i,20]<-plnorm(150,meanlog=log(Size_mdpts[i]+Exp_delta_size[20]), sdlog=sd_delta_size[20])-pnorm(95,meanlog=log(Size_mdpts[i]+Exp_delta_size[20]), sdlog=sd_delta_size[20])
}
round(Size_tran,3)
Size_tran<-matrix(NA, nrow=20, ncol=20)
for (i in 1:20){
Size_tran[i,1]<-plnorm(5,meanlog=log(Size_mdpts[i]+Exp_delta_size[i]), sdlog=sd_delta_size[i])
for (j in 2:19){
Size_tran[i,j]<-plnorm(Size_mdpts[j]+2.5,meanlog=log(Size_mdpts[i]+Exp_delta_size[i]), sdlog=sd_delta_size[i])-plnorm(Size_mdpts[j]-2.5,meanlog=log(Size_mdpts[i]+Exp_delta_size[i]), sdlog=sd_delta_size[i])
}
Size_tran[i,20]<-plnorm(150,meanlog=log(Size_mdpts[i]+Exp_delta_size[20]), sdlog=sd_delta_size[20])-plnorm(95,meanlog=log(Size_mdpts[i]+Exp_delta_size[20]), sdlog=sd_delta_size[20])
}
round(Size_tran,3)
Size_tran<-matrix(NA, nrow=20, ncol=20)
for (i in 1:20){
Size_tran[i,1]<-plnorm(5,meanlog=log(Size_mdpts[i]+Exp_delta_size[i]), sdlog=sd_delta_size[i])
for (j in 2:19){
Size_tran[i,j]<-plnorm(Size_mdpts[j]+2.5,meanlog=log(Size_mdpts[i]+Exp_delta_size[i]), sdlog=sd_delta_size[i])-plnorm(Size_mdpts[j]-2.5,meanlog=log(Size_mdpts[i]+Exp_delta_size[i]), sdlog=sd_delta_size[i])
}
Size_tran[i,20]<-plnorm(150,meanlog=log(Size_mdpts[i]+Exp_delta_size[i]), sdlog=sd_delta_size[i])-plnorm(95,meanlog=log(Size_mdpts[i]+Exp_delta_size[i]), sdlog=sd_delta_size[i])
}
round(Size_tran,3)
Linf<-90
K<-0.1
Exp_delta_size<-(Linf-Size_mdpts)*(1-exp(-K))
Exp_delta_size<-ifelse(Exp_delta_size<0, 0.1, Exp_delta_size)
CV_delta_size<-0.25
sd_delta_size<-CV_delta_size*Exp_delta_size
Size_tran<-matrix(NA, nrow=20, ncol=20)
for (i in 1:20){
Size_tran[i,1]<-plnorm(5,meanlog=log(Size_mdpts[i]+Exp_delta_size[i]), sdlog=sd_delta_size[i])
for (j in 2:19){
Size_tran[i,j]<-plnorm(Size_mdpts[j]+2.5,meanlog=log(Size_mdpts[i]+Exp_delta_size[i]), sdlog=sd_delta_size[i])-plnorm(Size_mdpts[j]-2.5,meanlog=log(Size_mdpts[i]+Exp_delta_size[i]), sdlog=sd_delta_size[i])
}
Size_tran[i,20]<-plnorm(150,meanlog=log(Size_mdpts[i]+Exp_delta_size[i]), sdlog=sd_delta_size[i])-plnorm(95,meanlog=log(Size_mdpts[i]+Exp_delta_size[i]), sdlog=sd_delta_size[i])
}
round(Size_tran,3)
library("PBSmodelling")
par(mfrow=c(1,1), mar=c(5,4,2,1)+0.1)
plotBubbles(t(results$Size_tran), xlab="Starting Bin Midpoint (mm)", ylab="Probability of Increment",yaxt="n",xaxt="n",cex.axis=0.9, xlim=c(0.75,25.25),ylim=c(0.75,25.25),size=0.08, hide0=T, main="Probability of Growing into Y Given Starting Length Bin X")
axis(side=2, at=1:20, labels=seq(2.5,97.5,5), cex.axis=0.9, las=2)
axis(side=1, at=1:20, labels=seq(2.5,97.5,5), cex.axis=0.9, las=2)
abline(a=0,b=1)
par(mfrow=c(1,1), mar=c(5,4,2,1)+0.1)
plotBubbles(t(Size_tran), xlab="Starting Bin Midpoint (mm)", ylab="Probability of Increment",yaxt="n",xaxt="n",cex.axis=0.9, xlim=c(0.75,25.25),ylim=c(0.75,25.25),size=0.08, hide0=T, main="Probability of Growing into Y Given Starting Length Bin X")
axis(side=2, at=1:20, labels=seq(2.5,97.5,5), cex.axis=0.9, las=2)
axis(side=1, at=1:20, labels=seq(2.5,97.5,5), cex.axis=0.9, las=2)
abline(a=0,b=1)
par(mfrow=c(1,1), mar=c(5,4,2,1)+0.1)
plotBubbles(t(Size_tran), xlab="Starting Bin Midpoint (mm)", ylab="Probability of Increment",yaxt="n",xaxt="n",cex.axis=0.9, xlim=c(0.75,20.25),ylim=c(0.75,20.25),size=0.08, hide0=T, main="Probability of Growing into Y Given Starting Length Bin X")
axis(side=2, at=1:20, labels=seq(2.5,97.5,5), cex.axis=0.9, las=2)
axis(side=1, at=1:20, labels=seq(2.5,97.5,5), cex.axis=0.9, las=2)
abline(a=0,b=1)
par(mfrow=c(1,1), mar=c(5,4,2,1)+0.1)
plotBubbles(t(Size_tran), xlab="Starting Bin Midpoint (mm)", ylab="Probability of Increment",yaxt="n",xaxt="n",cex.axis=0.9, xlim=c(0.75,20.25),ylim=c(0.75,20.25),size=0.08, hide0=T, main="Probability of Growing into Y Given Starting Length Bin X")
axis(side=2, at=1:20, labels=seq(2.5,97.5,5), cex.axis=0.9, las=2)
axis(side=1, at=1:20, labels=seq(2.5,97.5,5), cex.axis=0.9, las=1)
abline(a=0,b=1)
Linf<-90
K<-0.05
Exp_delta_size<-(Linf-Size_mdpts)*(1-exp(-K))
Exp_delta_size<-ifelse(Exp_delta_size<0, 0.1, Exp_delta_size)
CV_delta_size<-0.25
sd_delta_size<-CV_delta_size*Exp_delta_size
Exp_delta_size
sd_delta_size
#Normal Distribution
Size_tran<-matrix(NA, nrow=20, ncol=20)
for (i in 1:20){
Size_tran[i,1]<-pnorm(5,mean=Size_mdpts[i]+Exp_delta_size[i], sd=sd_delta_size[i])
for (j in 2:19){
Size_tran[i,j]<-pnorm(Size_mdpts[j]+2.5,mean=Size_mdpts[i]+Exp_delta_size[i], sd=sd_delta_size[i])-pnorm(Size_mdpts[j]-2.5,mean=Size_mdpts[i]+Exp_delta_size[i], sd=sd_delta_size[i])
}
Size_tran[i,20]<-pnorm(150,mean=Size_mdpts[i]+Exp_delta_size[i], sd=sd_delta_size[i])-pnorm(95,mean=Size_mdpts[i]+Exp_delta_size[i], sd=sd_delta_size[i])
}
round(Size_tran,3)
rowSums(Size_tran)
#Lognormal Distribution
Size_tran<-matrix(NA, nrow=20, ncol=20)
for (i in 1:20){
Size_tran[i,1]<-plnorm(5,meanlog=log(Size_mdpts[i]+Exp_delta_size[i]), sdlog=sd_delta_size[i])
for (j in 2:19){
Size_tran[i,j]<-plnorm(Size_mdpts[j]+2.5,meanlog=log(Size_mdpts[i]+Exp_delta_size[i]), sdlog=sd_delta_size[i])-plnorm(Size_mdpts[j]-2.5,meanlog=log(Size_mdpts[i]+Exp_delta_size[i]), sdlog=sd_delta_size[i])
}
Size_tran[i,20]<-plnorm(150,meanlog=log(Size_mdpts[i]+Exp_delta_size[i]), sdlog=sd_delta_size[i])-plnorm(95,meanlog=log(Size_mdpts[i]+Exp_delta_size[i]), sdlog=sd_delta_size[i])
}
round(Size_tran,3)
par(mfrow=c(1,1), mar=c(5,4,2,1)+0.1)
plotBubbles(t(Size_tran), xlab="Starting Bin Midpoint (mm)", ylab="Probability of Increment",yaxt="n",xaxt="n",cex.axis=0.9, xlim=c(0.75,20.25),ylim=c(0.75,20.25),size=0.08, hide0=T, main="Probability of Growing into Y Given Starting Length Bin X")
axis(side=2, at=1:20, labels=seq(2.5,97.5,5), cex.axis=0.9, las=2)
axis(side=1, at=1:20, labels=seq(2.5,97.5,5), cex.axis=0.9, las=2)
abline(a=0,b=1)
Exp_delta_size<-(Linf-Size_mdpts)*(1-exp(-K))
Exp_delta_size<-ifelse(Exp_delta_size<0, 0.1, Exp_delta_size)
CV_delta_size<-0.25
sd_delta_size<-CV_delta_size*Exp_delta_size
Exp_delta_size
sd_delta_size
#Normal Distribution
Size_tran<-matrix(NA, nrow=20, ncol=20)
for (i in 1:20){
Size_tran[i,1]<-pnorm(5,mean=Size_mdpts[i]+Exp_delta_size[i], sd=sd_delta_size[i])
for (j in 2:19){
Size_tran[i,j]<-pnorm(Size_mdpts[j]+2.5,mean=Size_mdpts[i]+Exp_delta_size[i], sd=sd_delta_size[i])-pnorm(Size_mdpts[j]-2.5,mean=Size_mdpts[i]+Exp_delta_size[i], sd=sd_delta_size[i])
}
Size_tran[i,20]<-pnorm(150,mean=Size_mdpts[i]+Exp_delta_size[i], sd=sd_delta_size[i])-pnorm(95,mean=Size_mdpts[i]+Exp_delta_size[i], sd=sd_delta_size[i])
}
par(mfrow=c(1,1), mar=c(5,4,2,1)+0.1)
plotBubbles(t(Size_tran), xlab="Starting Bin Midpoint (mm)", ylab="Probability of Increment",yaxt="n",xaxt="n",cex.axis=0.9, xlim=c(0.75,20.25),ylim=c(0.75,20.25),size=0.08, hide0=T, main="Probability of Growing into Y Given Starting Length Bin X")
axis(side=2, at=1:20, labels=seq(2.5,97.5,5), cex.axis=0.9, las=2)
axis(side=1, at=1:20, labels=seq(2.5,97.5,5), cex.axis=0.9, las=2)
abline(a=0,b=1)
K<-0.1
Exp_delta_size<-(Linf-Size_mdpts)*(1-exp(-K))
Exp_delta_size<-ifelse(Exp_delta_size<0, 0.1, Exp_delta_size)
CV_delta_size<-0.25
sd_delta_size<-CV_delta_size*Exp_delta_size
Size_tran<-matrix(NA, nrow=20, ncol=20)
for (i in 1:20){
Size_tran[i,1]<-pnorm(5,mean=Size_mdpts[i]+Exp_delta_size[i], sd=sd_delta_size[i])
for (j in 2:19){
Size_tran[i,j]<-pnorm(Size_mdpts[j]+2.5,mean=Size_mdpts[i]+Exp_delta_size[i], sd=sd_delta_size[i])-pnorm(Size_mdpts[j]-2.5,mean=Size_mdpts[i]+Exp_delta_size[i], sd=sd_delta_size[i])
}
Size_tran[i,20]<-pnorm(150,mean=Size_mdpts[i]+Exp_delta_size[i], sd=sd_delta_size[i])-pnorm(95,mean=Size_mdpts[i]+Exp_delta_size[i], sd=sd_delta_size[i])
}
par(mfrow=c(1,1), mar=c(5,4,2,1)+0.1)
plotBubbles(t(Size_tran), xlab="Starting Bin Midpoint (mm)", ylab="Probability of Increment",yaxt="n",xaxt="n",cex.axis=0.9, xlim=c(0.75,20.25),ylim=c(0.75,20.25),size=0.08, hide0=T, main="Probability of Growing into Y Given Starting Length Bin X")
axis(side=2, at=1:20, labels=seq(2.5,97.5,5), cex.axis=0.9, las=2)
axis(side=1, at=1:20, labels=seq(2.5,97.5,5), cex.axis=0.9, las=2)
abline(a=0,b=1)
Exp_delta_size<-(Linf-Size_mdpts)*(1-exp(-K))
Exp_delta_size<-ifelse(Exp_delta_size<0, 0.1, Exp_delta_size)
CV_delta_size<-0.75
sd_delta_size<-CV_delta_size*Exp_delta_size
Exp_delta_size
sd_delta_size
#Normal Distribution
Size_tran<-matrix(NA, nrow=20, ncol=20)
for (i in 1:20){
Size_tran[i,1]<-pnorm(5,mean=Size_mdpts[i]+Exp_delta_size[i], sd=sd_delta_size[i])
for (j in 2:19){
Size_tran[i,j]<-pnorm(Size_mdpts[j]+2.5,mean=Size_mdpts[i]+Exp_delta_size[i], sd=sd_delta_size[i])-pnorm(Size_mdpts[j]-2.5,mean=Size_mdpts[i]+Exp_delta_size[i], sd=sd_delta_size[i])
}
Size_tran[i,20]<-pnorm(150,mean=Size_mdpts[i]+Exp_delta_size[i], sd=sd_delta_size[i])-pnorm(95,mean=Size_mdpts[i]+Exp_delta_size[i], sd=sd_delta_size[i])
}
par(mfrow=c(1,1), mar=c(5,4,2,1)+0.1)
plotBubbles(t(Size_tran), xlab="Starting Bin Midpoint (mm)", ylab="Probability of Increment",yaxt="n",xaxt="n",cex.axis=0.9, xlim=c(0.75,20.25),ylim=c(0.75,20.25),size=0.08, hide0=T, main="Probability of Growing into Y Given Starting Length Bin X")
axis(side=2, at=1:20, labels=seq(2.5,97.5,5), cex.axis=0.9, las=2)
axis(side=1, at=1:20, labels=seq(2.5,97.5,5), cex.axis=0.9, las=2)
abline(a=0,b=1)
K<-0.3
Exp_delta_size<-(Linf-Size_mdpts)*(1-exp(-K))
Exp_delta_size<-ifelse(Exp_delta_size<0, 0.1, Exp_delta_size)
CV_delta_size<-0.75
sd_delta_size<-CV_delta_size*Exp_delta_size
Exp_delta_size
sd_delta_size
#Normal Distribution
Size_tran<-matrix(NA, nrow=20, ncol=20)
for (i in 1:20){
Size_tran[i,1]<-pnorm(5,mean=Size_mdpts[i]+Exp_delta_size[i], sd=sd_delta_size[i])
for (j in 2:19){
Size_tran[i,j]<-pnorm(Size_mdpts[j]+2.5,mean=Size_mdpts[i]+Exp_delta_size[i], sd=sd_delta_size[i])-pnorm(Size_mdpts[j]-2.5,mean=Size_mdpts[i]+Exp_delta_size[i], sd=sd_delta_size[i])
}
Size_tran[i,20]<-pnorm(150,mean=Size_mdpts[i]+Exp_delta_size[i], sd=sd_delta_size[i])-pnorm(95,mean=Size_mdpts[i]+Exp_delta_size[i], sd=sd_delta_size[i])
}
par(mfrow=c(1,1), mar=c(5,4,2,1)+0.1)
plotBubbles(t(Size_tran), xlab="Starting Bin Midpoint (mm)", ylab="Probability of Increment",yaxt="n",xaxt="n",cex.axis=0.9, xlim=c(0.75,20.25),ylim=c(0.75,20.25),size=0.08, hide0=T, main="Probability of Growing into Y Given Starting Length Bin X")
axis(side=2, at=1:20, labels=seq(2.5,97.5,5), cex.axis=0.9, las=2)
axis(side=1, at=1:20, labels=seq(2.5,97.5,5), cex.axis=0.9, las=2)
abline(a=0,b=1)
require(MCMCpack)
install.packages("TMB")
wd<-"C:/Users/fischnic/Documents/GitHub/CKMR_Project"
load(paste0(wd,"/Cod_wdat_N1000_Ind25_ckmrmultinom25_1.RData"))
load(paste0(wd,"/Flatfish_wdat_N1000_Ind25_ckmrmultinom25_1.RData"))
load(paste0(wd,"/Sardine_wdat_N1000_Ind25_ckmrmultinom25_1.RData"))
Cod_OM<-Cod_wdat
Flatfish_OM<-Flatfish_wdat
Sardine_OM<-Sardine_wdat
#TMB Section
library(TMB)
install.packages('TMB', type = 'source')
wd
library(TMB)
install.packages("TMB")
install.packages("TMB")
library(TMB)
setwd(wd)
#Compile and load model
compile("SCAA_Fisch_wAge0.cpp")
