plot(d6$cultch_volume_kg_m3,log(d6$live_density/d6$cultch_volume_kg_m3), pch=19,cex=1, col=clr_dat,type="p",xlab=expression("Cultch volume kg/m"^3),ylab=expression("Live Oyster Density m"^2),bty="l",main="BH with Depensation", ylim=c(), las=1)
lines(p_S, log(((exp(theta[1])*p_S^exp(theta[3]))/(1+exp(theta[1])/exp(theta[2])*p_S^exp(theta[3])))/p_S), col=4, lwd=2)
lines(p_S, log(((exp(theta[1])*p_S^exp(theta[3]))/(1+exp(theta[1])/exp(theta[2])*p_S^exp(theta[3])))/p_S)+1.96*exp(theta[4]), col=4, lwd=2, lty=2)
lines(p_S, log(((exp(theta[1])*p_S^exp(theta[3]))/(1+exp(theta[1])/exp(theta[2])*p_S^exp(theta[3])))/p_S)-1.96*exp(theta[4]), col=4, lwd=2, lty=2)
dep_nll(theta=fit_bhdep$par,S=d6$cultch_volume_kg_m3,R=d6$live_density,p_S)
fit_bhdep
dep_nll(theta=log(c(0.4,280,1.25,0.8)),S=d6$cultch_volume_kg_m3,R=d6$live_density,p_S)
theta<-log(c(0.4,280,1.25,1))
plot(d6$cultch_volume_kg_m3,d6$live_density, pch=19,cex=1, col=clr_dat,type="p",xlab=expression("Cultch volume kg/m"^3),ylab=expression("Live Oyster Density m"^2),bty="l",main="BH with Depensation", ylim=c(0,700), las=1)
#lines(p_S,dep_nll(theta=fit_bhdep$par,S=d6$cultch_volume_kg_m3,R=d6$live_density,p_S)$p_R_bcorr, col=2, lwd=2)
lines(p_S, (exp(theta[1])*p_S^exp(theta[3]))/(1+exp(theta[1])/exp(theta[2])*p_S^exp(theta[3])), col=4, lwd=2)
#log()
plot(d6$cultch_volume_kg_m3,log(d6$live_density/d6$cultch_volume_kg_m3), pch=19,cex=1, col=clr_dat,type="p",xlab=expression("Cultch volume kg/m"^3),ylab=expression("Live Oyster Density m"^2),bty="l",main="BH with Depensation", ylim=c(), las=1)
lines(p_S, log(((exp(theta[1])*p_S^exp(theta[3]))/(1+exp(theta[1])/exp(theta[2])*p_S^exp(theta[3])))/p_S), col=4, lwd=2)
lines(p_S, log(((exp(theta[1])*p_S^exp(theta[3]))/(1+exp(theta[1])/exp(theta[2])*p_S^exp(theta[3])))/p_S)+1.96*exp(theta[4]), col=4, lwd=2, lty=2)
lines(p_S, log(((exp(theta[1])*p_S^exp(theta[3]))/(1+exp(theta[1])/exp(theta[2])*p_S^exp(theta[3])))/p_S)-1.96*exp(theta[4]), col=4, lwd=2, lty=2)
dat_new<-fit_bhdep<-list()
alp<-bet<-gam<-sig<-NA
theta<-log(c(0.4,280,1.25,1))
set.seed(1)
for(i in 1:1000){
dat_new[[i]]<-rlnorm(n=length(d6$cultch_volume_kg_m3),meanlog=log(((exp(theta[1])*d6$cultch_volume_kg_m3^exp(theta[3]))/(1+exp(theta[1])/exp(theta[2])*d6$cultch_volume_kg_m3^exp(theta[3])))/d6$cultch_volume_kg_m3), sdlog=exp(theta[4]))
theta_start<-log(c(2,300,1,0.7))
fit_bhdep[[i]]<-optim(par=theta_start,function(theta)dep_nll(theta,S=d6$cultch_volume_kg_m3,R=exp(dat_new[[i]])*d6$live_density,p_S)$nll,hessian=TRUE)
alp[i]<-exp(fit_bhdep[[i]]$par[1])
bet[i]<-exp(fit_bhdep[[i]]$par[2])
gam[i]<-exp(fit_bhdep[[i]]$par[3])
sig[i]<-exp(fit_bhdep[[i]]$par[4])
}
hist(gam, breaks=seq(0,200,0.02), xlim=c(0,3))
abline(v=1, col=2)
length(which(gam<1))
wd<-"C:/Users/fischn/Documents/GitHub/CKMR_Project/"
unif_lbound<-0.95
unif_ubound<-3
load(paste0(wd,"/Cod_wdat_N100_Ind25_ckmrmultinom20_1.RData"))
load(paste0(wd,"/Flatfish_wdat_N100_Ind25_ckmrmultinom20_1.RData"))
load(paste0(wd,"/Sardine_wdat_N100_Ind25_ckmrmultinom20_1.RData"))
Cod_OM<-Cod_wdat
Flatfish_OM<-Flatfish_wdat
Sardine_OM<-Sardine_wdat
#TMB Section
library(TMB)
setwd(wd)
#Compile and load model
compile("SCAA_Fisch_wAge0.cpp")
#Doing N Simulations
N_sim<-1:100
res_list<-list()
for (Q in 1:3){  #Running through the life history types
res_list[[Q]]<-list()
for (s in N_sim){
if(Q==1){
OM<-Cod_OM[[s]]
} else if (Q==2){
OM<-Flatfish_OM[[s]]
}else if (Q==3){
OM<-Sardine_OM[[s]]
}
dat<-list(fyear=OM$OM$fyear, lyear=75, fage=OM$OM$fage, lage=OM$OM$lage,
years=OM$OM$fyear:75, ages=OM$OM$fage:OM$OM$lage,
obs_harv=OM$Obs_Catch,
obs_index=OM$Obs_Index,
obs_fishery_comp=OM$Obs_Catch_Comp/rowSums(OM$Obs_Catch_Comp),
SS_fishery=rowSums(OM$Obs_Catch_Comp),
Mat=OM$OM$Mat,
Laa=OM$OM$Laa,
Waa=OM$OM$Waa,
Lamda_Harvest=1,                           #Switch for whether to use a data source or not, 0=no, 1=yes
Lamda_Comp=1,
Lamda_Index=0)
#Parameters
set.seed(s)
par <- list(log_M=log(runif(1,min=OM$OM$Mref-OM$OM$Mref*unif_lbound,max=OM$OM$Mref+OM$OM$Mref*unif_ubound)),
log_q=log(runif(1,min=OM$q_index-OM$q_index*unif_lbound,max=OM$q_index+OM$q_index*unif_ubound)),
log_recruit_devs_init=rep(0,dat$lage),
log_recruit_devs=rep(0,dat$lyear),
steepness=OM$OM$h,
log_R0=log(runif(1,min=OM$OM$R0-OM$OM$R0*unif_lbound,max=OM$OM$R0+OM$OM$R0*unif_ubound)),
log_sigma_rec=log(runif(1,min=OM$OM$sd_rec-OM$OM$sd_rec*unif_lbound,max=OM$OM$sd_rec+OM$OM$sd_rec*unif_ubound)),
log_sd_catch=log(OM$sd_catch),
log_sd_index=log(OM$sd_index),
Sel_logis_k=log(runif(1,min=OM$OM$Sel_slope-OM$OM$Sel_slope*unif_lbound,max=OM$OM$Sel_slope+OM$OM$Sel_slope*unif_ubound)),
Sel_logis_midpt=log(runif(1,min=OM$OM$Sel_50-OM$OM$Sel_50*unif_lbound,max=OM$OM$Sel_50+OM$OM$Sel_50*unif_ubound)),
log_fint=log(runif(length(OM$OM$F_int[26:100]),min=OM$OM$F_int[26:100]-OM$OM$F_int[26:100]*unif_lbound,max=OM$OM$F_int[26:100]+OM$OM$F_int[26:100]*unif_ubound)))
################
#TMB stuff
################
dyn.load(dynlib("SCAA_Fisch_wAge0"))
parm_names<-names(MakeADFun(dat, par, DLL="SCAA_Fisch_wAge0")$par)
fixed<-list(steepness=factor(NA),
log_sd_catch=factor(NA),
log_q=factor(NA),
log_sd_index=factor(NA))
lower_bounds<-c(-5,-20,rep(-10,dat$lage),rep(-10,dat$lyear), 0, 5, -5,-5,-5,-5,-5,rep(-10,dat$lyear))
upper_bounds<-c( 2,  1,rep( 10,dat$lage),rep( 10,dat$lyear), 1, 25, 2, 2, 2, 5, 5,rep(  0,dat$lyear))
reffects=c("log_recruit_devs","log_recruit_devs_init")
l<-lower_bounds[-which(parm_names %in% c(names(fixed),reffects))]
u<-upper_bounds[-which(parm_names %in% c(names(fixed),reffects))]
SCAA <- MakeADFun(dat, par, DLL="SCAA_Fisch_wAge0", map=fixed, random=reffects)
SCAA_fit <- TMBhelper::fit_tmb(obj=SCAA, startpar=SCAA$par, lower=l, upper=u, newtonsteps = 1,getsd=TRUE,bias.correct=TRUE,getHessian=TRUE)
res_list[[Q]][[s]]<-SCAA_fit
print(c(Q,s))
}
}
saveRDS(res_list[[1]], file=paste0(wd,"/SCAAfit_Cod_N100_NoIndex_20yrs_noCKMR_Unif_l05u3.RData"))
saveRDS(res_list[[2]], file=paste0(wd,"/SCAAfit_Flatfish_N100_NoIndex_20yrs_noCKMR_Unif_l05u3.RData"))
saveRDS(res_list[[3]], file=paste0(wd,"/SCAAfit_Sardine_N100_NoIndex_20yrs_noCKMR_Unif_l05u3.RData"))
windows()
load(paste0(wd,"/Cod_wdat_N100_Ind25_ckmrmultinom20_1.RData"))
load(paste0(wd,"/Flatfish_wdat_N100_Ind25_ckmrmultinom20_1.RData"))
load(paste0(wd,"/Sardine_wdat_N100_Ind25_ckmrmultinom20_1.RData"))
Cod_100_25_20<-Cod_wdat
Flatfish_100_25_20<-Flatfish_wdat
Sardine_100_25_20<-Sardine_wdat
#unif 0.65
#N100 for 20yrs, and index sd 0.25
res_list<-list()
res_list[[1]]<-readRDS(paste0(wd,"/SCAAfit_Cod_N100_NoIndex_20yrs_noCKMR_Unif65.RData"))
res_list[[2]]<-readRDS(paste0(wd,"/SCAAfit_Flatfish_N100_NoIndex_20yrs_noCKMR_Unif65.RData"))
res_list[[3]]<-readRDS(paste0(wd,"/SCAAfit_Sardine_N100_NoIndex_20yrs_noCKMR_Unif65.RData"))
Cod_wdat<-Cod_100_25_20
Flatfish_wdat<-Flatfish_100_25_20
Sardine_wdat<-Sardine_100_25_20
re_Dep<-re_SSB<-array(NA, dim=c(3,100,76))
re_R0<-re_M<-matrix(NA, nrow=100, ncol=3)
for(f in 1:3){
for (i in 1:100){
if(f==1){
re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Cod_wdat[[i]]$OM$SSB[26:101])/Cod_wdat[[i]]$OM$SSB[26:101]
#re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Cod_wdat[[i]]$OM$SSB[26:101]/Cod_wdat[[i]]$OM$SSB0)/(Cod_wdat[[i]]$OM$SSB[26:101]/Cod_wdat[[i]]$OM$SSB0)
re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[2])-Cod_wdat[[i]]$OM$R0)/Cod_wdat[[i]]$OM$R0
re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Cod_wdat[[i]]$OM$Mref)/Cod_wdat[[i]]$OM$Mref
}else if (f==2){
re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Flatfish_wdat[[i]]$OM$SSB[26:101])/Flatfish_wdat[[i]]$OM$SSB[26:101]
#re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Flatfish_wdat[[i]]$OM$SSB[26:101]/Flatfish_wdat[[i]]$OM$SSB0)/(Flatfish_wdat[[i]]$OM$SSB[26:101]/Flatfish_wdat[[i]]$OM$SSB0)
re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[2])-Flatfish_wdat[[i]]$OM$R0)/Flatfish_wdat[[i]]$OM$R0
re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Flatfish_wdat[[i]]$OM$Mref)/Flatfish_wdat[[i]]$OM$Mref
} else if (f==3){
re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Sardine_wdat[[i]]$OM$SSB[26:101])/Sardine_wdat[[i]]$OM$SSB[26:101]
#re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Sardine_wdat[[i]]$OM$SSB[26:101]/Sardine_wdat[[i]]$OM$SSB0)/(Sardine_wdat[[i]]$OM$SSB[26:101]/Sardine_wdat[[i]]$OM$SSB0)
re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[2])-Sardine_wdat[[i]]$OM$R0)/Sardine_wdat[[i]]$OM$R0
re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Sardine_wdat[[i]]$OM$Mref)/Sardine_wdat[[i]]$OM$Mref
}
}
}
#SSB
par(mfrow=c(3,3))
boxplot(re_SSB[1,,], ylim=c(-0.25,0.25), las=1, main="Cod - N100, Index SD - 0.25, No CKMR", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[2,,], ylim=c(-0.25,0.25), las=1, main="Flatfish - N100, Index SD - 0.25, No CKMR", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[3,,], ylim=c(-0.25,0.25), las=1, main="Sardine - N100, Index SD - 0.25, No CKMR", ylab="RE - SSB")
abline(h=0)
#R0
boxplot(re_R0[,1], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,2], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,3], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
#M
boxplot(re_M[,1], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,2], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,3], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
#Relative error for point estimates
RE_ssb_N100_Ind25_noCKMR_Unif65<-re_SSB
RE_R0_N100_Ind25_noCKMR_Unif65<-re_R0
RE_M_N100_Ind25_noCKMR_Unif65<-re_M
#Interquartile Range of relative errors
IQR_RE_ssb_N100_Ind25_noCKMR_Unif65<-apply(re_SSB,c(1,3),quantile,probs=0.75, na.rm=TRUE)-apply(re_SSB,c(1,3),quantile,probs=0.25, na.rm=TRUE)
IQR_RE_R0_N100_Ind25_noCKMR_Unif65<-apply(re_R0,2,quantile,probs=0.75, na.rm=TRUE)-apply(re_R0,2,quantile,probs=0.25, na.rm=TRUE)
IQR_RE_M_N100_Ind25_noCKMR_Unif65<-apply(re_M,2,quantile,probs=0.75, na.rm=TRUE)-apply(re_M,2,quantile,probs=0.25, na.rm=TRUE)
#Interquartile Range of absolute relative errors
IQR_ARE_ssb_N100_Ind25_noCKMR<-apply(abs(re_SSB),c(1,3),quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_SSB),c(1,3),quantile,probs=0.25, na.rm=TRUE)
IQR_ARE_R0_N100_Ind25_noCKMR<-apply(abs(re_R0),2,quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_R0),2,quantile,probs=0.25, na.rm=TRUE)
IQR_ARE_M_N100_Ind25_noCKMR<-apply(abs(re_M),2,quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_M),2,quantile,probs=0.25, na.rm=TRUE)
#SD of relative error for point estimates
sd_RE_ssb_N100_Ind25_noCKMR_Unif65<-apply(re_SSB,c(1,3),sd, na.rm=TRUE)
sd_RE_R0_N100_Ind25_noCKMR_Unif65<-apply(re_R0,2,sd, na.rm=TRUE)
sd_RE_M_N100_Ind25_noCKMR_Unif65<-apply(re_M,2,sd, na.rm=TRUE)
#SD of absolute relative error
sd_ARE_ssb_N100_Ind25_noCKMR_Unif65<-apply(abs(re_SSB),c(1,3),sd, na.rm=TRUE)
sd_ARE_R0_N100_Ind25_noCKMR_Unif65<-apply(abs(re_R0),2,sd, na.rm=TRUE)
sd_ARE_M_N100_Ind25_noCKMR_Unif65<-apply(abs(re_M),2,sd, na.rm=TRUE)
#Precision within sims
SD_ssb_N100_Ind25_noCKMR_Unif65<-CV_ssb_N100_Ind25_noCKMR_Unif65<-array(NA, dim=c(3,100,76))
SD_R0_N100_Ind25_noCKMR_Unif65<-matrix(NA, nrow=3, ncol=100)
SD_M_N100_Ind25_noCKMR_Unif65<-matrix(NA, nrow=3, ncol=100)
for(f in 1:3){
for (i in 1:100){
CV_ssb_N100_Ind25_noCKMR_Unif65[f,i,]<-res_list[[f]][[i]]$SD$sd/res_list[[f]][[i]]$SD$unbiased$value
SD_ssb_N100_Ind25_noCKMR_Unif65[f,i,]<-res_list[[f]][[i]]$SD$sd
SD_R0_N100_Ind25_noCKMR_Unif65[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_R0","log_R0"])
SD_M_N100_Ind25_noCKMR_Unif65[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_M","log_M"])
}
}
#unif 0.8
#N100 for 20yrs, and index sd 0.25
res_list<-list()
res_list[[1]]<-readRDS(paste0(wd,"/SCAAfit_Cod_N100_NoIndex_20yrs_noCKMR_Unif80.RData"))
res_list[[2]]<-readRDS(paste0(wd,"/SCAAfit_Flatfish_N100_NoIndex_20yrs_noCKMR_Unif80.RData"))
res_list[[3]]<-readRDS(paste0(wd,"/SCAAfit_Sardine_N100_NoIndex_20yrs_noCKMR_Unif80.RData"))
Cod_wdat<-Cod_100_25_20
Flatfish_wdat<-Flatfish_100_25_20
Sardine_wdat<-Sardine_100_25_20
re_Dep<-re_SSB<-array(NA, dim=c(3,100,76))
re_R0<-re_M<-matrix(NA, nrow=100, ncol=3)
for(f in 1:3){
for (i in 1:100){
if(f==1){
re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Cod_wdat[[i]]$OM$SSB[26:101])/Cod_wdat[[i]]$OM$SSB[26:101]
#re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Cod_wdat[[i]]$OM$SSB[26:101]/Cod_wdat[[i]]$OM$SSB0)/(Cod_wdat[[i]]$OM$SSB[26:101]/Cod_wdat[[i]]$OM$SSB0)
re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[2])-Cod_wdat[[i]]$OM$R0)/Cod_wdat[[i]]$OM$R0
re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Cod_wdat[[i]]$OM$Mref)/Cod_wdat[[i]]$OM$Mref
}else if (f==2){
re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Flatfish_wdat[[i]]$OM$SSB[26:101])/Flatfish_wdat[[i]]$OM$SSB[26:101]
#re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Flatfish_wdat[[i]]$OM$SSB[26:101]/Flatfish_wdat[[i]]$OM$SSB0)/(Flatfish_wdat[[i]]$OM$SSB[26:101]/Flatfish_wdat[[i]]$OM$SSB0)
re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[2])-Flatfish_wdat[[i]]$OM$R0)/Flatfish_wdat[[i]]$OM$R0
re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Flatfish_wdat[[i]]$OM$Mref)/Flatfish_wdat[[i]]$OM$Mref
} else if (f==3){
re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Sardine_wdat[[i]]$OM$SSB[26:101])/Sardine_wdat[[i]]$OM$SSB[26:101]
#re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Sardine_wdat[[i]]$OM$SSB[26:101]/Sardine_wdat[[i]]$OM$SSB0)/(Sardine_wdat[[i]]$OM$SSB[26:101]/Sardine_wdat[[i]]$OM$SSB0)
re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[2])-Sardine_wdat[[i]]$OM$R0)/Sardine_wdat[[i]]$OM$R0
re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Sardine_wdat[[i]]$OM$Mref)/Sardine_wdat[[i]]$OM$Mref
}
}
}
#SSB
par(mfrow=c(3,3))
boxplot(re_SSB[1,,], ylim=c(-0.25,0.25), las=1, main="Cod - N100, Index SD - 0.25, No CKMR", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[2,,], ylim=c(-0.25,0.25), las=1, main="Flatfish - N100, Index SD - 0.25, No CKMR", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[3,,], ylim=c(-0.25,0.25), las=1, main="Sardine - N100, Index SD - 0.25, No CKMR", ylab="RE - SSB")
abline(h=0)
#R0
boxplot(re_R0[,1], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,2], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,3], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
#M
boxplot(re_M[,1], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,2], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,3], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
#Relative error for point estimates
RE_ssb_N100_Ind25_noCKMR_Unif80<-re_SSB
RE_R0_N100_Ind25_noCKMR_Unif80<-re_R0
RE_M_N100_Ind25_noCKMR_Unif80<-re_M
#Interquartile Range of relative errors
IQR_RE_ssb_N100_Ind25_noCKMR_Unif80<-apply(re_SSB,c(1,3),quantile,probs=0.75, na.rm=TRUE)-apply(re_SSB,c(1,3),quantile,probs=0.25, na.rm=TRUE)
IQR_RE_R0_N100_Ind25_noCKMR_Unif80<-apply(re_R0,2,quantile,probs=0.75, na.rm=TRUE)-apply(re_R0,2,quantile,probs=0.25, na.rm=TRUE)
IQR_RE_M_N100_Ind25_noCKMR_Unif80<-apply(re_M,2,quantile,probs=0.75, na.rm=TRUE)-apply(re_M,2,quantile,probs=0.25, na.rm=TRUE)
#Interquartile Range of absolute relative errors
IQR_ARE_ssb_N100_Ind25_noCKMR<-apply(abs(re_SSB),c(1,3),quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_SSB),c(1,3),quantile,probs=0.25, na.rm=TRUE)
IQR_ARE_R0_N100_Ind25_noCKMR<-apply(abs(re_R0),2,quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_R0),2,quantile,probs=0.25, na.rm=TRUE)
IQR_ARE_M_N100_Ind25_noCKMR<-apply(abs(re_M),2,quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_M),2,quantile,probs=0.25, na.rm=TRUE)
#SD of relative error for point estimates
sd_RE_ssb_N100_Ind25_noCKMR_Unif80<-apply(re_SSB,c(1,3),sd, na.rm=TRUE)
sd_RE_R0_N100_Ind25_noCKMR_Unif80<-apply(re_R0,2,sd, na.rm=TRUE)
sd_RE_M_N100_Ind25_noCKMR_Unif80<-apply(re_M,2,sd, na.rm=TRUE)
#SD of absolute relative error
sd_ARE_ssb_N100_Ind25_noCKMR_Unif80<-apply(abs(re_SSB),c(1,3),sd, na.rm=TRUE)
sd_ARE_R0_N100_Ind25_noCKMR_Unif80<-apply(abs(re_R0),2,sd, na.rm=TRUE)
sd_ARE_M_N100_Ind25_noCKMR_Unif80<-apply(abs(re_M),2,sd, na.rm=TRUE)
#Precision within sims
SD_ssb_N100_Ind25_noCKMR_Unif80<-CV_ssb_N100_Ind25_noCKMR_Unif80<-array(NA, dim=c(3,100,76))
SD_R0_N100_Ind25_noCKMR_Unif80<-matrix(NA, nrow=3, ncol=100)
SD_M_N100_Ind25_noCKMR_Unif80<-matrix(NA, nrow=3, ncol=100)
for(f in 1:3){
for (i in 1:100){
CV_ssb_N100_Ind25_noCKMR_Unif80[f,i,]<-res_list[[f]][[i]]$SD$sd/res_list[[f]][[i]]$SD$unbiased$value
SD_ssb_N100_Ind25_noCKMR_Unif80[f,i,]<-res_list[[f]][[i]]$SD$sd
SD_R0_N100_Ind25_noCKMR_Unif80[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_R0","log_R0"])
SD_M_N100_Ind25_noCKMR_Unif80[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_M","log_M"])
}
}
#unif 0.95
#N100 for 20yrs, and index sd 0.25
res_list<-list()
res_list[[1]]<-readRDS(paste0(wd,"/SCAAfit_Cod_N100_NoIndex_20yrs_noCKMR_Unif95.RData"))
res_list[[2]]<-readRDS(paste0(wd,"/SCAAfit_Flatfish_N100_NoIndex_20yrs_noCKMR_Unif95.RData"))
res_list[[3]]<-readRDS(paste0(wd,"/SCAAfit_Sardine_N100_NoIndex_20yrs_noCKMR_Unif95.RData"))
Cod_wdat<-Cod_100_25_20
Flatfish_wdat<-Flatfish_100_25_20
Sardine_wdat<-Sardine_100_25_20
re_Dep<-re_SSB<-array(NA, dim=c(3,100,76))
re_R0<-re_M<-matrix(NA, nrow=100, ncol=3)
for(f in 1:3){
for (i in 1:100){
if(f==1){
if(!is.null(res_list[[f]][[i]]$SD$unbiased$value)){
re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Cod_wdat[[i]]$OM$SSB[26:101])/Cod_wdat[[i]]$OM$SSB[26:101]
#re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Cod_wdat[[i]]$OM$SSB[26:101]/Cod_wdat[[i]]$OM$SSB0)/(Cod_wdat[[i]]$OM$SSB[26:101]/Cod_wdat[[i]]$OM$SSB0)
re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[2])-Cod_wdat[[i]]$OM$R0)/Cod_wdat[[i]]$OM$R0
re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Cod_wdat[[i]]$OM$Mref)/Cod_wdat[[i]]$OM$Mref
}
}else if (f==2){
if(!is.null(res_list[[f]][[i]]$SD$unbiased$value)){
re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Flatfish_wdat[[i]]$OM$SSB[26:101])/Flatfish_wdat[[i]]$OM$SSB[26:101]
#re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Flatfish_wdat[[i]]$OM$SSB[26:101]/Flatfish_wdat[[i]]$OM$SSB0)/(Flatfish_wdat[[i]]$OM$SSB[26:101]/Flatfish_wdat[[i]]$OM$SSB0)
re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[2])-Flatfish_wdat[[i]]$OM$R0)/Flatfish_wdat[[i]]$OM$R0
re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Flatfish_wdat[[i]]$OM$Mref)/Flatfish_wdat[[i]]$OM$Mref
}
} else if (f==3){
if(!is.null(res_list[[f]][[i]]$SD$unbiased$value)){
re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Sardine_wdat[[i]]$OM$SSB[26:101])/Sardine_wdat[[i]]$OM$SSB[26:101]
#re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Sardine_wdat[[i]]$OM$SSB[26:101]/Sardine_wdat[[i]]$OM$SSB0)/(Sardine_wdat[[i]]$OM$SSB[26:101]/Sardine_wdat[[i]]$OM$SSB0)
re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[2])-Sardine_wdat[[i]]$OM$R0)/Sardine_wdat[[i]]$OM$R0
re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Sardine_wdat[[i]]$OM$Mref)/Sardine_wdat[[i]]$OM$Mref
}
}
}
}
#SSB
par(mfrow=c(3,3))
boxplot(re_SSB[1,,], ylim=c(-0.25,0.25), las=1, main="Cod - N100, Index SD - 0.25, No CKMR", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[2,,], ylim=c(-0.25,0.25), las=1, main="Flatfish - N100, Index SD - 0.25, No CKMR", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[3,,], ylim=c(-0.25,0.25), las=1, main="Sardine - N100, Index SD - 0.25, No CKMR", ylab="RE - SSB")
abline(h=0)
#R0
boxplot(re_R0[,1], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,2], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,3], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
#M
boxplot(re_M[,1], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,2], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,3], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
#Relative error for point estimates
RE_ssb_N100_Ind25_noCKMR_Unif95<-re_SSB
RE_R0_N100_Ind25_noCKMR_Unif95<-re_R0
RE_M_N100_Ind25_noCKMR_Unif95<-re_M
#Interquartile Range of relative errors
IQR_RE_ssb_N100_Ind25_noCKMR_Unif95<-apply(re_SSB,c(1,3),quantile,probs=0.75, na.rm=TRUE)-apply(re_SSB,c(1,3),quantile,probs=0.25, na.rm=TRUE)
IQR_RE_R0_N100_Ind25_noCKMR_Unif95<-apply(re_R0,2,quantile,probs=0.75, na.rm=TRUE)-apply(re_R0,2,quantile,probs=0.25, na.rm=TRUE)
IQR_RE_M_N100_Ind25_noCKMR_Unif95<-apply(re_M,2,quantile,probs=0.75, na.rm=TRUE)-apply(re_M,2,quantile,probs=0.25, na.rm=TRUE)
#Interquartile Range of absolute relative errors
IQR_ARE_ssb_N100_Ind25_noCKMR<-apply(abs(re_SSB),c(1,3),quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_SSB),c(1,3),quantile,probs=0.25, na.rm=TRUE)
IQR_ARE_R0_N100_Ind25_noCKMR<-apply(abs(re_R0),2,quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_R0),2,quantile,probs=0.25, na.rm=TRUE)
IQR_ARE_M_N100_Ind25_noCKMR<-apply(abs(re_M),2,quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_M),2,quantile,probs=0.25, na.rm=TRUE)
#SD of relative error for point estimates
sd_RE_ssb_N100_Ind25_noCKMR_Unif95<-apply(re_SSB,c(1,3),sd, na.rm=TRUE)
sd_RE_R0_N100_Ind25_noCKMR_Unif95<-apply(re_R0,2,sd, na.rm=TRUE)
sd_RE_M_N100_Ind25_noCKMR_Unif95<-apply(re_M,2,sd, na.rm=TRUE)
#SD of absolute relative error
sd_ARE_ssb_N100_Ind25_noCKMR_Unif95<-apply(abs(re_SSB),c(1,3),sd, na.rm=TRUE)
sd_ARE_R0_N100_Ind25_noCKMR_Unif95<-apply(abs(re_R0),2,sd, na.rm=TRUE)
sd_ARE_M_N100_Ind25_noCKMR_Unif95<-apply(abs(re_M),2,sd, na.rm=TRUE)
#Precision within sims
SD_ssb_N100_Ind25_noCKMR_Unif95<-CV_ssb_N100_Ind25_noCKMR_Unif95<-array(NA, dim=c(3,100,76))
SD_R0_N100_Ind25_noCKMR_Unif95<-matrix(NA, nrow=3, ncol=100)
SD_M_N100_Ind25_noCKMR_Unif95<-matrix(NA, nrow=3, ncol=100)
for(f in 1:3){
for (i in 1:100){
if(!is.null(res_list[[f]][[i]]$SD$unbiased$value)){
CV_ssb_N100_Ind25_noCKMR_Unif95[f,i,]<-res_list[[f]][[i]]$SD$sd/res_list[[f]][[i]]$SD$unbiased$value
SD_ssb_N100_Ind25_noCKMR_Unif95[f,i,]<-res_list[[f]][[i]]$SD$sd
SD_R0_N100_Ind25_noCKMR_Unif95[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_R0","log_R0"])
SD_M_N100_Ind25_noCKMR_Unif95[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_M","log_M"])
}
}
}
res_list<-list()
res_list[[1]]<-readRDS(paste0(wd,"/SCAAfit_Cod_N100_NoIndex_20yrs_noCKMR_Unif_l05u3.RData"))
res_list[[2]]<-readRDS(paste0(wd,"/SCAAfit_Flatfish_N100_NoIndex_20yrs_noCKMR_Unif_l05u3.RData"))
res_list[[3]]<-readRDS(paste0(wd,"/SCAAfit_Sardine_N100_NoIndex_20yrs_noCKMR_Unif_l05u3.RData"))
Cod_wdat<-Cod_100_25_20
Flatfish_wdat<-Flatfish_100_25_20
Sardine_wdat<-Sardine_100_25_20
re_Dep<-re_SSB<-array(NA, dim=c(3,100,76))
re_R0<-re_M<-matrix(NA, nrow=100, ncol=3)
for(f in 1:3){
for (i in 1:100){
if(f==1){
if(!is.null(res_list[[f]][[i]]$SD$unbiased$value)){
re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Cod_wdat[[i]]$OM$SSB[26:101])/Cod_wdat[[i]]$OM$SSB[26:101]
#re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Cod_wdat[[i]]$OM$SSB[26:101]/Cod_wdat[[i]]$OM$SSB0)/(Cod_wdat[[i]]$OM$SSB[26:101]/Cod_wdat[[i]]$OM$SSB0)
re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[2])-Cod_wdat[[i]]$OM$R0)/Cod_wdat[[i]]$OM$R0
re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Cod_wdat[[i]]$OM$Mref)/Cod_wdat[[i]]$OM$Mref
}
}else if (f==2){
if(!is.null(res_list[[f]][[i]]$SD$unbiased$value)){
re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Flatfish_wdat[[i]]$OM$SSB[26:101])/Flatfish_wdat[[i]]$OM$SSB[26:101]
#re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Flatfish_wdat[[i]]$OM$SSB[26:101]/Flatfish_wdat[[i]]$OM$SSB0)/(Flatfish_wdat[[i]]$OM$SSB[26:101]/Flatfish_wdat[[i]]$OM$SSB0)
re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[2])-Flatfish_wdat[[i]]$OM$R0)/Flatfish_wdat[[i]]$OM$R0
re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Flatfish_wdat[[i]]$OM$Mref)/Flatfish_wdat[[i]]$OM$Mref
}
} else if (f==3){
if(!is.null(res_list[[f]][[i]]$SD$unbiased$value)){
re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Sardine_wdat[[i]]$OM$SSB[26:101])/Sardine_wdat[[i]]$OM$SSB[26:101]
#re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Sardine_wdat[[i]]$OM$SSB[26:101]/Sardine_wdat[[i]]$OM$SSB0)/(Sardine_wdat[[i]]$OM$SSB[26:101]/Sardine_wdat[[i]]$OM$SSB0)
re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[2])-Sardine_wdat[[i]]$OM$R0)/Sardine_wdat[[i]]$OM$R0
re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Sardine_wdat[[i]]$OM$Mref)/Sardine_wdat[[i]]$OM$Mref
}
}
}
}
#SSB
par(mfrow=c(3,3))
boxplot(re_SSB[1,,], ylim=c(-0.25,0.25), las=1, main="Cod - N100, Index SD - 0.25, No CKMR", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[2,,], ylim=c(-0.25,0.25), las=1, main="Flatfish - N100, Index SD - 0.25, No CKMR", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[3,,], ylim=c(-0.25,0.25), las=1, main="Sardine - N100, Index SD - 0.25, No CKMR", ylab="RE - SSB")
abline(h=0)
#R0
boxplot(re_R0[,1], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,2], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,3], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
#M
boxplot(re_M[,1], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,2], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,3], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
#Relative error for point estimates
RE_ssb_N100_Ind25_noCKMR_Unif_l05u3<-re_SSB
RE_R0_N100_Ind25_noCKMR_Unif_l05u3<-re_R0
RE_M_N100_Ind25_noCKMR_Unif_l05u3<-re_M
#Interquartile Range of relative errors
IQR_RE_ssb_N100_Ind25_noCKMR_Unif_l05u3<-apply(re_SSB,c(1,3),quantile,probs=0.75, na.rm=TRUE)-apply(re_SSB,c(1,3),quantile,probs=0.25, na.rm=TRUE)
IQR_RE_R0_N100_Ind25_noCKMR_Unif_l05u3<-apply(re_R0,2,quantile,probs=0.75, na.rm=TRUE)-apply(re_R0,2,quantile,probs=0.25, na.rm=TRUE)
IQR_RE_M_N100_Ind25_noCKMR_Unif_l05u3<-apply(re_M,2,quantile,probs=0.75, na.rm=TRUE)-apply(re_M,2,quantile,probs=0.25, na.rm=TRUE)
#Interquartile Range of absolute relative errors
IQR_ARE_ssb_N100_Ind25_noCKMR<-apply(abs(re_SSB),c(1,3),quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_SSB),c(1,3),quantile,probs=0.25, na.rm=TRUE)
IQR_ARE_R0_N100_Ind25_noCKMR<-apply(abs(re_R0),2,quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_R0),2,quantile,probs=0.25, na.rm=TRUE)
IQR_ARE_M_N100_Ind25_noCKMR<-apply(abs(re_M),2,quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_M),2,quantile,probs=0.25, na.rm=TRUE)
#SD of relative error for point estimates
sd_RE_ssb_N100_Ind25_noCKMR_Unif_l05u3<-apply(re_SSB,c(1,3),sd, na.rm=TRUE)
sd_RE_R0_N100_Ind25_noCKMR_Unif_l05u3<-apply(re_R0,2,sd, na.rm=TRUE)
sd_RE_M_N100_Ind25_noCKMR_Unif_l05u3<-apply(re_M,2,sd, na.rm=TRUE)
#SD of absolute relative error
sd_ARE_ssb_N100_Ind25_noCKMR_Unif_l05u3<-apply(abs(re_SSB),c(1,3),sd, na.rm=TRUE)
sd_ARE_R0_N100_Ind25_noCKMR_Unif_l05u3<-apply(abs(re_R0),2,sd, na.rm=TRUE)
sd_ARE_M_N100_Ind25_noCKMR_Unif_l05u3<-apply(abs(re_M),2,sd, na.rm=TRUE)
#Precision within sims
SD_ssb_N100_Ind25_noCKMR_Unif_l05u3<-CV_ssb_N100_Ind25_noCKMR_Unif_l05u3<-array(NA, dim=c(3,100,76))
SD_R0_N100_Ind25_noCKMR_Unif_l05u3<-matrix(NA, nrow=3, ncol=100)
SD_M_N100_Ind25_noCKMR_Unif_l05u3<-matrix(NA, nrow=3, ncol=100)
for(f in 1:3){
for (i in 1:100){
if(!is.null(res_list[[f]][[i]]$SD$unbiased$value)){
CV_ssb_N100_Ind25_noCKMR_Unif_l05u3[f,i,]<-res_list[[f]][[i]]$SD$sd/res_list[[f]][[i]]$SD$unbiased$value
SD_ssb_N100_Ind25_noCKMR_Unif_l05u3[f,i,]<-res_list[[f]][[i]]$SD$sd
SD_R0_N100_Ind25_noCKMR_Unif_l05u3[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_R0","log_R0"])
SD_M_N100_Ind25_noCKMR_Unif_l05u3[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_M","log_M"])
}
}
}
plot(IQR_RE_ssb_N100_Ind25_noCKMR_Unif65[1,], ylim=c(0,0.5), las=1, pch=19)
points(IQR_RE_ssb_N100_Ind25_noCKMR_Unif80[1,], col=2, pch=19)
points(IQR_RE_ssb_N100_Ind25_noCKMR_Unif95[1,], col=3, pch=19)
points(IQR_RE_ssb_N100_Ind25_noCKMR_Unif_l05u3[1,], col=3, pch=19)
IQR_RE_ssb_N100_Ind25_noCKMR_Unif_l05u3[1,]
plot(IQR_RE_ssb_N100_Ind25_noCKMR_Unif65[1,], ylim=c(0,0.5), las=1, pch=19)
points(IQR_RE_ssb_N100_Ind25_noCKMR_Unif80[1,], col=2, pch=19)
points(IQR_RE_ssb_N100_Ind25_noCKMR_Unif95[1,], col=3, pch=19)
points(IQR_RE_ssb_N100_Ind25_noCKMR_Unif_l05u3[1,], col=4, pch=19)
plot(IQR_RE_ssb_N100_Ind25_noCKMR_Unif65[2,], ylim=c(0,1), las=1, pch=19)
points(IQR_RE_ssb_N100_Ind25_noCKMR_Unif80[2,], col=2, pch=19)
points(IQR_RE_ssb_N100_Ind25_noCKMR_Unif95[2,], col=3, pch=19)
points(IQR_RE_ssb_N100_Ind25_noCKMR_Unif_l05u3[2,], col=4, pch=19)
plot(IQR_RE_ssb_N100_Ind25_noCKMR_Unif65[3,], ylim=c(0,1), las=1, pch=19)
points(IQR_RE_ssb_N100_Ind25_noCKMR_Unif80[3,], col=2, pch=19)
points(IQR_RE_ssb_N100_Ind25_noCKMR_Unif95[3,], col=3, pch=19)
points(IQR_RE_ssb_N100_Ind25_noCKMR_Unif_l05u3[3,], col=4, pch=19)
par(mfrow=c(1,3))
plot(IQR_RE_ssb_N100_Ind25_noCKMR_Unif65[1,], ylim=c(0,0.5), las=1, pch=19)
points(IQR_RE_ssb_N100_Ind25_noCKMR_Unif80[1,], col=2, pch=19)
points(IQR_RE_ssb_N100_Ind25_noCKMR_Unif95[1,], col=3, pch=19)
points(IQR_RE_ssb_N100_Ind25_noCKMR_Unif_l05u3[1,], col=4, pch=19)
plot(IQR_RE_ssb_N100_Ind25_noCKMR_Unif65[2,], ylim=c(0,1), las=1, pch=19)
points(IQR_RE_ssb_N100_Ind25_noCKMR_Unif80[2,], col=2, pch=19)
points(IQR_RE_ssb_N100_Ind25_noCKMR_Unif95[2,], col=3, pch=19)
points(IQR_RE_ssb_N100_Ind25_noCKMR_Unif_l05u3[2,], col=4, pch=19)
plot(IQR_RE_ssb_N100_Ind25_noCKMR_Unif65[3,], ylim=c(0,1), las=1, pch=19)
points(IQR_RE_ssb_N100_Ind25_noCKMR_Unif80[3,], col=2, pch=19)
points(IQR_RE_ssb_N100_Ind25_noCKMR_Unif95[3,], col=3, pch=19)
points(IQR_RE_ssb_N100_Ind25_noCKMR_Unif_l05u3[3,], col=4, pch=19)
par(mfrow=c(1,3))
plot(IQR_RE_ssb_N100_Ind25_noCKMR_Unif65[1,], ylim=c(0,0.8), las=1, pch=19)
points(IQR_RE_ssb_N100_Ind25_noCKMR_Unif80[1,], col=2, pch=19)
points(IQR_RE_ssb_N100_Ind25_noCKMR_Unif95[1,], col=3, pch=19)
points(IQR_RE_ssb_N100_Ind25_noCKMR_Unif_l05u3[1,], col=4, pch=19)
plot(IQR_RE_ssb_N100_Ind25_noCKMR_Unif65[2,], ylim=c(0,0.8), las=1, pch=19)
points(IQR_RE_ssb_N100_Ind25_noCKMR_Unif80[2,], col=2, pch=19)
points(IQR_RE_ssb_N100_Ind25_noCKMR_Unif95[2,], col=3, pch=19)
points(IQR_RE_ssb_N100_Ind25_noCKMR_Unif_l05u3[2,], col=4, pch=19)
plot(IQR_RE_ssb_N100_Ind25_noCKMR_Unif65[3,], ylim=c(0,0.8), las=1, pch=19)
points(IQR_RE_ssb_N100_Ind25_noCKMR_Unif80[3,], col=2, pch=19)
points(IQR_RE_ssb_N100_Ind25_noCKMR_Unif95[3,], col=3, pch=19)
points(IQR_RE_ssb_N100_Ind25_noCKMR_Unif_l05u3[3,], col=4, pch=19)
