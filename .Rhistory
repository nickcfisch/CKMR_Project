boxplot(Pairs_Cod_100_25_5, at=1:2, ylim=c(0,60), las=1, xlab="", main="Cod", xlim=c(1,26), xaxt="n", col=c("rosybrown1", "skyblue"))
boxplot(Pairs_Cod_100_25_10, at=4:5, ylim=c(0,60), las=1, xlab="", main="", xlim=c(1,26), xaxt="n",yaxt="n", col=c("rosybrown1", "skyblue"), add=TRUE)
boxplot(Pairs_Cod_100_25_20, at=7:8, ylim=c(0,60), las=1, xlab="", main="", xlim=c(1,26), xaxt="n",yaxt="n", col=c("rosybrown1", "skyblue"), add=TRUE)
boxplot(Pairs_Cod_1000_25_5, at=10:11, ylim=c(0,60), las=1, xlab="", main="", xlim=c(1,26), xaxt="n",yaxt="n", col=c("rosybrown1", "skyblue"), add=TRUE)
boxplot(Pairs_Cod_1000_25_10, at=13:14, ylim=c(0,60), las=1, xlab="", main="", xlim=c(1,26), xaxt="n",yaxt="n", col=c("rosybrown1", "skyblue"), add=TRUE)
boxplot(Pairs_Cod_1000_25_20, at=16:17, ylim=c(0,60), las=1, xlab="", main="", xlim=c(1,26), xaxt="n",yaxt="n", col=c("rosybrown1", "skyblue"), add=TRUE)
boxplot(Pairs_Cod_5000_25_5, at=19:20, ylim=c(0,60), las=1, xlab="", main="", xlim=c(1,26), xaxt="n",yaxt="n", col=c("rosybrown1", "skyblue"), add=TRUE)
boxplot(Pairs_Cod_5000_25_10, at=22:23, ylim=c(0,60), las=1, xlab="", main="", xlim=c(1,26), xaxt="n",yaxt="n", col=c("rosybrown1", "skyblue"), add=TRUE)
boxplot(Pairs_Cod_5000_25_20, at=25:26, ylim=c(0,60), las=1, xlab="", main="", xlim=c(1,26), xaxt="n",yaxt="n", col=c("rosybrown1", "skyblue"), add=TRUE)
abline(v=c(9,18))
mtext(side=3,"100 CKMR Samples",line=-3, at=4.5)
mtext(side=3,"1,000 CKMR Samples",line=-3)
mtext(side=3,"5,000 CKMR Samples",line=-3, at=22.5)
axis(side=1, at=seq(1.5,25.5,3), c("5yrs","10yrs","20yrs","5yrs","10yrs","20yrs","5yrs","10yrs","20yrs"))
boxplot(Pairs_Flatfish_100_25_5, at=1:2, ylim=c(0,1.5e5), las=1, xlab="", main="Flatfish", xlim=c(1,26), xaxt="n", col=c("rosybrown1", "skyblue"))
boxplot(Pairs_Flatfish_100_25_10, at=4:5, ylim=c(0,1.5e5), las=1, xlab="", main="", xlim=c(1,26), xaxt="n",yaxt="n", col=c("rosybrown1", "skyblue"), add=TRUE)
boxplot(Pairs_Flatfish_100_25_20, at=7:8, ylim=c(0,1.5e5), las=1, xlab="", main="", xlim=c(1,26), xaxt="n",yaxt="n", col=c("rosybrown1", "skyblue"), add=TRUE)
boxplot(Pairs_Flatfish_1000_25_5, at=10:11, ylim=c(0,1.5e5), las=1, xlab="", main="", xlim=c(1,26), xaxt="n",yaxt="n", col=c("rosybrown1", "skyblue"), add=TRUE)
boxplot(Pairs_Flatfish_1000_25_10, at=13:14, ylim=c(0,1.5e5), las=1, xlab="", main="", xlim=c(1,26), xaxt="n",yaxt="n", col=c("rosybrown1", "skyblue"), add=TRUE)
boxplot(Pairs_Flatfish_1000_25_20, at=16:17, ylim=c(0,1.5e5), las=1, xlab="", main="", xlim=c(1,26), xaxt="n",yaxt="n", col=c("rosybrown1", "skyblue"), add=TRUE)
boxplot(Pairs_Flatfish_5000_25_5, at=19:20, ylim=c(0,1.5e5), las=1, xlab="", main="", xlim=c(1,26), xaxt="n",yaxt="n", col=c("rosybrown1", "skyblue"), add=TRUE)
boxplot(Pairs_Flatfish_5000_25_10, at=22:23, ylim=c(0,1.5e5), las=1, xlab="", main="", xlim=c(1,26), xaxt="n",yaxt="n", col=c("rosybrown1", "skyblue"), add=TRUE)
boxplot(Pairs_Flatfish_5000_25_20, at=25:26, ylim=c(0,1.5e5), las=1, xlab="", main="", xlim=c(1,26), xaxt="n",yaxt="n", col=c("rosybrown1", "skyblue"), add=TRUE)
abline(v=c(9,18))
axis(side=1, at=seq(1.5,25.5,3), c("5yrs","10yrs","20yrs","5yrs","10yrs","20yrs","5yrs","10yrs","20yrs"))
mtext(side=2,"Pairs Found",line=4)
legend("top", c("POP", "HSP+GGP"),pch=15, col=c("rosybrown1", "skyblue"), bty="n", pt.cex=1.2)
boxplot(Pairs_Sardine_100_25_5, at=1:2, ylim=c(0,1.05e3), las=1, xlab="", main="Sardine", xlim=c(1,26), col=c("rosybrown1", "skyblue"), xaxt="n")
boxplot(Pairs_Sardine_100_25_10, at=4:5, ylim=c(0,1.05e3), las=1, xlab="", main="", xlim=c(1,26), xaxt="n",yaxt="n", col=c("rosybrown1", "skyblue"), add=TRUE)
boxplot(Pairs_Sardine_100_25_20, at=7:8, ylim=c(0,1.05e3), las=1, xlab="", main="", xlim=c(1,26), xaxt="n",yaxt="n", col=c("rosybrown1", "skyblue"), add=TRUE)
boxplot(Pairs_Sardine_1000_25_5, at=10:11, ylim=c(0,1.05e3), las=1, xlab="", main="", xlim=c(1,26), xaxt="n",yaxt="n", col=c("rosybrown1", "skyblue"), add=TRUE)
boxplot(Pairs_Sardine_1000_25_10, at=13:14, ylim=c(0,1.05e3), las=1, xlab="", main="", xlim=c(1,26), xaxt="n",yaxt="n", col=c("rosybrown1", "skyblue"), add=TRUE)
boxplot(Pairs_Sardine_1000_25_20, at=16:17, ylim=c(0,1.05e3), las=1, xlab="", main="", xlim=c(1,26), xaxt="n",yaxt="n", col=c("rosybrown1", "skyblue"), add=TRUE)
boxplot(Pairs_Sardine_5000_25_5, at=19:20, ylim=c(0,1.05e3), las=1, xlab="", main="", xlim=c(1,26), xaxt="n",yaxt="n", col=c("rosybrown1", "skyblue"), add=TRUE)
boxplot(Pairs_Sardine_5000_25_10, at=22:23, ylim=c(0,1.05e3), las=1, xlab="", main="", xlim=c(1,26), xaxt="n",yaxt="n", col=c("rosybrown1", "skyblue"), add=TRUE)
boxplot(Pairs_Sardine_5000_25_20, at=25:26, ylim=c(0,1.05e3), las=1, xlab="", main="", xlim=c(1,26), xaxt="n",yaxt="n", col=c("rosybrown1", "skyblue"), add=TRUE)
abline(v=c(9,18))
axis(side=1, at=seq(1.5,25.5,3), c("5yrs","10yrs","20yrs","5yrs","10yrs","20yrs","5yrs","10yrs","20yrs"))
mtext(side=1,"Number of Years of CKMR Collection",line=3.5)
tiff(paste0(wd,"/CKMRPairs.tiff"), height=20, width=30, units='cm', compression="lzw", res=500)
par(mfrow=c(3,1), oma=c(2,2,1,1), mar=c(3.5,4,1,1))
boxplot(Pairs_Cod_100_25_5, at=1:2, ylim=c(0,60), las=1, xlab="", main="Cod", xlim=c(1,26), xaxt="n", col=c("rosybrown1", "skyblue"))
boxplot(Pairs_Cod_100_25_10, at=4:5, ylim=c(0,60), las=1, xlab="", main="", xlim=c(1,26), xaxt="n",yaxt="n", col=c("rosybrown1", "skyblue"), add=TRUE)
boxplot(Pairs_Cod_100_25_20, at=7:8, ylim=c(0,60), las=1, xlab="", main="", xlim=c(1,26), xaxt="n",yaxt="n", col=c("rosybrown1", "skyblue"), add=TRUE)
boxplot(Pairs_Cod_1000_25_5, at=10:11, ylim=c(0,60), las=1, xlab="", main="", xlim=c(1,26), xaxt="n",yaxt="n", col=c("rosybrown1", "skyblue"), add=TRUE)
boxplot(Pairs_Cod_1000_25_10, at=13:14, ylim=c(0,60), las=1, xlab="", main="", xlim=c(1,26), xaxt="n",yaxt="n", col=c("rosybrown1", "skyblue"), add=TRUE)
boxplot(Pairs_Cod_1000_25_20, at=16:17, ylim=c(0,60), las=1, xlab="", main="", xlim=c(1,26), xaxt="n",yaxt="n", col=c("rosybrown1", "skyblue"), add=TRUE)
boxplot(Pairs_Cod_5000_25_5, at=19:20, ylim=c(0,60), las=1, xlab="", main="", xlim=c(1,26), xaxt="n",yaxt="n", col=c("rosybrown1", "skyblue"), add=TRUE)
boxplot(Pairs_Cod_5000_25_10, at=22:23, ylim=c(0,60), las=1, xlab="", main="", xlim=c(1,26), xaxt="n",yaxt="n", col=c("rosybrown1", "skyblue"), add=TRUE)
boxplot(Pairs_Cod_5000_25_20, at=25:26, ylim=c(0,60), las=1, xlab="", main="", xlim=c(1,26), xaxt="n",yaxt="n", col=c("rosybrown1", "skyblue"), add=TRUE)
abline(v=c(9,18))
mtext(side=3,"100 CKMR Samples",line=-3, at=4.5)
mtext(side=3,"1,000 CKMR Samples",line=-3)
mtext(side=3,"5,000 CKMR Samples",line=-3, at=22.5)
axis(side=1, at=seq(1.5,25.5,3), c("5yrs","10yrs","20yrs","5yrs","10yrs","20yrs","5yrs","10yrs","20yrs"))
boxplot(Pairs_Flatfish_100_25_5, at=1:2, ylim=c(0,1.5e5), las=1, xlab="", main="Flatfish", xlim=c(1,26), xaxt="n", col=c("rosybrown1", "skyblue"))
boxplot(Pairs_Flatfish_100_25_10, at=4:5, ylim=c(0,1.5e5), las=1, xlab="", main="", xlim=c(1,26), xaxt="n",yaxt="n", col=c("rosybrown1", "skyblue"), add=TRUE)
boxplot(Pairs_Flatfish_100_25_20, at=7:8, ylim=c(0,1.5e5), las=1, xlab="", main="", xlim=c(1,26), xaxt="n",yaxt="n", col=c("rosybrown1", "skyblue"), add=TRUE)
boxplot(Pairs_Flatfish_1000_25_5, at=10:11, ylim=c(0,1.5e5), las=1, xlab="", main="", xlim=c(1,26), xaxt="n",yaxt="n", col=c("rosybrown1", "skyblue"), add=TRUE)
boxplot(Pairs_Flatfish_1000_25_10, at=13:14, ylim=c(0,1.5e5), las=1, xlab="", main="", xlim=c(1,26), xaxt="n",yaxt="n", col=c("rosybrown1", "skyblue"), add=TRUE)
boxplot(Pairs_Flatfish_1000_25_20, at=16:17, ylim=c(0,1.5e5), las=1, xlab="", main="", xlim=c(1,26), xaxt="n",yaxt="n", col=c("rosybrown1", "skyblue"), add=TRUE)
boxplot(Pairs_Flatfish_5000_25_5, at=19:20, ylim=c(0,1.5e5), las=1, xlab="", main="", xlim=c(1,26), xaxt="n",yaxt="n", col=c("rosybrown1", "skyblue"), add=TRUE)
boxplot(Pairs_Flatfish_5000_25_10, at=22:23, ylim=c(0,1.5e5), las=1, xlab="", main="", xlim=c(1,26), xaxt="n",yaxt="n", col=c("rosybrown1", "skyblue"), add=TRUE)
boxplot(Pairs_Flatfish_5000_25_20, at=25:26, ylim=c(0,1.5e5), las=1, xlab="", main="", xlim=c(1,26), xaxt="n",yaxt="n", col=c("rosybrown1", "skyblue"), add=TRUE)
abline(v=c(9,18))
axis(side=1, at=seq(1.5,25.5,3), c("5yrs","10yrs","20yrs","5yrs","10yrs","20yrs","5yrs","10yrs","20yrs"))
mtext(side=2,"Pairs Found",line=4)
legend("top", c("POP", "HSP+GGP"),pch=15, col=c("rosybrown1", "skyblue"), bty="n", pt.cex=1.2)
boxplot(Pairs_Sardine_100_25_5, at=1:2, ylim=c(0,1.05e3), las=1, xlab="", main="Sardine", xlim=c(1,26), col=c("rosybrown1", "skyblue"), xaxt="n")
boxplot(Pairs_Sardine_100_25_10, at=4:5, ylim=c(0,1.05e3), las=1, xlab="", main="", xlim=c(1,26), xaxt="n",yaxt="n", col=c("rosybrown1", "skyblue"), add=TRUE)
boxplot(Pairs_Sardine_100_25_20, at=7:8, ylim=c(0,1.05e3), las=1, xlab="", main="", xlim=c(1,26), xaxt="n",yaxt="n", col=c("rosybrown1", "skyblue"), add=TRUE)
boxplot(Pairs_Sardine_1000_25_5, at=10:11, ylim=c(0,1.05e3), las=1, xlab="", main="", xlim=c(1,26), xaxt="n",yaxt="n", col=c("rosybrown1", "skyblue"), add=TRUE)
boxplot(Pairs_Sardine_1000_25_10, at=13:14, ylim=c(0,1.05e3), las=1, xlab="", main="", xlim=c(1,26), xaxt="n",yaxt="n", col=c("rosybrown1", "skyblue"), add=TRUE)
boxplot(Pairs_Sardine_1000_25_20, at=16:17, ylim=c(0,1.05e3), las=1, xlab="", main="", xlim=c(1,26), xaxt="n",yaxt="n", col=c("rosybrown1", "skyblue"), add=TRUE)
boxplot(Pairs_Sardine_5000_25_5, at=19:20, ylim=c(0,1.05e3), las=1, xlab="", main="", xlim=c(1,26), xaxt="n",yaxt="n", col=c("rosybrown1", "skyblue"), add=TRUE)
boxplot(Pairs_Sardine_5000_25_10, at=22:23, ylim=c(0,1.05e3), las=1, xlab="", main="", xlim=c(1,26), xaxt="n",yaxt="n", col=c("rosybrown1", "skyblue"), add=TRUE)
boxplot(Pairs_Sardine_5000_25_20, at=25:26, ylim=c(0,1.05e3), las=1, xlab="", main="", xlim=c(1,26), xaxt="n",yaxt="n", col=c("rosybrown1", "skyblue"), add=TRUE)
abline(v=c(9,18))
axis(side=1, at=seq(1.5,25.5,3), c("5yrs","10yrs","20yrs","5yrs","10yrs","20yrs","5yrs","10yrs","20yrs"))
mtext(side=1,"Number of Years of CKMR Collection",line=3.5)
dev.off()
tiff(paste0(wd,"/CKMRPairs_N100.tiff"), height=20, width=30, units='cm', compression="lzw", res=500)
par(mfrow=c(3,6), oma=c(2,2,1,1), mar=c(4,4,2.5,1))
hist(Pairs_Cod_100_25_5[,1], breaks=seq(-0.5,1e6,1), xlim=c(-0.5,5), las=1, xlab="", main="")
mtext(text="5yr", side=2, line=4.5, font=2)
mtext(text="POP", side=3, line=-2,font=2)
hist(Pairs_Cod_100_25_5[,2], breaks=seq(-0.5,1e6,1), xlim=c(-0.5,5), las=1, xlab="", main="", ylab="")
mtext(text="Cod", side=3, line=2, at=-4, font=2)
mtext(text="HSP+GGP", side=3, line=-2,font=2)
hist(Pairs_Flatfish_100_25_5[,1], breaks=seq(-0.5,1e6,10), xlim=c(-0.5,200), las=1, xlab="", main="", ylab="")
mtext(text="POP", side=3, line=-2,font=2)
hist(Pairs_Flatfish_100_25_5[,2], breaks=seq(-0.5,1e6,10), xlim=c(-0.5,200), las=1, xlab="", main="", ylab="")
mtext(text="Flatfish", side=3, line=2, at=-75, font=2)
mtext(text="HSP+GGP", side=3, line=-2,font=2)
hist(Pairs_Sardine_100_25_5[,1], breaks=seq(-0.5,1e6,1), xlim=c(-0.5,5), las=1, xlab="", main="", ylab="")
mtext(text="POP", side=3, line=-2,font=2)
hist(Pairs_Sardine_100_25_5[,2], breaks=seq(-0.5,1e6,1), xlim=c(-0.5,5), las=1, xlab="", main="", ylab="")
mtext(text="Sardine", side=3, line=2, at=-4, font=2)
mtext(text="HSP+GGP", side=3, line=-2,font=2)
hist(Pairs_Cod_100_25_10[,1], breaks=seq(-0.5,1e6,1), xlim=c(-0.5,5), las=1, xlab="", main="")
mtext(text="10yr", side=2, line=4.5, font=2)
hist(Pairs_Cod_100_25_10[,2], breaks=seq(-0.5,1e6,1), xlim=c(-0.5,5), las=1, xlab="", main="", ylab="")
hist(Pairs_Flatfish_100_25_10[,1], breaks=seq(-0.5,1e6,10), xlim=c(-0.5,200), las=1, xlab="", main="", ylab="")
hist(Pairs_Flatfish_100_25_10[,2], breaks=seq(-0.5,1e6,10), xlim=c(-0.5,200), las=1, xlab="", main="", ylab="")
hist(Pairs_Sardine_100_25_10[,1], breaks=seq(-0.5,1e6,1), xlim=c(-0.5,5), las=1, xlab="", main="", ylab="")
hist(Pairs_Sardine_100_25_10[,2], breaks=seq(-0.5,1e6,1), xlim=c(-0.5,5), las=1, xlab="", main="", ylab="")
hist(Pairs_Cod_100_25_20[,1], breaks=seq(-0.5,1e6,1), xlim=c(-0.5,5), las=1, xlab="Parent-Offspring Pairs", main="")
mtext(text="20yr", side=2, line=4.5, font=2)
hist(Pairs_Cod_100_25_20[,2], breaks=seq(-0.5,1e6,1), xlim=c(-0.5,5), las=1, xlab="Half-Sibling Pairs", main="", ylab="")
hist(Pairs_Flatfish_100_25_20[,1], breaks=seq(-0.5,1e6,10), xlim=c(-0.5,200), las=1, xlab="Parent-Offspring Pairs", main="", ylab="")
hist(Pairs_Flatfish_100_25_20[,2], breaks=seq(-0.5,1e6,10), xlim=c(-0.5,200), las=1, xlab="Half-Sibling Pairs", main="", ylab="")
hist(Pairs_Sardine_100_25_20[,1], breaks=seq(-0.5,1e6,1), xlim=c(-0.5,5), las=1, xlab="Parent-Offspring Pairs", main="", ylab="")
hist(Pairs_Sardine_100_25_20[,2], breaks=seq(-0.5,1e6,1), xlim=c(-0.5,5), las=1, xlab="Half-Sibling Pairs", main="", ylab="")
#dev.off()
dev.off()
tiff(paste0(wd,"/CKMRPairs_N1000.tiff"), height=20, width=30, units='cm', compression="lzw", res=500)
par(mfrow=c(3,6), oma=c(2,2,1,1), mar=c(4,4,2.5,1))
hist(Pairs_Cod_1000_25_5[,1], breaks=seq(-0.5,1e6,1), xlim=c(-0.5,10), las=1, xlab="", main="")
mtext(text="5yr", side=2, line=4.5, font=2)
mtext(text="POP", side=3, line=-2,font=2)
hist(Pairs_Cod_1000_25_5[,2], breaks=seq(-0.5,1e6,1), xlim=c(-0.5,10), las=1, xlab="", main="", ylab="")
mtext(text="Cod", side=3, line=2, at=-4, font=2)
mtext(text="HSP+GGP", side=3, line=-2,font=2)
hist(Pairs_Flatfish_1000_25_5[,1], breaks=seq(-0.5,1e6,100), xlim=c(-0.5,15000), las=1, xlab="", main="", ylab="")
mtext(text="POP", side=3, line=-2,font=2)
hist(Pairs_Flatfish_1000_25_5[,2], breaks=seq(-0.5,1e6,100), xlim=c(-0.5,15000), las=1, xlab="", main="", ylab="")
mtext(text="Flatfish", side=3, line=2, at=-2500, font=2)
mtext(text="HSP+GGP", side=3, line=-2,font=2)
hist(Pairs_Sardine_1000_25_5[,1], breaks=seq(-0.5,1e6,1), xlim=c(-0.5,100), las=1, xlab="", main="", ylab="")
mtext(text="POP", side=3, line=-2,font=2)
hist(Pairs_Sardine_1000_25_5[,2], breaks=seq(-0.5,1e6,1), xlim=c(-0.5,100), las=1, xlab="", main="", ylab="")
mtext(text="Sardine", side=3, line=2, at=-25, font=2)
mtext(text="HSP+GGP", side=3, line=-2,font=2)
hist(Pairs_Cod_1000_25_10[,1], breaks=seq(-0.5,1e6,1), xlim=c(-0.5,10), las=1, xlab="", main="")
mtext(text="10yr", side=2, line=4.5, font=2)
hist(Pairs_Cod_1000_25_10[,2], breaks=seq(-0.5,1e6,1), xlim=c(-0.5,10), las=1, xlab="", main="", ylab="")
hist(Pairs_Flatfish_1000_25_10[,1], breaks=seq(-0.5,1e6,100), xlim=c(-0.5,15000), las=1, xlab="", main="", ylab="")
hist(Pairs_Flatfish_1000_25_10[,2], breaks=seq(-0.5,1e6,100), xlim=c(-0.5,15000), las=1, xlab="", main="", ylab="")
hist(Pairs_Sardine_1000_25_10[,1], breaks=seq(-0.5,1e6,1), xlim=c(-0.5,100), las=1, xlab="", main="", ylab="")
hist(Pairs_Sardine_1000_25_10[,2], breaks=seq(-0.5,1e6,1), xlim=c(-0.5,100), las=1, xlab="", main="", ylab="")
hist(Pairs_Cod_1000_25_20[,1], breaks=seq(-0.5,1e6,1), xlim=c(-0.5,10), las=1, xlab="Parent-Offspring Pairs", main="")
mtext(text="20yr", side=2, line=4.5, font=2)
hist(Pairs_Cod_1000_25_20[,2], breaks=seq(-0.5,1e6,1), xlim=c(-0.5,10), las=1, xlab="Half-Sibling Pairs", main="", ylab="")
hist(Pairs_Flatfish_1000_25_20[,1], breaks=seq(-0.5,1e6,100), xlim=c(-0.5,15000), las=1, xlab="Parent-Offspring Pairs", main="", ylab="")
hist(Pairs_Flatfish_1000_25_20[,2], breaks=seq(-0.5,1e6,100), xlim=c(-0.5,15000), las=1, xlab="Half-Sibling Pairs", main="", ylab="")
hist(Pairs_Sardine_1000_25_20[,1], breaks=seq(-0.5,1e6,1), xlim=c(-0.5,100), las=1, xlab="Parent-Offspring Pairs", main="", ylab="")
hist(Pairs_Sardine_1000_25_20[,2], breaks=seq(-0.5,1e6,1), xlim=c(-0.5,100), las=1, xlab="Half-Sibling Pairs", main="", ylab="")
#
dev.off()
tiff(paste0(wd,"/CKMRPairs_N5000.tiff"), height=20, width=30, units='cm', compression="lzw", res=500)
par(mfrow=c(3,6), oma=c(2,2,1,1), mar=c(4,4,2.5,1))
hist(Pairs_Cod_5000_25_5[,1], breaks=seq(-0.5,1e6,1), xlim=c(-0.5,120), las=1, xlab="", main="")
mtext(text="5yr", side=2, line=4.5, font=2)
mtext(text="POP", side=3, line=-2,font=2)
hist(Pairs_Cod_5000_25_5[,2], breaks=seq(-0.5,1e6,1), xlim=c(-0.5,120), las=1, xlab="", main="", ylab="")
mtext(text="Cod", side=3, line=2, at=-30, font=2)
mtext(text="HSP+GGP", side=3, line=-2,font=2)
hist(Pairs_Flatfish_5000_25_5[,1], breaks=seq(-0.5,1e6,2e3), xlim=c(-0.5,3e5), las=1, xlab="", main="", ylab="")
mtext(text="POP", side=3, line=-2,font=2)
hist(Pairs_Flatfish_5000_25_5[,2], breaks=seq(-0.5,1e6,2e3), xlim=c(-0.5,3e5), las=1, xlab="", main="", ylab="")
mtext(text="Flatfish", side=3, line=2, at=-50000, font=2)
mtext(text="HSP+GGP", side=3, line=-2,font=2)
hist(Pairs_Sardine_5000_25_5[,1], breaks=seq(-0.5,1e6,50), xlim=c(-0.5,2500), las=1, xlab="", main="", ylab="")
mtext(text="POP", side=3, line=-2,font=2)
hist(Pairs_Sardine_5000_25_5[,2], breaks=seq(-0.5,1e6,50), xlim=c(-0.5,2500), las=1, xlab="", main="", ylab="")
mtext(text="Sardine", side=3, line=2, at=-600, font=2)
mtext(text="HSP+GGP", side=3, line=-2,font=2)
hist(Pairs_Cod_5000_25_10[,1], breaks=seq(-0.5,1e6,1), xlim=c(-0.5,120), las=1, xlab="", main="")
mtext(text="10yr", side=2, line=4.5, font=2)
hist(Pairs_Cod_5000_25_10[,2], breaks=seq(-0.5,1e6,1), xlim=c(-0.5,120), las=1, xlab="", main="", ylab="")
hist(Pairs_Flatfish_5000_25_10[,1], breaks=seq(-0.5,1e6,2e3), xlim=c(-0.5,3e5), las=1, xlab="", main="", ylab="")
hist(Pairs_Flatfish_5000_25_10[,2], breaks=seq(-0.5,1e6,2e3), xlim=c(-0.5,3e5), las=1, xlab="", main="", ylab="")
hist(Pairs_Sardine_5000_25_10[,1], breaks=seq(-0.5,1e6,50), xlim=c(-0.5,2500), las=1, xlab="", main="", ylab="")
hist(Pairs_Sardine_5000_25_10[,2], breaks=seq(-0.5,1e6,50), xlim=c(-0.5,2500), las=1, xlab="", main="", ylab="")
hist(Pairs_Cod_5000_25_20[,1], breaks=seq(-0.5,1e6,1), xlim=c(-0.5,120), las=1, xlab="Parent-Offspring Pairs", main="")
mtext(text="20yr", side=2, line=4.5, font=2)
hist(Pairs_Cod_5000_25_20[,2], breaks=seq(-0.5,1e6,1), xlim=c(-0.5,120), las=1, xlab="Half-Sibling Pairs", main="", ylab="")
hist(Pairs_Flatfish_5000_25_20[,1], breaks=seq(-0.5,1e6,2e3), xlim=c(-0.5,3e5), las=1, xlab="Parent-Offspring Pairs", main="", ylab="")
hist(Pairs_Flatfish_5000_25_20[,2], breaks=seq(-0.5,1e6,2e3), xlim=c(-0.5,3e5), las=1, xlab="Half-Sibling Pairs", main="", ylab="")
hist(Pairs_Sardine_5000_25_20[,1], breaks=seq(-0.5,1e6,50), xlim=c(-0.5,2500), las=1, xlab="Parent-Offspring Pairs", main="", ylab="")
hist(Pairs_Sardine_5000_25_20[,2], breaks=seq(-0.5,1e6,50), xlim=c(-0.5,2500), las=1, xlab="Half-Sibling Pairs", main="", ylab="")
dev.off()
tiff(paste0(wd,"/CKMRPairs_Overlap.tiff"), height=20, width=30, units='cm', compression="lzw", res=500)
par(mfrow=c(3,6), oma=c(2,2,1,1), mar=c(4,4,2.5,1))
hist(Pairs_Cod_5000_25_5[,1], breaks=seq(-0.5,1e6,1), xlim=c(-1,100), las=1, xlab="", main="",col=rgb(0.8,0,0,0.2))
hist(Pairs_Cod_1000_25_5[,1], breaks=seq(-0.5,1e6,1), add=TRUE, col=rgb(0,0.8,0,0.2))
hist(Pairs_Cod_100_25_5[,1], breaks=seq(-0.5,1e6,1), add=TRUE, col=rgb(0,0,0.8,0.2))
mtext(text="5yr", side=2, line=4.5, font=2)
mtext(text="POP", side=3, line=-2,font=2)
hist(Pairs_Cod_5000_25_5[,2], breaks=seq(-0.5,1e6,1), xlim=c(-1,100), las=1, xlab="", main="", ylab="",col=rgb(0.8,0,0,0.2))
hist(Pairs_Cod_1000_25_5[,2], breaks=seq(-0.5,1e6,1), add=TRUE, col=rgb(0,0.8,0,0.2))
hist(Pairs_Cod_100_25_5[,2], breaks=seq(-0.5,1e6,1), add=TRUE, col=rgb(0,0,0.8,0.2))
mtext(text="Cod", side=3, line=2, at=-30, font=2)
mtext(text="HSP", side=3, line=-2,font=2)
hist(Pairs_Flatfish_5000_25_5[,1], breaks=seq(-0.5,1e6,5e3), xlim=c(-1,2.5e5), las=1, xlab="", main="", ylab="",col=rgb(0.8,0,0,0.2))
hist(Pairs_Flatfish_1000_25_5[,1], breaks=seq(-0.5,1e6,5e3), add=TRUE, col=rgb(0,0.8,0,0.2))
hist(Pairs_Flatfish_100_25_5[,1], breaks=seq(-0.5,1e6,5e3), add=TRUE, col=rgb(0,0,0.8,0.2))
mtext(text="POP", side=3, line=-2,font=2)
hist(Pairs_Flatfish_5000_25_5[,2], breaks=seq(-0.5,1e6,5e3), xlim=c(-1,2.5e5), las=1, xlab="", main="", ylab="",col=rgb(0.8,0,0,0.2))
hist(Pairs_Flatfish_1000_25_5[,2], breaks=seq(-0.5,1e6,5e3), add=TRUE, col=rgb(0,0.8,0,0.2))
hist(Pairs_Flatfish_100_25_5[,2], breaks=seq(-0.5,1e6,5e3), add=TRUE, col=rgb(0,0,0.8,0.2))
mtext(text="Flatfish", side=3, line=2, at=-50000, font=2)
mtext(text="HSP", side=3, line=-2,font=2)
hist(Pairs_Sardine_5000_25_5[,1], breaks=seq(-0.5,1e6,50), xlim=c(-1,2200), las=1, xlab="", main="", ylab="",col=rgb(0.8,0,0,0.2))
hist(Pairs_Sardine_1000_25_5[,1], breaks=seq(-0.5,1e6,50), add=TRUE, col=rgb(0,0.8,0,0.2))
hist(Pairs_Sardine_100_25_5[,1], breaks=seq(-0.5,1e6,50), add=TRUE, col=rgb(0,0,0.8,0.2))
mtext(text="POP", side=3, line=-2,font=2)
hist(Pairs_Sardine_5000_25_5[,2], breaks=seq(-0.5,1e6,50), xlim=c(-1,2200), las=1, xlab="", main="", ylab="",col=rgb(0.8,0,0,0.2))
hist(Pairs_Sardine_1000_25_5[,2], breaks=seq(-0.5,1e6,50), add=TRUE, col=rgb(0,0.8,0,0.2))
hist(Pairs_Sardine_100_25_5[,2], breaks=seq(-0.5,1e6,50), add=TRUE, col=rgb(0,0,0.8,0.2))
mtext(text="Sardine", side=3, line=2, at=-600, font=2)
mtext(text="HSP", side=3, line=-2,font=2)
hist(Pairs_Cod_5000_25_10[,1], breaks=seq(-0.5,1e6,1), xlim=c(-1,100), las=1, xlab="", main="",col=rgb(0.8,0,0,0.2))
hist(Pairs_Cod_1000_25_10[,1], breaks=seq(-0.5,1e6,1), add=TRUE, col=rgb(0,0.8,0,0.2))
hist(Pairs_Cod_100_25_10[,1], breaks=seq(-0.5,1e6,1), add=TRUE, col=rgb(0,0,0.8,0.2))
mtext(text="10yr", side=2, line=4.5, font=2)
hist(Pairs_Cod_5000_25_10[,2], breaks=seq(-0.5,1e6,1), xlim=c(-1,100), las=1, xlab="", main="", ylab="",col=rgb(0.8,0,0,0.2))
hist(Pairs_Cod_1000_25_10[,2], breaks=seq(-0.5,1e6,1), add=TRUE, col=rgb(0,0.8,0,0.2))
hist(Pairs_Cod_100_25_10[,2], breaks=seq(-0.5,1e6,1), add=TRUE, col=rgb(0,0,0.8,0.2))
hist(Pairs_Flatfish_5000_25_10[,1], breaks=seq(-0.5,1e6,5e3), xlim=c(-1,2.5e5), las=1, xlab="", main="", ylab="",col=rgb(0.8,0,0,0.2))
hist(Pairs_Flatfish_1000_25_10[,1], breaks=seq(-0.5,1e6,5e3), add=TRUE, col=rgb(0,0.8,0,0.2))
hist(Pairs_Flatfish_100_25_10[,1], breaks=seq(-0.5,1e6,5e3), add=TRUE, col=rgb(0,0,0.8,0.2))
hist(Pairs_Flatfish_5000_25_10[,2], breaks=seq(-0.5,1e6,5e3), xlim=c(-1,2.5e5), las=1, xlab="", main="", ylab="",col=rgb(0.8,0,0,0.2))
hist(Pairs_Flatfish_1000_25_10[,2], breaks=seq(-0.5,1e6,5e3), add=TRUE, col=rgb(0,0.8,0,0.2))
hist(Pairs_Flatfish_100_25_10[,2], breaks=seq(-0.5,1e6,5e3), add=TRUE, col=rgb(0,0,0.8,0.2))
hist(Pairs_Sardine_5000_25_10[,1], breaks=seq(-0.5,1e6,50), xlim=c(-1,2200), las=1, xlab="", main="", ylab="",col=rgb(0.8,0,0,0.2))
hist(Pairs_Sardine_1000_25_10[,1], breaks=seq(-0.5,1e6,50), add=TRUE, col=rgb(0,0.8,0,0.2))
hist(Pairs_Sardine_100_25_10[,1], breaks=seq(-0.5,1e6,50), add=TRUE, col=rgb(0,0,0.8,0.2))
hist(Pairs_Sardine_5000_25_10[,2], breaks=seq(-0.5,1e6,50), xlim=c(-1,2200), las=1, xlab="", main="", ylab="",col=rgb(0.8,0,0,0.2))
hist(Pairs_Sardine_1000_25_10[,2], breaks=seq(-0.5,1e6,50), add=TRUE, col=rgb(0,0.8,0,0.2))
hist(Pairs_Sardine_100_25_10[,2], breaks=seq(-0.5,1e6,50), add=TRUE, col=rgb(0,0,0.8,0.2))
hist(Pairs_Cod_5000_25_20[,1], breaks=seq(-0.5,1e6,1), xlim=c(-1,100), las=1, xlab="Parent-Offspring Pairs", main="",col=rgb(0.8,0,0,0.2))
hist(Pairs_Cod_1000_25_20[,1], breaks=seq(-0.5,1e6,1), add=TRUE, col=rgb(0,0.8,0,0.2))
hist(Pairs_Cod_100_25_20[,1], breaks=seq(-0.5,1e6,1), add=TRUE, col=rgb(0,0,0.8,0.2))
mtext(text="20yr", side=2, line=4.5, font=2)
hist(Pairs_Cod_5000_25_20[,2], breaks=seq(-0.5,1e6,1), xlim=c(-1,100), las=1, xlab="Half-Sibling Pairs", main="", ylab="",col=rgb(0.8,0,0,0.2))
hist(Pairs_Cod_1000_25_20[,2], breaks=seq(-0.5,1e6,1), add=TRUE, col=rgb(0,0.8,0,0.2))
hist(Pairs_Cod_100_25_20[,2], breaks=seq(-0.5,1e6,1), add=TRUE, col=rgb(0,0,0.8,0.2))
hist(Pairs_Flatfish_5000_25_20[,1], breaks=seq(-0.5,1e6,5e3), xlim=c(-1,2.5e5), las=1, xlab="Parent-Offspring Pairs", main="", ylab="",col=rgb(0.8,0,0,0.2))
hist(Pairs_Flatfish_1000_25_20[,1], breaks=seq(-0.5,1e6,5e3), add=TRUE, col=rgb(0,0.8,0,0.2))
hist(Pairs_Flatfish_100_25_20[,1], breaks=seq(-0.5,1e6,5e3), add=TRUE, col=rgb(0,0,0.8,0.2))
hist(Pairs_Flatfish_5000_25_20[,2], breaks=seq(-0.5,1e6,5e3), xlim=c(-1,2.5e5), las=1, xlab="Half-Sibling Pairs", main="", ylab="",col=rgb(0.8,0,0,0.2))
hist(Pairs_Flatfish_1000_25_20[,2], breaks=seq(-0.5,1e6,5e3), add=TRUE, col=rgb(0,0.8,0,0.2))
hist(Pairs_Flatfish_100_25_20[,2], breaks=seq(-0.5,1e6,5e3), add=TRUE, col=rgb(0,0,0.8,0.2))
hist(Pairs_Sardine_5000_25_20[,1], breaks=seq(-0.5,1e6,50), xlim=c(-1,2200), las=1, xlab="Parent-Offspring Pairs", main="", ylab="",col=rgb(0.8,0,0,0.2))
hist(Pairs_Sardine_1000_25_20[,1], breaks=seq(-0.5,1e6,50), add=TRUE, col=rgb(0,0.8,0,0.2))
hist(Pairs_Sardine_100_25_20[,1], breaks=seq(-0.5,1e6,50), add=TRUE, col=rgb(0,0,0.8,0.2))
hist(Pairs_Sardine_5000_25_20[,2], breaks=seq(-0.5,1e6,50), xlim=c(-1,2200), las=1, xlab="Half-Sibling Pairs", main="", ylab="",col=rgb(0.8,0,0,0.2))
hist(Pairs_Sardine_1000_25_20[,2], breaks=seq(-0.5,1e6,50), add=TRUE, col=rgb(0,0.8,0,0.2))
hist(Pairs_Sardine_100_25_20[,2], breaks=seq(-0.5,1e6,50), add=TRUE, col=rgb(0,0,0.8,0.2))
dev.off()
c(mean(Pairs_Cod_100_25_5[,1]),sd(Pairs_Cod_100_25_5[,1]),mean(Pairs_Cod_100_25_5_HSPandGGP),sd(Pairs_Cod_100_25_5_HSPandGGP))
c(mean(Pairs_Cod_100_25_5[,1]),sd(Pairs_Cod_100_25_5[,1]),mean(Pairs_Cod_100_25_5[,2]),sd(Pairs_Cod_100_25_5[,2]))
c(mean(Pairs_Cod_100_25_10[,1]),sd(Pairs_Cod_100_25_10[,1]),mean(Pairs_Cod_100_25_10[,2]),sd(Pairs_Cod_100_25_10[,2]))
c(mean(Pairs_Cod_100_25_20[,1]),sd(Pairs_Cod_100_25_20[,1]),mean(Pairs_Cod_100_25_20[,2]),sd(Pairs_Cod_100_25_20[,2]))
dim(Pairs_Cod_100_25_20)
dim(Pairs_Cod_100_25_10)
c(mean(Pairs_Cod_1000_25_5[,1]),sd(Pairs_Cod_1000_25_5[,1]),mean(Pairs_Cod_1000_25_5[,2]),sd(Pairs_Cod_1000_25_5[,2]))
c(mean(Pairs_Cod_1000_25_10[,1]),sd(Pairs_Cod_1000_25_10[,1]),mean(Pairs_Cod_1000_25_10[,2]),sd(Pairs_Cod_1000_25_10[,2]))
c(mean(Pairs_Cod_1000_25_20[,1]),sd(Pairs_Cod_1000_25_20[,1]),mean(Pairs_Cod_1000_25_20[,2]),sd(Pairs_Cod_1000_25_20[,2]))
c(mean(Pairs_Cod_5000_25_5[,1]),sd(Pairs_Cod_5000_25_5[,1]),mean(Pairs_Cod_5000_25_5[,2]),sd(Pairs_Cod_5000_25_5[,2]))
c(mean(Pairs_Cod_5000_25_10[,1]),sd(Pairs_Cod_5000_25_10[,1]),mean(Pairs_Cod_5000_25_10[,2]),sd(Pairs_Cod_5000_25_10[,2]))
c(mean(Pairs_Cod_5000_25_20[,1]),sd(Pairs_Cod_5000_25_20[,1]),mean(Pairs_Cod_5000_25_20[,2]),sd(Pairs_Cod_5000_25_20[,2]))
c(mean(Pairs_Flatfish_100_25_5[,1]),sd(Pairs_Flatfish_100_25_5[,1]),mean(Pairs_Flatfish_100_25_5[,2]),sd(Pairs_Flatfish_100_25_5[,2]))
c(mean(Pairs_Flatfish_100_25_10[,1]),sd(Pairs_Flatfish_100_25_10[,1]),mean(Pairs_Flatfish_100_25_10[,2]),sd(Pairs_Flatfish_100_25_10[,2]))
c(mean(Pairs_Flatfish_100_25_20[,1]),sd(Pairs_Flatfish_100_25_20[,1]),mean(Pairs_Flatfish_100_25_20[,2]),sd(Pairs_Flatfish_100_25_20[,2]))
c(mean(Pairs_Flatfish_1000_25_5[,1]),sd(Pairs_Flatfish_1000_25_5[,1]),mean(Pairs_Flatfish_1000_25_5[,2]),sd(Pairs_Flatfish_1000_25_5[,2]))
c(mean(Pairs_Flatfish_1000_25_10[,1]),sd(Pairs_Flatfish_1000_25_10[,1]),mean(Pairs_Flatfish_1000_25_10[,2]),sd(Pairs_Flatfish_1000_25_10[,2]))
c(mean(Pairs_Flatfish_1000_25_20[,1]),sd(Pairs_Flatfish_1000_25_20[,1]),mean(Pairs_Flatfish_1000_25_20[,2]),sd(Pairs_Flatfish_1000_25_20[,2]))
c(mean(Pairs_Flatfish_5000_25_5[,1]),sd(Pairs_Flatfish_5000_25_5[,1]),mean(Pairs_Flatfish_5000_25_5[,2]),sd(Pairs_Flatfish_5000_25_5[,2]))
c(mean(Pairs_Flatfish_5000_25_10[,1]),sd(Pairs_Flatfish_5000_25_10[,1]),mean(Pairs_Flatfish_5000_25_10[,2]),sd(Pairs_Flatfish_5000_25_10[,2]))
c(mean(Pairs_Flatfish_5000_25_20[,1]),sd(Pairs_Flatfish_5000_25_20[,1]),mean(Pairs_Flatfish_5000_25_20[,2]),sd(Pairs_Flatfish_5000_25_20[,2]))
c(mean(Pairs_Sardine_100_25_5[,1]),sd(Pairs_Sardine_100_25_5[,1]),mean(Pairs_Sardine_100_25_5[,2]),sd(Pairs_Sardine_100_25_5[,2]))
c(mean(Pairs_Sardine_100_25_10[,1]),sd(Pairs_Sardine_100_25_10[,1]),mean(Pairs_Sardine_100_25_10[,2]),sd(Pairs_Sardine_100_25_10[,2]))
c(mean(Pairs_Sardine_100_25_20[,1]),sd(Pairs_Sardine_100_25_20[,1]),mean(Pairs_Sardine_100_25_20[,2]),sd(Pairs_Sardine_100_25_20[,2]))
c(mean(Pairs_Sardine_1000_25_5[,1]),sd(Pairs_Sardine_1000_25_5[,1]),mean(Pairs_Sardine_1000_25_5[,2]),sd(Pairs_Sardine_1000_25_5[,2]))
c(mean(Pairs_Sardine_1000_25_10[,1]),sd(Pairs_Sardine_1000_25_10[,1]),mean(Pairs_Sardine_1000_25_10[,2]),sd(Pairs_Sardine_1000_25_10[,2]))
c(mean(Pairs_Sardine_1000_25_20[,1]),sd(Pairs_Sardine_1000_25_20[,1]),mean(Pairs_Sardine_1000_25_20[,2]),sd(Pairs_Sardine_1000_25_20[,2]))
c(mean(Pairs_Sardine_5000_25_5[,1]),sd(Pairs_Sardine_5000_25_5[,1]),mean(Pairs_Sardine_5000_25_5[,2]),sd(Pairs_Sardine_5000_25_5[,2]))
c(mean(Pairs_Sardine_1000_25_5[,1]),sd(Pairs_Sardine_1000_25_5[,1]),mean(Pairs_Sardine_1000_25_5[,2]),sd(Pairs_Sardine_1000_25_5[,2]))
c(mean(Pairs_Sardine_1000_25_10[,1]),sd(Pairs_Sardine_1000_25_10[,1]),mean(Pairs_Sardine_1000_25_10[,2]),sd(Pairs_Sardine_1000_25_10[,2]))
c(mean(Pairs_Sardine_1000_25_20[,1]),sd(Pairs_Sardine_1000_25_20[,1]),mean(Pairs_Sardine_1000_25_20[,2]),sd(Pairs_Sardine_1000_25_20[,2]))
c(mean(Pairs_Sardine_5000_25_5[,1]),sd(Pairs_Sardine_5000_25_5[,1]),mean(Pairs_Sardine_5000_25_5[,2]),sd(Pairs_Sardine_5000_25_5[,2]))
c(mean(Pairs_Sardine_5000_25_10[,1]),sd(Pairs_Sardine_5000_25_10[,1]),mean(Pairs_Sardine_5000_25_10[,2]),sd(Pairs_Sardine_5000_25_10[,2]))
c(mean(Pairs_Sardine_5000_25_20[,1]),sd(Pairs_Sardine_5000_25_20[,1]),mean(Pairs_Sardine_5000_25_20[,2]),sd(Pairs_Sardine_5000_25_20[,2]))
24*4/10
80/100
100/80
1-80/100
80/100
100/80
wd<-"C:/Users/fischn/Documents/GitHub/CKMR_Project/"
#Ncomp 5000, sdindex 0.25, ckmr 20 years
load(paste0(wd,"/Cod_wdat_N5000_Ind25_ckmrmultinom20_1.RData"))
load(paste0(wd,"/Flatfish_wdat_N5000_Ind25_ckmrmultinom20_1.RData"))
load(paste0(wd,"/Sardine_wdat_N5000_Ind25_ckmrmultinom20_1.RData"))
Cod_5000_25_20<-Cod_wdat
Flatfish_5000_25_20<-Flatfish_wdat
Sardine_5000_25_20<-Sardine_wdat
res_list[[3]]<-readRDS(paste0(wd,"/SCAAfit_Sardine_N5000_Ind25_ckmrmultinom20.RData"))
Sardine_wdat[[1]]$OM$SSB[26:101]
load(paste0(wd,"/Sardine_wdat_N5000_Ind25_ckmrmultinom20_1.RData"))
Sardine_wdat[[1]]$OM$SSB[26:101]
wd<-"C:/Users/fischn/Documents/GitHub/CKMR_Project/"
AEs<-readRDS("C:/Users/fischn/Documents/GitHub/CKMR_Project/AE_mat_list.RData")
load(paste0(wd,"/Cod_wdat_N1000_Ind25_ckmrmultinom10_1.RData"))
load(paste0(wd,"/Flatfish_wdat_N1000_Ind25_ckmrmultinom10_1.RData"))
load(paste0(wd,"/Sardine_wdat_N1000_Ind25_ckmrmultinom10_1.RData"))
library(TMB)
setwd(wd)
#Compile and load model
compile("CKMRmultinom_POP_HSP_GPP_Fisch_wAE.cpp")
N_sim<-1:10
res_list<-list()
for (Q in 2:2){  #Running through the life history types
res_list[[Q]]<-list()
for (s in N_sim){
if(Q==1){
OM<-Cod_wdat[[s]]
} else if (Q==2){
OM<-Flatfish_wdat[[s]]
}else if (Q==3){
OM<-Sardine_wdat[[s]]
}
dat<-list(fyear=OM$OM$fyear, lyear=75, fage=OM$OM$fage, lage=OM$OM$lage,
years=OM$OM$fyear:75, ages=OM$OM$fage:OM$OM$lage,
obs_harv=OM$Obs_Catch,
obs_index=OM$Obs_Index,
obs_fishery_comp=OM$Obs_Catch_Comp/rowSums(OM$Obs_Catch_Comp),
SS_fishery=rowSums(OM$Obs_Catch_Comp),
Mat=OM$OM$Mat,
Laa=OM$OM$Laa,
Waa=OM$OM$Waa,
#CKMR
coded_born_year_old=OM$born_year_old-(OM$fyear_dat-1),
coded_age_diff=OM$age_diff,
n_ckmr=OM$n_ckmr,
k_ckmr_hsporggp=OM$k_ckmr_hsporggp,
coded_born_year_young=OM$born_year_young-(OM$fyear_dat-1),
k_ckmr_pop=OM$k_ckmr_pop,
samp_year_coded_old=OM$samp_year_old-(OM$fyear_dat-1),
coded_age_one=OM$coded_age_young,
coded_age_two=OM$coded_age_old,
coded_one_min=sapply(OM$coded_age_young, FUN=function(x){min(which(OM$AE_mat[,x+1]>0.01)-1)}),
coded_one_max=sapply(OM$coded_age_young, FUN=function(x){max(which(OM$AE_mat[,x+1]>0.01)-1)}),
coded_two_min=sapply(OM$coded_age_old, FUN=function(x){min(which(OM$AE_mat[,x+1]>0.01)-1)}),
coded_two_max=sapply(OM$coded_age_old, FUN=function(x){max(which(OM$AE_mat[,x+1]>0.01)-1)}),
#Switch for whether to use a data source or not, 0=no, 1=yes
Lamda_Harvest=1,
Lamda_Comp=1,
Lamda_Index=1,
Lamda_CKMR=1,
AE_mat=OM$AE_mat,
pi_nu=OM$pi_nu)
#Parameters
set.seed(s)
par <- list(log_M=log(runif(1,min=OM$OM$Mref-OM$OM$Mref*0.5,max=OM$OM$Mref+OM$OM$Mref*0.5)),
log_q=log(runif(1,min=OM$q_index-OM$q_index*0.5,max=OM$q_index+OM$q_index*0.5)),
log_recruit_devs_init=rep(0,dat$lage),
log_recruit_devs=rep(0,dat$lyear),
steepness=OM$OM$h,
log_R0=log(runif(1,min=OM$OM$R0-OM$OM$R0*0.5,max=OM$OM$R0+OM$OM$R0*0.5)),
log_sigma_rec=log(OM$OM$sd_rec),
log_sd_catch=log(OM$sd_catch),
log_sd_index=log(OM$sd_index),
Sel_logis_k=log(runif(1,min=OM$OM$Sel_slope-OM$OM$Sel_slope*0.5,max=OM$OM$Sel_slope+OM$OM$Sel_slope*0.5)),
Sel_logis_midpt=log(runif(1,min=OM$OM$Sel_50-OM$OM$Sel_50*0.5,max=OM$OM$Sel_50+OM$OM$Sel_50*0.5)),
log_fint=log(runif(length(OM$OM$F_int[26:100]),min=OM$OM$F_int[26:100]-OM$OM$F_int[26:100]*0.5,max=OM$OM$F_int[26:100]+OM$OM$F_int[26:100]*0.5)))
dyn.load(dynlib("CKMRmultinom_POP_HSP_GPP_Fisch_wAE"))
parm_names<-rep(names(par),lapply(par,length))
fixed<-list(steepness=factor(NA),log_sigma_rec=factor(NA),
log_sd_catch=factor(NA),
log_sd_index=factor(NA))
lower_bounds<-c(-5,-20,rep(-10,dat$lage),rep(-10,dat$lyear), 0, 5, -5,-5,-5,-5,-5,rep(-10,dat$lyear))
upper_bounds<-c( 2,  1,rep( 10,dat$lage),rep( 10,dat$lyear), 1, 25, 2, 2, 2, 5, 5,rep(  0,dat$lyear))
reffects=c("log_recruit_devs","log_recruit_devs_init")
l<-lower_bounds[-which(parm_names %in% c(names(fixed)))]
u<-upper_bounds[-which(parm_names %in% c(names(fixed)))]
SCAA <- MakeADFun(dat, par, DLL="CKMRmultinom_POP_HSP_GPP_Fisch_wAE", map=fixed)
SCAA_fit <- TMBhelper::fit_tmb(obj=SCAA, startpar=SCAA$par, lower=l, upper=u, newtonsteps=1, getsd=TRUE)
res_list[[Q]][[s]]<-SCAA_fit
print(c(Q,s))
}
}
load(paste0(wd,"/Flatfish_wdat_N1000_Ind25_ckmrmultinom10_1.RData"))
Flatfish_1000_25_10<-Flatfish_wdat
windows()
plot(Flatfish_1000_25_10[[1]]$OM$SSB)
plot(Flatfish_1000_25_10[[1]]$OM$SSB, ylim=c(0,1e5))
plot(Flatfish_1000_25_10[[1]]$OM$SSB, ylim=c(0,1e5), pch=16)
points(res_list[[2]][[1]]$SD$value, col=2)
plot(Flatfish_1000_25_10[[1]]$OM$SSB[26:101], ylim=c(0,1e5), pch=16)
points(res_list[[2]][[1]]$SD$value, col=2)
load(paste0(wd,"/Flatfish_wdat_N5000_Ind25_ckmrmultinom5_1.RData"))
sum(Flatfish_wdat[[1]]$k_ckmr_hsporggp)
load(paste0(wd,"/Flatfish_wdat_N1000_Ind25_ckmrmultinom10_1.RData"))
sum(Flatfish_wdat[[1]]$k_ckmr_hsporggp)
length(Flatfish_wdat[[1]]$k_ckmr_hsporggp)
load(paste0(wd,"/Flatfish_wdat_N5000_Ind25_ckmrmultinom5_1.RData"))
length(Flatfish_wdat[[1]]$k_ckmr_hsporggp)
load(paste0(wd,"/Flatfish_wdat_N5000_Ind25_ckmrmultinom5_1.RData"))
N_sim<-1:100
res_list<-list()
for (Q in 2:2){  #Running through the life history types
res_list[[Q]]<-list()
for (s in N_sim){
if(Q==1){
OM<-Cod_wdat[[s]]
} else if (Q==2){
OM<-Flatfish_wdat[[s]]
}else if (Q==3){
OM<-Sardine_wdat[[s]]
}
dat<-list(fyear=OM$OM$fyear, lyear=75, fage=OM$OM$fage, lage=OM$OM$lage,
years=OM$OM$fyear:75, ages=OM$OM$fage:OM$OM$lage,
obs_harv=OM$Obs_Catch,
obs_index=OM$Obs_Index,
obs_fishery_comp=OM$Obs_Catch_Comp/rowSums(OM$Obs_Catch_Comp),
SS_fishery=rowSums(OM$Obs_Catch_Comp),
Mat=OM$OM$Mat,
Laa=OM$OM$Laa,
Waa=OM$OM$Waa,
#CKMR
coded_born_year_old=OM$born_year_old-(OM$fyear_dat-1),
coded_age_diff=OM$age_diff,
n_ckmr=OM$n_ckmr,
k_ckmr_hsporggp=OM$k_ckmr_hsporggp,
coded_born_year_young=OM$born_year_young-(OM$fyear_dat-1),
k_ckmr_pop=OM$k_ckmr_pop,
samp_year_coded_old=OM$samp_year_old-(OM$fyear_dat-1),
coded_age_one=OM$coded_age_young,
coded_age_two=OM$coded_age_old,
coded_one_min=sapply(OM$coded_age_young, FUN=function(x){min(which(OM$AE_mat[,x+1]>0.01)-1)}),
coded_one_max=sapply(OM$coded_age_young, FUN=function(x){max(which(OM$AE_mat[,x+1]>0.01)-1)}),
coded_two_min=sapply(OM$coded_age_old, FUN=function(x){min(which(OM$AE_mat[,x+1]>0.01)-1)}),
coded_two_max=sapply(OM$coded_age_old, FUN=function(x){max(which(OM$AE_mat[,x+1]>0.01)-1)}),
#Switch for whether to use a data source or not, 0=no, 1=yes
Lamda_Harvest=1,
Lamda_Comp=1,
Lamda_Index=1,
Lamda_CKMR=1,
AE_mat=OM$AE_mat,
pi_nu=OM$pi_nu)
#Parameters
set.seed(s)
par <- list(log_M=log(runif(1,min=OM$OM$Mref-OM$OM$Mref*0.5,max=OM$OM$Mref+OM$OM$Mref*0.5)),
log_q=log(runif(1,min=OM$q_index-OM$q_index*0.5,max=OM$q_index+OM$q_index*0.5)),
log_recruit_devs_init=rep(0,dat$lage),
log_recruit_devs=rep(0,dat$lyear),
steepness=OM$OM$h,
log_R0=log(runif(1,min=OM$OM$R0-OM$OM$R0*0.5,max=OM$OM$R0+OM$OM$R0*0.5)),
log_sigma_rec=log(OM$OM$sd_rec),
log_sd_catch=log(OM$sd_catch),
log_sd_index=log(OM$sd_index),
Sel_logis_k=log(runif(1,min=OM$OM$Sel_slope-OM$OM$Sel_slope*0.5,max=OM$OM$Sel_slope+OM$OM$Sel_slope*0.5)),
Sel_logis_midpt=log(runif(1,min=OM$OM$Sel_50-OM$OM$Sel_50*0.5,max=OM$OM$Sel_50+OM$OM$Sel_50*0.5)),
log_fint=log(runif(length(OM$OM$F_int[26:100]),min=OM$OM$F_int[26:100]-OM$OM$F_int[26:100]*0.5,max=OM$OM$F_int[26:100]+OM$OM$F_int[26:100]*0.5)))
dyn.load(dynlib("CKMRmultinom_POP_HSP_GPP_Fisch_wAE"))
parm_names<-rep(names(par),lapply(par,length))
fixed<-list(steepness=factor(NA),log_sigma_rec=factor(NA),
log_sd_catch=factor(NA),
log_sd_index=factor(NA))
lower_bounds<-c(-5,-20,rep(-10,dat$lage),rep(-10,dat$lyear), 0, 5, -5,-5,-5,-5,-5,rep(-10,dat$lyear))
upper_bounds<-c( 2,  1,rep( 10,dat$lage),rep( 10,dat$lyear), 1, 25, 2, 2, 2, 5, 5,rep(  0,dat$lyear))
reffects=c("log_recruit_devs","log_recruit_devs_init")
l<-lower_bounds[-which(parm_names %in% c(names(fixed)))]
u<-upper_bounds[-which(parm_names %in% c(names(fixed)))]
SCAA <- MakeADFun(dat, par, DLL="CKMRmultinom_POP_HSP_GPP_Fisch_wAE", map=fixed)
SCAA_fit <- TMBhelper::fit_tmb(obj=SCAA, startpar=SCAA$par, lower=l, upper=u, newtonsteps=1, getsd=TRUE)
res_list[[Q]][[s]]<-SCAA_fit
print(c(Q,s))
}
}
s
res_list[[2]][[31]]$SD$value
re_Dep<-re_SSB<-array(NA, dim=c(3,100,76))
re_R0<-re_M<-matrix(NA, nrow=100, ncol=3)
for(f in 2:2){
for (i in 1:31){
if(f==1){
if(length(res_list[[f]][[i]])>2){
re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Cod_wdat[[i]]$OM$SSB[26:101])/Cod_wdat[[i]]$OM$SSB[26:101]
re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Cod_wdat[[i]]$OM$R0)/Cod_wdat[[i]]$OM$R0
re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Cod_wdat[[i]]$OM$Mref)/Cod_wdat[[i]]$OM$Mref
}
}else if (f==2){
if(length(res_list[[f]][[i]])>2){
re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Flatfish_wdat[[i]]$OM$SSB[26:101])/Flatfish_wdat[[i]]$OM$SSB[26:101]
re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Flatfish_wdat[[i]]$OM$R0)/Flatfish_wdat[[i]]$OM$R0
re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Flatfish_wdat[[i]]$OM$Mref)/Flatfish_wdat[[i]]$OM$Mref
}
} else if (f==3){
if(length(res_list[[f]][[i]])>2){
re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Sardine_wdat[[i]]$OM$SSB[26:101])/Sardine_wdat[[i]]$OM$SSB[26:101]
re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Sardine_wdat[[i]]$OM$R0)/Sardine_wdat[[i]]$OM$R0
re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Sardine_wdat[[i]]$OM$Mref)/Sardine_wdat[[i]]$OM$Mref
}
}
}
}
boxplot(re_SSB[2,,], ylim=c(-0.25,0.25), las=1, main="Flatfish - N5000, Index SD - 0.50, CKMR 5yrs", ylab="RE - SSB")
re_SSB
re_SSB[2,,]
boxplot(re_SSB[2,,], ylim=c(), las=1, main="Flatfish - N5000, Index SD - 0.50, CKMR 5yrs", ylab="RE - SSB")
res_list[[2]][[1]]$SD$value-Flatfish_wdat[[1]]$OM$SSB[26:101])
res_list[[2]][[1]]$SD$value-Flatfish_wdat[[1]]$OM$SSB[26:101]
plot(Flatfish_wdat[[1]]$OM$SSB[26:101])
points(res_list[[2]][[1]]$SD$value, col=2)
plot(Flatfish_wdat[[1]]$OM$SSB[26:101], ylim=c(0,1e5))
points(res_list[[2]][[1]]$SD$value, col=2)
plot(Flatfish_wdat[[2]]$OM$SSB[26:101], ylim=c(0,1e5))
points(res_list[[2]][[2]]$SD$value, col=2)
