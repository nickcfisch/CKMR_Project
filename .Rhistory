for(f in 1:3){
for (i in 1:100){
CV_ssb_N1000_NoIndex_ckmrmultinom10[f,i,]<-res_list[[f]][[i]]$SD$sd/res_list[[f]][[i]]$SD$unbiased$value
SD_ssb_N1000_NoIndex_ckmrmultinom10[f,i,]<-res_list[[f]][[i]]$SD$sd
SD_R0_N1000_NoIndex_ckmrmultinom10[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_R0","log_R0"])
SD_M_N1000_NoIndex_ckmrmultinom10[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_M","log_M"])
}
}
#N5000, 10yrs CKMR data, No Index
res_list<-list()
res_list[[1]]<-readRDS(paste0(wd,"/SCAAfit_Cod_N5000_NoIndex_ckmrmultinom10.RData"))
res_list[[2]]<-readRDS(paste0(wd,"/SCAAfit_Flatfish_N5000_NoIndex_ckmrmultinom10.RData"))
res_list[[3]]<-readRDS(paste0(wd,"/SCAAfit_Sardine_N5000_NoIndex_ckmrmultinom10.RData"))
load(paste0(wd,"/Cod_wdat_N5000_Ind25_ckmrmultinom10_1.RData"))
load(paste0(wd,"/Flatfish_wdat_N5000_Ind25_ckmrmultinom10_1.RData"))
load(paste0(wd,"/Sardine_wdat_N5000_Ind25_ckmrmultinom10_1.RData"))
re_Dep<-re_SSB<-array(NA, dim=c(3,100,76))
re_R0<-re_M<-matrix(NA, nrow=100, ncol=3)
for(f in 1:3){
for (i in 1:100){
if(f==1){
if (!is.null(res_list[[f]][[i]])){
re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Cod_wdat[[i]]$OM$SSB[26:101])/Cod_wdat[[i]]$OM$SSB[26:101]
#re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Cod_wdat[[i]]$OM$SSB[26:101]/Cod_wdat[[i]]$OM$SSB0)/(Cod_wdat[[i]]$OM$SSB[26:101]/Cod_wdat[[i]]$OM$SSB0)
re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[2])-Cod_wdat[[i]]$OM$R0)/Cod_wdat[[i]]$OM$R0
re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Cod_wdat[[i]]$OM$Mref)/Cod_wdat[[i]]$OM$Mref
}
}else if (f==2){
if (!is.null(res_list[[f]][[i]])){
re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Flatfish_wdat[[i]]$OM$SSB[26:101])/Flatfish_wdat[[i]]$OM$SSB[26:101]
#re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Flatfish_wdat[[i]]$OM$SSB[26:101]/Flatfish_wdat[[i]]$OM$SSB0)/(Flatfish_wdat[[i]]$OM$SSB[26:101]/Flatfish_wdat[[i]]$OM$SSB0)
re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[2])-Flatfish_wdat[[i]]$OM$R0)/Flatfish_wdat[[i]]$OM$R0
re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Flatfish_wdat[[i]]$OM$Mref)/Flatfish_wdat[[i]]$OM$Mref
}
} else if (f==3){
if (!is.null(res_list[[f]][[i]])){
re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Sardine_wdat[[i]]$OM$SSB[26:101])/Sardine_wdat[[i]]$OM$SSB[26:101]
#re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Sardine_wdat[[i]]$OM$SSB[26:101]/Sardine_wdat[[i]]$OM$SSB0)/(Sardine_wdat[[i]]$OM$SSB[26:101]/Sardine_wdat[[i]]$OM$SSB0)
re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[2])-Sardine_wdat[[i]]$OM$R0)/Sardine_wdat[[i]]$OM$R0
re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Sardine_wdat[[i]]$OM$Mref)/Sardine_wdat[[i]]$OM$Mref
}
}
}
}
#SSB
par(mfrow=c(3,3))
boxplot(re_SSB[1,,], ylim=c(-0.25,0.25), las=1, main="Cod - N5000, No Index, CKMR 10yrs", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[2,,], ylim=c(-0.25,0.25), las=1, main="Flatfish - N5000, No Index, CKMR 10yrs", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[3,,], ylim=c(-0.25,0.25), las=1, main="Sardine - N5000, No Index, CKMR 10yrs", ylab="RE - SSB")
abline(h=0)
#R0
boxplot(re_R0[,1], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,2], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,3], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
#M
boxplot(re_M[,1], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,2], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,3], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
#Relative error for point estimates
RE_ssb_N5000_NoIndex_ckmrmultinom10<-re_SSB
RE_R0_N5000_NoIndex_ckmrmultinom10<-re_R0
RE_M_N5000_NoIndex_ckmrmultinom10<-re_M
#Interquartile Range of relative errors
IQR_RE_ssb_N5000_NoIndex_ckmrmultinom10<-apply(re_SSB,c(1,3),quantile,probs=0.75, na.rm=TRUE)-apply(re_SSB,c(1,3),quantile,probs=0.25, na.rm=TRUE)
IQR_RE_R0_N5000_NoIndex_ckmrmultinom10<-apply(re_R0,2,quantile,probs=0.75, na.rm=TRUE)-apply(re_R0,2,quantile,probs=0.25, na.rm=TRUE)
IQR_RE_M_N5000_NoIndex_ckmrmultinom10<-apply(re_M,2,quantile,probs=0.75, na.rm=TRUE)-apply(re_M,2,quantile,probs=0.25, na.rm=TRUE)
#Interquartile Range of absolute relative errors
IQR_ARE_ssb_N5000_NoIndex_ckmrmultinom10<-apply(abs(re_SSB),c(1,3),quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_SSB),c(1,3),quantile,probs=0.25, na.rm=TRUE)
IQR_ARE_R0_N5000_NoIndex_ckmrmultinom10<-apply(abs(re_R0),2,quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_R0),2,quantile,probs=0.25, na.rm=TRUE)
IQR_ARE_M_N5000_NoIndex_ckmrmultinom10<-apply(abs(re_M),2,quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_M),2,quantile,probs=0.25, na.rm=TRUE)
#SD of relative error for point estimates
sd_RE_ssb_N5000_NoIndex_ckmrmultinom10<-apply(re_SSB,c(1,3),sd, na.rm=TRUE)
sd_RE_R0_N5000_NoIndex_ckmrmultinom10<-apply(re_R0,2,sd, na.rm=TRUE)
sd_RE_M_N5000_NoIndex_ckmrmultinom10<-apply(re_M,2,sd, na.rm=TRUE)
#SD of absolute relative error
sd_ARE_ssb_N5000_NoIndex_ckmrmultinom10<-apply(abs(re_SSB),c(1,3),sd, na.rm=TRUE)
sd_ARE_R0_N5000_NoIndex_ckmrmultinom10<-apply(abs(re_R0),2,sd, na.rm=TRUE)
sd_ARE_M_N5000_NoIndex_ckmrmultinom10<-apply(abs(re_M),2,sd, na.rm=TRUE)
#Precision within sims
SD_ssb_N5000_NoIndex_ckmrmultinom10<-CV_ssb_N5000_NoIndex_ckmrmultinom10<-array(NA, dim=c(3,100,76))
SD_R0_N5000_NoIndex_ckmrmultinom10<-matrix(NA, nrow=3, ncol=100)
SD_M_N5000_NoIndex_ckmrmultinom10<-matrix(NA, nrow=3, ncol=100)
for(f in 1:3){
for (i in 1:100){
if (!is.null(res_list[[f]][[i]])){
CV_ssb_N5000_NoIndex_ckmrmultinom10[f,i,]<-res_list[[f]][[i]]$SD$sd/res_list[[f]][[i]]$SD$unbiased$value
SD_ssb_N5000_NoIndex_ckmrmultinom10[f,i,]<-res_list[[f]][[i]]$SD$sd
SD_R0_N5000_NoIndex_ckmrmultinom10[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_R0","log_R0"])
SD_M_N5000_NoIndex_ckmrmultinom10[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_M","log_M"])
}
}
}
#N100, 20yrs CKMR data, No Index
res_list<-list()
res_list[[1]]<-readRDS(paste0(wd,"/SCAAfit_Cod_N100_NoIndex_ckmrmultinom20.RData"))
res_list[[2]]<-readRDS(paste0(wd,"/SCAAfit_Flatfish_N100_NoIndex_ckmrmultinom20.RData"))
res_list[[3]]<-readRDS(paste0(wd,"/SCAAfit_Sardine_N100_NoIndex_ckmrmultinom20.RData"))
load(paste0(wd,"/Cod_wdat_N100_Ind25_ckmrmultinom20_1.RData"))
load(paste0(wd,"/Flatfish_wdat_N100_Ind25_ckmrmultinom20_1.RData"))
load(paste0(wd,"/Sardine_wdat_N100_Ind25_ckmrmultinom20_1.RData"))
re_Dep<-re_SSB<-array(NA, dim=c(3,100,76))
re_R0<-re_M<-matrix(NA, nrow=100, ncol=3)
for(f in 1:3){
for (i in 1:100){
if(f==1){
re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Cod_wdat[[i]]$OM$SSB[26:101])/Cod_wdat[[i]]$OM$SSB[26:101]
#re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Cod_wdat[[i]]$OM$SSB[26:101]/Cod_wdat[[i]]$OM$SSB0)/(Cod_wdat[[i]]$OM$SSB[26:101]/Cod_wdat[[i]]$OM$SSB0)
re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[2])-Cod_wdat[[i]]$OM$R0)/Cod_wdat[[i]]$OM$R0
re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Cod_wdat[[i]]$OM$Mref)/Cod_wdat[[i]]$OM$Mref
}else if (f==2){
re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Flatfish_wdat[[i]]$OM$SSB[26:101])/Flatfish_wdat[[i]]$OM$SSB[26:101]
#re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Flatfish_wdat[[i]]$OM$SSB[26:101]/Flatfish_wdat[[i]]$OM$SSB0)/(Flatfish_wdat[[i]]$OM$SSB[26:101]/Flatfish_wdat[[i]]$OM$SSB0)
re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[2])-Flatfish_wdat[[i]]$OM$R0)/Flatfish_wdat[[i]]$OM$R0
re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Flatfish_wdat[[i]]$OM$Mref)/Flatfish_wdat[[i]]$OM$Mref
} else if (f==3){
re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Sardine_wdat[[i]]$OM$SSB[26:101])/Sardine_wdat[[i]]$OM$SSB[26:101]
#re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Sardine_wdat[[i]]$OM$SSB[26:101]/Sardine_wdat[[i]]$OM$SSB0)/(Sardine_wdat[[i]]$OM$SSB[26:101]/Sardine_wdat[[i]]$OM$SSB0)
re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[2])-Sardine_wdat[[i]]$OM$R0)/Sardine_wdat[[i]]$OM$R0
re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Sardine_wdat[[i]]$OM$Mref)/Sardine_wdat[[i]]$OM$Mref
}
}
}
#SSB
par(mfrow=c(3,3))
boxplot(re_SSB[1,,], ylim=c(-0.25,0.25), las=1, main="Cod - N100, No Index, CKMR 20yrs", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[2,,], ylim=c(-0.25,0.25), las=1, main="Flatfish - N100, No Index, CKMR 20yrs", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[3,,], ylim=c(-0.25,0.25), las=1, main="Sardine - N100, No Index, CKMR 20yrs", ylab="RE - SSB")
abline(h=0)
#R0
boxplot(re_R0[,1], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,2], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,3], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
#M
boxplot(re_M[,1], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,2], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,3], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
#Relative error for point estimates
RE_ssb_N100_NoIndex_ckmrmultinom20<-re_SSB
RE_R0_N100_NoIndex_ckmrmultinom20<-re_R0
RE_M_N100_NoIndex_ckmrmultinom20<-re_M
#Interquartile Range of relative errors
IQR_RE_ssb_N100_NoIndex_ckmrmultinom20<-apply(re_SSB,c(1,3),quantile,probs=0.75, na.rm=TRUE)-apply(re_SSB,c(1,3),quantile,probs=0.25, na.rm=TRUE)
IQR_RE_R0_N100_NoIndex_ckmrmultinom20<-apply(re_R0,2,quantile,probs=0.75, na.rm=TRUE)-apply(re_R0,2,quantile,probs=0.25, na.rm=TRUE)
IQR_RE_M_N100_NoIndex_ckmrmultinom20<-apply(re_M,2,quantile,probs=0.75, na.rm=TRUE)-apply(re_M,2,quantile,probs=0.25, na.rm=TRUE)
#Interquartile Range of absolute relative errors
IQR_ARE_ssb_N100_NoIndex_ckmrmultinom20<-apply(abs(re_SSB),c(1,3),quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_SSB),c(1,3),quantile,probs=0.25, na.rm=TRUE)
IQR_ARE_R0_N100_NoIndex_ckmrmultinom20<-apply(abs(re_R0),2,quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_R0),2,quantile,probs=0.25, na.rm=TRUE)
IQR_ARE_M_N100_NoIndex_ckmrmultinom20<-apply(abs(re_M),2,quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_M),2,quantile,probs=0.25, na.rm=TRUE)
#SD of relative error for point estimates
sd_RE_ssb_N100_NoIndex_ckmrmultinom20<-apply(re_SSB,c(1,3),sd, na.rm=TRUE)
sd_RE_R0_N100_NoIndex_ckmrmultinom20<-apply(re_R0,2,sd, na.rm=TRUE)
sd_RE_M_N100_NoIndex_ckmrmultinom20<-apply(re_M,2,sd, na.rm=TRUE)
#SD of absolute relative error
sd_ARE_ssb_N100_NoIndex_ckmrmultinom20<-apply(abs(re_SSB),c(1,3),sd, na.rm=TRUE)
sd_ARE_R0_N100_NoIndex_ckmrmultinom20<-apply(abs(re_R0),2,sd, na.rm=TRUE)
sd_ARE_M_N100_NoIndex_ckmrmultinom20<-apply(abs(re_M),2,sd, na.rm=TRUE)
#Precision within sims
SD_ssb_N100_NoIndex_ckmrmultinom20<-CV_ssb_N100_NoIndex_ckmrmultinom20<-array(NA, dim=c(3,100,76))
SD_R0_N100_NoIndex_ckmrmultinom20<-matrix(NA, nrow=3, ncol=100)
SD_M_N100_NoIndex_ckmrmultinom20<-matrix(NA, nrow=3, ncol=100)
for(f in 1:3){
for (i in 1:100){
CV_ssb_N100_NoIndex_ckmrmultinom20[f,i,]<-res_list[[f]][[i]]$SD$sd/res_list[[f]][[i]]$SD$unbiased$value
SD_ssb_N100_NoIndex_ckmrmultinom20[f,i,]<-res_list[[f]][[i]]$SD$sd
SD_R0_N100_NoIndex_ckmrmultinom20[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_R0","log_R0"])
SD_M_N100_NoIndex_ckmrmultinom20[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_M","log_M"])
}
}
#N1000, 20yrs CKMR data, No Index
res_list<-list()
res_list[[1]]<-readRDS(paste0(wd,"/SCAAfit_Cod_N1000_NoIndex_ckmrmultinom20.RData"))
res_list[[2]]<-readRDS(paste0(wd,"/SCAAfit_Flatfish_N1000_NoIndex_ckmrmultinom20.RData"))
res_list[[3]]<-readRDS(paste0(wd,"/SCAAfit_Sardine_N1000_NoIndex_ckmrmultinom20.RData"))
load(paste0(wd,"/Cod_wdat_N1000_Ind25_ckmrmultinom20_1.RData"))
load(paste0(wd,"/Flatfish_wdat_N1000_Ind25_ckmrmultinom20_1.RData"))
load(paste0(wd,"/Sardine_wdat_N1000_Ind25_ckmrmultinom20_1.RData"))
re_Dep<-re_SSB<-array(NA, dim=c(3,100,76))
re_R0<-re_M<-matrix(NA, nrow=100, ncol=3)
for(f in 1:3){
for (i in 1:100){
if(f==1){
re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Cod_wdat[[i]]$OM$SSB[26:101])/Cod_wdat[[i]]$OM$SSB[26:101]
#re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Cod_wdat[[i]]$OM$SSB[26:101]/Cod_wdat[[i]]$OM$SSB0)/(Cod_wdat[[i]]$OM$SSB[26:101]/Cod_wdat[[i]]$OM$SSB0)
re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[2])-Cod_wdat[[i]]$OM$R0)/Cod_wdat[[i]]$OM$R0
re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Cod_wdat[[i]]$OM$Mref)/Cod_wdat[[i]]$OM$Mref
}else if (f==2){
re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Flatfish_wdat[[i]]$OM$SSB[26:101])/Flatfish_wdat[[i]]$OM$SSB[26:101]
#re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Flatfish_wdat[[i]]$OM$SSB[26:101]/Flatfish_wdat[[i]]$OM$SSB0)/(Flatfish_wdat[[i]]$OM$SSB[26:101]/Flatfish_wdat[[i]]$OM$SSB0)
re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[2])-Flatfish_wdat[[i]]$OM$R0)/Flatfish_wdat[[i]]$OM$R0
re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Flatfish_wdat[[i]]$OM$Mref)/Flatfish_wdat[[i]]$OM$Mref
} else if (f==3){
re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Sardine_wdat[[i]]$OM$SSB[26:101])/Sardine_wdat[[i]]$OM$SSB[26:101]
#re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Sardine_wdat[[i]]$OM$SSB[26:101]/Sardine_wdat[[i]]$OM$SSB0)/(Sardine_wdat[[i]]$OM$SSB[26:101]/Sardine_wdat[[i]]$OM$SSB0)
re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[2])-Sardine_wdat[[i]]$OM$R0)/Sardine_wdat[[i]]$OM$R0
re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Sardine_wdat[[i]]$OM$Mref)/Sardine_wdat[[i]]$OM$Mref
}
}
}
#SSB
par(mfrow=c(3,3))
boxplot(re_SSB[1,,], ylim=c(-0.25,0.25), las=1, main="Cod - N1000, No Index, CKMR 20yrs", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[2,,], ylim=c(-0.25,0.25), las=1, main="Flatfish - N1000, No Index, CKMR 20yrs", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[3,,], ylim=c(-0.25,0.25), las=1, main="Sardine - N1000, No Index, CKMR 20yrs", ylab="RE - SSB")
abline(h=0)
#R0
boxplot(re_R0[,1], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,2], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,3], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
#M
boxplot(re_M[,1], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,2], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,3], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
#Relative error for point estimates
RE_ssb_N1000_NoIndex_ckmrmultinom20<-re_SSB
RE_R0_N1000_NoIndex_ckmrmultinom20<-re_R0
RE_M_N1000_NoIndex_ckmrmultinom20<-re_M
#Interquartile Range of relative errors
IQR_RE_ssb_N1000_NoIndex_ckmrmultinom20<-apply(re_SSB,c(1,3),quantile,probs=0.75, na.rm=TRUE)-apply(re_SSB,c(1,3),quantile,probs=0.25, na.rm=TRUE)
IQR_RE_R0_N1000_NoIndex_ckmrmultinom20<-apply(re_R0,2,quantile,probs=0.75, na.rm=TRUE)-apply(re_R0,2,quantile,probs=0.25, na.rm=TRUE)
IQR_RE_M_N1000_NoIndex_ckmrmultinom20<-apply(re_M,2,quantile,probs=0.75, na.rm=TRUE)-apply(re_M,2,quantile,probs=0.25, na.rm=TRUE)
#Interquartile Range of absolute relative errors
IQR_ARE_ssb_N1000_NoIndex_ckmrmultinom20<-apply(abs(re_SSB),c(1,3),quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_SSB),c(1,3),quantile,probs=0.25, na.rm=TRUE)
IQR_ARE_R0_N1000_NoIndex_ckmrmultinom20<-apply(abs(re_R0),2,quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_R0),2,quantile,probs=0.25, na.rm=TRUE)
IQR_ARE_M_N1000_NoIndex_ckmrmultinom20<-apply(abs(re_M),2,quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_M),2,quantile,probs=0.25, na.rm=TRUE)
#SD of relative error for point estimates
sd_RE_ssb_N1000_NoIndex_ckmrmultinom20<-apply(re_SSB,c(1,3),sd, na.rm=TRUE)
sd_RE_R0_N1000_NoIndex_ckmrmultinom20<-apply(re_R0,2,sd, na.rm=TRUE)
sd_RE_M_N1000_NoIndex_ckmrmultinom20<-apply(re_M,2,sd, na.rm=TRUE)
#SD of absolute relative error
sd_ARE_ssb_N1000_NoIndex_ckmrmultinom20<-apply(abs(re_SSB),c(1,3),sd, na.rm=TRUE)
sd_ARE_R0_N1000_NoIndex_ckmrmultinom20<-apply(abs(re_R0),2,sd, na.rm=TRUE)
sd_ARE_M_N1000_NoIndex_ckmrmultinom20<-apply(abs(re_M),2,sd, na.rm=TRUE)
#Precision within sims
SD_ssb_N1000_NoIndex_ckmrmultinom20<-CV_ssb_N1000_NoIndex_ckmrmultinom20<-array(NA, dim=c(3,100,76))
SD_R0_N1000_NoIndex_ckmrmultinom20<-matrix(NA, nrow=3, ncol=100)
SD_M_N1000_NoIndex_ckmrmultinom20<-matrix(NA, nrow=3, ncol=100)
for(f in 1:3){
for (i in 1:100){
CV_ssb_N1000_NoIndex_ckmrmultinom20[f,i,]<-res_list[[f]][[i]]$SD$sd/res_list[[f]][[i]]$SD$unbiased$value
SD_ssb_N1000_NoIndex_ckmrmultinom20[f,i,]<-res_list[[f]][[i]]$SD$sd
SD_R0_N1000_NoIndex_ckmrmultinom20[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_R0","log_R0"])
SD_M_N1000_NoIndex_ckmrmultinom20[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_M","log_M"])
}
}
#N5000, 20yrs CKMR data, No Index
res_list<-list()
res_list[[1]]<-readRDS(paste0(wd,"/SCAAfit_Cod_N5000_NoIndex_ckmrmultinom20.RData"))
res_list[[2]]<-readRDS(paste0(wd,"/SCAAfit_Flatfish_N5000_NoIndex_ckmrmultinom20.RData"))
res_list[[3]]<-readRDS(paste0(wd,"/SCAAfit_Sardine_N5000_NoIndex_ckmrmultinom20.RData"))
load(paste0(wd,"/Cod_wdat_N5000_Ind25_ckmrmultinom20_1.RData"))
load(paste0(wd,"/Flatfish_wdat_N5000_Ind25_ckmrmultinom20_1.RData"))
load(paste0(wd,"/Sardine_wdat_N5000_Ind25_ckmrmultinom20_1.RData"))
re_Dep<-re_SSB<-array(NA, dim=c(3,100,76))
re_R0<-re_M<-matrix(NA, nrow=100, ncol=3)
for(f in 1:3){
for (i in 1:100){
if(f==1){
if (!is.null(res_list[[f]][[i]])){
re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Cod_wdat[[i]]$OM$SSB[26:101])/Cod_wdat[[i]]$OM$SSB[26:101]
#re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Cod_wdat[[i]]$OM$SSB[26:101]/Cod_wdat[[i]]$OM$SSB0)/(Cod_wdat[[i]]$OM$SSB[26:101]/Cod_wdat[[i]]$OM$SSB0)
re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[2])-Cod_wdat[[i]]$OM$R0)/Cod_wdat[[i]]$OM$R0
re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Cod_wdat[[i]]$OM$Mref)/Cod_wdat[[i]]$OM$Mref
}
}else if (f==2){
if (!is.null(res_list[[f]][[i]])){
re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Flatfish_wdat[[i]]$OM$SSB[26:101])/Flatfish_wdat[[i]]$OM$SSB[26:101]
#re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Flatfish_wdat[[i]]$OM$SSB[26:101]/Flatfish_wdat[[i]]$OM$SSB0)/(Flatfish_wdat[[i]]$OM$SSB[26:101]/Flatfish_wdat[[i]]$OM$SSB0)
re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[2])-Flatfish_wdat[[i]]$OM$R0)/Flatfish_wdat[[i]]$OM$R0
re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Flatfish_wdat[[i]]$OM$Mref)/Flatfish_wdat[[i]]$OM$Mref
}
} else if (f==3){
if (!is.null(res_list[[f]][[i]])){
re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Sardine_wdat[[i]]$OM$SSB[26:101])/Sardine_wdat[[i]]$OM$SSB[26:101]
#re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Sardine_wdat[[i]]$OM$SSB[26:101]/Sardine_wdat[[i]]$OM$SSB0)/(Sardine_wdat[[i]]$OM$SSB[26:101]/Sardine_wdat[[i]]$OM$SSB0)
re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[2])-Sardine_wdat[[i]]$OM$R0)/Sardine_wdat[[i]]$OM$R0
re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Sardine_wdat[[i]]$OM$Mref)/Sardine_wdat[[i]]$OM$Mref
}
}
}
}
#SSB
par(mfrow=c(3,3))
boxplot(re_SSB[1,,], ylim=c(-0.25,0.25), las=1, main="Cod - N5000, No Index, CKMR 20yrs", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[2,,], ylim=c(-0.25,0.25), las=1, main="Flatfish - N5000, No Index, CKMR 20yrs", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[3,,], ylim=c(-0.25,0.25), las=1, main="Sardine - N5000, No Index, CKMR 20yrs", ylab="RE - SSB")
abline(h=0)
#R0
boxplot(re_R0[,1], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,2], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,3], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
#M
boxplot(re_M[,1], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,2], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,3], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
#Relative error for point estimates
RE_ssb_N5000_NoIndex_ckmrmultinom20<-re_SSB
RE_R0_N5000_NoIndex_ckmrmultinom20<-re_R0
RE_M_N5000_NoIndex_ckmrmultinom20<-re_M
#Interquartile Range of relative errors
IQR_RE_ssb_N5000_NoIndex_ckmrmultinom20<-apply(re_SSB,c(1,3),quantile,probs=0.75, na.rm=TRUE)-apply(re_SSB,c(1,3),quantile,probs=0.25, na.rm=TRUE)
IQR_RE_R0_N5000_NoIndex_ckmrmultinom20<-apply(re_R0,2,quantile,probs=0.75, na.rm=TRUE)-apply(re_R0,2,quantile,probs=0.25, na.rm=TRUE)
IQR_RE_M_N5000_NoIndex_ckmrmultinom20<-apply(re_M,2,quantile,probs=0.75, na.rm=TRUE)-apply(re_M,2,quantile,probs=0.25, na.rm=TRUE)
#Interquartile Range of absolute relative errors
IQR_ARE_ssb_N5000_NoIndex_ckmrmultinom20<-apply(abs(re_SSB),c(1,3),quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_SSB),c(1,3),quantile,probs=0.25, na.rm=TRUE)
IQR_ARE_R0_N5000_NoIndex_ckmrmultinom20<-apply(abs(re_R0),2,quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_R0),2,quantile,probs=0.25, na.rm=TRUE)
IQR_ARE_M_N5000_NoIndex_ckmrmultinom20<-apply(abs(re_M),2,quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_M),2,quantile,probs=0.25, na.rm=TRUE)
#SD of relative error for point estimates
sd_RE_ssb_N5000_NoIndex_ckmrmultinom20<-apply(re_SSB,c(1,3),sd, na.rm=TRUE)
sd_RE_R0_N5000_NoIndex_ckmrmultinom20<-apply(re_R0,2,sd, na.rm=TRUE)
sd_RE_M_N5000_NoIndex_ckmrmultinom20<-apply(re_M,2,sd, na.rm=TRUE)
#SD of absolute relative error
sd_ARE_ssb_N5000_NoIndex_ckmrmultinom20<-apply(abs(re_SSB),c(1,3),sd, na.rm=TRUE)
sd_ARE_R0_N5000_NoIndex_ckmrmultinom20<-apply(abs(re_R0),2,sd, na.rm=TRUE)
sd_ARE_M_N5000_NoIndex_ckmrmultinom20<-apply(abs(re_M),2,sd, na.rm=TRUE)
#Precision within sims
SD_ssb_N5000_NoIndex_ckmrmultinom20<-CV_ssb_N5000_NoIndex_ckmrmultinom20<-array(NA, dim=c(3,100,76))
SD_R0_N5000_NoIndex_ckmrmultinom20<-matrix(NA, nrow=3, ncol=100)
SD_M_N5000_NoIndex_ckmrmultinom20<-matrix(NA, nrow=3, ncol=100)
for(f in 1:3){
for (i in 1:100){
if (!is.null(res_list[[f]][[i]])){
CV_ssb_N5000_NoIndex_ckmrmultinom20[f,i,]<-res_list[[f]][[i]]$SD$sd/res_list[[f]][[i]]$SD$unbiased$value
SD_ssb_N5000_NoIndex_ckmrmultinom20[f,i,]<-res_list[[f]][[i]]$SD$sd
SD_R0_N5000_NoIndex_ckmrmultinom20[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_R0","log_R0"])
SD_M_N5000_NoIndex_ckmrmultinom20[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_M","log_M"])
}
}
}
##############
#ARE SSB
##############
#tiff(filename="C:/Users/fischn/Documents/GitHub/CKMR_Project/ARE.tiff", height=30, width=50, units='cm', compression="lzw", res=500)
par(mfrow=c(3,9), mar=c(1,1,1,0.5), oma=c(3.5,4,1,1))
#Cod
plot(1:76,apply(abs(RE_ssb_N100_NoIndex_ckmrmultinom5),c(1,3),median)[1,]/apply(abs(RE_ssb_N100_NoIndex_5yrs_noCKMR),c(1,3),median)[1,], pch=16, las=1, ylim=c(0,1.4), ylab="", xlab="", main="5yrs",xaxt="n", xlim=c(0,250),bty="[")
abline(h=1, lty=2)
points(86:161,apply(abs(RE_ssb_N1000_NoIndex_ckmrmultinom5),c(1,3),median)[1,]/apply(abs(RE_ssb_N1000_NoIndex_5yrs_noCKMR),c(1,3),median)[1,], pch=16, col=2)
points(171:246,apply(abs(RE_ssb_N5000_NoIndex_ckmrmultinom5),c(1,3),median)[1,]/apply(abs(RE_ssb_N5000_NoIndex_5yrs_noCKMR),c(1,3),median)[1,], pch=16, col=3)
plot(1:76,apply(abs(RE_ssb_N100_NoIndex_ckmrmultinom10),c(1,3),median)[1,]/apply(abs(RE_ssb_N100_NoIndex_10yrs_noCKMR),c(1,3),median)[1,], pch=16, col=1,las=1, ylim=c(0,1.4), ylab="", xlab="", main="10yrs",xaxt="n",  xlim=c(0,250),yaxt="n",bty="n")
abline(h=1, lty=2)
points(86:161,apply(abs(RE_ssb_N1000_NoIndex_ckmrmultinom10),c(1,3),median)[1,]/apply(abs(RE_ssb_N1000_NoIndex_10yrs_noCKMR),c(1,3),median)[1,], pch=16, col=2)
points(171:246,apply(abs(RE_ssb_N5000_NoIndex_ckmrmultinom10),c(1,3),median)[1,]/apply(abs(RE_ssb_N5000_NoIndex_10yrs_noCKMR),c(1,3),median)[1,], pch=16, col=3)
mtext(side=3, text="No Index", line=-1.5, font=2)
axis(side=1,lwd.ticks = 0, labels=FALSE)
axis(side=3,lwd.ticks = 0, labels=FALSE)
plot(1:76,apply(abs(RE_ssb_N100_NoIndex_ckmrmultinom20),c(1,3),median)[1,]/apply(abs(RE_ssb_N100_NoIndex_20yrs_noCKMR),c(1,3),median)[1,], pch=16, col=1,las=1, ylim=c(0,1.4), ylab="", xlab="", main="20yrs",xaxt="n",  xlim=c(0,250),yaxt="n",bty="]")
abline(h=1, lty=2)
points(86:161,apply(abs(RE_ssb_N1000_NoIndex_ckmrmultinom20),c(1,3),median)[1,]/apply(abs(RE_ssb_N1000_NoIndex_20yrs_noCKMR),c(1,3),median)[1,], pch=16, col=2)
points(171:246,apply(abs(RE_ssb_N5000_NoIndex_ckmrmultinom20),c(1,3),median)[1,]/apply(abs(RE_ssb_N5000_NoIndex_20yrs_noCKMR),c(1,3),median)[1,], pch=16, col=3)
plot(1:76,apply(abs(RE_ssb_N100_Ind50_ckmrmultinom5),c(1,3),median)[1,]/apply(abs(RE_ssb_N100_Ind50_5yrs_noCKMR),c(1,3),median)[1,], pch=16, las=1, ylim=c(0,1.4), ylab="", xlab="", main="5yrs",xaxt="n", xlim=c(0,250),yaxt="n",bty="[")
abline(h=1, lty=2)
points(86:161,apply(abs(RE_ssb_N1000_Ind50_ckmrmultinom5),c(1,3),median)[1,]/apply(abs(RE_ssb_N1000_Ind50_5yrs_noCKMR),c(1,3),median)[1,], pch=16, col=2)
points(171:246,apply(abs(RE_ssb_N5000_Ind50_ckmrmultinom5),c(1,3),median)[1,]/apply(abs(RE_ssb_N5000_Ind50_5yrs_noCKMR),c(1,3),median)[1,], pch=16, col=3)
plot(1:76,apply(abs(RE_ssb_N100_Ind50_ckmrmultinom10),c(1,3),median)[1,]/apply(abs(RE_ssb_N100_Ind50_10yrs_noCKMR),c(1,3),median)[1,], pch=16, col=1,las=1, ylim=c(0,1.4), ylab="", xlab="", main="10yrs",xaxt="n",  xlim=c(0,250),yaxt="n",bty="n")
abline(h=1, lty=2)
points(86:161,apply(abs(RE_ssb_N1000_Ind50_ckmrmultinom10),c(1,3),median)[1,]/apply(abs(RE_ssb_N1000_Ind50_10yrs_noCKMR),c(1,3),median)[1,], pch=16, col=2)
points(171:246,apply(abs(RE_ssb_N5000_Ind50_ckmrmultinom10),c(1,3),median)[1,]/apply(abs(RE_ssb_N5000_Ind50_10yrs_noCKMR),c(1,3),median)[1,], pch=16, col=3)
mtext(side=1, text="Cod", line=-1, font=2)
mtext(side=3, text="Index - 0.5", line=-1.5, font=2)
axis(side=1,lwd.ticks = 0, labels=FALSE)
axis(side=3,lwd.ticks = 0, labels=FALSE)
plot(1:76,apply(abs(RE_ssb_N100_Ind50_ckmrmultinom20),c(1,3),median)[1,]/apply(abs(RE_ssb_N100_Ind50_20yrs_noCKMR),c(1,3),median)[1,], pch=16, col=1,las=1, ylim=c(0,1.4), ylab="", xlab="", main="20yrs",xaxt="n",  xlim=c(0,250),yaxt="n",bty="]")
abline(h=1, lty=2)
points(86:161,apply(abs(RE_ssb_N1000_Ind50_ckmrmultinom20),c(1,3),median)[1,]/apply(abs(RE_ssb_N1000_Ind50_20yrs_noCKMR),c(1,3),median)[1,], pch=16, col=2)
points(171:246,apply(abs(RE_ssb_N5000_Ind50_ckmrmultinom20),c(1,3),median)[1,]/apply(abs(RE_ssb_N5000_Ind50_20yrs_noCKMR),c(1,3),median)[1,], pch=16, col=3)
plot(1:76,apply(abs(RE_ssb_N100_Ind25_ckmrmultinom5),c(1,3),median)[1,]/apply(abs(RE_ssb_N100_Ind25_5yrs_noCKMR),c(1,3),median)[1,], pch=16, las=1, ylim=c(0,1.4), ylab="", xlab="", main="5yrs",xaxt="n", xlim=c(0,250),yaxt="n",bty="[")
abline(h=1, lty=2)
points(86:161,apply(abs(RE_ssb_N1000_Ind25_ckmrmultinom5),c(1,3),median)[1,]/apply(abs(RE_ssb_N1000_Ind25_5yrs_noCKMR),c(1,3),median)[1,], pch=16, col=2)
points(171:246,apply(abs(RE_ssb_N5000_Ind25_ckmrmultinom5),c(1,3),median)[1,]/apply(abs(RE_ssb_N5000_Ind25_5yrs_noCKMR),c(1,3),median)[1,], pch=16, col=3)
plot(1:76,apply(abs(RE_ssb_N100_Ind25_ckmrmultinom10),c(1,3),median)[1,]/apply(abs(RE_ssb_N100_Ind25_10yrs_noCKMR),c(1,3),median)[1,], pch=16, col=1,las=1, ylim=c(0,1.4), ylab="", xlab="", main="10yrs",xaxt="n",  xlim=c(0,250),yaxt="n",bty="n")
abline(h=1, lty=2)
points(86:161,apply(abs(RE_ssb_N1000_Ind25_ckmrmultinom10),c(1,3),median)[1,]/apply(abs(RE_ssb_N1000_Ind25_10yrs_noCKMR),c(1,3),median)[1,], pch=16, col=2)
points(171:246,apply(abs(RE_ssb_N5000_Ind25_ckmrmultinom10),c(1,3),median)[1,]/apply(abs(RE_ssb_N5000_Ind25_10yrs_noCKMR),c(1,3),median)[1,], pch=16, col=3)
mtext(side=3, text="Index - 0.25", line=-1.5, font=2)
axis(side=1,lwd.ticks = 0, labels=FALSE)
axis(side=3,lwd.ticks = 0, labels=FALSE)
plot(1:76,apply(abs(RE_ssb_N100_Ind25_ckmrmultinom20),c(1,3),median)[1,]/apply(abs(RE_ssb_N100_Ind25_20yrs_noCKMR),c(1,3),median)[1,], pch=16, col=1,las=1, ylim=c(0,1.4), ylab="", xlab="", main="20yrs",xaxt="n",  xlim=c(0,250),yaxt="n",bty="]")
abline(h=1, lty=2)
points(86:161,apply(abs(RE_ssb_N1000_Ind25_ckmrmultinom20),c(1,3),median)[1,]/apply(abs(RE_ssb_N1000_Ind25_20yrs_noCKMR),c(1,3),median)[1,], pch=16, col=2)
points(171:246,apply(abs(RE_ssb_N5000_Ind25_ckmrmultinom20),c(1,3),median)[1,]/apply(abs(RE_ssb_N5000_Ind25_20yrs_noCKMR),c(1,3),median)[1,], pch=16, col=3)
#Flatfish
plot(1:76,apply(abs(RE_ssb_N100_NoIndex_ckmrmultinom5),c(1,3),median)[2,]/apply(abs(RE_ssb_N100_NoIndex_5yrs_noCKMR),c(1,3),median)[2,], pch=16, las=1, ylim=c(0,1.4), ylab="", xlab="", main="",xaxt="n", xlim=c(0,250),bty="[")
abline(h=1, lty=2)
points(86:161,apply(abs(RE_ssb_N1000_NoIndex_ckmrmultinom5),c(1,3),median)[2,]/apply(abs(RE_ssb_N1000_NoIndex_5yrs_noCKMR),c(1,3),median)[2,], pch=16, col=2)
points(171:246,apply(abs(RE_ssb_N5000_NoIndex_ckmrmultinom5),c(1,3),median)[2,]/apply(abs(RE_ssb_N5000_NoIndex_5yrs_noCKMR),c(1,3),median)[2,], pch=16, col=3)
mtext(side=2, text="Median ARE of SSB / No CKMR", line=3)
plot(1:76,apply(abs(RE_ssb_N100_NoIndex_ckmrmultinom10),c(1,3),median)[2,]/apply(abs(RE_ssb_N100_NoIndex_10yrs_noCKMR),c(1,3),median)[2,], pch=16, col=1,las=1, ylim=c(0,1.4), ylab="", xlab="", main="",xaxt="n",  xlim=c(0,250),yaxt="n",bty="n")
abline(h=1, lty=2)
points(86:161,apply(abs(RE_ssb_N1000_NoIndex_ckmrmultinom10),c(1,3),median)[2,]/apply(abs(RE_ssb_N1000_NoIndex_10yrs_noCKMR),c(1,3),median)[2,], pch=16, col=2)
points(171:246,apply(abs(RE_ssb_N5000_NoIndex_ckmrmultinom10),c(1,3),median)[2,]/apply(abs(RE_ssb_N5000_NoIndex_10yrs_noCKMR),c(1,3),median)[2,], pch=16, col=3)
axis(side=1,lwd.ticks = 0, labels=FALSE)
axis(side=3,lwd.ticks = 0, labels=FALSE)
plot(1:76,apply(abs(RE_ssb_N100_NoIndex_ckmrmultinom20),c(1,3),median)[2,]/apply(abs(RE_ssb_N100_NoIndex_20yrs_noCKMR),c(1,3),median)[2,], pch=16, col=1,las=1, ylim=c(0,1.4), ylab="", xlab="", main="",xaxt="n",  xlim=c(0,250),yaxt="n",bty="]")
abline(h=1, lty=2)
points(86:161,apply(abs(RE_ssb_N1000_NoIndex_ckmrmultinom20),c(1,3),median)[2,]/apply(abs(RE_ssb_N1000_NoIndex_20yrs_noCKMR),c(1,3),median)[2,], pch=16, col=2)
points(171:246,apply(abs(RE_ssb_N5000_NoIndex_ckmrmultinom20),c(1,3),median)[2,]/apply(abs(RE_ssb_N5000_NoIndex_20yrs_noCKMR),c(1,3),median)[2,], pch=16, col=3)
plot(1:76,apply(abs(RE_ssb_N100_Ind50_ckmrmultinom5),c(1,3),median)[2,]/apply(abs(RE_ssb_N100_Ind50_5yrs_noCKMR),c(1,3),median)[2,], pch=16, las=1, ylim=c(0,1.4),yaxt="n", ylab="", xlab="", main="",xaxt="n", xlim=c(0,250),bty="[")
abline(h=1, lty=2)
points(86:161,apply(abs(RE_ssb_N1000_Ind50_ckmrmultinom5),c(1,3),median)[2,]/apply(abs(RE_ssb_N1000_Ind50_5yrs_noCKMR),c(1,3),median)[2,], pch=16, col=2)
points(171:246,apply(abs(RE_ssb_N5000_Ind50_ckmrmultinom5),c(1,3),median)[2,]/apply(abs(RE_ssb_N5000_Ind50_5yrs_noCKMR),c(1,3),median)[2,], pch=16, col=3)
plot(1:76,apply(abs(RE_ssb_N100_Ind50_ckmrmultinom10),c(1,3),median)[2,]/apply(abs(RE_ssb_N100_Ind50_10yrs_noCKMR),c(1,3),median)[2,], pch=16, col=1,las=1, ylim=c(0,1.4), ylab="", xlab="", main="",xaxt="n",  xlim=c(0,250),yaxt="n",bty="n")
abline(h=1, lty=2)
points(86:161,apply(abs(RE_ssb_N1000_Ind50_ckmrmultinom10),c(1,3),median)[2,]/apply(abs(RE_ssb_N1000_Ind50_10yrs_noCKMR),c(1,3),median)[2,], pch=16, col=2)
points(171:246,apply(abs(RE_ssb_N5000_Ind50_ckmrmultinom10),c(1,3),median)[2,]/apply(abs(RE_ssb_N5000_Ind50_10yrs_noCKMR),c(1,3),median)[2,], pch=16, col=3)
mtext(side=1, text="Flatfish", line=-1, font=2)
axis(side=1,lwd.ticks = 0, labels=FALSE)
axis(side=3,lwd.ticks = 0, labels=FALSE)
plot(1:76,apply(abs(RE_ssb_N100_Ind50_ckmrmultinom20),c(1,3),median)[2,]/apply(abs(RE_ssb_N100_Ind50_20yrs_noCKMR),c(1,3),median)[2,], pch=16, col=1,las=1, ylim=c(0,1.4), ylab="", xlab="", main="",xaxt="n",  xlim=c(0,250),yaxt="n",bty="]")
abline(h=1, lty=2)
points(86:161,apply(abs(RE_ssb_N1000_Ind50_ckmrmultinom20),c(1,3),median)[2,]/apply(abs(RE_ssb_N1000_Ind50_20yrs_noCKMR),c(1,3),median)[2,], pch=16, col=2)
points(171:246,apply(abs(RE_ssb_N5000_Ind50_ckmrmultinom20),c(1,3),median)[2,]/apply(abs(RE_ssb_N5000_Ind50_20yrs_noCKMR),c(1,3),median)[2,], pch=16, col=3)
plot(1:76,apply(abs(RE_ssb_N100_Ind25_ckmrmultinom5),c(1,3),median)[2,]/apply(abs(RE_ssb_N100_Ind25_5yrs_noCKMR),c(1,3),median)[2,], pch=16, las=1, ylim=c(0,1.4),yaxt="n", ylab="", xlab="", main="",xaxt="n", xlim=c(0,250),bty="[")
abline(h=1, lty=2)
points(86:161,apply(abs(RE_ssb_N1000_Ind25_ckmrmultinom5),c(1,3),median)[2,]/apply(abs(RE_ssb_N1000_Ind25_5yrs_noCKMR),c(1,3),median)[2,], pch=16, col=2)
points(171:246,apply(abs(RE_ssb_N5000_Ind25_ckmrmultinom5),c(1,3),median)[2,]/apply(abs(RE_ssb_N5000_Ind25_5yrs_noCKMR),c(1,3),median)[2,], pch=16, col=3)
plot(1:76,apply(abs(RE_ssb_N100_Ind25_ckmrmultinom10),c(1,3),median)[2,]/apply(abs(RE_ssb_N100_Ind25_10yrs_noCKMR),c(1,3),median)[2,], pch=16, col=1,las=1, ylim=c(0,1.4), ylab="", xlab="", main="",xaxt="n",  xlim=c(0,250),yaxt="n",bty="n")
abline(h=1, lty=2)
points(86:161,apply(abs(RE_ssb_N1000_Ind25_ckmrmultinom10),c(1,3),median)[2,]/apply(abs(RE_ssb_N1000_Ind25_10yrs_noCKMR),c(1,3),median)[2,], pch=16, col=2)
points(171:246,apply(abs(RE_ssb_N5000_Ind25_ckmrmultinom10),c(1,3),median)[2,]/apply(abs(RE_ssb_N5000_Ind25_10yrs_noCKMR),c(1,3),median)[2,], pch=16, col=3)
axis(side=1,lwd.ticks = 0, labels=FALSE)
axis(side=3,lwd.ticks = 0, labels=FALSE)
plot(1:76,apply(abs(RE_ssb_N100_Ind25_ckmrmultinom20),c(1,3),median)[2,]/apply(abs(RE_ssb_N100_Ind25_20yrs_noCKMR),c(1,3),median)[2,], pch=16, col=1,las=1, ylim=c(0,1.4), ylab="", xlab="", main="",xaxt="n",  xlim=c(0,250),yaxt="n",bty="]")
abline(h=1, lty=2)
points(86:161,apply(abs(RE_ssb_N1000_Ind25_ckmrmultinom20),c(1,3),median)[2,]/apply(abs(RE_ssb_N1000_Ind25_20yrs_noCKMR),c(1,3),median)[2,], pch=16, col=2)
points(171:246,apply(abs(RE_ssb_N5000_Ind25_ckmrmultinom20),c(1,3),median)[2,]/apply(abs(RE_ssb_N5000_Ind25_20yrs_noCKMR),c(1,3),median)[2,], pch=16, col=3)
#Sardine
plot(1:76,apply(abs(RE_ssb_N100_NoIndex_ckmrmultinom5),c(1,3),median)[3,]/apply(abs(RE_ssb_N100_NoIndex_5yrs_noCKMR),c(1,3),median)[3,], pch=16, las=1, ylim=c(0,1.4), ylab="", xlab="", main="",xaxt="n", xlim=c(0,250),bty="[")
abline(h=1, lty=2)
points(86:161,apply(abs(RE_ssb_N1000_NoIndex_ckmrmultinom5),c(1,3),median)[3,]/apply(abs(RE_ssb_N1000_NoIndex_5yrs_noCKMR),c(1,3),median)[3,], pch=16, col=2)
points(171:246,apply(abs(RE_ssb_N5000_NoIndex_ckmrmultinom5),c(1,3),median)[3,]/apply(abs(RE_ssb_N5000_NoIndex_5yrs_noCKMR),c(1,3),median)[3,], pch=16, col=3)
axis(side=1, at=c(40,127,211), labels=c("N100", "N1000", "N5000"))
plot(1:76,apply(abs(RE_ssb_N100_NoIndex_ckmrmultinom10),c(1,3),median)[3,]/apply(abs(RE_ssb_N100_NoIndex_10yrs_noCKMR),c(1,3),median)[3,], pch=16, col=1,las=1, ylim=c(0,1.4), ylab="", xlab="", main="",xaxt="n",  xlim=c(0,250),yaxt="n",bty="n")
abline(h=1, lty=2)
points(86:161,apply(abs(RE_ssb_N1000_NoIndex_ckmrmultinom10),c(1,3),median)[3,]/apply(abs(RE_ssb_N1000_NoIndex_10yrs_noCKMR),c(1,3),median)[3,], pch=16, col=2)
points(171:246,apply(abs(RE_ssb_N5000_NoIndex_ckmrmultinom10),c(1,3),median)[3,]/apply(abs(RE_ssb_N5000_NoIndex_10yrs_noCKMR),c(1,3),median)[3,], pch=16, col=3)
axis(side=1, at=c(40,127,211), labels=c("N100", "N1000", "N5000"))
axis(side=1,lwd.ticks = 0, labels=FALSE)
axis(side=3,lwd.ticks = 0, labels=FALSE)
plot(1:76,apply(abs(RE_ssb_N100_NoIndex_ckmrmultinom20),c(1,3),median)[3,]/apply(abs(RE_ssb_N100_NoIndex_20yrs_noCKMR),c(1,3),median)[3,], pch=16, col=1,las=1, ylim=c(0,1.4), ylab="", xlab="", main="",xaxt="n",  xlim=c(0,250),yaxt="n",bty="]")
abline(h=1, lty=2)
points(86:161,apply(abs(RE_ssb_N1000_NoIndex_ckmrmultinom20),c(1,3),median)[3,]/apply(abs(RE_ssb_N1000_NoIndex_20yrs_noCKMR),c(1,3),median)[3,], pch=16, col=2)
points(171:246,apply(abs(RE_ssb_N5000_NoIndex_ckmrmultinom20),c(1,3),median)[3,]/apply(abs(RE_ssb_N5000_NoIndex_20yrs_noCKMR),c(1,3),median)[3,], pch=16, col=3)
axis(side=1, at=c(40,127,211), labels=c("N100", "N1000", "N5000"))
plot(1:76,apply(abs(RE_ssb_N100_Ind50_ckmrmultinom5),c(1,3),median)[3,]/apply(abs(RE_ssb_N100_Ind50_5yrs_noCKMR),c(1,3),median)[3,], pch=16, las=1, ylim=c(0,1.4), ylab="", xlab="", main="",xaxt="n", xlim=c(0,250),yaxt="n",bty="[")
abline(h=1, lty=2)
points(86:161,apply(abs(RE_ssb_N1000_Ind50_ckmrmultinom5),c(1,3),median)[3,]/apply(abs(RE_ssb_N1000_Ind50_5yrs_noCKMR),c(1,3),median)[3,], pch=16, col=2)
points(171:246,apply(abs(RE_ssb_N5000_Ind50_ckmrmultinom5),c(1,3),median)[3,]/apply(abs(RE_ssb_N5000_Ind50_5yrs_noCKMR),c(1,3),median)[3,], pch=16, col=3)
axis(side=1, at=c(40,127,211), labels=c("N100", "N1000", "N5000"))
plot(1:76,apply(abs(RE_ssb_N100_Ind50_ckmrmultinom10),c(1,3),median)[3,]/apply(abs(RE_ssb_N100_Ind50_10yrs_noCKMR),c(1,3),median)[3,], pch=16, col=1,las=1, ylim=c(0,1.4), ylab="", xlab="", main="",xaxt="n",  xlim=c(0,250),yaxt="n",bty="n")
abline(h=1, lty=2)
points(86:161,apply(abs(RE_ssb_N1000_Ind50_ckmrmultinom10),c(1,3),median)[3,]/apply(abs(RE_ssb_N1000_Ind50_10yrs_noCKMR),c(1,3),median)[3,], pch=16, col=2)
points(171:246,apply(abs(RE_ssb_N5000_Ind50_ckmrmultinom10),c(1,3),median)[3,]/apply(abs(RE_ssb_N5000_Ind50_10yrs_noCKMR),c(1,3),median)[3,], pch=16, col=3)
axis(side=1, at=c(40,127,211), labels=c("N100", "N1000", "N5000"))
mtext(side=1, text="Sardine", line=-1, font=2)
mtext(side=1, text="Sample Size", line=3)
axis(side=1,lwd.ticks = 0, labels=FALSE)
axis(side=3,lwd.ticks = 0, labels=FALSE)
plot(1:76,apply(abs(RE_ssb_N100_Ind50_ckmrmultinom20),c(1,3),median)[3,]/apply(abs(RE_ssb_N100_Ind50_20yrs_noCKMR),c(1,3),median)[3,], pch=16, col=1,las=1, ylim=c(0,1.4), ylab="", xlab="", main="",xaxt="n",  xlim=c(0,250),yaxt="n",bty="]")
abline(h=1, lty=2)
points(86:161,apply(abs(RE_ssb_N1000_Ind50_ckmrmultinom20),c(1,3),median)[3,]/apply(abs(RE_ssb_N1000_Ind50_20yrs_noCKMR),c(1,3),median)[3,], pch=16, col=2)
points(171:246,apply(abs(RE_ssb_N5000_Ind50_ckmrmultinom20),c(1,3),median)[3,]/apply(abs(RE_ssb_N5000_Ind50_20yrs_noCKMR),c(1,3),median)[3,], pch=16, col=3)
axis(side=1, at=c(40,127,211), labels=c("N100", "N1000", "N5000"))
plot(1:76,apply(abs(RE_ssb_N100_Ind25_ckmrmultinom5),c(1,3),median)[3,]/apply(abs(RE_ssb_N100_Ind25_5yrs_noCKMR),c(1,3),median)[3,], pch=16, las=1, ylim=c(0,1.4), ylab="", xlab="", main="",xaxt="n", xlim=c(0,250),yaxt="n",bty="[")
abline(h=1, lty=2)
points(86:161,apply(abs(RE_ssb_N1000_Ind25_ckmrmultinom5),c(1,3),median)[3,]/apply(abs(RE_ssb_N1000_Ind25_5yrs_noCKMR),c(1,3),median)[3,], pch=16, col=2)
points(171:246,apply(abs(RE_ssb_N5000_Ind25_ckmrmultinom5),c(1,3),median)[3,]/apply(abs(RE_ssb_N5000_Ind25_5yrs_noCKMR),c(1,3),median)[3,], pch=16, col=3)
axis(side=1, at=c(40,127,211), labels=c("N100", "N1000", "N5000"))
plot(1:76,apply(abs(RE_ssb_N100_Ind25_ckmrmultinom10),c(1,3),median)[3,]/apply(abs(RE_ssb_N100_Ind25_10yrs_noCKMR),c(1,3),median)[3,], pch=16, col=1,las=1, ylim=c(0,1.4), ylab="", xlab="", main="",xaxt="n",  xlim=c(0,250),yaxt="n",bty="n")
abline(h=1, lty=2)
points(86:161,apply(abs(RE_ssb_N1000_Ind25_ckmrmultinom10),c(1,3),median)[3,]/apply(abs(RE_ssb_N1000_Ind25_10yrs_noCKMR),c(1,3),median)[3,], pch=16, col=2)
points(171:246,apply(abs(RE_ssb_N5000_Ind25_ckmrmultinom10),c(1,3),median)[3,]/apply(abs(RE_ssb_N5000_Ind25_10yrs_noCKMR),c(1,3),median)[3,], pch=16, col=3)
axis(side=1, at=c(40,127,211), labels=c("N100", "N1000", "N5000"))
axis(side=1,lwd.ticks = 0, labels=FALSE)
axis(side=3,lwd.ticks = 0, labels=FALSE)
plot(1:76,apply(abs(RE_ssb_N100_Ind25_ckmrmultinom20),c(1,3),median)[3,]/apply(abs(RE_ssb_N100_Ind25_20yrs_noCKMR),c(1,3),median)[3,], pch=16, col=1,las=1, ylim=c(0,1.4), ylab="", xlab="", main="",xaxt="n",  xlim=c(0,250),yaxt="n",bty="]")
abline(h=1, lty=2)
points(86:161,apply(abs(RE_ssb_N1000_Ind25_ckmrmultinom20),c(1,3),median)[3,]/apply(abs(RE_ssb_N1000_Ind25_20yrs_noCKMR),c(1,3),median)[3,], pch=16, col=2)
points(171:246,apply(abs(RE_ssb_N5000_Ind25_ckmrmultinom20),c(1,3),median)[3,]/apply(abs(RE_ssb_N5000_Ind25_20yrs_noCKMR),c(1,3),median)[3,], pch=16, col=3)
axis(side=1, at=c(40,127,211), labels=c("N100", "N1000", "N5000"))
#dev.off()
