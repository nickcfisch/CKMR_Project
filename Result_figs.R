
####################################################
#Looking at Kinship results
####################################################

#wd<-"C:/Users/fischn/Documents/GitHub/CKMR_Project/"

#Ncomp 100, sdindex 0.25, ckmr 5 years
load(paste0(wd,"/Cod_wdat_N100_Ind25_ckmrmultinom5_1.RData"))
load(paste0(wd,"/Flatfish_wdat_N100_Ind25_ckmrmultinom5_1.RData"))
load(paste0(wd,"/Sardine_wdat_N100_Ind25_ckmrmultinom5_1.RData"))

Cod_100_25_5<-Cod_wdat
Flatfish_100_25_5<-Flatfish_wdat
Sardine_100_25_5<-Sardine_wdat

#Ncomp 1000, sdindex 0.25, ckmr 5 years
load(paste0(wd,"/Cod_wdat_N1000_Ind25_ckmrmultinom5_1.RData"))
load(paste0(wd,"/Flatfish_wdat_N1000_Ind25_ckmrmultinom5_1.RData"))
load(paste0(wd,"/Sardine_wdat_N1000_Ind25_ckmrmultinom5_1.RData"))

Cod_1000_25_5<-Cod_wdat
Flatfish_1000_25_5<-Flatfish_wdat
Sardine_1000_25_5<-Sardine_wdat

#Ncomp 5000, sdindex 0.25, ckmr 5 years
load(paste0(wd,"/Cod_wdat_N5000_Ind25_ckmrmultinom5_1.RData"))
load(paste0(wd,"/Flatfish_wdat_N5000_Ind25_ckmrmultinom5_1.RData"))
load(paste0(wd,"/Sardine_wdat_N5000_Ind25_ckmrmultinom5_1.RData"))

Cod_5000_25_5<-Cod_wdat
Flatfish_5000_25_5<-Flatfish_wdat
Sardine_5000_25_5<-Sardine_wdat

#Ncomp 100, sdindex 0.25, ckmr 10 years
load(paste0(wd,"/Cod_wdat_N100_Ind25_ckmrmultinom10_1.RData"))
load(paste0(wd,"/Flatfish_wdat_N100_Ind25_ckmrmultinom10_1.RData"))
load(paste0(wd,"/Sardine_wdat_N100_Ind25_ckmrmultinom10_1.RData"))

Cod_100_25_10<-Cod_wdat
Flatfish_100_25_10<-Flatfish_wdat
Sardine_100_25_10<-Sardine_wdat

#Ncomp 1000, sdindex 0.25, ckmr 10 years
load(paste0(wd,"/Cod_wdat_N1000_Ind25_ckmrmultinom10_1.RData"))
load(paste0(wd,"/Flatfish_wdat_N1000_Ind25_ckmrmultinom10_1.RData"))
load(paste0(wd,"/Sardine_wdat_N1000_Ind25_ckmrmultinom10_1.RData"))

Cod_1000_25_10<-Cod_wdat
Flatfish_1000_25_10<-Flatfish_wdat
Sardine_1000_25_10<-Sardine_wdat

#Ncomp 5000, sdindex 0.25, ckmr 10 years
load(paste0(wd,"/Cod_wdat_N5000_Ind25_ckmrmultinom10_1.RData"))
load(paste0(wd,"/Flatfish_wdat_N5000_Ind25_ckmrmultinom10_1.RData"))
load(paste0(wd,"/Sardine_wdat_N5000_Ind25_ckmrmultinom10_1.RData"))

Cod_5000_25_10<-Cod_wdat
Flatfish_5000_25_10<-Flatfish_wdat
Sardine_5000_25_10<-Sardine_wdat

#Ncomp 100, sdindex 0.25, ckmr 20 years
load(paste0(wd,"/Cod_wdat_N100_Ind25_ckmrmultinom20_1.RData"))
load(paste0(wd,"/Flatfish_wdat_N100_Ind25_ckmrmultinom20_1.RData"))
load(paste0(wd,"/Sardine_wdat_N100_Ind25_ckmrmultinom20_1.RData"))

Cod_100_25_20<-Cod_wdat
Flatfish_100_25_20<-Flatfish_wdat
Sardine_100_25_20<-Sardine_wdat

#Ncomp 1000, sdindex 0.25, ckmr 20 years
load(paste0(wd,"/Cod_wdat_N1000_Ind25_ckmrmultinom20_1.RData"))
load(paste0(wd,"/Flatfish_wdat_N1000_Ind25_ckmrmultinom20_1.RData"))
load(paste0(wd,"/Sardine_wdat_N1000_Ind25_ckmrmultinom20_1.RData"))

Cod_1000_25_20<-Cod_wdat
Flatfish_1000_25_20<-Flatfish_wdat
Sardine_1000_25_20<-Sardine_wdat

#Ncomp 5000, sdindex 0.25, ckmr 20 years
load(paste0(wd,"/Cod_wdat_N5000_Ind25_ckmrmultinom20_1.RData"))
load(paste0(wd,"/Flatfish_wdat_N5000_Ind25_ckmrmultinom20_1.RData"))
load(paste0(wd,"/Sardine_wdat_N5000_Ind25_ckmrmultinom20_1.RData"))

Cod_5000_25_20<-Cod_wdat
Flatfish_5000_25_20<-Flatfish_wdat
Sardine_5000_25_20<-Sardine_wdat

#Ncomp 100, sdindex 0.50, ckmr 5 years
load(paste0(wd,"/Cod_wdat_N100_Ind50_ckmrmultinom5_1.RData"))
load(paste0(wd,"/Flatfish_wdat_N100_Ind50_ckmrmultinom5_1.RData"))
load(paste0(wd,"/Sardine_wdat_N100_Ind50_ckmrmultinom5_1.RData"))

Cod_100_50_5<-Cod_wdat
Flatfish_100_50_5<-Flatfish_wdat
Sardine_100_50_5<-Sardine_wdat

#Ncomp 1000, sdindex 0.50, ckmr 5 years
load(paste0(wd,"/Cod_wdat_N1000_Ind50_ckmrmultinom5_1.RData"))
load(paste0(wd,"/Flatfish_wdat_N1000_Ind50_ckmrmultinom5_1.RData"))
load(paste0(wd,"/Sardine_wdat_N1000_Ind50_ckmrmultinom5_1.RData"))

Cod_1000_50_5<-Cod_wdat
Flatfish_1000_50_5<-Flatfish_wdat
Sardine_1000_50_5<-Sardine_wdat

#Ncomp 5000, sdindex 0.50, ckmr 5 years
load(paste0(wd,"/Cod_wdat_N5000_Ind50_ckmrmultinom5_1.RData"))
load(paste0(wd,"/Flatfish_wdat_N5000_Ind50_ckmrmultinom5_1.RData"))
load(paste0(wd,"/Sardine_wdat_N5000_Ind50_ckmrmultinom5_1.RData"))

Cod_5000_50_5<-Cod_wdat
Flatfish_5000_50_5<-Flatfish_wdat
Sardine_5000_50_5<-Sardine_wdat

#Ncomp 100, sdindex 0.50, ckmr 10 years
load(paste0(wd,"/Cod_wdat_N100_Ind50_ckmrmultinom10_1.RData"))
load(paste0(wd,"/Flatfish_wdat_N100_Ind50_ckmrmultinom10_1.RData"))
load(paste0(wd,"/Sardine_wdat_N100_Ind50_ckmrmultinom10_1.RData"))

Cod_100_50_10<-Cod_wdat
Flatfish_100_50_10<-Flatfish_wdat
Sardine_100_50_10<-Sardine_wdat

#Ncomp 1000, sdindex 0.50, ckmr 10 years
load(paste0(wd,"/Cod_wdat_N1000_Ind50_ckmrmultinom10_1.RData"))
load(paste0(wd,"/Flatfish_wdat_N1000_Ind50_ckmrmultinom10_1.RData"))
load(paste0(wd,"/Sardine_wdat_N1000_Ind50_ckmrmultinom10_1.RData"))

Cod_1000_50_10<-Cod_wdat
Flatfish_1000_50_10<-Flatfish_wdat
Sardine_1000_50_10<-Sardine_wdat

#Ncomp 5000, sdindex 0.50, ckmr 10 years
load(paste0(wd,"/Cod_wdat_N5000_Ind50_ckmrmultinom10_1.RData"))
load(paste0(wd,"/Flatfish_wdat_N5000_Ind50_ckmrmultinom10_1.RData"))
load(paste0(wd,"/Sardine_wdat_N5000_Ind50_ckmrmultinom10_1.RData"))

Cod_5000_50_10<-Cod_wdat
Flatfish_5000_50_10<-Flatfish_wdat
Sardine_5000_50_10<-Sardine_wdat

#Ncomp 100, sdindex 0.50, ckmr 20 years
load(paste0(wd,"/Cod_wdat_N100_Ind50_ckmrmultinom20_1.RData"))
load(paste0(wd,"/Flatfish_wdat_N100_Ind50_ckmrmultinom20_1.RData"))
load(paste0(wd,"/Sardine_wdat_N100_Ind50_ckmrmultinom20_1.RData"))

Cod_100_50_20<-Cod_wdat
Flatfish_100_50_20<-Flatfish_wdat
Sardine_100_50_20<-Sardine_wdat

#Ncomp 1000, sdindex 0.50, ckmr 20 years
load(paste0(wd,"/Cod_wdat_N1000_Ind50_ckmrmultinom20_1.RData"))
load(paste0(wd,"/Flatfish_wdat_N1000_Ind50_ckmrmultinom20_1.RData"))
load(paste0(wd,"/Sardine_wdat_N1000_Ind50_ckmrmultinom20_1.RData"))

Cod_1000_50_20<-Cod_wdat
Flatfish_1000_50_20<-Flatfish_wdat
Sardine_1000_50_20<-Sardine_wdat

#Ncomp 5000, sdindex 0.50, ckmr 20 years
load(paste0(wd,"/Cod_wdat_N5000_Ind50_ckmrmultinom20_1.RData"))
load(paste0(wd,"/Flatfish_wdat_N5000_Ind50_ckmrmultinom20_1.RData"))
load(paste0(wd,"/Sardine_wdat_N5000_Ind50_ckmrmultinom20_1.RData"))

Cod_5000_50_20<-Cod_wdat
Flatfish_5000_50_20<-Flatfish_wdat
Sardine_5000_50_20<-Sardine_wdat

#############################################
#Looking at the number of pairs by treatment 
#############################################
#Getting it into more usable data 
Pairs_Cod_100_25_5<-Pairs_Cod_1000_25_5<-Pairs_Cod_5000_25_5<-matrix(NA, nrow=100,ncol=2)
Pairs_Cod_100_25_10<-Pairs_Cod_1000_25_10<-Pairs_Cod_5000_25_10<-matrix(NA, nrow=100,ncol=2)
Pairs_Cod_100_25_20<-Pairs_Cod_1000_25_20<-Pairs_Cod_5000_25_20<-matrix(NA, nrow=100,ncol=2)
Pairs_Flatfish_100_25_5<-Pairs_Flatfish_1000_25_5<-Pairs_Flatfish_5000_25_5<-matrix(NA, nrow=100,ncol=2)
Pairs_Flatfish_100_25_10<-Pairs_Flatfish_1000_25_10<-Pairs_Flatfish_5000_25_10<-matrix(NA, nrow=100,ncol=2)
Pairs_Flatfish_100_25_20<-Pairs_Flatfish_1000_25_20<-Pairs_Flatfish_5000_25_20<-matrix(NA, nrow=100,ncol=2)
Pairs_Sardine_100_25_5<-Pairs_Sardine_1000_25_5<-Pairs_Sardine_5000_25_5<-matrix(NA, nrow=100,ncol=2)
Pairs_Sardine_100_25_10<-Pairs_Sardine_1000_25_10<-Pairs_Sardine_5000_25_10<-matrix(NA, nrow=100,ncol=2)
Pairs_Sardine_100_25_20<-Pairs_Sardine_1000_25_20<-Pairs_Sardine_5000_25_20<-matrix(NA, nrow=100,ncol=2)
for (i in 1:100){
 Pairs_Cod_100_25_5[i,1]<-(sum(Cod_100_25_5[[i]]$k_ckmr_pop))
 Pairs_Cod_100_25_5[i,2]<-(sum(Cod_100_25_5[[i]]$k_ckmr_hsporggp))
 Pairs_Cod_1000_25_5[i,1]<-(sum(Cod_1000_25_5[[i]]$k_ckmr_pop))
 Pairs_Cod_1000_25_5[i,2]<-(sum(Cod_1000_25_5[[i]]$k_ckmr_hsporggp))
 Pairs_Cod_5000_25_5[i,1]<-(sum(Cod_5000_25_5[[i]]$k_ckmr_pop))
 Pairs_Cod_5000_25_5[i,2]<-(sum(Cod_5000_25_5[[i]]$k_ckmr_hsporggp))

 Pairs_Cod_100_25_10[i,1]<-(sum(Cod_100_25_10[[i]]$k_ckmr_pop))
 Pairs_Cod_100_25_10[i,2]<-(sum(Cod_100_25_10[[i]]$k_ckmr_hsporggp))
 Pairs_Cod_1000_25_10[i,1]<-(sum(Cod_1000_25_10[[i]]$k_ckmr_pop))
 Pairs_Cod_1000_25_10[i,2]<-(sum(Cod_1000_25_10[[i]]$k_ckmr_hsporggp))
 Pairs_Cod_5000_25_10[i,1]<-(sum(Cod_5000_25_10[[i]]$k_ckmr_pop))
 Pairs_Cod_5000_25_10[i,2]<-(sum(Cod_5000_25_10[[i]]$k_ckmr_hsporggp))

 Pairs_Cod_100_25_20[i,1]<-(sum(Cod_100_25_20[[i]]$k_ckmr_pop))
 Pairs_Cod_100_25_20[i,2]<-(sum(Cod_100_25_20[[i]]$k_ckmr_hsporggp))
 Pairs_Cod_1000_25_20[i,1]<-(sum(Cod_1000_25_20[[i]]$k_ckmr_pop))
 Pairs_Cod_1000_25_20[i,2]<-(sum(Cod_1000_25_20[[i]]$k_ckmr_hsporggp))
 Pairs_Cod_5000_25_20[i,1]<-(sum(Cod_5000_25_20[[i]]$k_ckmr_pop))
 Pairs_Cod_5000_25_20[i,2]<-(sum(Cod_5000_25_20[[i]]$k_ckmr_hsporggp))

 Pairs_Flatfish_100_25_5[i,1]<-(sum(Flatfish_100_25_5[[i]]$k_ckmr_pop))
 Pairs_Flatfish_100_25_5[i,2]<-(sum(Flatfish_100_25_5[[i]]$k_ckmr_hsporggp))
 Pairs_Flatfish_1000_25_5[i,1]<-(sum(Flatfish_1000_25_5[[i]]$k_ckmr_pop))
 Pairs_Flatfish_1000_25_5[i,2]<-(sum(Flatfish_1000_25_5[[i]]$k_ckmr_hsporggp))
 Pairs_Flatfish_5000_25_5[i,1]<-(sum(Flatfish_5000_25_5[[i]]$k_ckmr_pop))
 Pairs_Flatfish_5000_25_5[i,2]<-(sum(Flatfish_5000_25_5[[i]]$k_ckmr_hsporggp))

 Pairs_Flatfish_100_25_10[i,1]<-(sum(Flatfish_100_25_10[[i]]$k_ckmr_pop))
 Pairs_Flatfish_100_25_10[i,2]<-(sum(Flatfish_100_25_10[[i]]$k_ckmr_hsporggp))
 Pairs_Flatfish_1000_25_10[i,1]<-(sum(Flatfish_1000_25_10[[i]]$k_ckmr_pop))
 Pairs_Flatfish_1000_25_10[i,2]<-(sum(Flatfish_1000_25_10[[i]]$k_ckmr_hsporggp))
 Pairs_Flatfish_5000_25_10[i,1]<-(sum(Flatfish_5000_25_10[[i]]$k_ckmr_pop))
 Pairs_Flatfish_5000_25_10[i,2]<-(sum(Flatfish_5000_25_10[[i]]$k_ckmr_hsporggp))

 Pairs_Flatfish_100_25_20[i,1]<-(sum(Flatfish_100_25_20[[i]]$k_ckmr_pop))
 Pairs_Flatfish_100_25_20[i,2]<-(sum(Flatfish_100_25_20[[i]]$k_ckmr_hsporggp))
 Pairs_Flatfish_1000_25_20[i,1]<-(sum(Flatfish_1000_25_20[[i]]$k_ckmr_pop))
 Pairs_Flatfish_1000_25_20[i,2]<-(sum(Flatfish_1000_25_20[[i]]$k_ckmr_hsporggp))
 Pairs_Flatfish_5000_25_20[i,1]<-(sum(Flatfish_5000_25_20[[i]]$k_ckmr_pop))
 Pairs_Flatfish_5000_25_20[i,2]<-(sum(Flatfish_5000_25_20[[i]]$k_ckmr_hsporggp))

 Pairs_Sardine_100_25_5[i,1]<-(sum(Sardine_100_25_5[[i]]$k_ckmr_pop))
 Pairs_Sardine_100_25_5[i,2]<-(sum(Sardine_100_25_5[[i]]$k_ckmr_hsporggp))
 Pairs_Sardine_1000_25_5[i,1]<-(sum(Sardine_1000_25_5[[i]]$k_ckmr_pop))
 Pairs_Sardine_1000_25_5[i,2]<-(sum(Sardine_1000_25_5[[i]]$k_ckmr_hsporggp))
 Pairs_Sardine_5000_25_5[i,1]<-(sum(Sardine_5000_25_5[[i]]$k_ckmr_pop))
 Pairs_Sardine_5000_25_5[i,2]<-(sum(Sardine_5000_25_5[[i]]$k_ckmr_hsporggp))

 Pairs_Sardine_100_25_10[i,1]<-(sum(Sardine_100_25_10[[i]]$k_ckmr_pop))
 Pairs_Sardine_100_25_10[i,2]<-(sum(Sardine_100_25_10[[i]]$k_ckmr_hsporggp))
 Pairs_Sardine_1000_25_10[i,1]<-(sum(Sardine_1000_25_10[[i]]$k_ckmr_pop))
 Pairs_Sardine_1000_25_10[i,2]<-(sum(Sardine_1000_25_10[[i]]$k_ckmr_hsporggp))
 Pairs_Sardine_5000_25_10[i,1]<-(sum(Sardine_5000_25_10[[i]]$k_ckmr_pop))
 Pairs_Sardine_5000_25_10[i,2]<-(sum(Sardine_5000_25_10[[i]]$k_ckmr_hsporggp))

 Pairs_Sardine_100_25_20[i,1]<-(sum(Sardine_100_25_20[[i]]$k_ckmr_pop))
 Pairs_Sardine_100_25_20[i,2]<-(sum(Sardine_100_25_20[[i]]$k_ckmr_hsporggp))
 Pairs_Sardine_1000_25_20[i,1]<-(sum(Sardine_1000_25_20[[i]]$k_ckmr_pop))
 Pairs_Sardine_1000_25_20[i,2]<-(sum(Sardine_1000_25_20[[i]]$k_ckmr_hsporggp))
 Pairs_Sardine_5000_25_20[i,1]<-(sum(Sardine_5000_25_20[[i]]$k_ckmr_pop))
 Pairs_Sardine_5000_25_20[i,2]<-(sum(Sardine_5000_25_20[[i]]$k_ckmr_hsporggp))
}

#Trying boxplot as reviewer suggested 
#tiff(paste0(wd,"/CKMRPairs.tiff"), height=20, width=30, units='cm', compression="lzw", res=500)
par(mfrow=c(3,1), oma=c(2,2,1,1), mar=c(3.5,4,1,1))
boxplot(Pairs_Cod_100_25_5, at=1:2, ylim=c(0,80), las=1, xlab="", main="Cod", xlim=c(1,26), xaxt="n", col=c("rosybrown1", "skyblue"))
boxplot(Pairs_Cod_100_25_10, at=4:5, ylim=c(0,80), las=1, xlab="", main="", xlim=c(1,26), xaxt="n",yaxt="n", col=c("rosybrown1", "skyblue"), add=TRUE)
boxplot(Pairs_Cod_100_25_20, at=7:8, ylim=c(0,80), las=1, xlab="", main="", xlim=c(1,26), xaxt="n",yaxt="n", col=c("rosybrown1", "skyblue"), add=TRUE)
boxplot(Pairs_Cod_1000_25_5, at=10:11, ylim=c(0,80), las=1, xlab="", main="", xlim=c(1,26), xaxt="n",yaxt="n", col=c("rosybrown1", "skyblue"), add=TRUE)
boxplot(Pairs_Cod_1000_25_10, at=13:14, ylim=c(0,80), las=1, xlab="", main="", xlim=c(1,26), xaxt="n",yaxt="n", col=c("rosybrown1", "skyblue"), add=TRUE)
boxplot(Pairs_Cod_1000_25_20, at=16:17, ylim=c(0,80), las=1, xlab="", main="", xlim=c(1,26), xaxt="n",yaxt="n", col=c("rosybrown1", "skyblue"), add=TRUE)
boxplot(Pairs_Cod_5000_25_5, at=19:20, ylim=c(0,80), las=1, xlab="", main="", xlim=c(1,26), xaxt="n",yaxt="n", col=c("rosybrown1", "skyblue"), add=TRUE)
boxplot(Pairs_Cod_5000_25_10, at=22:23, ylim=c(0,80), las=1, xlab="", main="", xlim=c(1,26), xaxt="n",yaxt="n", col=c("rosybrown1", "skyblue"), add=TRUE)
boxplot(Pairs_Cod_5000_25_20, at=25:26, ylim=c(0,80), las=1, xlab="", main="", xlim=c(1,26), xaxt="n",yaxt="n", col=c("rosybrown1", "skyblue"), add=TRUE)
abline(v=c(9,18))
mtext(side=3,"100 CKMR Samples",line=-3, at=4.5)
mtext(side=3,"1,000 CKMR Samples",line=-3)
mtext(side=3,"5,000 CKMR Samples",line=-3, at=22.5)
axis(side=1, at=seq(1.5,25.5,3), c("5yrs","10yrs","20yrs","5yrs","10yrs","20yrs","5yrs","10yrs","20yrs"))

boxplot(Pairs_Flatfish_100_25_5, at=1:2, ylim=c(0,2.5e5), las=1, xlab="", main="Flatfish", xlim=c(1,26), xaxt="n", col=c("rosybrown1", "skyblue"))
boxplot(Pairs_Flatfish_100_25_10, at=4:5, ylim=c(0,2.5e5), las=1, xlab="", main="", xlim=c(1,26), xaxt="n",yaxt="n", col=c("rosybrown1", "skyblue"), add=TRUE)
boxplot(Pairs_Flatfish_100_25_20, at=7:8, ylim=c(0,2.5e5), las=1, xlab="", main="", xlim=c(1,26), xaxt="n",yaxt="n", col=c("rosybrown1", "skyblue"), add=TRUE)
boxplot(Pairs_Flatfish_1000_25_5, at=10:11, ylim=c(0,2.5e5), las=1, xlab="", main="", xlim=c(1,26), xaxt="n",yaxt="n", col=c("rosybrown1", "skyblue"), add=TRUE)
boxplot(Pairs_Flatfish_1000_25_10, at=13:14, ylim=c(0,2.5e5), las=1, xlab="", main="", xlim=c(1,26), xaxt="n",yaxt="n", col=c("rosybrown1", "skyblue"), add=TRUE)
boxplot(Pairs_Flatfish_1000_25_20, at=16:17, ylim=c(0,2.5e5), las=1, xlab="", main="", xlim=c(1,26), xaxt="n",yaxt="n", col=c("rosybrown1", "skyblue"), add=TRUE)
boxplot(Pairs_Flatfish_5000_25_5, at=19:20, ylim=c(0,2.5e5), las=1, xlab="", main="", xlim=c(1,26), xaxt="n",yaxt="n", col=c("rosybrown1", "skyblue"), add=TRUE)
boxplot(Pairs_Flatfish_5000_25_10, at=22:23, ylim=c(0,2.5e5), las=1, xlab="", main="", xlim=c(1,26), xaxt="n",yaxt="n", col=c("rosybrown1", "skyblue"), add=TRUE)
boxplot(Pairs_Flatfish_5000_25_20, at=25:26, ylim=c(0,2.5e5), las=1, xlab="", main="", xlim=c(1,26), xaxt="n",yaxt="n", col=c("rosybrown1", "skyblue"), add=TRUE)
abline(v=c(9,18))
axis(side=1, at=seq(1.5,25.5,3), c("5yrs","10yrs","20yrs","5yrs","10yrs","20yrs","5yrs","10yrs","20yrs"))
mtext(side=2,"Pairs Found",line=4)
legend("top", c("POP", "HSP+GGP"),pch=15, col=c("rosybrown1", "skyblue"), bty="n", pt.cex=1.2)

boxplot(Pairs_Sardine_100_25_5, at=1:2, ylim=c(0,2.05e3), las=1, xlab="", main="Sardine", xlim=c(1,26), col=c("rosybrown1", "skyblue"), xaxt="n")
boxplot(Pairs_Sardine_100_25_10, at=4:5, ylim=c(0,2.05e3), las=1, xlab="", main="", xlim=c(1,26), xaxt="n",yaxt="n", col=c("rosybrown1", "skyblue"), add=TRUE)
boxplot(Pairs_Sardine_100_25_20, at=7:8, ylim=c(0,2.05e3), las=1, xlab="", main="", xlim=c(1,26), xaxt="n",yaxt="n", col=c("rosybrown1", "skyblue"), add=TRUE)
boxplot(Pairs_Sardine_1000_25_5, at=10:11, ylim=c(0,2.05e3), las=1, xlab="", main="", xlim=c(1,26), xaxt="n",yaxt="n", col=c("rosybrown1", "skyblue"), add=TRUE)
boxplot(Pairs_Sardine_1000_25_10, at=13:14, ylim=c(0,2.05e3), las=1, xlab="", main="", xlim=c(1,26), xaxt="n",yaxt="n", col=c("rosybrown1", "skyblue"), add=TRUE)
boxplot(Pairs_Sardine_1000_25_20, at=16:17, ylim=c(0,2.05e3), las=1, xlab="", main="", xlim=c(1,26), xaxt="n",yaxt="n", col=c("rosybrown1", "skyblue"), add=TRUE)
boxplot(Pairs_Sardine_5000_25_5, at=19:20, ylim=c(0,2.05e3), las=1, xlab="", main="", xlim=c(1,26), xaxt="n",yaxt="n", col=c("rosybrown1", "skyblue"), add=TRUE)
boxplot(Pairs_Sardine_5000_25_10, at=22:23, ylim=c(0,2.05e3), las=1, xlab="", main="", xlim=c(1,26), xaxt="n",yaxt="n", col=c("rosybrown1", "skyblue"), add=TRUE)
boxplot(Pairs_Sardine_5000_25_20, at=25:26, ylim=c(0,2.05e3), las=1, xlab="", main="", xlim=c(1,26), xaxt="n",yaxt="n", col=c("rosybrown1", "skyblue"), add=TRUE)
abline(v=c(9,18))
axis(side=1, at=seq(1.5,25.5,3), c("5yrs","10yrs","20yrs","5yrs","10yrs","20yrs","5yrs","10yrs","20yrs"))
mtext(side=1,"Number of Years of CKMR Collection",line=3.5)
#dev.off()

#N100
#tiff(paste0(wd,"/CKMRPairs_N100.tiff"), height=20, width=30, units='cm', compression="lzw", res=500)
par(mfrow=c(3,6), oma=c(2,2,1,1), mar=c(4,4,2.5,1))
hist(Pairs_Cod_100_25_5[,1], breaks=seq(-0.5,1e6,1), xlim=c(-0.5,5), las=1, xlab="", main="")
mtext(text="5yr", side=2, line=4.5, font=2)
mtext(text="POP", side=3, line=-2,font=2)
hist(Pairs_Cod_100_25_5[,2], breaks=seq(-0.5,1e6,1), xlim=c(-0.5,5), las=1, xlab="", main="", ylab="")
mtext(text="Cod", side=3, line=2, at=-4, font=2)
mtext(text="HSP+GGP", side=3, line=-2,font=2)

hist(Pairs_Flatfish_100_25_5[,1], breaks=seq(-0.5,1e6,10), xlim=c(-0.5,200), las=1, xlab="", main="", ylab="")
mtext(text="POP", side=3, line=-2,font=2)
hist(Pairs_Flatfish_100_25_5[,2], breaks=seq(-0.5,1e6,10), xlim=c(-0.5,200), las=1, xlab="", main="", ylab="")
mtext(text="Flatfish", side=3, line=2, at=-75, font=2)
mtext(text="HSP+GGP", side=3, line=-2,font=2)

hist(Pairs_Sardine_100_25_5[,1], breaks=seq(-0.5,1e6,1), xlim=c(-0.5,5), las=1, xlab="", main="", ylab="")
mtext(text="POP", side=3, line=-2,font=2)
hist(Pairs_Sardine_100_25_5[,2], breaks=seq(-0.5,1e6,1), xlim=c(-0.5,5), las=1, xlab="", main="", ylab="")
mtext(text="Sardine", side=3, line=2, at=-4, font=2)
mtext(text="HSP+GGP", side=3, line=-2,font=2)

hist(Pairs_Cod_100_25_10[,1], breaks=seq(-0.5,1e6,1), xlim=c(-0.5,5), las=1, xlab="", main="")
mtext(text="10yr", side=2, line=4.5, font=2)
hist(Pairs_Cod_100_25_10[,2], breaks=seq(-0.5,1e6,1), xlim=c(-0.5,5), las=1, xlab="", main="", ylab="")

hist(Pairs_Flatfish_100_25_10[,1], breaks=seq(-0.5,1e6,10), xlim=c(-0.5,200), las=1, xlab="", main="", ylab="")
hist(Pairs_Flatfish_100_25_10[,2], breaks=seq(-0.5,1e6,10), xlim=c(-0.5,200), las=1, xlab="", main="", ylab="")

hist(Pairs_Sardine_100_25_10[,1], breaks=seq(-0.5,1e6,1), xlim=c(-0.5,5), las=1, xlab="", main="", ylab="")
hist(Pairs_Sardine_100_25_10[,2], breaks=seq(-0.5,1e6,1), xlim=c(-0.5,5), las=1, xlab="", main="", ylab="")

hist(Pairs_Cod_100_25_20[,1], breaks=seq(-0.5,1e6,1), xlim=c(-0.5,5), las=1, xlab="Parent-Offspring Pairs", main="")
mtext(text="20yr", side=2, line=4.5, font=2)
hist(Pairs_Cod_100_25_20[,2], breaks=seq(-0.5,1e6,1), xlim=c(-0.5,5), las=1, xlab="Half-Sibling Pairs", main="", ylab="")

hist(Pairs_Flatfish_100_25_20[,1], breaks=seq(-0.5,1e6,10), xlim=c(-0.5,200), las=1, xlab="Parent-Offspring Pairs", main="", ylab="")
hist(Pairs_Flatfish_100_25_20[,2], breaks=seq(-0.5,1e6,10), xlim=c(-0.5,200), las=1, xlab="Half-Sibling Pairs", main="", ylab="")

hist(Pairs_Sardine_100_25_20[,1], breaks=seq(-0.5,1e6,1), xlim=c(-0.5,5), las=1, xlab="Parent-Offspring Pairs", main="", ylab="")
hist(Pairs_Sardine_100_25_20[,2], breaks=seq(-0.5,1e6,1), xlim=c(-0.5,5), las=1, xlab="Half-Sibling Pairs", main="", ylab="")
#dev.off()

#N1000
#tiff(paste0(wd,"/CKMRPairs_N1000.tiff"), height=20, width=30, units='cm', compression="lzw", res=500)
par(mfrow=c(3,6), oma=c(2,2,1,1), mar=c(4,4,2.5,1))
hist(Pairs_Cod_1000_25_5[,1], breaks=seq(-0.5,1e6,1), xlim=c(-0.5,10), las=1, xlab="", main="")
mtext(text="5yr", side=2, line=4.5, font=2)
mtext(text="POP", side=3, line=-2,font=2)
hist(Pairs_Cod_1000_25_5[,2], breaks=seq(-0.5,1e6,1), xlim=c(-0.5,10), las=1, xlab="", main="", ylab="")
mtext(text="Cod", side=3, line=2, at=-4, font=2)
mtext(text="HSP+GGP", side=3, line=-2,font=2)

hist(Pairs_Flatfish_1000_25_5[,1], breaks=seq(-0.5,1e6,100), xlim=c(-0.5,15000), las=1, xlab="", main="", ylab="")
mtext(text="POP", side=3, line=-2,font=2)
hist(Pairs_Flatfish_1000_25_5[,2], breaks=seq(-0.5,1e6,100), xlim=c(-0.5,15000), las=1, xlab="", main="", ylab="")
mtext(text="Flatfish", side=3, line=2, at=-2500, font=2)
mtext(text="HSP+GGP", side=3, line=-2,font=2)

hist(Pairs_Sardine_1000_25_5[,1], breaks=seq(-0.5,1e6,1), xlim=c(-0.5,100), las=1, xlab="", main="", ylab="")
mtext(text="POP", side=3, line=-2,font=2)
hist(Pairs_Sardine_1000_25_5[,2], breaks=seq(-0.5,1e6,1), xlim=c(-0.5,100), las=1, xlab="", main="", ylab="")
mtext(text="Sardine", side=3, line=2, at=-25, font=2)
mtext(text="HSP+GGP", side=3, line=-2,font=2)

hist(Pairs_Cod_1000_25_10[,1], breaks=seq(-0.5,1e6,1), xlim=c(-0.5,10), las=1, xlab="", main="")
mtext(text="10yr", side=2, line=4.5, font=2)
hist(Pairs_Cod_1000_25_10[,2], breaks=seq(-0.5,1e6,1), xlim=c(-0.5,10), las=1, xlab="", main="", ylab="")

hist(Pairs_Flatfish_1000_25_10[,1], breaks=seq(-0.5,1e6,100), xlim=c(-0.5,15000), las=1, xlab="", main="", ylab="")
hist(Pairs_Flatfish_1000_25_10[,2], breaks=seq(-0.5,1e6,100), xlim=c(-0.5,15000), las=1, xlab="", main="", ylab="")

hist(Pairs_Sardine_1000_25_10[,1], breaks=seq(-0.5,1e6,1), xlim=c(-0.5,100), las=1, xlab="", main="", ylab="")
hist(Pairs_Sardine_1000_25_10[,2], breaks=seq(-0.5,1e6,1), xlim=c(-0.5,100), las=1, xlab="", main="", ylab="")

hist(Pairs_Cod_1000_25_20[,1], breaks=seq(-0.5,1e6,1), xlim=c(-0.5,10), las=1, xlab="Parent-Offspring Pairs", main="")
mtext(text="20yr", side=2, line=4.5, font=2)
hist(Pairs_Cod_1000_25_20[,2], breaks=seq(-0.5,1e6,1), xlim=c(-0.5,10), las=1, xlab="Half-Sibling Pairs", main="", ylab="")

hist(Pairs_Flatfish_1000_25_20[,1], breaks=seq(-0.5,1e6,100), xlim=c(-0.5,15000), las=1, xlab="Parent-Offspring Pairs", main="", ylab="")
hist(Pairs_Flatfish_1000_25_20[,2], breaks=seq(-0.5,1e6,100), xlim=c(-0.5,15000), las=1, xlab="Half-Sibling Pairs", main="", ylab="")

hist(Pairs_Sardine_1000_25_20[,1], breaks=seq(-0.5,1e6,1), xlim=c(-0.5,100), las=1, xlab="Parent-Offspring Pairs", main="", ylab="")
hist(Pairs_Sardine_1000_25_20[,2], breaks=seq(-0.5,1e6,1), xlim=c(-0.5,100), las=1, xlab="Half-Sibling Pairs", main="", ylab="")
#dev.off()

#N5000
#tiff(paste0(wd,"/CKMRPairs_N5000.tiff"), height=20, width=30, units='cm', compression="lzw", res=500)
par(mfrow=c(3,6), oma=c(2,2,1,1), mar=c(4,4,2.5,1))
hist(Pairs_Cod_5000_25_5[,1], breaks=seq(-0.5,1e6,1), xlim=c(-0.5,120), las=1, xlab="", main="")
mtext(text="5yr", side=2, line=4.5, font=2)
mtext(text="POP", side=3, line=-2,font=2)
hist(Pairs_Cod_5000_25_5[,2], breaks=seq(-0.5,1e6,1), xlim=c(-0.5,120), las=1, xlab="", main="", ylab="")
mtext(text="Cod", side=3, line=2, at=-30, font=2)
mtext(text="HSP+GGP", side=3, line=-2,font=2)

hist(Pairs_Flatfish_5000_25_5[,1], breaks=seq(-0.5,1e6,2e3), xlim=c(-0.5,3e5), las=1, xlab="", main="", ylab="")
mtext(text="POP", side=3, line=-2,font=2)
hist(Pairs_Flatfish_5000_25_5[,2], breaks=seq(-0.5,1e6,2e3), xlim=c(-0.5,3e5), las=1, xlab="", main="", ylab="")
mtext(text="Flatfish", side=3, line=2, at=-50000, font=2)
mtext(text="HSP+GGP", side=3, line=-2,font=2)

hist(Pairs_Sardine_5000_25_5[,1], breaks=seq(-0.5,1e6,50), xlim=c(-0.5,2500), las=1, xlab="", main="", ylab="")
mtext(text="POP", side=3, line=-2,font=2)
hist(Pairs_Sardine_5000_25_5[,2], breaks=seq(-0.5,1e6,50), xlim=c(-0.5,2500), las=1, xlab="", main="", ylab="")
mtext(text="Sardine", side=3, line=2, at=-600, font=2)
mtext(text="HSP+GGP", side=3, line=-2,font=2)

hist(Pairs_Cod_5000_25_10[,1], breaks=seq(-0.5,1e6,1), xlim=c(-0.5,120), las=1, xlab="", main="")
mtext(text="10yr", side=2, line=4.5, font=2)
hist(Pairs_Cod_5000_25_10[,2], breaks=seq(-0.5,1e6,1), xlim=c(-0.5,120), las=1, xlab="", main="", ylab="")

hist(Pairs_Flatfish_5000_25_10[,1], breaks=seq(-0.5,1e6,2e3), xlim=c(-0.5,3e5), las=1, xlab="", main="", ylab="")
hist(Pairs_Flatfish_5000_25_10[,2], breaks=seq(-0.5,1e6,2e3), xlim=c(-0.5,3e5), las=1, xlab="", main="", ylab="")

hist(Pairs_Sardine_5000_25_10[,1], breaks=seq(-0.5,1e6,50), xlim=c(-0.5,2500), las=1, xlab="", main="", ylab="")
hist(Pairs_Sardine_5000_25_10[,2], breaks=seq(-0.5,1e6,50), xlim=c(-0.5,2500), las=1, xlab="", main="", ylab="")

hist(Pairs_Cod_5000_25_20[,1], breaks=seq(-0.5,1e6,1), xlim=c(-0.5,120), las=1, xlab="Parent-Offspring Pairs", main="")
mtext(text="20yr", side=2, line=4.5, font=2)
hist(Pairs_Cod_5000_25_20[,2], breaks=seq(-0.5,1e6,1), xlim=c(-0.5,120), las=1, xlab="Half-Sibling Pairs", main="", ylab="")

hist(Pairs_Flatfish_5000_25_20[,1], breaks=seq(-0.5,1e6,2e3), xlim=c(-0.5,3e5), las=1, xlab="Parent-Offspring Pairs", main="", ylab="")
hist(Pairs_Flatfish_5000_25_20[,2], breaks=seq(-0.5,1e6,2e3), xlim=c(-0.5,3e5), las=1, xlab="Half-Sibling Pairs", main="", ylab="")

hist(Pairs_Sardine_5000_25_20[,1], breaks=seq(-0.5,1e6,50), xlim=c(-0.5,2500), las=1, xlab="Parent-Offspring Pairs", main="", ylab="")
hist(Pairs_Sardine_5000_25_20[,2], breaks=seq(-0.5,1e6,50), xlim=c(-0.5,2500), las=1, xlab="Half-Sibling Pairs", main="", ylab="")
#dev.off()

#Overlap histograms
#N5000
#tiff(paste0(wd,"/CKMRPairs_Overlap.tiff"), height=20, width=30, units='cm', compression="lzw", res=500)
par(mfrow=c(3,6), oma=c(2,2,1,1), mar=c(4,4,2.5,1))
hist(Pairs_Cod_5000_25_5[,1], breaks=seq(-0.5,1e6,1), xlim=c(-1,100), las=1, xlab="", main="",col=rgb(0.8,0,0,0.2))
hist(Pairs_Cod_1000_25_5[,1], breaks=seq(-0.5,1e6,1), add=TRUE, col=rgb(0,0.8,0,0.2))
hist(Pairs_Cod_100_25_5[,1], breaks=seq(-0.5,1e6,1), add=TRUE, col=rgb(0,0,0.8,0.2))
mtext(text="5yr", side=2, line=4.5, font=2)
mtext(text="POP", side=3, line=-2,font=2)
hist(Pairs_Cod_5000_25_5[,2], breaks=seq(-0.5,1e6,1), xlim=c(-1,100), las=1, xlab="", main="", ylab="",col=rgb(0.8,0,0,0.2))
hist(Pairs_Cod_1000_25_5[,2], breaks=seq(-0.5,1e6,1), add=TRUE, col=rgb(0,0.8,0,0.2))
hist(Pairs_Cod_100_25_5[,2], breaks=seq(-0.5,1e6,1), add=TRUE, col=rgb(0,0,0.8,0.2))
mtext(text="Cod", side=3, line=2, at=-30, font=2)
mtext(text="HSP", side=3, line=-2,font=2)

hist(Pairs_Flatfish_5000_25_5[,1], breaks=seq(-0.5,1e6,5e3), xlim=c(-1,2.5e5), las=1, xlab="", main="", ylab="",col=rgb(0.8,0,0,0.2))
hist(Pairs_Flatfish_1000_25_5[,1], breaks=seq(-0.5,1e6,5e3), add=TRUE, col=rgb(0,0.8,0,0.2))
hist(Pairs_Flatfish_100_25_5[,1], breaks=seq(-0.5,1e6,5e3), add=TRUE, col=rgb(0,0,0.8,0.2))
mtext(text="POP", side=3, line=-2,font=2)
hist(Pairs_Flatfish_5000_25_5[,2], breaks=seq(-0.5,1e6,5e3), xlim=c(-1,2.5e5), las=1, xlab="", main="", ylab="",col=rgb(0.8,0,0,0.2))
hist(Pairs_Flatfish_1000_25_5[,2], breaks=seq(-0.5,1e6,5e3), add=TRUE, col=rgb(0,0.8,0,0.2))
hist(Pairs_Flatfish_100_25_5[,2], breaks=seq(-0.5,1e6,5e3), add=TRUE, col=rgb(0,0,0.8,0.2))
mtext(text="Flatfish", side=3, line=2, at=-50000, font=2)
mtext(text="HSP", side=3, line=-2,font=2)

hist(Pairs_Sardine_5000_25_5[,1], breaks=seq(-0.5,1e6,50), xlim=c(-1,2200), las=1, xlab="", main="", ylab="",col=rgb(0.8,0,0,0.2))
hist(Pairs_Sardine_1000_25_5[,1], breaks=seq(-0.5,1e6,50), add=TRUE, col=rgb(0,0.8,0,0.2))
hist(Pairs_Sardine_100_25_5[,1], breaks=seq(-0.5,1e6,50), add=TRUE, col=rgb(0,0,0.8,0.2))
mtext(text="POP", side=3, line=-2,font=2)
hist(Pairs_Sardine_5000_25_5[,2], breaks=seq(-0.5,1e6,50), xlim=c(-1,2200), las=1, xlab="", main="", ylab="",col=rgb(0.8,0,0,0.2))
hist(Pairs_Sardine_1000_25_5[,2], breaks=seq(-0.5,1e6,50), add=TRUE, col=rgb(0,0.8,0,0.2))
hist(Pairs_Sardine_100_25_5[,2], breaks=seq(-0.5,1e6,50), add=TRUE, col=rgb(0,0,0.8,0.2))
mtext(text="Sardine", side=3, line=2, at=-600, font=2)
mtext(text="HSP", side=3, line=-2,font=2)

hist(Pairs_Cod_5000_25_10[,1], breaks=seq(-0.5,1e6,1), xlim=c(-1,100), las=1, xlab="", main="",col=rgb(0.8,0,0,0.2))
hist(Pairs_Cod_1000_25_10[,1], breaks=seq(-0.5,1e6,1), add=TRUE, col=rgb(0,0.8,0,0.2))
hist(Pairs_Cod_100_25_10[,1], breaks=seq(-0.5,1e6,1), add=TRUE, col=rgb(0,0,0.8,0.2))
mtext(text="10yr", side=2, line=4.5, font=2)
hist(Pairs_Cod_5000_25_10[,2], breaks=seq(-0.5,1e6,1), xlim=c(-1,100), las=1, xlab="", main="", ylab="",col=rgb(0.8,0,0,0.2))
hist(Pairs_Cod_1000_25_10[,2], breaks=seq(-0.5,1e6,1), add=TRUE, col=rgb(0,0.8,0,0.2))
hist(Pairs_Cod_100_25_10[,2], breaks=seq(-0.5,1e6,1), add=TRUE, col=rgb(0,0,0.8,0.2))

hist(Pairs_Flatfish_5000_25_10[,1], breaks=seq(-0.5,1e6,5e3), xlim=c(-1,2.5e5), las=1, xlab="", main="", ylab="",col=rgb(0.8,0,0,0.2))
hist(Pairs_Flatfish_1000_25_10[,1], breaks=seq(-0.5,1e6,5e3), add=TRUE, col=rgb(0,0.8,0,0.2))
hist(Pairs_Flatfish_100_25_10[,1], breaks=seq(-0.5,1e6,5e3), add=TRUE, col=rgb(0,0,0.8,0.2))
hist(Pairs_Flatfish_5000_25_10[,2], breaks=seq(-0.5,1e6,5e3), xlim=c(-1,2.5e5), las=1, xlab="", main="", ylab="",col=rgb(0.8,0,0,0.2))
hist(Pairs_Flatfish_1000_25_10[,2], breaks=seq(-0.5,1e6,5e3), add=TRUE, col=rgb(0,0.8,0,0.2))
hist(Pairs_Flatfish_100_25_10[,2], breaks=seq(-0.5,1e6,5e3), add=TRUE, col=rgb(0,0,0.8,0.2))

hist(Pairs_Sardine_5000_25_10[,1], breaks=seq(-0.5,1e6,50), xlim=c(-1,2200), las=1, xlab="", main="", ylab="",col=rgb(0.8,0,0,0.2))
hist(Pairs_Sardine_1000_25_10[,1], breaks=seq(-0.5,1e6,50), add=TRUE, col=rgb(0,0.8,0,0.2))
hist(Pairs_Sardine_100_25_10[,1], breaks=seq(-0.5,1e6,50), add=TRUE, col=rgb(0,0,0.8,0.2))
hist(Pairs_Sardine_5000_25_10[,2], breaks=seq(-0.5,1e6,50), xlim=c(-1,2200), las=1, xlab="", main="", ylab="",col=rgb(0.8,0,0,0.2))
hist(Pairs_Sardine_1000_25_10[,2], breaks=seq(-0.5,1e6,50), add=TRUE, col=rgb(0,0.8,0,0.2))
hist(Pairs_Sardine_100_25_10[,2], breaks=seq(-0.5,1e6,50), add=TRUE, col=rgb(0,0,0.8,0.2))

hist(Pairs_Cod_5000_25_20[,1], breaks=seq(-0.5,1e6,1), xlim=c(-1,100), las=1, xlab="Parent-Offspring Pairs", main="",col=rgb(0.8,0,0,0.2))
hist(Pairs_Cod_1000_25_20[,1], breaks=seq(-0.5,1e6,1), add=TRUE, col=rgb(0,0.8,0,0.2))
hist(Pairs_Cod_100_25_20[,1], breaks=seq(-0.5,1e6,1), add=TRUE, col=rgb(0,0,0.8,0.2))
mtext(text="20yr", side=2, line=4.5, font=2)
hist(Pairs_Cod_5000_25_20[,2], breaks=seq(-0.5,1e6,1), xlim=c(-1,100), las=1, xlab="Half-Sibling Pairs", main="", ylab="",col=rgb(0.8,0,0,0.2))
hist(Pairs_Cod_1000_25_20[,2], breaks=seq(-0.5,1e6,1), add=TRUE, col=rgb(0,0.8,0,0.2))
hist(Pairs_Cod_100_25_20[,2], breaks=seq(-0.5,1e6,1), add=TRUE, col=rgb(0,0,0.8,0.2))

hist(Pairs_Flatfish_5000_25_20[,1], breaks=seq(-0.5,1e6,5e3), xlim=c(-1,2.5e5), las=1, xlab="Parent-Offspring Pairs", main="", ylab="",col=rgb(0.8,0,0,0.2))
hist(Pairs_Flatfish_1000_25_20[,1], breaks=seq(-0.5,1e6,5e3), add=TRUE, col=rgb(0,0.8,0,0.2))
hist(Pairs_Flatfish_100_25_20[,1], breaks=seq(-0.5,1e6,5e3), add=TRUE, col=rgb(0,0,0.8,0.2))
hist(Pairs_Flatfish_5000_25_20[,2], breaks=seq(-0.5,1e6,5e3), xlim=c(-1,2.5e5), las=1, xlab="Half-Sibling Pairs", main="", ylab="",col=rgb(0.8,0,0,0.2))
hist(Pairs_Flatfish_1000_25_20[,2], breaks=seq(-0.5,1e6,5e3), add=TRUE, col=rgb(0,0.8,0,0.2))
hist(Pairs_Flatfish_100_25_20[,2], breaks=seq(-0.5,1e6,5e3), add=TRUE, col=rgb(0,0,0.8,0.2))

hist(Pairs_Sardine_5000_25_20[,1], breaks=seq(-0.5,1e6,50), xlim=c(-1,2200), las=1, xlab="Parent-Offspring Pairs", main="", ylab="",col=rgb(0.8,0,0,0.2))
hist(Pairs_Sardine_1000_25_20[,1], breaks=seq(-0.5,1e6,50), add=TRUE, col=rgb(0,0.8,0,0.2))
hist(Pairs_Sardine_100_25_20[,1], breaks=seq(-0.5,1e6,50), add=TRUE, col=rgb(0,0,0.8,0.2))
hist(Pairs_Sardine_5000_25_20[,2], breaks=seq(-0.5,1e6,50), xlim=c(-1,2200), las=1, xlab="Half-Sibling Pairs", main="", ylab="",col=rgb(0.8,0,0,0.2))
hist(Pairs_Sardine_1000_25_20[,2], breaks=seq(-0.5,1e6,50), add=TRUE, col=rgb(0,0.8,0,0.2))
hist(Pairs_Sardine_100_25_20[,2], breaks=seq(-0.5,1e6,50), add=TRUE, col=rgb(0,0,0.8,0.2))
#dev.off()

#Plots of Selectivity
par(mfrow=c(3,1), mar=c(4,4,1,1), oma=c(2,2,1,2))
plot(0:25, Cod_runs[[1]]$Sel, xlab="", ylab="", las=1, type="b", pch=16, lwd=2, main="Cod")
points(0:25, Cod_runs[[1]]$Mat*Cod_runs[[1]]$Waa/max(Cod_runs[[1]]$Mat*Cod_runs[[1]]$Waa), col=3, pch=16, type="b")
plot(0:25,Flatfish_runs[[1]]$Sel, ylab="", xlab="", type="b", pch=16, lwd=2, las=1, main="Flatfish")
points(0:25, Flatfish_runs[[1]]$Mat*Flatfish_runs[[1]]$Waa/max(Flatfish_runs[[1]]$Mat*Flatfish_runs[[1]]$Waa), col=3, pch=16, type="b")
mtext("Selectivity or Relative Fecundity", side=2, line=3.5)
plot(0:15,Sardine_runs[[1]]$Sel, xlab="Age", ylab="", las=1, type="b", pch=16, lwd=2, main="Sardine")
points(0:15, Sardine_runs[[1]]$Mat*Sardine_runs[[1]]$Waa/max(Sardine_runs[[1]]$Mat*Sardine_runs[[1]]$Waa), col=3, pch=16, type="b")
legend("bottom", c("Selectivity", "Fecundity"), col=c(1,3), lwd=2, bty="n")

#########################################
#Example CKMR data given to assessment
#########################################
#Doing Flatfish for 10 years N1000
load(paste0(wd,"/Flatfish_wdat_N1000_Ind50_ckmrmultinom10_1.RData"))
 
Flatfish_OM<-Flatfish_wdat
OM<-Flatfish_OM[[1]]
dat<-list(fyear=OM$OM$fyear, lyear=75, fage=OM$OM$fage, lage=OM$OM$lage, 
          years=OM$OM$fyear:75, ages=OM$OM$fage:OM$OM$lage,
          obs_harv=OM$Obs_Catch,
          obs_index=OM$Obs_Index,
          obs_fishery_comp=OM$Obs_Catch_Comp/rowSums(OM$Obs_Catch_Comp),
          SS_fishery=rowSums(OM$Obs_Catch_Comp),
          Mat=OM$OM$Mat,
          Laa=OM$OM$Laa,
          Waa=OM$OM$Waa,
          #CKMR 
          coded_born_year_old=OM$born_year_old-(OM$fyear_dat-1),
          coded_age_diff=OM$age_diff,
          n_ckmr=OM$n_ckmr,
          k_ckmr_hsporggp=OM$k_ckmr_hsporggp,
          coded_born_year_young=OM$born_year_young-(OM$fyear_dat-1), 
          k_ckmr_pop=OM$k_ckmr_pop,
          samp_year_coded_old=OM$samp_year_old-(OM$fyear_dat-1),
          coded_age_one=OM$coded_age_young,
          coded_age_two=OM$coded_age_old,
          coded_one_min=sapply(OM$coded_age_young, FUN=function(x){min(which(OM$AE_mat[,x+1]>0.01)-1)}),
          coded_one_max=sapply(OM$coded_age_young, FUN=function(x){max(which(OM$AE_mat[,x+1]>0.01)-1)}),
          coded_two_min=sapply(OM$coded_age_old, FUN=function(x){min(which(OM$AE_mat[,x+1]>0.01)-1)}),
          coded_two_max=sapply(OM$coded_age_old, FUN=function(x){max(which(OM$AE_mat[,x+1]>0.01)-1)}),
          #Switch for whether to use a data source or not, 0=no, 1=yes
          Lamda_Harvest=1,
          Lamda_Comp=1,
          Lamda_Index=1,
          Lamda_CKMR=1,
          AE_mat=OM$AE_mat,
          pi_nu=OM$pi_nu)

#for the ageing error case, you need sample year old, sample year young, coded age old and coded age young

ex_dat<-data.frame(samp_year_old=dat$samp_year_coded_old,samp_year_young=dat$coded_born_year_young+dat$coded_age_one,coded_age_old=dat$coded_age_two,coded_age_young=dat$coded_age_one,n_ckmr=dat$n_ckmr,k_ckmr_pop=dat$k_ckmr_pop,k_ckmr_hsporggp=dat$k_ckmr_hsporggp)
set.seed(43)
samp<-sample(1:(dim(ex_dat)[1]),size=10,replace=FALSE)
ex_dat[samp,]

head(ex_dat)
tail(ex_dat)

##################################
#SCAAs without CKMR data
##################################

#N100 for 5yrs, and index sd 0.25
res_list<-list()
res_list[[1]]<-readRDS(paste0(wd,"/SCAAfit_Cod_N100_Ind25_5yrs_noCKMR.RData"))
res_list[[2]]<-readRDS(paste0(wd,"/SCAAfit_Flatfish_N100_Ind25_5yrs_noCKMR.RData"))
res_list[[3]]<-readRDS(paste0(wd,"/SCAAfit_Sardine_N100_Ind25_5yrs_noCKMR.RData"))

Cod_wdat<-Cod_100_25_5
Flatfish_wdat<-Flatfish_100_25_5
Sardine_wdat<-Sardine_100_25_5
  
re_Dep<-re_SSB<-array(NA, dim=c(3,100,76))
re_R0<-re_M<-matrix(NA, nrow=100, ncol=3)
for(f in 1:3){
  for (i in 1:100){
    if(f==1){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Cod_wdat[[i]]$OM$SSB[26:101])/Cod_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Cod_wdat[[i]]$OM$R0)/Cod_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Cod_wdat[[i]]$OM$Mref)/Cod_wdat[[i]]$OM$Mref
      }
    }else if (f==2){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Flatfish_wdat[[i]]$OM$SSB[26:101])/Flatfish_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Flatfish_wdat[[i]]$OM$R0)/Flatfish_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Flatfish_wdat[[i]]$OM$Mref)/Flatfish_wdat[[i]]$OM$Mref
      }
    } else if (f==3){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Sardine_wdat[[i]]$OM$SSB[26:101])/Sardine_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Sardine_wdat[[i]]$OM$R0)/Sardine_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Sardine_wdat[[i]]$OM$Mref)/Sardine_wdat[[i]]$OM$Mref
      }
    }
  }
}

#SSB
par(mfrow=c(3,3))
boxplot(re_SSB[1,,], ylim=c(-0.25,0.25), las=1, main="Cod - N100, Index SD - 0.25, No CKMR", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[2,,], ylim=c(-0.25,0.25), las=1, main="Flatfish - N100, Index SD - 0.25, No CKMR", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[3,,], ylim=c(-0.25,0.25), las=1, main="Sardine - N100, Index SD - 0.25, No CKMR", ylab="RE - SSB")
abline(h=0)

#R0
boxplot(re_R0[,1], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,2], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,3], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)

#M
boxplot(re_M[,1], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,2], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,3], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)

#Relative error for point estimates
RE_ssb_N100_Ind25_5yrs_noCKMR<-re_SSB
RE_R0_N100_Ind25_5yrs_noCKMR<-re_R0
RE_M_N100_Ind25_5yrs_noCKMR<-re_M

#Interquartile Range of relative errors
IQR_RE_ssb_N100_Ind25_5yrs_noCKMR<-apply(re_SSB,c(1,3),quantile,probs=0.75, na.rm=TRUE)-apply(re_SSB,c(1,3),quantile,probs=0.25, na.rm=TRUE)
IQR_RE_R0_N100_Ind25_5yrs_noCKMR<-apply(re_R0,2,quantile,probs=0.75, na.rm=TRUE)-apply(re_R0,2,quantile,probs=0.25, na.rm=TRUE)
IQR_RE_M_N100_Ind25_5yrs_noCKMR<-apply(re_M,2,quantile,probs=0.75, na.rm=TRUE)-apply(re_M,2,quantile,probs=0.25, na.rm=TRUE)

#Interquartile Range of absolute relative errors
IQR_ARE_ssb_N100_Ind25_5yrs_noCKMR<-apply(abs(re_SSB),c(1,3),quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_SSB),c(1,3),quantile,probs=0.25, na.rm=TRUE)
IQR_ARE_R0_N100_Ind25_5yrs_noCKMR<-apply(abs(re_R0),2,quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_R0),2,quantile,probs=0.25, na.rm=TRUE)
IQR_ARE_M_N100_Ind25_5yrs_noCKMR<-apply(abs(re_M),2,quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_M),2,quantile,probs=0.25, na.rm=TRUE)

#SD of relative error for point estimates
sd_RE_ssb_N100_Ind25_5yrs_noCKMR<-apply(re_SSB,c(1,3),sd, na.rm=TRUE)
sd_RE_R0_N100_Ind25_5yrs_noCKMR<-apply(re_R0,2,sd, na.rm=TRUE)
sd_RE_M_N100_Ind25_5yrs_noCKMR<-apply(re_M,2,sd, na.rm=TRUE)

#SD of absolute relative error
sd_ARE_ssb_N100_Ind25_5yrs_noCKMR<-apply(abs(re_SSB),c(1,3),sd, na.rm=TRUE)
sd_ARE_R0_N100_Ind25_5yrs_noCKMR<-apply(abs(re_R0),2,sd, na.rm=TRUE)
sd_ARE_M_N100_Ind25_5yrs_noCKMR<-apply(abs(re_M),2,sd, na.rm=TRUE)

#Precision within sims
SD_ssb_N100_Ind25_5yrs_noCKMR<-CV_ssb_N100_Ind25_5yrs_noCKMR<-array(NA, dim=c(3,100,76)) 
SD_R0_N100_Ind25_5yrs_noCKMR<-matrix(NA, nrow=3, ncol=100)
SD_M_N100_Ind25_5yrs_noCKMR<-matrix(NA, nrow=3, ncol=100)
for(f in 1:3){
  for (i in 1:100){
    if(length(res_list[[f]][[i]])>2){
      CV_ssb_N100_Ind25_5yrs_noCKMR[f,i,]<-res_list[[f]][[i]]$SD$sd/res_list[[f]][[i]]$SD$value
    SD_ssb_N100_Ind25_5yrs_noCKMR[f,i,]<-res_list[[f]][[i]]$SD$sd
    SD_R0_N100_Ind25_5yrs_noCKMR[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_R0","log_R0"])
    SD_M_N100_Ind25_5yrs_noCKMR[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_M","log_M"])
    }
  }
}

#N1000 for 5 yrs, sd index 0.25
res_list[[1]]<-readRDS(paste0(wd,"/SCAAfit_Cod_N1000_Ind25_5yrs_noCKMR.RData"))
res_list[[2]]<-readRDS(paste0(wd,"/SCAAfit_Flatfish_N1000_Ind25_5yrs_noCKMR.RData"))
res_list[[3]]<-readRDS(paste0(wd,"/SCAAfit_Sardine_N1000_Ind25_5yrs_noCKMR.RData"))

Cod_wdat<-Cod_1000_25_5
Flatfish_wdat<-Flatfish_1000_25_5
Sardine_wdat<-Sardine_1000_25_5

re_Dep<-re_SSB<-array(NA, dim=c(3,100,76))
re_R0<-re_M<-matrix(NA, nrow=100, ncol=3)
for(f in 1:3){
  for (i in 1:100){
    if(f==1){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Cod_wdat[[i]]$OM$SSB[26:101])/Cod_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Cod_wdat[[i]]$OM$R0)/Cod_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Cod_wdat[[i]]$OM$Mref)/Cod_wdat[[i]]$OM$Mref
      }
    }else if (f==2){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Flatfish_wdat[[i]]$OM$SSB[26:101])/Flatfish_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Flatfish_wdat[[i]]$OM$R0)/Flatfish_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Flatfish_wdat[[i]]$OM$Mref)/Flatfish_wdat[[i]]$OM$Mref
      }
    } else if (f==3){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Sardine_wdat[[i]]$OM$SSB[26:101])/Sardine_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Sardine_wdat[[i]]$OM$R0)/Sardine_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Sardine_wdat[[i]]$OM$Mref)/Sardine_wdat[[i]]$OM$Mref
      }
    }
  }
}

#SSB
par(mfrow=c(3,3))
boxplot(re_SSB[1,,], ylim=c(-0.25,0.25), las=1, main="Cod - N1000|5yrs, Index SD - 0.25, No CKMR", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[2,,], ylim=c(-0.25,0.25), las=1, main="Flatfish - N1000|5yrs, Index SD - 0.25, No CKMR", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[3,,], ylim=c(-0.25,0.25), las=1, main="Sardine - N1000|5yrs, Index SD - 0.25, No CKMR", ylab="RE - SSB")
abline(h=0)

#R0
boxplot(re_R0[,1], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,2], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,3], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)

#M
boxplot(re_M[,1], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,2], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,3], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)

#Relative error for point estimates
RE_ssb_N1000_Ind25_5yrs_noCKMR<-re_SSB
RE_R0_N1000_Ind25_5yrs_noCKMR<-re_R0
RE_M_N1000_Ind25_5yrs_noCKMR<-re_M

#Interquartile Range of relative errors
IQR_RE_ssb_N1000_Ind25_5yrs_noCKMR<-apply(re_SSB,c(1,3),quantile,probs=0.75, na.rm=TRUE)-apply(re_SSB,c(1,3),quantile,probs=0.25, na.rm=TRUE)
IQR_RE_R0_N1000_Ind25_5yrs_noCKMR<-apply(re_R0,2,quantile,probs=0.75, na.rm=TRUE)-apply(re_R0,2,quantile,probs=0.25, na.rm=TRUE)
IQR_RE_M_N1000_Ind25_5yrs_noCKMR<-apply(re_M,2,quantile,probs=0.75, na.rm=TRUE)-apply(re_M,2,quantile,probs=0.25, na.rm=TRUE)

#Interquartile Range of absolute relative errors
IQR_ARE_ssb_N1000_Ind25_5yrs_noCKMR<-apply(abs(re_SSB),c(1,3),quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_SSB),c(1,3),quantile,probs=0.25, na.rm=TRUE)
IQR_ARE_R0_N1000_Ind25_5yrs_noCKMR<-apply(abs(re_R0),2,quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_R0),2,quantile,probs=0.25, na.rm=TRUE)
IQR_ARE_M_N1000_Ind25_5yrs_noCKMR<-apply(abs(re_M),2,quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_M),2,quantile,probs=0.25, na.rm=TRUE)

#SD of relative error for point estimates
sd_RE_ssb_N1000_Ind25_5yrs_noCKMR<-apply(re_SSB,c(1,3),sd, na.rm=TRUE)
sd_RE_R0_N1000_Ind25_5yrs_noCKMR<-apply(re_R0,2,sd, na.rm=TRUE)
sd_RE_M_N1000_Ind25_5yrs_noCKMR<-apply(re_M,2,sd, na.rm=TRUE)

#SD of absolute relative error
sd_ARE_ssb_N1000_Ind25_5yrs_noCKMR<-apply(abs(re_SSB),c(1,3),sd, na.rm=TRUE)
sd_ARE_R0_N1000_Ind25_5yrs_noCKMR<-apply(abs(re_R0),2,sd, na.rm=TRUE)
sd_ARE_M_N1000_Ind25_5yrs_noCKMR<-apply(abs(re_M),2,sd, na.rm=TRUE)

#Precision within sims
SD_ssb_N1000_Ind25_5yrs_noCKMR<-CV_ssb_N1000_Ind25_5yrs_noCKMR<-array(NA, dim=c(3,100,76)) 
SD_R0_N1000_Ind25_5yrs_noCKMR<-matrix(NA, nrow=3, ncol=100)
SD_M_N1000_Ind25_5yrs_noCKMR<-matrix(NA, nrow=3, ncol=100)
for(f in 1:3){
  for (i in 1:100){
    if(length(res_list[[f]][[i]])>2){
      CV_ssb_N1000_Ind25_5yrs_noCKMR[f,i,]<-res_list[[f]][[i]]$SD$sd/res_list[[f]][[i]]$SD$value
    SD_ssb_N1000_Ind25_5yrs_noCKMR[f,i,]<-res_list[[f]][[i]]$SD$sd
    SD_R0_N1000_Ind25_5yrs_noCKMR[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_R0","log_R0"])
    SD_M_N1000_Ind25_5yrs_noCKMR[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_M","log_M"])
    }
  }
}

#N5000 for 5 yrs, sd index 0.25
res_list<-list()
res_list[[1]]<-readRDS(paste0(wd,"/SCAAfit_Cod_N5000_Ind25_5yrs_noCKMR.RData"))
res_list[[2]]<-readRDS(paste0(wd,"/SCAAfit_Flatfish_N5000_Ind25_5yrs_noCKMR.RData"))
res_list[[3]]<-readRDS(paste0(wd,"/SCAAfit_Sardine_N5000_Ind25_5yrs_noCKMR.RData"))

Cod_wdat<-Cod_5000_25_5
Flatfish_wdat<-Flatfish_5000_25_5
Sardine_wdat<-Sardine_5000_25_5

re_Dep<-re_SSB<-array(NA, dim=c(3,100,76))
re_R0<-re_M<-matrix(NA, nrow=100, ncol=3)
for(f in 1:3){
  for (i in 1:100){
    if(f==1){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Cod_wdat[[i]]$OM$SSB[26:101])/Cod_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Cod_wdat[[i]]$OM$R0)/Cod_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Cod_wdat[[i]]$OM$Mref)/Cod_wdat[[i]]$OM$Mref
      }
    }else if (f==2){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Flatfish_wdat[[i]]$OM$SSB[26:101])/Flatfish_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Flatfish_wdat[[i]]$OM$R0)/Flatfish_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Flatfish_wdat[[i]]$OM$Mref)/Flatfish_wdat[[i]]$OM$Mref
      }
    } else if (f==3){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Sardine_wdat[[i]]$OM$SSB[26:101])/Sardine_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Sardine_wdat[[i]]$OM$R0)/Sardine_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Sardine_wdat[[i]]$OM$Mref)/Sardine_wdat[[i]]$OM$Mref
      }
    }
  }
}

#SSB
par(mfrow=c(3,3))
boxplot(re_SSB[1,,], ylim=c(-0.25,0.25), las=1, main="Cod - N5000|5yrs, Index SD - 0.25, No CKMR", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[2,,], ylim=c(-0.25,0.25), las=1, main="Flatfish - N5000|5yrs, Index SD - 0.25, No CKMR", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[3,,], ylim=c(-0.25,0.25), las=1, main="Sardine - N5000|5yrs, Index SD - 0.25, No CKMR", ylab="RE - SSB")
abline(h=0)

#R0
boxplot(re_R0[,1], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,2], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,3], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)

#M
boxplot(re_M[,1], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,2], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,3], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)

#Relative error for point estimates
RE_ssb_N5000_Ind25_5yrs_noCKMR<-re_SSB
RE_R0_N5000_Ind25_5yrs_noCKMR<-re_R0
RE_M_N5000_Ind25_5yrs_noCKMR<-re_M

#Interquartile Range of relative errors
IQR_RE_ssb_N5000_Ind25_5yrs_noCKMR<-apply(re_SSB,c(1,3),quantile,probs=0.75, na.rm=TRUE)-apply(re_SSB,c(1,3),quantile,probs=0.25, na.rm=TRUE)
IQR_RE_R0_N5000_Ind25_5yrs_noCKMR<-apply(re_R0,2,quantile,probs=0.75, na.rm=TRUE)-apply(re_R0,2,quantile,probs=0.25, na.rm=TRUE)
IQR_RE_M_N5000_Ind25_5yrs_noCKMR<-apply(re_M,2,quantile,probs=0.75, na.rm=TRUE)-apply(re_M,2,quantile,probs=0.25, na.rm=TRUE)

#Interquartile Range of absolute relative errors
IQR_ARE_ssb_N5000_Ind25_5yrs_noCKMR<-apply(abs(re_SSB),c(1,3),quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_SSB),c(1,3),quantile,probs=0.25, na.rm=TRUE)
IQR_ARE_R0_N5000_Ind25_5yrs_noCKMR<-apply(abs(re_R0),2,quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_R0),2,quantile,probs=0.25, na.rm=TRUE)
IQR_ARE_M_N5000_Ind25_5yrs_noCKMR<-apply(abs(re_M),2,quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_M),2,quantile,probs=0.25, na.rm=TRUE)

#SD of relative error for point estimates
sd_RE_ssb_N5000_Ind25_5yrs_noCKMR<-apply(re_SSB,c(1,3),sd, na.rm=TRUE)
sd_RE_R0_N5000_Ind25_5yrs_noCKMR<-apply(re_R0,2,sd, na.rm=TRUE)
sd_RE_M_N5000_Ind25_5yrs_noCKMR<-apply(re_M,2,sd, na.rm=TRUE)

#SD of absolute relative error
sd_ARE_ssb_N5000_Ind25_5yrs_noCKMR<-apply(abs(re_SSB),c(1,3),sd, na.rm=TRUE)
sd_ARE_R0_N5000_Ind25_5yrs_noCKMR<-apply(abs(re_R0),2,sd, na.rm=TRUE)
sd_ARE_M_N5000_Ind25_5yrs_noCKMR<-apply(abs(re_M),2,sd, na.rm=TRUE)

#Precision within sims
SD_ssb_N5000_Ind25_5yrs_noCKMR<-CV_ssb_N5000_Ind25_5yrs_noCKMR<-array(NA, dim=c(3,100,76)) 
SD_R0_N5000_Ind25_5yrs_noCKMR<-matrix(NA, nrow=3, ncol=100)
SD_M_N5000_Ind25_5yrs_noCKMR<-matrix(NA, nrow=3, ncol=100)
for(f in 1:3){
  for (i in 1:100){
    if(length(res_list[[f]][[i]])>2){
      CV_ssb_N5000_Ind25_5yrs_noCKMR[f,i,]<-res_list[[f]][[i]]$SD$sd/res_list[[f]][[i]]$SD$value
    SD_ssb_N5000_Ind25_5yrs_noCKMR[f,i,]<-res_list[[f]][[i]]$SD$sd
    SD_R0_N5000_Ind25_5yrs_noCKMR[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_R0","log_R0"])
    SD_M_N5000_Ind25_5yrs_noCKMR[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_M","log_M"])
    }
  }
}

#N100 for 5 yrs and index sd 0.50
res_list<-list()
res_list[[1]]<-readRDS(paste0(wd,"/SCAAfit_Cod_N100_Ind50_5yrs_noCKMR.RData"))
res_list[[2]]<-readRDS(paste0(wd,"/SCAAfit_Flatfish_N100_Ind50_5yrs_noCKMR.RData"))
res_list[[3]]<-readRDS(paste0(wd,"/SCAAfit_Sardine_N100_Ind50_5yrs_noCKMR.RData"))

Cod_wdat<-Cod_100_50_5
Flatfish_wdat<-Flatfish_100_50_5
Sardine_wdat<-Sardine_100_50_5

re_Dep<-re_SSB<-array(NA, dim=c(3,100,76))
re_R0<-re_M<-matrix(NA, nrow=100, ncol=3)
for(f in 1:3){
  for (i in 1:100){
    if(f==1){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Cod_wdat[[i]]$OM$SSB[26:101])/Cod_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Cod_wdat[[i]]$OM$R0)/Cod_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Cod_wdat[[i]]$OM$Mref)/Cod_wdat[[i]]$OM$Mref
      }
    }else if (f==2){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Flatfish_wdat[[i]]$OM$SSB[26:101])/Flatfish_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Flatfish_wdat[[i]]$OM$R0)/Flatfish_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Flatfish_wdat[[i]]$OM$Mref)/Flatfish_wdat[[i]]$OM$Mref
      }
    } else if (f==3){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Sardine_wdat[[i]]$OM$SSB[26:101])/Sardine_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Sardine_wdat[[i]]$OM$R0)/Sardine_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Sardine_wdat[[i]]$OM$Mref)/Sardine_wdat[[i]]$OM$Mref
      }
    }
  }
}

#SSB
par(mfrow=c(3,3))
boxplot(re_SSB[1,,], ylim=c(-0.25,0.25), las=1, main="Cod - N100, Index SD - 0.50, No CKMR", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[2,,], ylim=c(-0.25,0.25), las=1, main="Flatfish - N100, Index SD - 0.50, No CKMR", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[3,,], ylim=c(-0.25,0.25), las=1, main="Sardine - N100, Index SD - 0.50, No CKMR", ylab="RE - SSB")
abline(h=0)

#R0
boxplot(re_R0[,1], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,2], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,3], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)

#M
boxplot(re_M[,1], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,2], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,3], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)

#Relative error for point estimates
RE_ssb_N100_Ind50_5yrs_noCKMR<-re_SSB
RE_R0_N100_Ind50_5yrs_noCKMR<-re_R0
RE_M_N100_Ind50_5yrs_noCKMR<-re_M

#Interquartile Range of relative errors
IQR_RE_ssb_N100_Ind50_5yrs_noCKMR<-apply(re_SSB,c(1,3),quantile,probs=0.75, na.rm=TRUE)-apply(re_SSB,c(1,3),quantile,probs=0.25, na.rm=TRUE)
IQR_RE_R0_N100_Ind50_5yrs_noCKMR<-apply(re_R0,2,quantile,probs=0.75, na.rm=TRUE)-apply(re_R0,2,quantile,probs=0.25, na.rm=TRUE)
IQR_RE_M_N100_Ind50_5yrs_noCKMR<-apply(re_M,2,quantile,probs=0.75, na.rm=TRUE)-apply(re_M,2,quantile,probs=0.25, na.rm=TRUE)

#Interquartile Range of absolute relative errors
IQR_ARE_ssb_N100_Ind50_5yrs_noCKMR<-apply(abs(re_SSB),c(1,3),quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_SSB),c(1,3),quantile,probs=0.25, na.rm=TRUE)
IQR_ARE_R0_N100_Ind50_5yrs_noCKMR<-apply(abs(re_R0),2,quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_R0),2,quantile,probs=0.25, na.rm=TRUE)
IQR_ARE_M_N100_Ind50_5yrs_noCKMR<-apply(abs(re_M),2,quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_M),2,quantile,probs=0.25, na.rm=TRUE)

#SD of relative error for point estimates
sd_RE_ssb_N100_Ind50_5yrs_noCKMR<-apply(re_SSB,c(1,3),sd, na.rm=TRUE)
sd_RE_R0_N100_Ind50_5yrs_noCKMR<-apply(re_R0,2,sd, na.rm=TRUE)
sd_RE_M_N100_Ind50_5yrs_noCKMR<-apply(re_M,2,sd, na.rm=TRUE)

#SD of absolute relative error
sd_ARE_ssb_N100_Ind50_5yrs_noCKMR<-apply(abs(re_SSB),c(1,3),sd, na.rm=TRUE)
sd_ARE_R0_N100_Ind50_5yrs_noCKMR<-apply(abs(re_R0),2,sd, na.rm=TRUE)
sd_ARE_M_N100_Ind50_5yrs_noCKMR<-apply(abs(re_M),2,sd, na.rm=TRUE)

#Precision within sims
SD_ssb_N100_Ind50_5yrs_noCKMR<-CV_ssb_N100_Ind50_5yrs_noCKMR<-array(NA, dim=c(3,100,76)) 
SD_R0_N100_Ind50_5yrs_noCKMR<-matrix(NA, nrow=3, ncol=100)
SD_M_N100_Ind50_5yrs_noCKMR<-matrix(NA, nrow=3, ncol=100)
for(f in 1:3){
  for (i in 1:100){
    if(length(res_list[[f]][[i]])>2){
      CV_ssb_N100_Ind50_5yrs_noCKMR[f,i,]<-res_list[[f]][[i]]$SD$sd/res_list[[f]][[i]]$SD$value
    SD_ssb_N100_Ind50_5yrs_noCKMR[f,i,]<-res_list[[f]][[i]]$SD$sd
    SD_R0_N100_Ind50_5yrs_noCKMR[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_R0","log_R0"])
    SD_M_N100_Ind50_5yrs_noCKMR[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_M","log_M"])
    }
  }
}

#N1000 for 5 yrs, sd index 0.50
res_list[[1]]<-readRDS(paste0(wd,"/SCAAfit_Cod_N1000_Ind50_5yrs_noCKMR.RData"))
res_list[[2]]<-readRDS(paste0(wd,"/SCAAfit_Flatfish_N1000_Ind50_5yrs_noCKMR.RData"))
res_list[[3]]<-readRDS(paste0(wd,"/SCAAfit_Sardine_N1000_Ind50_5yrs_noCKMR.RData"))

Cod_wdat<-Cod_1000_50_5
Flatfish_wdat<-Flatfish_1000_50_5
Sardine_wdat<-Sardine_1000_50_5

re_Dep<-re_SSB<-array(NA, dim=c(3,100,76))
re_R0<-re_M<-matrix(NA, nrow=100, ncol=3)
for(f in 1:3){
  for (i in 1:100){
    if(f==1){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Cod_wdat[[i]]$OM$SSB[26:101])/Cod_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Cod_wdat[[i]]$OM$R0)/Cod_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Cod_wdat[[i]]$OM$Mref)/Cod_wdat[[i]]$OM$Mref
      }
    }else if (f==2){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Flatfish_wdat[[i]]$OM$SSB[26:101])/Flatfish_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Flatfish_wdat[[i]]$OM$R0)/Flatfish_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Flatfish_wdat[[i]]$OM$Mref)/Flatfish_wdat[[i]]$OM$Mref
      }
    } else if (f==3){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Sardine_wdat[[i]]$OM$SSB[26:101])/Sardine_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Sardine_wdat[[i]]$OM$R0)/Sardine_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Sardine_wdat[[i]]$OM$Mref)/Sardine_wdat[[i]]$OM$Mref
      }
    }
  }
}

#SSB
par(mfrow=c(3,3))
boxplot(re_SSB[1,,], ylim=c(-0.25,0.25), las=1, main="Cod - N1000|5yrs, Index SD - 0.50, No CKMR", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[2,,], ylim=c(-0.25,0.25), las=1, main="Flatfish - N1000|5yrs, Index SD - 0.50, No CKMR", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[3,,], ylim=c(-0.25,0.25), las=1, main="Sardine - N1000|5yrs, Index SD - 0.50, No CKMR", ylab="RE - SSB")
abline(h=0)

#R0
boxplot(re_R0[,1], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,2], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,3], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)

#M
boxplot(re_M[,1], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,2], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,3], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)

#Relative error for point estimates
RE_ssb_N1000_Ind50_5yrs_noCKMR<-re_SSB
RE_R0_N1000_Ind50_5yrs_noCKMR<-re_R0
RE_M_N1000_Ind50_5yrs_noCKMR<-re_M

#Interquartile Range of relative errors
IQR_RE_ssb_N1000_Ind50_5yrs_noCKMR<-apply(re_SSB,c(1,3),quantile,probs=0.75, na.rm=TRUE)-apply(re_SSB,c(1,3),quantile,probs=0.25, na.rm=TRUE)
IQR_RE_R0_N1000_Ind50_5yrs_noCKMR<-apply(re_R0,2,quantile,probs=0.75, na.rm=TRUE)-apply(re_R0,2,quantile,probs=0.25, na.rm=TRUE)
IQR_RE_M_N1000_Ind50_5yrs_noCKMR<-apply(re_M,2,quantile,probs=0.75, na.rm=TRUE)-apply(re_M,2,quantile,probs=0.25, na.rm=TRUE)

#Interquartile Range of absolute relative errors
IQR_ARE_ssb_N1000_Ind50_5yrs_noCKMR<-apply(abs(re_SSB),c(1,3),quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_SSB),c(1,3),quantile,probs=0.25, na.rm=TRUE)
IQR_ARE_R0_N1000_Ind50_5yrs_noCKMR<-apply(abs(re_R0),2,quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_R0),2,quantile,probs=0.25, na.rm=TRUE)
IQR_ARE_M_N1000_Ind50_5yrs_noCKMR<-apply(abs(re_M),2,quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_M),2,quantile,probs=0.25, na.rm=TRUE)

#SD of relative error for point estimates
sd_RE_ssb_N1000_Ind50_5yrs_noCKMR<-apply(re_SSB,c(1,3),sd, na.rm=TRUE)
sd_RE_R0_N1000_Ind50_5yrs_noCKMR<-apply(re_R0,2,sd, na.rm=TRUE)
sd_RE_M_N1000_Ind50_5yrs_noCKMR<-apply(re_M,2,sd, na.rm=TRUE)

#SD of absolute relative error
sd_ARE_ssb_N1000_Ind50_5yrs_noCKMR<-apply(abs(re_SSB),c(1,3),sd, na.rm=TRUE)
sd_ARE_R0_N1000_Ind50_5yrs_noCKMR<-apply(abs(re_R0),2,sd, na.rm=TRUE)
sd_ARE_M_N1000_Ind50_5yrs_noCKMR<-apply(abs(re_M),2,sd, na.rm=TRUE)

#Precision within sims
SD_ssb_N1000_Ind50_5yrs_noCKMR<-CV_ssb_N1000_Ind50_5yrs_noCKMR<-array(NA, dim=c(3,100,76)) 
SD_R0_N1000_Ind50_5yrs_noCKMR<-matrix(NA, nrow=3, ncol=100)
SD_M_N1000_Ind50_5yrs_noCKMR<-matrix(NA, nrow=3, ncol=100)
for(f in 1:3){
  for (i in 1:100){
    if(length(res_list[[f]][[i]])>2){
      CV_ssb_N1000_Ind50_5yrs_noCKMR[f,i,]<-res_list[[f]][[i]]$SD$sd/res_list[[f]][[i]]$SD$value
    SD_ssb_N1000_Ind50_5yrs_noCKMR[f,i,]<-res_list[[f]][[i]]$SD$sd
    SD_R0_N1000_Ind50_5yrs_noCKMR[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_R0","log_R0"])
    SD_M_N1000_Ind50_5yrs_noCKMR[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_M","log_M"])
    }
  }
}

#N5000 for 5 years, sd index 0.50
res_list[[1]]<-readRDS(paste0(wd,"/SCAAfit_Cod_N5000_Ind50_5yrs_noCKMR.RData"))
res_list[[2]]<-readRDS(paste0(wd,"/SCAAfit_Flatfish_N5000_Ind50_5yrs_noCKMR.RData"))
res_list[[3]]<-readRDS(paste0(wd,"/SCAAfit_Sardine_N5000_Ind50_5yrs_noCKMR.RData"))

Cod_wdat<-Cod_5000_50_5
Flatfish_wdat<-Flatfish_5000_50_5
Sardine_wdat<-Sardine_5000_50_5

re_Dep<-re_SSB<-array(NA, dim=c(3,100,76))
re_R0<-re_M<-matrix(NA, nrow=100, ncol=3)
for(f in 1:3){
  for (i in 1:100){
    if(f==1){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Cod_wdat[[i]]$OM$SSB[26:101])/Cod_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Cod_wdat[[i]]$OM$R0)/Cod_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Cod_wdat[[i]]$OM$Mref)/Cod_wdat[[i]]$OM$Mref
      }
    }else if (f==2){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Flatfish_wdat[[i]]$OM$SSB[26:101])/Flatfish_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Flatfish_wdat[[i]]$OM$R0)/Flatfish_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Flatfish_wdat[[i]]$OM$Mref)/Flatfish_wdat[[i]]$OM$Mref
      }
    } else if (f==3){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Sardine_wdat[[i]]$OM$SSB[26:101])/Sardine_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Sardine_wdat[[i]]$OM$R0)/Sardine_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Sardine_wdat[[i]]$OM$Mref)/Sardine_wdat[[i]]$OM$Mref
      }
    }
  }
}

#SSB
par(mfrow=c(3,3))
boxplot(re_SSB[1,,], ylim=c(-0.25,0.25), las=1, main="Cod - N5000|5yrs, Index SD - 0.50, No CKMR", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[2,,], ylim=c(-0.25,0.25), las=1, main="Flatfish - N5000|5yrs, Index SD - 0.50, No CKMR", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[3,,], ylim=c(-0.25,0.25), las=1, main="Sardine - N5000|5yrs, Index SD - 0.50, No CKMR", ylab="RE - SSB")
abline(h=0)

#R0
boxplot(re_R0[,1], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,2], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,3], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)

#M
boxplot(re_M[,1], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,2], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,3], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)

#Relative error for point estimates
RE_ssb_N5000_Ind50_5yrs_noCKMR<-re_SSB
RE_R0_N5000_Ind50_5yrs_noCKMR<-re_R0
RE_M_N5000_Ind50_5yrs_noCKMR<-re_M

#Interquartile Range of relative errors
IQR_RE_ssb_N5000_Ind50_5yrs_noCKMR<-apply(re_SSB,c(1,3),quantile,probs=0.75, na.rm=TRUE)-apply(re_SSB,c(1,3),quantile,probs=0.25, na.rm=TRUE)
IQR_RE_R0_N5000_Ind50_5yrs_noCKMR<-apply(re_R0,2,quantile,probs=0.75, na.rm=TRUE)-apply(re_R0,2,quantile,probs=0.25, na.rm=TRUE)
IQR_RE_M_N5000_Ind50_5yrs_noCKMR<-apply(re_M,2,quantile,probs=0.75, na.rm=TRUE)-apply(re_M,2,quantile,probs=0.25, na.rm=TRUE)

#Interquartile Range of absolute relative errors
IQR_ARE_ssb_N5000_Ind50_5yrs_noCKMR<-apply(abs(re_SSB),c(1,3),quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_SSB),c(1,3),quantile,probs=0.25, na.rm=TRUE)
IQR_ARE_R0_N5000_Ind50_5yrs_noCKMR<-apply(abs(re_R0),2,quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_R0),2,quantile,probs=0.25, na.rm=TRUE)
IQR_ARE_M_N5000_Ind50_5yrs_noCKMR<-apply(abs(re_M),2,quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_M),2,quantile,probs=0.25, na.rm=TRUE)

#SD of relative error for point estimates
sd_RE_ssb_N5000_Ind50_5yrs_noCKMR<-apply(re_SSB,c(1,3),sd, na.rm=TRUE)
sd_RE_R0_N5000_Ind50_5yrs_noCKMR<-apply(re_R0,2,sd, na.rm=TRUE)
sd_RE_M_N5000_Ind50_5yrs_noCKMR<-apply(re_M,2,sd, na.rm=TRUE)

#SD of absolute relative error
sd_ARE_ssb_N5000_Ind50_5yrs_noCKMR<-apply(abs(re_SSB),c(1,3),sd, na.rm=TRUE)
sd_ARE_R0_N5000_Ind50_5yrs_noCKMR<-apply(abs(re_R0),2,sd, na.rm=TRUE)
sd_ARE_M_N5000_Ind50_5yrs_noCKMR<-apply(abs(re_M),2,sd, na.rm=TRUE)

#Precision within sims
SD_ssb_N5000_Ind50_5yrs_noCKMR<-CV_ssb_N5000_Ind50_5yrs_noCKMR<-array(NA, dim=c(3,100,76)) 
SD_R0_N5000_Ind50_5yrs_noCKMR<-matrix(NA, nrow=3, ncol=100)
SD_M_N5000_Ind50_5yrs_noCKMR<-matrix(NA, nrow=3, ncol=100)
for(f in 1:3){
  for (i in 1:100){
    if(length(res_list[[f]][[i]])>2){
      CV_ssb_N5000_Ind50_5yrs_noCKMR[f,i,]<-res_list[[f]][[i]]$SD$sd/res_list[[f]][[i]]$SD$value
    SD_ssb_N5000_Ind50_5yrs_noCKMR[f,i,]<-res_list[[f]][[i]]$SD$sd
    SD_R0_N5000_Ind50_5yrs_noCKMR[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_R0","log_R0"])
    SD_M_N5000_Ind50_5yrs_noCKMR[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_M","log_M"])
    }
  }
}

#########
#10 years
#########

#N100 for 10yrs, and index sd 0.25
res_list<-list()
res_list[[1]]<-readRDS(paste0(wd,"/SCAAfit_Cod_N100_Ind25_10yrs_noCKMR.RData"))
res_list[[2]]<-readRDS(paste0(wd,"/SCAAfit_Flatfish_N100_Ind25_10yrs_noCKMR.RData"))
res_list[[3]]<-readRDS(paste0(wd,"/SCAAfit_Sardine_N100_Ind25_10yrs_noCKMR.RData"))

Cod_wdat<-Cod_100_25_10
Flatfish_wdat<-Flatfish_100_25_10
Sardine_wdat<-Sardine_100_25_10

re_Dep<-re_SSB<-array(NA, dim=c(3,100,76))
re_R0<-re_M<-matrix(NA, nrow=100, ncol=3)
for(f in 1:3){
  for (i in 1:100){
    if(f==1){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Cod_wdat[[i]]$OM$SSB[26:101])/Cod_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Cod_wdat[[i]]$OM$R0)/Cod_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Cod_wdat[[i]]$OM$Mref)/Cod_wdat[[i]]$OM$Mref
      }
    }else if (f==2){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Flatfish_wdat[[i]]$OM$SSB[26:101])/Flatfish_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Flatfish_wdat[[i]]$OM$R0)/Flatfish_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Flatfish_wdat[[i]]$OM$Mref)/Flatfish_wdat[[i]]$OM$Mref
      }
    } else if (f==3){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Sardine_wdat[[i]]$OM$SSB[26:101])/Sardine_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Sardine_wdat[[i]]$OM$R0)/Sardine_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Sardine_wdat[[i]]$OM$Mref)/Sardine_wdat[[i]]$OM$Mref
      }
    }
  }
}

#SSB
par(mfrow=c(3,3))
boxplot(re_SSB[1,,], ylim=c(-0.25,0.25), las=1, main="Cod - N100, Index SD - 0.25, No CKMR", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[2,,], ylim=c(-0.25,0.25), las=1, main="Flatfish - N100, Index SD - 0.25, No CKMR", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[3,,], ylim=c(-0.25,0.25), las=1, main="Sardine - N100, Index SD - 0.25, No CKMR", ylab="RE - SSB")
abline(h=0)

#R0
boxplot(re_R0[,1], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,2], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,3], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)

#M
boxplot(re_M[,1], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,2], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,3], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)

#Relative error for point estimates
RE_ssb_N100_Ind25_10yrs_noCKMR<-re_SSB
RE_R0_N100_Ind25_10yrs_noCKMR<-re_R0
RE_M_N100_Ind25_10yrs_noCKMR<-re_M

#Interquartile Range of relative errors
IQR_RE_ssb_N100_Ind25_10yrs_noCKMR<-apply(re_SSB,c(1,3),quantile,probs=0.75, na.rm=TRUE)-apply(re_SSB,c(1,3),quantile,probs=0.25, na.rm=TRUE)
IQR_RE_R0_N100_Ind25_10yrs_noCKMR<-apply(re_R0,2,quantile,probs=0.75, na.rm=TRUE)-apply(re_R0,2,quantile,probs=0.25, na.rm=TRUE)
IQR_RE_M_N100_Ind25_10yrs_noCKMR<-apply(re_M,2,quantile,probs=0.75, na.rm=TRUE)-apply(re_M,2,quantile,probs=0.25, na.rm=TRUE)

#Interquartile Range of absolute relative errors
IQR_ARE_ssb_N100_Ind25_10yrs_noCKMR<-apply(abs(re_SSB),c(1,3),quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_SSB),c(1,3),quantile,probs=0.25, na.rm=TRUE)
IQR_ARE_R0_N100_Ind25_10yrs_noCKMR<-apply(abs(re_R0),2,quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_R0),2,quantile,probs=0.25, na.rm=TRUE)
IQR_ARE_M_N100_Ind25_10yrs_noCKMR<-apply(abs(re_M),2,quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_M),2,quantile,probs=0.25, na.rm=TRUE)

#SD of relative error for point estimates
sd_RE_ssb_N100_Ind25_10yrs_noCKMR<-apply(re_SSB,c(1,3),sd, na.rm=TRUE)
sd_RE_R0_N100_Ind25_10yrs_noCKMR<-apply(re_R0,2,sd, na.rm=TRUE)
sd_RE_M_N100_Ind25_10yrs_noCKMR<-apply(re_M,2,sd, na.rm=TRUE)

#SD of absolute relative error
sd_ARE_ssb_N100_Ind25_10yrs_noCKMR<-apply(abs(re_SSB),c(1,3),sd, na.rm=TRUE)
sd_ARE_R0_N100_Ind25_10yrs_noCKMR<-apply(abs(re_R0),2,sd, na.rm=TRUE)
sd_ARE_M_N100_Ind25_10yrs_noCKMR<-apply(abs(re_M),2,sd, na.rm=TRUE)

#Precision within sims
SD_ssb_N100_Ind25_10yrs_noCKMR<-CV_ssb_N100_Ind25_10yrs_noCKMR<-array(NA, dim=c(3,100,76)) 
SD_R0_N100_Ind25_10yrs_noCKMR<-matrix(NA, nrow=3, ncol=100)
SD_M_N100_Ind25_10yrs_noCKMR<-matrix(NA, nrow=3, ncol=100)
for(f in 1:3){
  for (i in 1:100){
    if(length(res_list[[f]][[i]])>2){
      CV_ssb_N100_Ind25_10yrs_noCKMR[f,i,]<-res_list[[f]][[i]]$SD$sd/res_list[[f]][[i]]$SD$value
    SD_ssb_N100_Ind25_10yrs_noCKMR[f,i,]<-res_list[[f]][[i]]$SD$sd
    SD_R0_N100_Ind25_10yrs_noCKMR[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_R0","log_R0"])
    SD_M_N100_Ind25_10yrs_noCKMR[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_M","log_M"])
    }
  }
}

#N1000 for 10yrs, sd index 0.25
res_list[[1]]<-readRDS(paste0(wd,"/SCAAfit_Cod_N1000_Ind25_10yrs_noCKMR.RData"))
res_list[[2]]<-readRDS(paste0(wd,"/SCAAfit_Flatfish_N1000_Ind25_10yrs_noCKMR.RData"))
res_list[[3]]<-readRDS(paste0(wd,"/SCAAfit_Sardine_N1000_Ind25_10yrs_noCKMR.RData"))

Cod_wdat<-Cod_1000_25_10
Flatfish_wdat<-Flatfish_1000_25_10
Sardine_wdat<-Sardine_1000_25_10

re_Dep<-re_SSB<-array(NA, dim=c(3,100,76))
re_R0<-re_M<-matrix(NA, nrow=100, ncol=3)
for(f in 1:3){
  for (i in 1:100){
    if(f==1){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Cod_wdat[[i]]$OM$SSB[26:101])/Cod_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Cod_wdat[[i]]$OM$R0)/Cod_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Cod_wdat[[i]]$OM$Mref)/Cod_wdat[[i]]$OM$Mref
      }
    }else if (f==2){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Flatfish_wdat[[i]]$OM$SSB[26:101])/Flatfish_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Flatfish_wdat[[i]]$OM$R0)/Flatfish_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Flatfish_wdat[[i]]$OM$Mref)/Flatfish_wdat[[i]]$OM$Mref
      }
    } else if (f==3){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Sardine_wdat[[i]]$OM$SSB[26:101])/Sardine_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Sardine_wdat[[i]]$OM$R0)/Sardine_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Sardine_wdat[[i]]$OM$Mref)/Sardine_wdat[[i]]$OM$Mref
      }
    }
  }
}

#SSB
par(mfrow=c(3,3))
boxplot(re_SSB[1,,], ylim=c(-0.25,0.25), las=1, main="Cod - N1000|10yrs, Index SD - 0.25, No CKMR", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[2,,], ylim=c(-0.25,0.25), las=1, main="Flatfish - N1000|10yrs, Index SD - 0.25, No CKMR", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[3,,], ylim=c(-0.25,0.25), las=1, main="Sardine - N1000|10yrs, Index SD - 0.25, No CKMR", ylab="RE - SSB")
abline(h=0)

#R0
boxplot(re_R0[,1], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,2], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,3], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)

#M
boxplot(re_M[,1], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,2], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,3], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)

#Relative error for point estimates
RE_ssb_N1000_Ind25_10yrs_noCKMR<-re_SSB
RE_R0_N1000_Ind25_10yrs_noCKMR<-re_R0
RE_M_N1000_Ind25_10yrs_noCKMR<-re_M

#Interquartile Range of relative errors
IQR_RE_ssb_N1000_Ind25_10yrs_noCKMR<-apply(re_SSB,c(1,3),quantile,probs=0.75, na.rm=TRUE)-apply(re_SSB,c(1,3),quantile,probs=0.25, na.rm=TRUE)
IQR_RE_R0_N1000_Ind25_10yrs_noCKMR<-apply(re_R0,2,quantile,probs=0.75, na.rm=TRUE)-apply(re_R0,2,quantile,probs=0.25, na.rm=TRUE)
IQR_RE_M_N1000_Ind25_10yrs_noCKMR<-apply(re_M,2,quantile,probs=0.75, na.rm=TRUE)-apply(re_M,2,quantile,probs=0.25, na.rm=TRUE)

#Interquartile Range of absolute relative errors
IQR_ARE_ssb_N1000_Ind25_10yrs_noCKMR<-apply(abs(re_SSB),c(1,3),quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_SSB),c(1,3),quantile,probs=0.25, na.rm=TRUE)
IQR_ARE_R0_N1000_Ind25_10yrs_noCKMR<-apply(abs(re_R0),2,quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_R0),2,quantile,probs=0.25, na.rm=TRUE)
IQR_ARE_M_N1000_Ind25_10yrs_noCKMR<-apply(abs(re_M),2,quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_M),2,quantile,probs=0.25, na.rm=TRUE)

#SD of relative error for point estimates
sd_RE_ssb_N1000_Ind25_10yrs_noCKMR<-apply(re_SSB,c(1,3),sd, na.rm=TRUE)
sd_RE_R0_N1000_Ind25_10yrs_noCKMR<-apply(re_R0,2,sd, na.rm=TRUE)
sd_RE_M_N1000_Ind25_10yrs_noCKMR<-apply(re_M,2,sd, na.rm=TRUE)

#SD of absolute relative error
sd_ARE_ssb_N1000_Ind25_10yrs_noCKMR<-apply(abs(re_SSB),c(1,3),sd, na.rm=TRUE)
sd_ARE_R0_N1000_Ind25_10yrs_noCKMR<-apply(abs(re_R0),2,sd, na.rm=TRUE)
sd_ARE_M_N1000_Ind25_10yrs_noCKMR<-apply(abs(re_M),2,sd, na.rm=TRUE)

#Precision within sims
SD_ssb_N1000_Ind25_10yrs_noCKMR<-CV_ssb_N1000_Ind25_10yrs_noCKMR<-array(NA, dim=c(3,100,76)) 
SD_R0_N1000_Ind25_10yrs_noCKMR<-matrix(NA, nrow=3, ncol=100)
SD_M_N1000_Ind25_10yrs_noCKMR<-matrix(NA, nrow=3, ncol=100)
for(f in 1:3){
  for (i in 1:100){
    if(length(res_list[[f]][[i]])>2){
      CV_ssb_N1000_Ind25_10yrs_noCKMR[f,i,]<-res_list[[f]][[i]]$SD$sd/res_list[[f]][[i]]$SD$value
    SD_ssb_N1000_Ind25_10yrs_noCKMR[f,i,]<-res_list[[f]][[i]]$SD$sd
    SD_R0_N1000_Ind25_10yrs_noCKMR[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_R0","log_R0"])
    SD_M_N1000_Ind25_10yrs_noCKMR[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_M","log_M"])
    }
  }
}

#N5000 for 10yrs, sd index 0.25
res_list[[1]]<-readRDS(paste0(wd,"/SCAAfit_Cod_N5000_Ind25_10yrs_noCKMR.RData"))
res_list[[2]]<-readRDS(paste0(wd,"/SCAAfit_Flatfish_N5000_Ind25_10yrs_noCKMR.RData"))
res_list[[3]]<-readRDS(paste0(wd,"/SCAAfit_Sardine_N5000_Ind25_10yrs_noCKMR.RData"))

Cod_wdat<-Cod_5000_25_10
Flatfish_wdat<-Flatfish_5000_25_10
Sardine_wdat<-Sardine_5000_25_10

re_Dep<-re_SSB<-array(NA, dim=c(3,100,76))
re_R0<-re_M<-matrix(NA, nrow=100, ncol=3)
for(f in 1:3){
  for (i in 1:100){
    if(f==1){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Cod_wdat[[i]]$OM$SSB[26:101])/Cod_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Cod_wdat[[i]]$OM$R0)/Cod_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Cod_wdat[[i]]$OM$Mref)/Cod_wdat[[i]]$OM$Mref
      }
    }else if (f==2){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Flatfish_wdat[[i]]$OM$SSB[26:101])/Flatfish_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Flatfish_wdat[[i]]$OM$R0)/Flatfish_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Flatfish_wdat[[i]]$OM$Mref)/Flatfish_wdat[[i]]$OM$Mref
      }
    } else if (f==3){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Sardine_wdat[[i]]$OM$SSB[26:101])/Sardine_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Sardine_wdat[[i]]$OM$R0)/Sardine_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Sardine_wdat[[i]]$OM$Mref)/Sardine_wdat[[i]]$OM$Mref
      }
    }
  }
}

#SSB
par(mfrow=c(3,3))
boxplot(re_SSB[1,,], ylim=c(-0.25,0.25), las=1, main="Cod - N5000|10yrs, Index SD - 0.25, No CKMR", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[2,,], ylim=c(-0.25,0.25), las=1, main="Flatfish - N5000|10yrs, Index SD - 0.25, No CKMR", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[3,,], ylim=c(-0.25,0.25), las=1, main="Sardine - N5000|10yrs, Index SD - 0.25, No CKMR", ylab="RE - SSB")
abline(h=0)

#R0
boxplot(re_R0[,1], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,2], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,3], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)

#M
boxplot(re_M[,1], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,2], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,3], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)

#Relative error for point estimates
RE_ssb_N5000_Ind25_10yrs_noCKMR<-re_SSB
RE_R0_N5000_Ind25_10yrs_noCKMR<-re_R0
RE_M_N5000_Ind25_10yrs_noCKMR<-re_M

#Interquartile Range of relative errors
IQR_RE_ssb_N5000_Ind25_10yrs_noCKMR<-apply(re_SSB,c(1,3),quantile,probs=0.75, na.rm=TRUE)-apply(re_SSB,c(1,3),quantile,probs=0.25, na.rm=TRUE)
IQR_RE_R0_N5000_Ind25_10yrs_noCKMR<-apply(re_R0,2,quantile,probs=0.75, na.rm=TRUE)-apply(re_R0,2,quantile,probs=0.25, na.rm=TRUE)
IQR_RE_M_N5000_Ind25_10yrs_noCKMR<-apply(re_M,2,quantile,probs=0.75, na.rm=TRUE)-apply(re_M,2,quantile,probs=0.25, na.rm=TRUE)

#Interquartile Range of absolute relative errors
IQR_ARE_ssb_N5000_Ind25_10yrs_noCKMR<-apply(abs(re_SSB),c(1,3),quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_SSB),c(1,3),quantile,probs=0.25, na.rm=TRUE)
IQR_ARE_R0_N5000_Ind25_10yrs_noCKMR<-apply(abs(re_R0),2,quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_R0),2,quantile,probs=0.25, na.rm=TRUE)
IQR_ARE_M_N5000_Ind25_10yrs_noCKMR<-apply(abs(re_M),2,quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_M),2,quantile,probs=0.25, na.rm=TRUE)

#SD of relative error for point estimates
sd_RE_ssb_N5000_Ind25_10yrs_noCKMR<-apply(re_SSB,c(1,3),sd, na.rm=TRUE)
sd_RE_R0_N5000_Ind25_10yrs_noCKMR<-apply(re_R0,2,sd, na.rm=TRUE)
sd_RE_M_N5000_Ind25_10yrs_noCKMR<-apply(re_M,2,sd, na.rm=TRUE)

#SD of absolute relative error
sd_ARE_ssb_N5000_Ind25_10yrs_noCKMR<-apply(abs(re_SSB),c(1,3),sd, na.rm=TRUE)
sd_ARE_R0_N5000_Ind25_10yrs_noCKMR<-apply(abs(re_R0),2,sd, na.rm=TRUE)
sd_ARE_M_N5000_Ind25_10yrs_noCKMR<-apply(abs(re_M),2,sd, na.rm=TRUE)

#Precision within sims
SD_ssb_N5000_Ind25_10yrs_noCKMR<-CV_ssb_N5000_Ind25_10yrs_noCKMR<-array(NA, dim=c(3,100,76)) 
SD_R0_N5000_Ind25_10yrs_noCKMR<-matrix(NA, nrow=3, ncol=100)
SD_M_N5000_Ind25_10yrs_noCKMR<-matrix(NA, nrow=3, ncol=100)
for(f in 1:3){
  for (i in 1:100){
    if(length(res_list[[f]][[i]])>2){
      CV_ssb_N5000_Ind25_10yrs_noCKMR[f,i,]<-res_list[[f]][[i]]$SD$sd/res_list[[f]][[i]]$SD$value
    SD_ssb_N5000_Ind25_10yrs_noCKMR[f,i,]<-res_list[[f]][[i]]$SD$sd
    SD_R0_N5000_Ind25_10yrs_noCKMR[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_R0","log_R0"])
    SD_M_N5000_Ind25_10yrs_noCKMR[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_M","log_M"])
    }
  }
}

#N100 for 10yrs and index sd 0.50
res_list<-list()
res_list[[1]]<-readRDS(paste0(wd,"/SCAAfit_Cod_N100_Ind50_10yrs_noCKMR.RData"))
res_list[[2]]<-readRDS(paste0(wd,"/SCAAfit_Flatfish_N100_Ind50_10yrs_noCKMR.RData"))
res_list[[3]]<-readRDS(paste0(wd,"/SCAAfit_Sardine_N100_Ind50_10yrs_noCKMR.RData"))

Cod_wdat<-Cod_100_50_10
Flatfish_wdat<-Flatfish_100_50_10
Sardine_wdat<-Sardine_100_50_10

re_Dep<-re_SSB<-array(NA, dim=c(3,100,76))
re_R0<-re_M<-matrix(NA, nrow=100, ncol=3)
for(f in 1:3){
  for (i in 1:100){
    if(f==1){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Cod_wdat[[i]]$OM$SSB[26:101])/Cod_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Cod_wdat[[i]]$OM$R0)/Cod_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Cod_wdat[[i]]$OM$Mref)/Cod_wdat[[i]]$OM$Mref
      }
    }else if (f==2){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Flatfish_wdat[[i]]$OM$SSB[26:101])/Flatfish_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Flatfish_wdat[[i]]$OM$R0)/Flatfish_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Flatfish_wdat[[i]]$OM$Mref)/Flatfish_wdat[[i]]$OM$Mref
      }
    } else if (f==3){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Sardine_wdat[[i]]$OM$SSB[26:101])/Sardine_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Sardine_wdat[[i]]$OM$R0)/Sardine_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Sardine_wdat[[i]]$OM$Mref)/Sardine_wdat[[i]]$OM$Mref
      }
    }
  }
}

#SSB
par(mfrow=c(3,3))
boxplot(re_SSB[1,,], ylim=c(-0.25,0.25), las=1, main="Cod - N100, Index SD - 0.50, No CKMR", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[2,,], ylim=c(-0.25,0.25), las=1, main="Flatfish - N100, Index SD - 0.50, No CKMR", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[3,,], ylim=c(-0.25,0.25), las=1, main="Sardine - N100, Index SD - 0.50, No CKMR", ylab="RE - SSB")
abline(h=0)

#R0
boxplot(re_R0[,1], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,2], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,3], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)

#M
boxplot(re_M[,1], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,2], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,3], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)

#Relative error for point estimates
RE_ssb_N100_Ind50_10yrs_noCKMR<-re_SSB
RE_R0_N100_Ind50_10yrs_noCKMR<-re_R0
RE_M_N100_Ind50_10yrs_noCKMR<-re_M

#Interquartile Range of relative errors
IQR_RE_ssb_N100_Ind50_10yrs_noCKMR<-apply(re_SSB,c(1,3),quantile,probs=0.75, na.rm=TRUE)-apply(re_SSB,c(1,3),quantile,probs=0.25, na.rm=TRUE)
IQR_RE_R0_N100_Ind50_10yrs_noCKMR<-apply(re_R0,2,quantile,probs=0.75, na.rm=TRUE)-apply(re_R0,2,quantile,probs=0.25, na.rm=TRUE)
IQR_RE_M_N100_Ind50_10yrs_noCKMR<-apply(re_M,2,quantile,probs=0.75, na.rm=TRUE)-apply(re_M,2,quantile,probs=0.25, na.rm=TRUE)

#Interquartile Range of absolute relative errors
IQR_ARE_ssb_N100_Ind50_10yrs_noCKMR<-apply(abs(re_SSB),c(1,3),quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_SSB),c(1,3),quantile,probs=0.25, na.rm=TRUE)
IQR_ARE_R0_N100_Ind50_10yrs_noCKMR<-apply(abs(re_R0),2,quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_R0),2,quantile,probs=0.25, na.rm=TRUE)
IQR_ARE_M_N100_Ind50_10yrs_noCKMR<-apply(abs(re_M),2,quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_M),2,quantile,probs=0.25, na.rm=TRUE)

#SD of relative error for point estimates
sd_RE_ssb_N100_Ind50_10yrs_noCKMR<-apply(re_SSB,c(1,3),sd, na.rm=TRUE)
sd_RE_R0_N100_Ind50_10yrs_noCKMR<-apply(re_R0,2,sd, na.rm=TRUE)
sd_RE_M_N100_Ind50_10yrs_noCKMR<-apply(re_M,2,sd, na.rm=TRUE)

#SD of absolute relative error
sd_ARE_ssb_N100_Ind50_10yrs_noCKMR<-apply(abs(re_SSB),c(1,3),sd, na.rm=TRUE)
sd_ARE_R0_N100_Ind50_10yrs_noCKMR<-apply(abs(re_R0),2,sd, na.rm=TRUE)
sd_ARE_M_N100_Ind50_10yrs_noCKMR<-apply(abs(re_M),2,sd, na.rm=TRUE)

#Precision within sims
SD_ssb_N100_Ind50_10yrs_noCKMR<-CV_ssb_N100_Ind50_10yrs_noCKMR<-array(NA, dim=c(3,100,76)) 
SD_R0_N100_Ind50_10yrs_noCKMR<-matrix(NA, nrow=3, ncol=100)
SD_M_N100_Ind50_10yrs_noCKMR<-matrix(NA, nrow=3, ncol=100)
for(f in 1:3){
  for (i in 1:100){
    if(length(res_list[[f]][[i]])>2){
      CV_ssb_N100_Ind50_10yrs_noCKMR[f,i,]<-res_list[[f]][[i]]$SD$sd/res_list[[f]][[i]]$SD$value
    SD_ssb_N100_Ind50_10yrs_noCKMR[f,i,]<-res_list[[f]][[i]]$SD$sd
    SD_R0_N100_Ind50_10yrs_noCKMR[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_R0","log_R0"])
    SD_M_N100_Ind50_10yrs_noCKMR[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_M","log_M"])
    }
  }
}

#N1000 for 10yrs, sd index 0.50
res_list[[1]]<-readRDS(paste0(wd,"/SCAAfit_Cod_N1000_Ind50_10yrs_noCKMR.RData"))
res_list[[2]]<-readRDS(paste0(wd,"/SCAAfit_Flatfish_N1000_Ind50_10yrs_noCKMR.RData"))
res_list[[3]]<-readRDS(paste0(wd,"/SCAAfit_Sardine_N1000_Ind50_10yrs_noCKMR.RData"))

Cod_wdat<-Cod_1000_50_10
Flatfish_wdat<-Flatfish_1000_50_10
Sardine_wdat<-Sardine_1000_50_10

re_Dep<-re_SSB<-array(NA, dim=c(3,100,76))
re_R0<-re_M<-matrix(NA, nrow=100, ncol=3)
for(f in 1:3){
  for (i in 1:100){
    if(f==1){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Cod_wdat[[i]]$OM$SSB[26:101])/Cod_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Cod_wdat[[i]]$OM$R0)/Cod_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Cod_wdat[[i]]$OM$Mref)/Cod_wdat[[i]]$OM$Mref
      }
    }else if (f==2){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Flatfish_wdat[[i]]$OM$SSB[26:101])/Flatfish_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Flatfish_wdat[[i]]$OM$R0)/Flatfish_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Flatfish_wdat[[i]]$OM$Mref)/Flatfish_wdat[[i]]$OM$Mref
      }
    } else if (f==3){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Sardine_wdat[[i]]$OM$SSB[26:101])/Sardine_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Sardine_wdat[[i]]$OM$R0)/Sardine_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Sardine_wdat[[i]]$OM$Mref)/Sardine_wdat[[i]]$OM$Mref
      }
    }
  }
}

#SSB
par(mfrow=c(3,3))
boxplot(re_SSB[1,,], ylim=c(-0.25,0.25), las=1, main="Cod - N1000|10yrs, Index SD - 0.50, No CKMR", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[2,,], ylim=c(-0.25,0.25), las=1, main="Flatfish - N1000|10yrs, Index SD - 0.50, No CKMR", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[3,,], ylim=c(-0.25,0.25), las=1, main="Sardine - N1000|10yrs, Index SD - 0.50, No CKMR", ylab="RE - SSB")
abline(h=0)

#R0
boxplot(re_R0[,1], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,2], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,3], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)

#M
boxplot(re_M[,1], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,2], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,3], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)

#Relative error for point estimates
RE_ssb_N1000_Ind50_10yrs_noCKMR<-re_SSB
RE_R0_N1000_Ind50_10yrs_noCKMR<-re_R0
RE_M_N1000_Ind50_10yrs_noCKMR<-re_M

#Interquartile Range of relative errors
IQR_RE_ssb_N1000_Ind50_10yrs_noCKMR<-apply(re_SSB,c(1,3),quantile,probs=0.75, na.rm=TRUE)-apply(re_SSB,c(1,3),quantile,probs=0.25, na.rm=TRUE)
IQR_RE_R0_N1000_Ind50_10yrs_noCKMR<-apply(re_R0,2,quantile,probs=0.75, na.rm=TRUE)-apply(re_R0,2,quantile,probs=0.25, na.rm=TRUE)
IQR_RE_M_N1000_Ind50_10yrs_noCKMR<-apply(re_M,2,quantile,probs=0.75, na.rm=TRUE)-apply(re_M,2,quantile,probs=0.25, na.rm=TRUE)

#Interquartile Range of absolute relative errors
IQR_ARE_ssb_N1000_Ind50_10yrs_noCKMR<-apply(abs(re_SSB),c(1,3),quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_SSB),c(1,3),quantile,probs=0.25, na.rm=TRUE)
IQR_ARE_R0_N1000_Ind50_10yrs_noCKMR<-apply(abs(re_R0),2,quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_R0),2,quantile,probs=0.25, na.rm=TRUE)
IQR_ARE_M_N1000_Ind50_10yrs_noCKMR<-apply(abs(re_M),2,quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_M),2,quantile,probs=0.25, na.rm=TRUE)

#SD of relative error for point estimates
sd_RE_ssb_N1000_Ind50_10yrs_noCKMR<-apply(re_SSB,c(1,3),sd, na.rm=TRUE)
sd_RE_R0_N1000_Ind50_10yrs_noCKMR<-apply(re_R0,2,sd, na.rm=TRUE)
sd_RE_M_N1000_Ind50_10yrs_noCKMR<-apply(re_M,2,sd, na.rm=TRUE)

#SD of absolute relative error
sd_ARE_ssb_N1000_Ind50_10yrs_noCKMR<-apply(abs(re_SSB),c(1,3),sd, na.rm=TRUE)
sd_ARE_R0_N1000_Ind50_10yrs_noCKMR<-apply(abs(re_R0),2,sd, na.rm=TRUE)
sd_ARE_M_N1000_Ind50_10yrs_noCKMR<-apply(abs(re_M),2,sd, na.rm=TRUE)

#Precision within sims
SD_ssb_N1000_Ind50_10yrs_noCKMR<-CV_ssb_N1000_Ind50_10yrs_noCKMR<-array(NA, dim=c(3,100,76)) 
SD_R0_N1000_Ind50_10yrs_noCKMR<-matrix(NA, nrow=3, ncol=100)
SD_M_N1000_Ind50_10yrs_noCKMR<-matrix(NA, nrow=3, ncol=100)
for(f in 1:3){
  for (i in 1:100){
    if(length(res_list[[f]][[i]])>2){
      CV_ssb_N1000_Ind50_10yrs_noCKMR[f,i,]<-res_list[[f]][[i]]$SD$sd/res_list[[f]][[i]]$SD$value
    SD_ssb_N1000_Ind50_10yrs_noCKMR[f,i,]<-res_list[[f]][[i]]$SD$sd
    SD_R0_N1000_Ind50_10yrs_noCKMR[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_R0","log_R0"])
    SD_M_N1000_Ind50_10yrs_noCKMR[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_M","log_M"])
    }
  }
}

#N5000 for 10yrs, sd index 0.50
res_list[[1]]<-readRDS(paste0(wd,"/SCAAfit_Cod_N5000_Ind50_10yrs_noCKMR.RData"))
res_list[[2]]<-readRDS(paste0(wd,"/SCAAfit_Flatfish_N5000_Ind50_10yrs_noCKMR.RData"))
res_list[[3]]<-readRDS(paste0(wd,"/SCAAfit_Sardine_N5000_Ind50_10yrs_noCKMR.RData"))

Cod_wdat<-Cod_5000_50_10
Flatfish_wdat<-Flatfish_5000_50_10
Sardine_wdat<-Sardine_5000_50_10

re_Dep<-re_SSB<-array(NA, dim=c(3,100,76))
re_R0<-re_M<-matrix(NA, nrow=100, ncol=3)
for(f in 1:3){
  for (i in 1:100){
    if(f==1){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Cod_wdat[[i]]$OM$SSB[26:101])/Cod_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Cod_wdat[[i]]$OM$R0)/Cod_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Cod_wdat[[i]]$OM$Mref)/Cod_wdat[[i]]$OM$Mref
      }
    }else if (f==2){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Flatfish_wdat[[i]]$OM$SSB[26:101])/Flatfish_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Flatfish_wdat[[i]]$OM$R0)/Flatfish_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Flatfish_wdat[[i]]$OM$Mref)/Flatfish_wdat[[i]]$OM$Mref
      }
    } else if (f==3){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Sardine_wdat[[i]]$OM$SSB[26:101])/Sardine_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Sardine_wdat[[i]]$OM$R0)/Sardine_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Sardine_wdat[[i]]$OM$Mref)/Sardine_wdat[[i]]$OM$Mref
      }
    }
  }
}

#SSB
par(mfrow=c(3,3))
boxplot(re_SSB[1,,], ylim=c(-0.25,0.25), las=1, main="Cod - N5000|10yrs, Index SD - 0.50, No CKMR", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[2,,], ylim=c(-0.25,0.25), las=1, main="Flatfish - N5000|10yrs, Index SD - 0.50, No CKMR", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[3,,], ylim=c(-0.25,0.25), las=1, main="Sardine - N5000|10yrs, Index SD - 0.50, No CKMR", ylab="RE - SSB")
abline(h=0)

#R0
boxplot(re_R0[,1], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,2], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,3], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)

#M
boxplot(re_M[,1], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,2], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,3], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)

#Relative error for point estimates
RE_ssb_N5000_Ind50_10yrs_noCKMR<-re_SSB
RE_R0_N5000_Ind50_10yrs_noCKMR<-re_R0
RE_M_N5000_Ind50_10yrs_noCKMR<-re_M

#Interquartile Range of relative errors
IQR_RE_ssb_N5000_Ind50_10yrs_noCKMR<-apply(re_SSB,c(1,3),quantile,probs=0.75, na.rm=TRUE)-apply(re_SSB,c(1,3),quantile,probs=0.25, na.rm=TRUE)
IQR_RE_R0_N5000_Ind50_10yrs_noCKMR<-apply(re_R0,2,quantile,probs=0.75, na.rm=TRUE)-apply(re_R0,2,quantile,probs=0.25, na.rm=TRUE)
IQR_RE_M_N5000_Ind50_10yrs_noCKMR<-apply(re_M,2,quantile,probs=0.75, na.rm=TRUE)-apply(re_M,2,quantile,probs=0.25, na.rm=TRUE)

#Interquartile Range of absolute relative errors
IQR_ARE_ssb_N5000_Ind50_10yrs_noCKMR<-apply(abs(re_SSB),c(1,3),quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_SSB),c(1,3),quantile,probs=0.25, na.rm=TRUE)
IQR_ARE_R0_N5000_Ind50_10yrs_noCKMR<-apply(abs(re_R0),2,quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_R0),2,quantile,probs=0.25, na.rm=TRUE)
IQR_ARE_M_N5000_Ind50_10yrs_noCKMR<-apply(abs(re_M),2,quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_M),2,quantile,probs=0.25, na.rm=TRUE)

#SD of relative error for point estimates
sd_RE_ssb_N5000_Ind50_10yrs_noCKMR<-apply(re_SSB,c(1,3),sd, na.rm=TRUE)
sd_RE_R0_N5000_Ind50_10yrs_noCKMR<-apply(re_R0,2,sd, na.rm=TRUE)
sd_RE_M_N5000_Ind50_10yrs_noCKMR<-apply(re_M,2,sd, na.rm=TRUE)

#SD of absolute relative error
sd_ARE_ssb_N5000_Ind50_10yrs_noCKMR<-apply(abs(re_SSB),c(1,3),sd, na.rm=TRUE)
sd_ARE_R0_N5000_Ind50_10yrs_noCKMR<-apply(abs(re_R0),2,sd, na.rm=TRUE)
sd_ARE_M_N5000_Ind50_10yrs_noCKMR<-apply(abs(re_M),2,sd, na.rm=TRUE)

#Precision within sims
SD_ssb_N5000_Ind50_10yrs_noCKMR<-CV_ssb_N5000_Ind50_10yrs_noCKMR<-array(NA, dim=c(3,100,76)) 
SD_R0_N5000_Ind50_10yrs_noCKMR<-matrix(NA, nrow=3, ncol=100)
SD_M_N5000_Ind50_10yrs_noCKMR<-matrix(NA, nrow=3, ncol=100)
for(f in 1:3){
  for (i in 1:100){
    if(length(res_list[[f]][[i]])>2){
      CV_ssb_N5000_Ind50_10yrs_noCKMR[f,i,]<-res_list[[f]][[i]]$SD$sd/res_list[[f]][[i]]$SD$value
    SD_ssb_N5000_Ind50_10yrs_noCKMR[f,i,]<-res_list[[f]][[i]]$SD$sd
    SD_R0_N5000_Ind50_10yrs_noCKMR[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_R0","log_R0"])
    SD_M_N5000_Ind50_10yrs_noCKMR[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_M","log_M"])
    }
  }
}

#########
#20 years
#########

#N100 for 20yrs, and index sd 0.25
res_list<-list()
res_list[[1]]<-readRDS(paste0(wd,"/SCAAfit_Cod_N100_Ind25_20yrs_noCKMR.RData"))
res_list[[2]]<-readRDS(paste0(wd,"/SCAAfit_Flatfish_N100_Ind25_20yrs_noCKMR.RData"))
res_list[[3]]<-readRDS(paste0(wd,"/SCAAfit_Sardine_N100_Ind25_20yrs_noCKMR.RData"))

Cod_wdat<-Cod_100_25_20
Flatfish_wdat<-Flatfish_100_25_20
Sardine_wdat<-Sardine_100_25_20

re_Dep<-re_SSB<-array(NA, dim=c(3,100,76))
re_R0<-re_M<-matrix(NA, nrow=100, ncol=3)
for(f in 1:3){
  for (i in 1:100){
    if(f==1){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Cod_wdat[[i]]$OM$SSB[26:101])/Cod_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Cod_wdat[[i]]$OM$R0)/Cod_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Cod_wdat[[i]]$OM$Mref)/Cod_wdat[[i]]$OM$Mref
      }
    }else if (f==2){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Flatfish_wdat[[i]]$OM$SSB[26:101])/Flatfish_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Flatfish_wdat[[i]]$OM$R0)/Flatfish_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Flatfish_wdat[[i]]$OM$Mref)/Flatfish_wdat[[i]]$OM$Mref
      }
    } else if (f==3){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Sardine_wdat[[i]]$OM$SSB[26:101])/Sardine_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Sardine_wdat[[i]]$OM$R0)/Sardine_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Sardine_wdat[[i]]$OM$Mref)/Sardine_wdat[[i]]$OM$Mref
      }
    }
  }
}

#SSB
par(mfrow=c(3,3))
boxplot(re_SSB[1,,], ylim=c(-0.25,0.25), las=1, main="Cod - N100, Index SD - 0.25, No CKMR", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[2,,], ylim=c(-0.25,0.25), las=1, main="Flatfish - N100, Index SD - 0.25, No CKMR", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[3,,], ylim=c(-0.25,0.25), las=1, main="Sardine - N100, Index SD - 0.25, No CKMR", ylab="RE - SSB")
abline(h=0)

#R0
boxplot(re_R0[,1], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,2], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,3], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)

#M
boxplot(re_M[,1], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,2], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,3], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)

#Relative error for point estimates
RE_ssb_N100_Ind25_20yrs_noCKMR<-re_SSB
RE_R0_N100_Ind25_20yrs_noCKMR<-re_R0
RE_M_N100_Ind25_20yrs_noCKMR<-re_M

#Interquartile Range of relative errors
IQR_RE_ssb_N100_Ind25_20yrs_noCKMR<-apply(re_SSB,c(1,3),quantile,probs=0.75, na.rm=TRUE)-apply(re_SSB,c(1,3),quantile,probs=0.25, na.rm=TRUE)
IQR_RE_R0_N100_Ind25_20yrs_noCKMR<-apply(re_R0,2,quantile,probs=0.75, na.rm=TRUE)-apply(re_R0,2,quantile,probs=0.25, na.rm=TRUE)
IQR_RE_M_N100_Ind25_20yrs_noCKMR<-apply(re_M,2,quantile,probs=0.75, na.rm=TRUE)-apply(re_M,2,quantile,probs=0.25, na.rm=TRUE)

#Interquartile Range of absolute relative errors
IQR_ARE_ssb_N100_Ind25_20yrs_noCKMR<-apply(abs(re_SSB),c(1,3),quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_SSB),c(1,3),quantile,probs=0.25, na.rm=TRUE)
IQR_ARE_R0_N100_Ind25_20yrs_noCKMR<-apply(abs(re_R0),2,quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_R0),2,quantile,probs=0.25, na.rm=TRUE)
IQR_ARE_M_N100_Ind25_20yrs_noCKMR<-apply(abs(re_M),2,quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_M),2,quantile,probs=0.25, na.rm=TRUE)

#SD of relative error for point estimates
sd_RE_ssb_N100_Ind25_20yrs_noCKMR<-apply(re_SSB,c(1,3),sd, na.rm=TRUE)
sd_RE_R0_N100_Ind25_20yrs_noCKMR<-apply(re_R0,2,sd, na.rm=TRUE)
sd_RE_M_N100_Ind25_20yrs_noCKMR<-apply(re_M,2,sd, na.rm=TRUE)

#SD of absolute relative error
sd_ARE_ssb_N100_Ind25_20yrs_noCKMR<-apply(abs(re_SSB),c(1,3),sd, na.rm=TRUE)
sd_ARE_R0_N100_Ind25_20yrs_noCKMR<-apply(abs(re_R0),2,sd, na.rm=TRUE)
sd_ARE_M_N100_Ind25_20yrs_noCKMR<-apply(abs(re_M),2,sd, na.rm=TRUE)

#Precision within sims
SD_ssb_N100_Ind25_20yrs_noCKMR<-CV_ssb_N100_Ind25_20yrs_noCKMR<-array(NA, dim=c(3,100,76)) 
SD_R0_N100_Ind25_20yrs_noCKMR<-matrix(NA, nrow=3, ncol=100)
SD_M_N100_Ind25_20yrs_noCKMR<-matrix(NA, nrow=3, ncol=100)
for(f in 1:3){
  for (i in 1:100){
    if(length(res_list[[f]][[i]])>2){
      CV_ssb_N100_Ind25_20yrs_noCKMR[f,i,]<-res_list[[f]][[i]]$SD$sd/res_list[[f]][[i]]$SD$value
    SD_ssb_N100_Ind25_20yrs_noCKMR[f,i,]<-res_list[[f]][[i]]$SD$sd
    SD_R0_N100_Ind25_20yrs_noCKMR[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_R0","log_R0"])
    SD_M_N100_Ind25_20yrs_noCKMR[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_M","log_M"])
    }
  }
}

#N1000 for 20yrs, sd index 0.25
res_list[[1]]<-readRDS(paste0(wd,"/SCAAfit_Cod_N1000_Ind25_20yrs_noCKMR.RData"))
res_list[[2]]<-readRDS(paste0(wd,"/SCAAfit_Flatfish_N1000_Ind25_20yrs_noCKMR.RData"))
res_list[[3]]<-readRDS(paste0(wd,"/SCAAfit_Sardine_N1000_Ind25_20yrs_noCKMR.RData"))

Cod_wdat<-Cod_1000_25_20
Flatfish_wdat<-Flatfish_1000_25_20
Sardine_wdat<-Sardine_1000_25_20

re_Dep<-re_SSB<-array(NA, dim=c(3,100,76))
re_R0<-re_M<-matrix(NA, nrow=100, ncol=3)
for(f in 1:3){
  for (i in 1:100){
    if(f==1){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Cod_wdat[[i]]$OM$SSB[26:101])/Cod_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Cod_wdat[[i]]$OM$R0)/Cod_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Cod_wdat[[i]]$OM$Mref)/Cod_wdat[[i]]$OM$Mref
      }
    }else if (f==2){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Flatfish_wdat[[i]]$OM$SSB[26:101])/Flatfish_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Flatfish_wdat[[i]]$OM$R0)/Flatfish_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Flatfish_wdat[[i]]$OM$Mref)/Flatfish_wdat[[i]]$OM$Mref
      }
    } else if (f==3){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Sardine_wdat[[i]]$OM$SSB[26:101])/Sardine_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Sardine_wdat[[i]]$OM$R0)/Sardine_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Sardine_wdat[[i]]$OM$Mref)/Sardine_wdat[[i]]$OM$Mref
      }
    }
  }
}

#SSB
par(mfrow=c(3,3))
boxplot(re_SSB[1,,], ylim=c(-0.25,0.25), las=1, main="Cod - N1000|20yrs, Index SD - 0.25, No CKMR", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[2,,], ylim=c(-0.25,0.25), las=1, main="Flatfish - N1000|20yrs, Index SD - 0.25, No CKMR", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[3,,], ylim=c(-0.25,0.25), las=1, main="Sardine - N1000|20yrs, Index SD - 0.25, No CKMR", ylab="RE - SSB")
abline(h=0)

#R0
boxplot(re_R0[,1], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,2], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,3], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)

#M
boxplot(re_M[,1], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,2], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,3], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)

#Relative error for point estimates
RE_ssb_N1000_Ind25_20yrs_noCKMR<-re_SSB
RE_R0_N1000_Ind25_20yrs_noCKMR<-re_R0
RE_M_N1000_Ind25_20yrs_noCKMR<-re_M

#Interquartile Range of relative errors
IQR_RE_ssb_N1000_Ind25_20yrs_noCKMR<-apply(re_SSB,c(1,3),quantile,probs=0.75, na.rm=TRUE)-apply(re_SSB,c(1,3),quantile,probs=0.25, na.rm=TRUE)
IQR_RE_R0_N1000_Ind25_20yrs_noCKMR<-apply(re_R0,2,quantile,probs=0.75, na.rm=TRUE)-apply(re_R0,2,quantile,probs=0.25, na.rm=TRUE)
IQR_RE_M_N1000_Ind25_20yrs_noCKMR<-apply(re_M,2,quantile,probs=0.75, na.rm=TRUE)-apply(re_M,2,quantile,probs=0.25, na.rm=TRUE)

#Interquartile Range of absolute relative errors
IQR_ARE_ssb_N1000_Ind25_20yrs_noCKMR<-apply(abs(re_SSB),c(1,3),quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_SSB),c(1,3),quantile,probs=0.25, na.rm=TRUE)
IQR_ARE_R0_N1000_Ind25_20yrs_noCKMR<-apply(abs(re_R0),2,quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_R0),2,quantile,probs=0.25, na.rm=TRUE)
IQR_ARE_M_N1000_Ind25_20yrs_noCKMR<-apply(abs(re_M),2,quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_M),2,quantile,probs=0.25, na.rm=TRUE)

#SD of relative error for point estimates
sd_RE_ssb_N1000_Ind25_20yrs_noCKMR<-apply(re_SSB,c(1,3),sd, na.rm=TRUE)
sd_RE_R0_N1000_Ind25_20yrs_noCKMR<-apply(re_R0,2,sd, na.rm=TRUE)
sd_RE_M_N1000_Ind25_20yrs_noCKMR<-apply(re_M,2,sd, na.rm=TRUE)

#SD of absolute relative error
sd_ARE_ssb_N1000_Ind25_20yrs_noCKMR<-apply(abs(re_SSB),c(1,3),sd, na.rm=TRUE)
sd_ARE_R0_N1000_Ind25_20yrs_noCKMR<-apply(abs(re_R0),2,sd, na.rm=TRUE)
sd_ARE_M_N1000_Ind25_20yrs_noCKMR<-apply(abs(re_M),2,sd, na.rm=TRUE)

#Precision within sims
SD_ssb_N1000_Ind25_20yrs_noCKMR<-CV_ssb_N1000_Ind25_20yrs_noCKMR<-array(NA, dim=c(3,100,76)) 
SD_R0_N1000_Ind25_20yrs_noCKMR<-matrix(NA, nrow=3, ncol=100)
SD_M_N1000_Ind25_20yrs_noCKMR<-matrix(NA, nrow=3, ncol=100)
for(f in 1:3){
  for (i in 1:100){
    if(length(res_list[[f]][[i]])>2){
      CV_ssb_N1000_Ind25_20yrs_noCKMR[f,i,]<-res_list[[f]][[i]]$SD$sd/res_list[[f]][[i]]$SD$value
    SD_ssb_N1000_Ind25_20yrs_noCKMR[f,i,]<-res_list[[f]][[i]]$SD$sd
    SD_R0_N1000_Ind25_20yrs_noCKMR[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_R0","log_R0"])
    SD_M_N1000_Ind25_20yrs_noCKMR[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_M","log_M"])
    }
  }
}

#N5000 for 20yrs, sd index 0.25
res_list<-list()
res_list[[1]]<-readRDS(paste0(wd,"/SCAAfit_Cod_N5000_Ind25_20yrs_noCKMR.RData"))
res_list[[2]]<-readRDS(paste0(wd,"/SCAAfit_Flatfish_N5000_Ind25_20yrs_noCKMR.RData"))
res_list[[3]]<-readRDS(paste0(wd,"/SCAAfit_Sardine_N5000_Ind25_20yrs_noCKMR.RData"))

Cod_wdat<-Cod_5000_25_20
Flatfish_wdat<-Flatfish_5000_25_20
Sardine_wdat<-Sardine_5000_25_20

re_Dep<-re_SSB<-array(NA, dim=c(3,100,76))
re_R0<-re_M<-matrix(NA, nrow=100, ncol=3)
for(f in 1:3){
  for (i in 1:100){
    if(f==1){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Cod_wdat[[i]]$OM$SSB[26:101])/Cod_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Cod_wdat[[i]]$OM$R0)/Cod_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Cod_wdat[[i]]$OM$Mref)/Cod_wdat[[i]]$OM$Mref
      }
    }else if (f==2){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Flatfish_wdat[[i]]$OM$SSB[26:101])/Flatfish_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Flatfish_wdat[[i]]$OM$R0)/Flatfish_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Flatfish_wdat[[i]]$OM$Mref)/Flatfish_wdat[[i]]$OM$Mref
      }
    } else if (f==3){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Sardine_wdat[[i]]$OM$SSB[26:101])/Sardine_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Sardine_wdat[[i]]$OM$R0)/Sardine_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Sardine_wdat[[i]]$OM$Mref)/Sardine_wdat[[i]]$OM$Mref
      }
    }
  }
}

#SSB
par(mfrow=c(3,3))
boxplot(re_SSB[1,,], ylim=c(-0.25,0.25), las=1, main="Cod - N5000|20yrs, Index SD - 0.25, No CKMR", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[2,,], ylim=c(-0.25,0.25), las=1, main="Flatfish - N5000|20yrs, Index SD - 0.25, No CKMR", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[3,,], ylim=c(-0.25,0.25), las=1, main="Sardine - N5000|20yrs, Index SD - 0.25, No CKMR", ylab="RE - SSB")
abline(h=0)

#R0
boxplot(re_R0[,1], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,2], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,3], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)

#M
boxplot(re_M[,1], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,2], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,3], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)

#Relative error for point estimates
RE_ssb_N5000_Ind25_20yrs_noCKMR<-re_SSB
RE_R0_N5000_Ind25_20yrs_noCKMR<-re_R0
RE_M_N5000_Ind25_20yrs_noCKMR<-re_M

#Interquartile Range of relative errors
IQR_RE_ssb_N5000_Ind25_20yrs_noCKMR<-apply(re_SSB,c(1,3),quantile,probs=0.75, na.rm=TRUE)-apply(re_SSB,c(1,3),quantile,probs=0.25, na.rm=TRUE)
IQR_RE_R0_N5000_Ind25_20yrs_noCKMR<-apply(re_R0,2,quantile,probs=0.75, na.rm=TRUE)-apply(re_R0,2,quantile,probs=0.25, na.rm=TRUE)
IQR_RE_M_N5000_Ind25_20yrs_noCKMR<-apply(re_M,2,quantile,probs=0.75, na.rm=TRUE)-apply(re_M,2,quantile,probs=0.25, na.rm=TRUE)

#Interquartile Range of absolute relative errors
IQR_ARE_ssb_N5000_Ind25_20yrs_noCKMR<-apply(abs(re_SSB),c(1,3),quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_SSB),c(1,3),quantile,probs=0.25, na.rm=TRUE)
IQR_ARE_R0_N5000_Ind25_20yrs_noCKMR<-apply(abs(re_R0),2,quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_R0),2,quantile,probs=0.25, na.rm=TRUE)
IQR_ARE_M_N5000_Ind25_20yrs_noCKMR<-apply(abs(re_M),2,quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_M),2,quantile,probs=0.25, na.rm=TRUE)

#SD of relative error for point estimates
sd_RE_ssb_N5000_Ind25_20yrs_noCKMR<-apply(re_SSB,c(1,3),sd, na.rm=TRUE)
sd_RE_R0_N5000_Ind25_20yrs_noCKMR<-apply(re_R0,2,sd, na.rm=TRUE)
sd_RE_M_N5000_Ind25_20yrs_noCKMR<-apply(re_M,2,sd, na.rm=TRUE)

#SD of absolute relative error
sd_ARE_ssb_N5000_Ind25_20yrs_noCKMR<-apply(abs(re_SSB),c(1,3),sd, na.rm=TRUE)
sd_ARE_R0_N5000_Ind25_20yrs_noCKMR<-apply(abs(re_R0),2,sd, na.rm=TRUE)
sd_ARE_M_N5000_Ind25_20yrs_noCKMR<-apply(abs(re_M),2,sd, na.rm=TRUE)

#Precision within sims
SD_ssb_N5000_Ind25_20yrs_noCKMR<-CV_ssb_N5000_Ind25_20yrs_noCKMR<-array(NA, dim=c(3,100,76)) 
SD_R0_N5000_Ind25_20yrs_noCKMR<-matrix(NA, nrow=3, ncol=100)
SD_M_N5000_Ind25_20yrs_noCKMR<-matrix(NA, nrow=3, ncol=100)
for(f in 1:3){
  for (i in 1:100){
    if(length(res_list[[f]][[i]])>2){
      CV_ssb_N5000_Ind25_20yrs_noCKMR[f,i,]<-res_list[[f]][[i]]$SD$sd/res_list[[f]][[i]]$SD$value
    SD_ssb_N5000_Ind25_20yrs_noCKMR[f,i,]<-res_list[[f]][[i]]$SD$sd
    SD_R0_N5000_Ind25_20yrs_noCKMR[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_R0","log_R0"])
    SD_M_N5000_Ind25_20yrs_noCKMR[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_M","log_M"])
    }
  }
}

#N100 for 20yrs and index sd 0.50
res_list<-list()
res_list[[1]]<-readRDS(paste0(wd,"/SCAAfit_Cod_N100_Ind50_20yrs_noCKMR.RData"))
res_list[[2]]<-readRDS(paste0(wd,"/SCAAfit_Flatfish_N100_Ind50_20yrs_noCKMR.RData"))
res_list[[3]]<-readRDS(paste0(wd,"/SCAAfit_Sardine_N100_Ind50_20yrs_noCKMR.RData"))

Cod_wdat<-Cod_100_50_20
Flatfish_wdat<-Flatfish_100_50_20
Sardine_wdat<-Sardine_100_50_20

re_Dep<-re_SSB<-array(NA, dim=c(3,100,76))
re_R0<-re_M<-matrix(NA, nrow=100, ncol=3)
for(f in 1:3){
  for (i in 1:100){
    if(f==1){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Cod_wdat[[i]]$OM$SSB[26:101])/Cod_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Cod_wdat[[i]]$OM$R0)/Cod_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Cod_wdat[[i]]$OM$Mref)/Cod_wdat[[i]]$OM$Mref
      }
    }else if (f==2){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Flatfish_wdat[[i]]$OM$SSB[26:101])/Flatfish_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Flatfish_wdat[[i]]$OM$R0)/Flatfish_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Flatfish_wdat[[i]]$OM$Mref)/Flatfish_wdat[[i]]$OM$Mref
      }
    } else if (f==3){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Sardine_wdat[[i]]$OM$SSB[26:101])/Sardine_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Sardine_wdat[[i]]$OM$R0)/Sardine_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Sardine_wdat[[i]]$OM$Mref)/Sardine_wdat[[i]]$OM$Mref
      }
    }
  }
}

#SSB
par(mfrow=c(3,3))
boxplot(re_SSB[1,,], ylim=c(-0.25,0.25), las=1, main="Cod - N100, Index SD - 0.50, No CKMR", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[2,,], ylim=c(-0.25,0.25), las=1, main="Flatfish - N100, Index SD - 0.50, No CKMR", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[3,,], ylim=c(-0.25,0.25), las=1, main="Sardine - N100, Index SD - 0.50, No CKMR", ylab="RE - SSB")
abline(h=0)

#R0
boxplot(re_R0[,1], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,2], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,3], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)

#M
boxplot(re_M[,1], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,2], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,3], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)

#Relative error for point estimates
RE_ssb_N100_Ind50_20yrs_noCKMR<-re_SSB
RE_R0_N100_Ind50_20yrs_noCKMR<-re_R0
RE_M_N100_Ind50_20yrs_noCKMR<-re_M

#Interquartile Range of relative errors
IQR_RE_ssb_N100_Ind50_20yrs_noCKMR<-apply(re_SSB,c(1,3),quantile,probs=0.75, na.rm=TRUE)-apply(re_SSB,c(1,3),quantile,probs=0.25, na.rm=TRUE)
IQR_RE_R0_N100_Ind50_20yrs_noCKMR<-apply(re_R0,2,quantile,probs=0.75, na.rm=TRUE)-apply(re_R0,2,quantile,probs=0.25, na.rm=TRUE)
IQR_RE_M_N100_Ind50_20yrs_noCKMR<-apply(re_M,2,quantile,probs=0.75, na.rm=TRUE)-apply(re_M,2,quantile,probs=0.25, na.rm=TRUE)

#Interquartile Range of absolute relative errors
IQR_ARE_ssb_N100_Ind50_20yrs_noCKMR<-apply(abs(re_SSB),c(1,3),quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_SSB),c(1,3),quantile,probs=0.25, na.rm=TRUE)
IQR_ARE_R0_N100_Ind50_20yrs_noCKMR<-apply(abs(re_R0),2,quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_R0),2,quantile,probs=0.25, na.rm=TRUE)
IQR_ARE_M_N100_Ind50_20yrs_noCKMR<-apply(abs(re_M),2,quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_M),2,quantile,probs=0.25, na.rm=TRUE)

#SD of relative error for point estimates
sd_RE_ssb_N100_Ind50_20yrs_noCKMR<-apply(re_SSB,c(1,3),sd, na.rm=TRUE)
sd_RE_R0_N100_Ind50_20yrs_noCKMR<-apply(re_R0,2,sd, na.rm=TRUE)
sd_RE_M_N100_Ind50_20yrs_noCKMR<-apply(re_M,2,sd, na.rm=TRUE)

#SD of absolute relative error
sd_ARE_ssb_N100_Ind50_20yrs_noCKMR<-apply(abs(re_SSB),c(1,3),sd, na.rm=TRUE)
sd_ARE_R0_N100_Ind50_20yrs_noCKMR<-apply(abs(re_R0),2,sd, na.rm=TRUE)
sd_ARE_M_N100_Ind50_20yrs_noCKMR<-apply(abs(re_M),2,sd, na.rm=TRUE)

#Precision within sims
SD_ssb_N100_Ind50_20yrs_noCKMR<-CV_ssb_N100_Ind50_20yrs_noCKMR<-array(NA, dim=c(3,100,76)) 
SD_R0_N100_Ind50_20yrs_noCKMR<-matrix(NA, nrow=3, ncol=100)
SD_M_N100_Ind50_20yrs_noCKMR<-matrix(NA, nrow=3, ncol=100)
for(f in 1:3){
  for (i in 1:100){
    if(length(res_list[[f]][[i]])>2){
      CV_ssb_N100_Ind50_20yrs_noCKMR[f,i,]<-res_list[[f]][[i]]$SD$sd/res_list[[f]][[i]]$SD$value
    SD_ssb_N100_Ind50_20yrs_noCKMR[f,i,]<-res_list[[f]][[i]]$SD$sd
    SD_R0_N100_Ind50_20yrs_noCKMR[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_R0","log_R0"])
    SD_M_N100_Ind50_20yrs_noCKMR[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_M","log_M"])
    }
  }
}

#N1000 for 20yrs, sd index 0.50
res_list[[1]]<-readRDS(paste0(wd,"/SCAAfit_Cod_N1000_Ind50_20yrs_noCKMR.RData"))
res_list[[2]]<-readRDS(paste0(wd,"/SCAAfit_Flatfish_N1000_Ind50_20yrs_noCKMR.RData"))
res_list[[3]]<-readRDS(paste0(wd,"/SCAAfit_Sardine_N1000_Ind50_20yrs_noCKMR.RData"))

Cod_wdat<-Cod_1000_50_20
Flatfish_wdat<-Flatfish_1000_50_20
Sardine_wdat<-Sardine_1000_50_20

re_Dep<-re_SSB<-array(NA, dim=c(3,100,76))
re_R0<-re_M<-matrix(NA, nrow=100, ncol=3)
for(f in 1:3){
  for (i in 1:100){
    if(f==1){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Cod_wdat[[i]]$OM$SSB[26:101])/Cod_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Cod_wdat[[i]]$OM$R0)/Cod_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Cod_wdat[[i]]$OM$Mref)/Cod_wdat[[i]]$OM$Mref
      }
    }else if (f==2){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Flatfish_wdat[[i]]$OM$SSB[26:101])/Flatfish_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Flatfish_wdat[[i]]$OM$R0)/Flatfish_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Flatfish_wdat[[i]]$OM$Mref)/Flatfish_wdat[[i]]$OM$Mref
      }
    } else if (f==3){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Sardine_wdat[[i]]$OM$SSB[26:101])/Sardine_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Sardine_wdat[[i]]$OM$R0)/Sardine_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Sardine_wdat[[i]]$OM$Mref)/Sardine_wdat[[i]]$OM$Mref
      }
    }
  }
}

#SSB
par(mfrow=c(3,3))
boxplot(re_SSB[1,,], ylim=c(-0.25,0.25), las=1, main="Cod - N1000|20yrs, Index SD - 0.50, No CKMR", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[2,,], ylim=c(-0.25,0.25), las=1, main="Flatfish - N1000|20yrs, Index SD - 0.50, No CKMR", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[3,,], ylim=c(-0.25,0.25), las=1, main="Sardine - N1000|20yrs, Index SD - 0.50, No CKMR", ylab="RE - SSB")
abline(h=0)

#R0
boxplot(re_R0[,1], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,2], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,3], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)

#M
boxplot(re_M[,1], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,2], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,3], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)

#Relative error for point estimates
RE_ssb_N1000_Ind50_20yrs_noCKMR<-re_SSB
RE_R0_N1000_Ind50_20yrs_noCKMR<-re_R0
RE_M_N1000_Ind50_20yrs_noCKMR<-re_M

#Interquartile Range of relative errors
IQR_RE_ssb_N1000_Ind50_20yrs_noCKMR<-apply(re_SSB,c(1,3),quantile,probs=0.75, na.rm=TRUE)-apply(re_SSB,c(1,3),quantile,probs=0.25, na.rm=TRUE)
IQR_RE_R0_N1000_Ind50_20yrs_noCKMR<-apply(re_R0,2,quantile,probs=0.75, na.rm=TRUE)-apply(re_R0,2,quantile,probs=0.25, na.rm=TRUE)
IQR_RE_M_N1000_Ind50_20yrs_noCKMR<-apply(re_M,2,quantile,probs=0.75, na.rm=TRUE)-apply(re_M,2,quantile,probs=0.25, na.rm=TRUE)

#Interquartile Range of absolute relative errors
IQR_ARE_ssb_N1000_Ind50_20yrs_noCKMR<-apply(abs(re_SSB),c(1,3),quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_SSB),c(1,3),quantile,probs=0.25, na.rm=TRUE)
IQR_ARE_R0_N1000_Ind50_20yrs_noCKMR<-apply(abs(re_R0),2,quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_R0),2,quantile,probs=0.25, na.rm=TRUE)
IQR_ARE_M_N1000_Ind50_20yrs_noCKMR<-apply(abs(re_M),2,quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_M),2,quantile,probs=0.25, na.rm=TRUE)

#SD of relative error for point estimates
sd_RE_ssb_N1000_Ind50_20yrs_noCKMR<-apply(re_SSB,c(1,3),sd, na.rm=TRUE)
sd_RE_R0_N1000_Ind50_20yrs_noCKMR<-apply(re_R0,2,sd, na.rm=TRUE)
sd_RE_M_N1000_Ind50_20yrs_noCKMR<-apply(re_M,2,sd, na.rm=TRUE)

#SD of absolute relative error
sd_ARE_ssb_N1000_Ind50_20yrs_noCKMR<-apply(abs(re_SSB),c(1,3),sd, na.rm=TRUE)
sd_ARE_R0_N1000_Ind50_20yrs_noCKMR<-apply(abs(re_R0),2,sd, na.rm=TRUE)
sd_ARE_M_N1000_Ind50_20yrs_noCKMR<-apply(abs(re_M),2,sd, na.rm=TRUE)

#Precision within sims
SD_ssb_N1000_Ind50_20yrs_noCKMR<-CV_ssb_N1000_Ind50_20yrs_noCKMR<-array(NA, dim=c(3,100,76)) 
SD_R0_N1000_Ind50_20yrs_noCKMR<-matrix(NA, nrow=3, ncol=100)
SD_M_N1000_Ind50_20yrs_noCKMR<-matrix(NA, nrow=3, ncol=100)
for(f in 1:3){
  for (i in 1:100){
    if(length(res_list[[f]][[i]])>2){
      CV_ssb_N1000_Ind50_20yrs_noCKMR[f,i,]<-res_list[[f]][[i]]$SD$sd/res_list[[f]][[i]]$SD$value
    SD_ssb_N1000_Ind50_20yrs_noCKMR[f,i,]<-res_list[[f]][[i]]$SD$sd
    SD_R0_N1000_Ind50_20yrs_noCKMR[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_R0","log_R0"])
    SD_M_N1000_Ind50_20yrs_noCKMR[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_M","log_M"])
    }
  }
}

#N5000 for 20yrs, sd index 0.50
res_list[[1]]<-readRDS(paste0(wd,"/SCAAfit_Cod_N5000_Ind50_20yrs_noCKMR.RData"))
res_list[[2]]<-readRDS(paste0(wd,"/SCAAfit_Flatfish_N5000_Ind50_20yrs_noCKMR.RData"))
res_list[[3]]<-readRDS(paste0(wd,"/SCAAfit_Sardine_N5000_Ind50_20yrs_noCKMR.RData"))

Cod_wdat<-Cod_5000_50_20
Flatfish_wdat<-Flatfish_5000_50_20
Sardine_wdat<-Sardine_5000_50_20

re_Dep<-re_SSB<-array(NA, dim=c(3,100,76))
re_R0<-re_M<-matrix(NA, nrow=100, ncol=3)
for(f in 1:3){
  for (i in 1:100){
    if(f==1){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Cod_wdat[[i]]$OM$SSB[26:101])/Cod_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Cod_wdat[[i]]$OM$R0)/Cod_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Cod_wdat[[i]]$OM$Mref)/Cod_wdat[[i]]$OM$Mref
      }
    }else if (f==2){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Flatfish_wdat[[i]]$OM$SSB[26:101])/Flatfish_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Flatfish_wdat[[i]]$OM$R0)/Flatfish_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Flatfish_wdat[[i]]$OM$Mref)/Flatfish_wdat[[i]]$OM$Mref
      }
    } else if (f==3){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Sardine_wdat[[i]]$OM$SSB[26:101])/Sardine_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Sardine_wdat[[i]]$OM$R0)/Sardine_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Sardine_wdat[[i]]$OM$Mref)/Sardine_wdat[[i]]$OM$Mref
      }
    }
  }
}

#SSB
par(mfrow=c(3,3))
boxplot(re_SSB[1,,], ylim=c(-0.25,0.25), las=1, main="Cod - N5000|20yrs, Index SD - 0.50, No CKMR", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[2,,], ylim=c(-0.25,0.25), las=1, main="Flatfish - N5000|20yrs, Index SD - 0.50, No CKMR", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[3,,], ylim=c(-0.25,0.25), las=1, main="Sardine - N5000|20yrs, Index SD - 0.50, No CKMR", ylab="RE - SSB")
abline(h=0)

#R0
boxplot(re_R0[,1], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,2], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,3], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)

#M
boxplot(re_M[,1], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,2], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,3], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)

#Relative error for point estimates
RE_ssb_N5000_Ind50_20yrs_noCKMR<-re_SSB
RE_R0_N5000_Ind50_20yrs_noCKMR<-re_R0
RE_M_N5000_Ind50_20yrs_noCKMR<-re_M

#Interquartile Range of relative errors
IQR_RE_ssb_N5000_Ind50_20yrs_noCKMR<-apply(re_SSB,c(1,3),quantile,probs=0.75, na.rm=TRUE)-apply(re_SSB,c(1,3),quantile,probs=0.25, na.rm=TRUE)
IQR_RE_R0_N5000_Ind50_20yrs_noCKMR<-apply(re_R0,2,quantile,probs=0.75, na.rm=TRUE)-apply(re_R0,2,quantile,probs=0.25, na.rm=TRUE)
IQR_RE_M_N5000_Ind50_20yrs_noCKMR<-apply(re_M,2,quantile,probs=0.75, na.rm=TRUE)-apply(re_M,2,quantile,probs=0.25, na.rm=TRUE)

#Interquartile Range of absolute relative errors
IQR_ARE_ssb_N5000_Ind50_20yrs_noCKMR<-apply(abs(re_SSB),c(1,3),quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_SSB),c(1,3),quantile,probs=0.25, na.rm=TRUE)
IQR_ARE_R0_N5000_Ind50_20yrs_noCKMR<-apply(abs(re_R0),2,quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_R0),2,quantile,probs=0.25, na.rm=TRUE)
IQR_ARE_M_N5000_Ind50_20yrs_noCKMR<-apply(abs(re_M),2,quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_M),2,quantile,probs=0.25, na.rm=TRUE)

#SD of relative error for point estimates
sd_RE_ssb_N5000_Ind50_20yrs_noCKMR<-apply(re_SSB,c(1,3),sd, na.rm=TRUE)
sd_RE_R0_N5000_Ind50_20yrs_noCKMR<-apply(re_R0,2,sd, na.rm=TRUE)
sd_RE_M_N5000_Ind50_20yrs_noCKMR<-apply(re_M,2,sd, na.rm=TRUE)

#SD of absolute relative error
sd_ARE_ssb_N5000_Ind50_20yrs_noCKMR<-apply(abs(re_SSB),c(1,3),sd, na.rm=TRUE)
sd_ARE_R0_N5000_Ind50_20yrs_noCKMR<-apply(abs(re_R0),2,sd, na.rm=TRUE)
sd_ARE_M_N5000_Ind50_20yrs_noCKMR<-apply(abs(re_M),2,sd, na.rm=TRUE)

#Precision within sims
SD_ssb_N5000_Ind50_20yrs_noCKMR<-CV_ssb_N5000_Ind50_20yrs_noCKMR<-array(NA, dim=c(3,100,76)) 
SD_R0_N5000_Ind50_20yrs_noCKMR<-matrix(NA, nrow=3, ncol=100)
SD_M_N5000_Ind50_20yrs_noCKMR<-matrix(NA, nrow=3, ncol=100)
for(f in 1:3){
  for (i in 1:100){
    if(length(res_list[[f]][[i]])>2){
      CV_ssb_N5000_Ind50_20yrs_noCKMR[f,i,]<-res_list[[f]][[i]]$SD$sd/res_list[[f]][[i]]$SD$value
    SD_ssb_N5000_Ind50_20yrs_noCKMR[f,i,]<-res_list[[f]][[i]]$SD$sd
    SD_R0_N5000_Ind50_20yrs_noCKMR[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_R0","log_R0"])
    SD_M_N5000_Ind50_20yrs_noCKMR[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_M","log_M"])
    }
  }
}

###########################################
#SCAAs with No Index data and No CKMR
###########################################

#N100 for 5yrs, No Index
res_list<-list()
res_list[[1]]<-readRDS(paste0(wd,"/SCAAfit_Cod_N100_NoIndex_5yrs_noCKMR.RData"))
res_list[[2]]<-readRDS(paste0(wd,"/SCAAfit_Flatfish_N100_NoIndex_5yrs_noCKMR.RData"))
res_list[[3]]<-readRDS(paste0(wd,"/SCAAfit_Sardine_N100_NoIndex_5yrs_noCKMR.RData"))

Cod_wdat<-Cod_100_25_5
Flatfish_wdat<-Flatfish_100_25_5
Sardine_wdat<-Sardine_100_25_5

re_Dep<-re_SSB<-array(NA, dim=c(3,100,76))
re_R0<-re_M<-matrix(NA, nrow=100, ncol=3)
for(f in 1:3){
  for (i in 1:100){
    if(f==1){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Cod_wdat[[i]]$OM$SSB[26:101])/Cod_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Cod_wdat[[i]]$OM$R0)/Cod_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Cod_wdat[[i]]$OM$Mref)/Cod_wdat[[i]]$OM$Mref
      }
    }else if (f==2){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Flatfish_wdat[[i]]$OM$SSB[26:101])/Flatfish_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Flatfish_wdat[[i]]$OM$R0)/Flatfish_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Flatfish_wdat[[i]]$OM$Mref)/Flatfish_wdat[[i]]$OM$Mref
      }
    } else if (f==3){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Sardine_wdat[[i]]$OM$SSB[26:101])/Sardine_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Sardine_wdat[[i]]$OM$R0)/Sardine_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Sardine_wdat[[i]]$OM$Mref)/Sardine_wdat[[i]]$OM$Mref
      }
    }
  }
}

#SSB
par(mfrow=c(3,3))
boxplot(re_SSB[1,,], ylim=c(-0.25,0.25), las=1, main="Cod - N100, No Index, No CKMR", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[2,,], ylim=c(-0.25,0.25), las=1, main="Flatfish - N100, No Index, No CKMR", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[3,,], ylim=c(-0.25,0.25), las=1, main="Sardine - N100, No Index, No CKMR", ylab="RE - SSB")
abline(h=0)

#R0
boxplot(re_R0[,1], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,2], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,3], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)

#M
boxplot(re_M[,1], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,2], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,3], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)

#Relative error for point estimates
RE_ssb_N100_NoIndex_5yrs_noCKMR<-re_SSB
RE_R0_N100_NoIndex_5yrs_noCKMR<-re_R0
RE_M_N100_NoIndex_5yrs_noCKMR<-re_M

#Interquartile Range of relative errors
IQR_RE_ssb_N100_NoIndex_5yrs_noCKMR<-apply(re_SSB,c(1,3),quantile,probs=0.75, na.rm=TRUE)-apply(re_SSB,c(1,3),quantile,probs=0.25, na.rm=TRUE)
IQR_RE_R0_N100_NoIndex_5yrs_noCKMR<-apply(re_R0,2,quantile,probs=0.75, na.rm=TRUE)-apply(re_R0,2,quantile,probs=0.25, na.rm=TRUE)
IQR_RE_M_N100_NoIndex_5yrs_noCKMR<-apply(re_M,2,quantile,probs=0.75, na.rm=TRUE)-apply(re_M,2,quantile,probs=0.25, na.rm=TRUE)

#Interquartile Range of absolute relative errors
IQR_ARE_ssb_N100_NoIndex_5yrs_noCKMR<-apply(abs(re_SSB),c(1,3),quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_SSB),c(1,3),quantile,probs=0.25, na.rm=TRUE)
IQR_ARE_R0_N100_NoIndex_5yrs_noCKMR<-apply(abs(re_R0),2,quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_R0),2,quantile,probs=0.25, na.rm=TRUE)
IQR_ARE_M_N100_NoIndex_5yrs_noCKMR<-apply(abs(re_M),2,quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_M),2,quantile,probs=0.25, na.rm=TRUE)

#SD of relative error for point estimates
sd_RE_ssb_N100_NoIndex_5yrs_noCKMR<-apply(re_SSB,c(1,3),sd, na.rm=TRUE)
sd_RE_R0_N100_NoIndex_5yrs_noCKMR<-apply(re_R0,2,sd, na.rm=TRUE)
sd_RE_M_N100_NoIndex_5yrs_noCKMR<-apply(re_M,2,sd, na.rm=TRUE)

#SD of absolute relative error
sd_ARE_ssb_N100_NoIndex_5yrs_noCKMR<-apply(abs(re_SSB),c(1,3),sd, na.rm=TRUE)
sd_ARE_R0_N100_NoIndex_5yrs_noCKMR<-apply(abs(re_R0),2,sd, na.rm=TRUE)
sd_ARE_M_N100_NoIndex_5yrs_noCKMR<-apply(abs(re_M),2,sd, na.rm=TRUE)

#Precision within sims
SD_ssb_N100_NoIndex_5yrs_noCKMR<-CV_ssb_N100_NoIndex_5yrs_noCKMR<-array(NA, dim=c(3,100,76)) 
SD_R0_N100_NoIndex_5yrs_noCKMR<-matrix(NA, nrow=3, ncol=100)
SD_M_N100_NoIndex_5yrs_noCKMR<-matrix(NA, nrow=3, ncol=100)
for(f in 1:3){
  for (i in 1:100){
    if(length(res_list[[f]][[i]])>2){
      CV_ssb_N100_NoIndex_5yrs_noCKMR[f,i,]<-res_list[[f]][[i]]$SD$sd/res_list[[f]][[i]]$SD$value
    SD_ssb_N100_NoIndex_5yrs_noCKMR[f,i,]<-res_list[[f]][[i]]$SD$sd
    SD_R0_N100_NoIndex_5yrs_noCKMR[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_R0","log_R0"])
    SD_M_N100_NoIndex_5yrs_noCKMR[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_M","log_M"])
    }
  }
}

#N1000 for 5 yrs, No Index
res_list[[1]]<-readRDS(paste0(wd,"/SCAAfit_Cod_N1000_NoIndex_5yrs_noCKMR.RData"))
res_list[[2]]<-readRDS(paste0(wd,"/SCAAfit_Flatfish_N1000_NoIndex_5yrs_noCKMR.RData"))
res_list[[3]]<-readRDS(paste0(wd,"/SCAAfit_Sardine_N1000_NoIndex_5yrs_noCKMR.RData"))

Cod_wdat<-Cod_1000_25_5
Flatfish_wdat<-Flatfish_1000_25_5
Sardine_wdat<-Sardine_1000_25_5

re_Dep<-re_SSB<-array(NA, dim=c(3,100,76))
re_R0<-re_M<-matrix(NA, nrow=100, ncol=3)
for(f in 1:3){
  for (i in 1:100){
    if(f==1){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Cod_wdat[[i]]$OM$SSB[26:101])/Cod_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Cod_wdat[[i]]$OM$R0)/Cod_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Cod_wdat[[i]]$OM$Mref)/Cod_wdat[[i]]$OM$Mref
      }
    }else if (f==2){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Flatfish_wdat[[i]]$OM$SSB[26:101])/Flatfish_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Flatfish_wdat[[i]]$OM$R0)/Flatfish_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Flatfish_wdat[[i]]$OM$Mref)/Flatfish_wdat[[i]]$OM$Mref
      }
    } else if (f==3){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Sardine_wdat[[i]]$OM$SSB[26:101])/Sardine_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Sardine_wdat[[i]]$OM$R0)/Sardine_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Sardine_wdat[[i]]$OM$Mref)/Sardine_wdat[[i]]$OM$Mref
      }
    }
  }
}

par(mfrow=c(3,3))
boxplot(re_SSB[1,,], ylim=c(-0.25,0.25), las=1, main="Cod - N1000|5yrs, No Index, No CKMR", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[2,,], ylim=c(-0.25,0.25), las=1, main="Flatfish - N1000|5yrs, No Index, No CKMR", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[3,,], ylim=c(-0.25,0.25), las=1, main="Sardine - N1000|5yrs, No Index, No CKMR", ylab="RE - SSB")
abline(h=0)

#R0
boxplot(re_R0[,1], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,2], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,3], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)

#M
boxplot(re_M[,1], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,2], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,3], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)

#Relative error for point estimates
RE_ssb_N1000_NoIndex_5yrs_noCKMR<-re_SSB
RE_R0_N1000_NoIndex_5yrs_noCKMR<-re_R0
RE_M_N1000_NoIndex_5yrs_noCKMR<-re_M

#Interquartile Range of relative errors
IQR_RE_ssb_N1000_NoIndex_5yrs_noCKMR<-apply(re_SSB,c(1,3),quantile,probs=0.75, na.rm=TRUE)-apply(re_SSB,c(1,3),quantile,probs=0.25, na.rm=TRUE)
IQR_RE_R0_N1000_NoIndex_5yrs_noCKMR<-apply(re_R0,2,quantile,probs=0.75, na.rm=TRUE)-apply(re_R0,2,quantile,probs=0.25, na.rm=TRUE)
IQR_RE_M_N1000_NoIndex_5yrs_noCKMR<-apply(re_M,2,quantile,probs=0.75, na.rm=TRUE)-apply(re_M,2,quantile,probs=0.25, na.rm=TRUE)

#Interquartile Range of absolute relative errors
IQR_ARE_ssb_N1000_NoIndex_5yrs_noCKMR<-apply(abs(re_SSB),c(1,3),quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_SSB),c(1,3),quantile,probs=0.25, na.rm=TRUE)
IQR_ARE_R0_N1000_NoIndex_5yrs_noCKMR<-apply(abs(re_R0),2,quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_R0),2,quantile,probs=0.25, na.rm=TRUE)
IQR_ARE_M_N1000_NoIndex_5yrs_noCKMR<-apply(abs(re_M),2,quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_M),2,quantile,probs=0.25, na.rm=TRUE)

#SD of relative error for point estimates
sd_RE_ssb_N1000_NoIndex_5yrs_noCKMR<-apply(re_SSB,c(1,3),sd, na.rm=TRUE)
sd_RE_R0_N1000_NoIndex_5yrs_noCKMR<-apply(re_R0,2,sd, na.rm=TRUE)
sd_RE_M_N1000_NoIndex_5yrs_noCKMR<-apply(re_M,2,sd, na.rm=TRUE)

#SD of absolute relative error
sd_ARE_ssb_N1000_NoIndex_5yrs_noCKMR<-apply(abs(re_SSB),c(1,3),sd, na.rm=TRUE)
sd_ARE_R0_N1000_NoIndex_5yrs_noCKMR<-apply(abs(re_R0),2,sd, na.rm=TRUE)
sd_ARE_M_N1000_NoIndex_5yrs_noCKMR<-apply(abs(re_M),2,sd, na.rm=TRUE)

#Precision within sims
SD_ssb_N1000_NoIndex_5yrs_noCKMR<-CV_ssb_N1000_NoIndex_5yrs_noCKMR<-array(NA, dim=c(3,100,76)) 
SD_R0_N1000_NoIndex_5yrs_noCKMR<-matrix(NA, nrow=3, ncol=100)
SD_M_N1000_NoIndex_5yrs_noCKMR<-matrix(NA, nrow=3, ncol=100)
for(f in 1:3){
  for (i in 1:100){
    if(length(res_list[[f]][[i]])>2){
      CV_ssb_N1000_NoIndex_5yrs_noCKMR[f,i,]<-res_list[[f]][[i]]$SD$sd/res_list[[f]][[i]]$SD$value
    SD_ssb_N1000_NoIndex_5yrs_noCKMR[f,i,]<-res_list[[f]][[i]]$SD$sd
    SD_R0_N1000_NoIndex_5yrs_noCKMR[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_R0","log_R0"])
    SD_M_N1000_NoIndex_5yrs_noCKMR[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_M","log_M"])
    }
  }
}

#N5000 for 5 yrs, No Index
res_list[[1]]<-readRDS(paste0(wd,"/SCAAfit_Cod_N5000_NoIndex_5yrs_noCKMR.RData"))
res_list[[2]]<-readRDS(paste0(wd,"/SCAAfit_Flatfish_N5000_NoIndex_5yrs_noCKMR.RData"))
res_list[[3]]<-readRDS(paste0(wd,"/SCAAfit_Sardine_N5000_NoIndex_5yrs_noCKMR.RData"))

Cod_wdat<-Cod_5000_25_5
Flatfish_wdat<-Flatfish_5000_25_5
Sardine_wdat<-Sardine_5000_25_5

re_Dep<-re_SSB<-array(NA, dim=c(3,100,76))
re_R0<-re_M<-matrix(NA, nrow=100, ncol=3)
for(f in 1:3){
  for (i in 1:100){
    if(f==1){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Cod_wdat[[i]]$OM$SSB[26:101])/Cod_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Cod_wdat[[i]]$OM$R0)/Cod_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Cod_wdat[[i]]$OM$Mref)/Cod_wdat[[i]]$OM$Mref
      }
    }else if (f==2){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Flatfish_wdat[[i]]$OM$SSB[26:101])/Flatfish_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Flatfish_wdat[[i]]$OM$R0)/Flatfish_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Flatfish_wdat[[i]]$OM$Mref)/Flatfish_wdat[[i]]$OM$Mref
      }
    } else if (f==3){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Sardine_wdat[[i]]$OM$SSB[26:101])/Sardine_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Sardine_wdat[[i]]$OM$R0)/Sardine_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Sardine_wdat[[i]]$OM$Mref)/Sardine_wdat[[i]]$OM$Mref
      }
    }
  }
}

par(mfrow=c(3,3))
boxplot(re_SSB[1,,], ylim=c(-0.25,0.25), las=1, main="Cod - N5000|5yrs, No Index, No CKMR", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[2,,], ylim=c(-0.25,0.25), las=1, main="Flatfish - N5000|5yrs, No Index, No CKMR", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[3,,], ylim=c(-0.25,0.25), las=1, main="Sardine - N5000|5yrs, No Index, No CKMR", ylab="RE - SSB")
abline(h=0)

#R0
boxplot(re_R0[,1], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,2], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,3], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)

#M
boxplot(re_M[,1], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,2], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,3], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)

#Relative error for point estimates
RE_ssb_N5000_NoIndex_5yrs_noCKMR<-re_SSB
RE_R0_N5000_NoIndex_5yrs_noCKMR<-re_R0
RE_M_N5000_NoIndex_5yrs_noCKMR<-re_M

#Interquartile Range of relative errors
IQR_RE_ssb_N5000_NoIndex_5yrs_noCKMR<-apply(re_SSB,c(1,3),quantile,probs=0.75, na.rm=TRUE)-apply(re_SSB,c(1,3),quantile,probs=0.25, na.rm=TRUE)
IQR_RE_R0_N5000_NoIndex_5yrs_noCKMR<-apply(re_R0,2,quantile,probs=0.75, na.rm=TRUE)-apply(re_R0,2,quantile,probs=0.25, na.rm=TRUE)
IQR_RE_M_N5000_NoIndex_5yrs_noCKMR<-apply(re_M,2,quantile,probs=0.75, na.rm=TRUE)-apply(re_M,2,quantile,probs=0.25, na.rm=TRUE)

#Interquartile Range of absolute relative errors
IQR_ARE_ssb_N5000_NoIndex_5yrs_noCKMR<-apply(abs(re_SSB),c(1,3),quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_SSB),c(1,3),quantile,probs=0.25, na.rm=TRUE)
IQR_ARE_R0_N5000_NoIndex_5yrs_noCKMR<-apply(abs(re_R0),2,quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_R0),2,quantile,probs=0.25, na.rm=TRUE)
IQR_ARE_M_N5000_NoIndex_5yrs_noCKMR<-apply(abs(re_M),2,quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_M),2,quantile,probs=0.25, na.rm=TRUE)

#SD of relative error for point estimates
sd_RE_ssb_N5000_NoIndex_5yrs_noCKMR<-apply(re_SSB,c(1,3),sd, na.rm=TRUE)
sd_RE_R0_N5000_NoIndex_5yrs_noCKMR<-apply(re_R0,2,sd, na.rm=TRUE)
sd_RE_M_N5000_NoIndex_5yrs_noCKMR<-apply(re_M,2,sd, na.rm=TRUE)

#SD of absolute relative error
sd_ARE_ssb_N5000_NoIndex_5yrs_noCKMR<-apply(abs(re_SSB),c(1,3),sd, na.rm=TRUE)
sd_ARE_R0_N5000_NoIndex_5yrs_noCKMR<-apply(abs(re_R0),2,sd, na.rm=TRUE)
sd_ARE_M_N5000_NoIndex_5yrs_noCKMR<-apply(abs(re_M),2,sd, na.rm=TRUE)

#Precision within sims
SD_ssb_N5000_NoIndex_5yrs_noCKMR<-CV_ssb_N5000_NoIndex_5yrs_noCKMR<-array(NA, dim=c(3,100,76)) 
SD_R0_N5000_NoIndex_5yrs_noCKMR<-matrix(NA, nrow=3, ncol=100)
SD_M_N5000_NoIndex_5yrs_noCKMR<-matrix(NA, nrow=3, ncol=100)
for(f in 1:3){
  for (i in 1:100){
    if(length(res_list[[f]][[i]])>2){
      CV_ssb_N5000_NoIndex_5yrs_noCKMR[f,i,]<-res_list[[f]][[i]]$SD$sd/res_list[[f]][[i]]$SD$value
    SD_ssb_N5000_NoIndex_5yrs_noCKMR[f,i,]<-res_list[[f]][[i]]$SD$sd
    SD_R0_N5000_NoIndex_5yrs_noCKMR[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_R0","log_R0"])
    SD_M_N5000_NoIndex_5yrs_noCKMR[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_M","log_M"])
    }
  }
}

#########
#10 years
#########

#N100 for 10yrs, and No Index
res_list<-list()
res_list[[1]]<-readRDS(paste0(wd,"/SCAAfit_Cod_N100_NoIndex_10yrs_noCKMR.RData"))
res_list[[2]]<-readRDS(paste0(wd,"/SCAAfit_Flatfish_N100_NoIndex_10yrs_noCKMR.RData"))
res_list[[3]]<-readRDS(paste0(wd,"/SCAAfit_Sardine_N100_NoIndex_10yrs_noCKMR.RData"))

Cod_wdat<-Cod_100_25_10
Flatfish_wdat<-Flatfish_100_25_10
Sardine_wdat<-Sardine_100_25_10

re_Dep<-re_SSB<-array(NA, dim=c(3,100,76))
re_R0<-re_M<-matrix(NA, nrow=100, ncol=3)
for(f in 1:3){
  for (i in 1:100){
    if(f==1){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Cod_wdat[[i]]$OM$SSB[26:101])/Cod_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Cod_wdat[[i]]$OM$R0)/Cod_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Cod_wdat[[i]]$OM$Mref)/Cod_wdat[[i]]$OM$Mref
      }
    }else if (f==2){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Flatfish_wdat[[i]]$OM$SSB[26:101])/Flatfish_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Flatfish_wdat[[i]]$OM$R0)/Flatfish_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Flatfish_wdat[[i]]$OM$Mref)/Flatfish_wdat[[i]]$OM$Mref
      }
    } else if (f==3){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Sardine_wdat[[i]]$OM$SSB[26:101])/Sardine_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Sardine_wdat[[i]]$OM$R0)/Sardine_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Sardine_wdat[[i]]$OM$Mref)/Sardine_wdat[[i]]$OM$Mref
      }
    }
  }
}

#SSB
par(mfrow=c(3,3))
boxplot(re_SSB[1,,], ylim=c(-0.25,0.25), las=1, main="Cod - N100, No Index, No CKMR", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[2,,], ylim=c(-0.25,0.25), las=1, main="Flatfish - N100, No Index, No CKMR", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[3,,], ylim=c(-0.25,0.25), las=1, main="Sardine - N100, No Index, No CKMR", ylab="RE - SSB")
abline(h=0)

#R0
boxplot(re_R0[,1], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,2], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,3], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)

#M
boxplot(re_M[,1], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,2], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,3], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)

#Relative error for point estimates
RE_ssb_N100_NoIndex_10yrs_noCKMR<-re_SSB
RE_R0_N100_NoIndex_10yrs_noCKMR<-re_R0
RE_M_N100_NoIndex_10yrs_noCKMR<-re_M

#Interquartile Range of relative errors
IQR_RE_ssb_N100_NoIndex_10yrs_noCKMR<-apply(re_SSB,c(1,3),quantile,probs=0.75, na.rm=TRUE)-apply(re_SSB,c(1,3),quantile,probs=0.25, na.rm=TRUE)
IQR_RE_R0_N100_NoIndex_10yrs_noCKMR<-apply(re_R0,2,quantile,probs=0.75, na.rm=TRUE)-apply(re_R0,2,quantile,probs=0.25, na.rm=TRUE)
IQR_RE_M_N100_NoIndex_10yrs_noCKMR<-apply(re_M,2,quantile,probs=0.75, na.rm=TRUE)-apply(re_M,2,quantile,probs=0.25, na.rm=TRUE)

#Interquartile Range of absolute relative errors
IQR_ARE_ssb_N100_NoIndex_10yrs_noCKMR<-apply(abs(re_SSB),c(1,3),quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_SSB),c(1,3),quantile,probs=0.25, na.rm=TRUE)
IQR_ARE_R0_N100_NoIndex_10yrs_noCKMR<-apply(abs(re_R0),2,quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_R0),2,quantile,probs=0.25, na.rm=TRUE)
IQR_ARE_M_N100_NoIndex_10yrs_noCKMR<-apply(abs(re_M),2,quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_M),2,quantile,probs=0.25, na.rm=TRUE)

#SD of relative error for point estimates
sd_RE_ssb_N100_NoIndex_10yrs_noCKMR<-apply(re_SSB,c(1,3),sd, na.rm=TRUE)
sd_RE_R0_N100_NoIndex_10yrs_noCKMR<-apply(re_R0,2,sd, na.rm=TRUE)
sd_RE_M_N100_NoIndex_10yrs_noCKMR<-apply(re_M,2,sd, na.rm=TRUE)

#SD of absolute relative error
sd_ARE_ssb_N100_NoIndex_10yrs_noCKMR<-apply(abs(re_SSB),c(1,3),sd, na.rm=TRUE)
sd_ARE_R0_N100_NoIndex_10yrs_noCKMR<-apply(abs(re_R0),2,sd, na.rm=TRUE)
sd_ARE_M_N100_NoIndex_10yrs_noCKMR<-apply(abs(re_M),2,sd, na.rm=TRUE)

#Precision within sims
SD_ssb_N100_NoIndex_10yrs_noCKMR<-CV_ssb_N100_NoIndex_10yrs_noCKMR<-array(NA, dim=c(3,100,76)) 
SD_R0_N100_NoIndex_10yrs_noCKMR<-matrix(NA, nrow=3, ncol=100)
SD_M_N100_NoIndex_10yrs_noCKMR<-matrix(NA, nrow=3, ncol=100)
for(f in 1:3){
  for (i in 1:100){
    if(length(res_list[[f]][[i]])>2){
      CV_ssb_N100_NoIndex_10yrs_noCKMR[f,i,]<-res_list[[f]][[i]]$SD$sd/res_list[[f]][[i]]$SD$value
    SD_ssb_N100_NoIndex_10yrs_noCKMR[f,i,]<-res_list[[f]][[i]]$SD$sd
    SD_R0_N100_NoIndex_10yrs_noCKMR[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_R0","log_R0"])
    SD_M_N100_NoIndex_10yrs_noCKMR[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_M","log_M"])
    }
  }
}

#N1000 for 10yrs, No Index
res_list[[1]]<-readRDS(paste0(wd,"/SCAAfit_Cod_N1000_NoIndex_10yrs_noCKMR.RData"))
res_list[[2]]<-readRDS(paste0(wd,"/SCAAfit_Flatfish_N1000_NoIndex_10yrs_noCKMR.RData"))
res_list[[3]]<-readRDS(paste0(wd,"/SCAAfit_Sardine_N1000_NoIndex_10yrs_noCKMR.RData"))

Cod_wdat<-Cod_1000_25_10
Flatfish_wdat<-Flatfish_1000_25_10
Sardine_wdat<-Sardine_1000_25_10

re_Dep<-re_SSB<-array(NA, dim=c(3,100,76))
re_R0<-re_M<-matrix(NA, nrow=100, ncol=3)
for(f in 1:3){
  for (i in 1:100){
    if(f==1){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Cod_wdat[[i]]$OM$SSB[26:101])/Cod_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Cod_wdat[[i]]$OM$R0)/Cod_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Cod_wdat[[i]]$OM$Mref)/Cod_wdat[[i]]$OM$Mref
      }
    }else if (f==2){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Flatfish_wdat[[i]]$OM$SSB[26:101])/Flatfish_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Flatfish_wdat[[i]]$OM$R0)/Flatfish_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Flatfish_wdat[[i]]$OM$Mref)/Flatfish_wdat[[i]]$OM$Mref
      }
    } else if (f==3){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Sardine_wdat[[i]]$OM$SSB[26:101])/Sardine_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Sardine_wdat[[i]]$OM$R0)/Sardine_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Sardine_wdat[[i]]$OM$Mref)/Sardine_wdat[[i]]$OM$Mref
      }
    }
  }
}

#SSB
par(mfrow=c(3,3))
boxplot(re_SSB[1,,], ylim=c(-0.25,0.25), las=1, main="Cod - N1000|10yrs, No Index, No CKMR", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[2,,], ylim=c(-0.25,0.25), las=1, main="Flatfish - N1000|10yrs, No Index, No CKMR", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[3,,], ylim=c(-0.25,0.25), las=1, main="Sardine - N1000|10yrs, No Index, No CKMR", ylab="RE - SSB")
abline(h=0)

#R0
boxplot(re_R0[,1], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,2], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,3], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)

#M
boxplot(re_M[,1], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,2], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,3], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)

#Relative error for point estimates
RE_ssb_N1000_NoIndex_10yrs_noCKMR<-re_SSB
RE_R0_N1000_NoIndex_10yrs_noCKMR<-re_R0
RE_M_N1000_NoIndex_10yrs_noCKMR<-re_M

#Interquartile Range of relative errors
IQR_RE_ssb_N1000_NoIndex_10yrs_noCKMR<-apply(re_SSB,c(1,3),quantile,probs=0.75, na.rm=TRUE)-apply(re_SSB,c(1,3),quantile,probs=0.25, na.rm=TRUE)
IQR_RE_R0_N1000_NoIndex_10yrs_noCKMR<-apply(re_R0,2,quantile,probs=0.75, na.rm=TRUE)-apply(re_R0,2,quantile,probs=0.25, na.rm=TRUE)
IQR_RE_M_N1000_NoIndex_10yrs_noCKMR<-apply(re_M,2,quantile,probs=0.75, na.rm=TRUE)-apply(re_M,2,quantile,probs=0.25, na.rm=TRUE)

#Interquartile Range of absolute relative errors
IQR_ARE_ssb_N1000_NoIndex_10yrs_noCKMR<-apply(abs(re_SSB),c(1,3),quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_SSB),c(1,3),quantile,probs=0.25, na.rm=TRUE)
IQR_ARE_R0_N1000_NoIndex_10yrs_noCKMR<-apply(abs(re_R0),2,quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_R0),2,quantile,probs=0.25, na.rm=TRUE)
IQR_ARE_M_N1000_NoIndex_10yrs_noCKMR<-apply(abs(re_M),2,quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_M),2,quantile,probs=0.25, na.rm=TRUE)

#SD of relative error for point estimates
sd_RE_ssb_N1000_NoIndex_10yrs_noCKMR<-apply(re_SSB,c(1,3),sd, na.rm=TRUE)
sd_RE_R0_N1000_NoIndex_10yrs_noCKMR<-apply(re_R0,2,sd, na.rm=TRUE)
sd_RE_M_N1000_NoIndex_10yrs_noCKMR<-apply(re_M,2,sd, na.rm=TRUE)

#SD of absolute relative error
sd_ARE_ssb_N1000_NoIndex_10yrs_noCKMR<-apply(abs(re_SSB),c(1,3),sd, na.rm=TRUE)
sd_ARE_R0_N1000_NoIndex_10yrs_noCKMR<-apply(abs(re_R0),2,sd, na.rm=TRUE)
sd_ARE_M_N1000_NoIndex_10yrs_noCKMR<-apply(abs(re_M),2,sd, na.rm=TRUE)

#Precision within sims
SD_ssb_N1000_NoIndex_10yrs_noCKMR<-CV_ssb_N1000_NoIndex_10yrs_noCKMR<-array(NA, dim=c(3,100,76)) 
SD_R0_N1000_NoIndex_10yrs_noCKMR<-matrix(NA, nrow=3, ncol=100)
SD_M_N1000_NoIndex_10yrs_noCKMR<-matrix(NA, nrow=3, ncol=100)
for(f in 1:3){
  for (i in 1:100){
    if(length(res_list[[f]][[i]])>2){
      CV_ssb_N1000_NoIndex_10yrs_noCKMR[f,i,]<-res_list[[f]][[i]]$SD$sd/res_list[[f]][[i]]$SD$value
    SD_ssb_N1000_NoIndex_10yrs_noCKMR[f,i,]<-res_list[[f]][[i]]$SD$sd
    SD_R0_N1000_NoIndex_10yrs_noCKMR[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_R0","log_R0"])
    SD_M_N1000_NoIndex_10yrs_noCKMR[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_M","log_M"])
    }
  }
}

#N5000 for 10yrs, No Index
res_list[[1]]<-readRDS(paste0(wd,"/SCAAfit_Cod_N5000_NoIndex_10yrs_noCKMR.RData"))
res_list[[2]]<-readRDS(paste0(wd,"/SCAAfit_Flatfish_N5000_NoIndex_10yrs_noCKMR.RData"))
res_list[[3]]<-readRDS(paste0(wd,"/SCAAfit_Sardine_N5000_NoIndex_10yrs_noCKMR.RData"))

Cod_wdat<-Cod_5000_25_10
Flatfish_wdat<-Flatfish_5000_25_10
Sardine_wdat<-Sardine_5000_25_10

re_Dep<-re_SSB<-array(NA, dim=c(3,100,76))
re_R0<-re_M<-matrix(NA, nrow=100, ncol=3)
for(f in 1:3){
  for (i in 1:100){
    if(f==1){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Cod_wdat[[i]]$OM$SSB[26:101])/Cod_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Cod_wdat[[i]]$OM$R0)/Cod_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Cod_wdat[[i]]$OM$Mref)/Cod_wdat[[i]]$OM$Mref
      }
    }else if (f==2){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Flatfish_wdat[[i]]$OM$SSB[26:101])/Flatfish_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Flatfish_wdat[[i]]$OM$R0)/Flatfish_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Flatfish_wdat[[i]]$OM$Mref)/Flatfish_wdat[[i]]$OM$Mref
      }
    } else if (f==3){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Sardine_wdat[[i]]$OM$SSB[26:101])/Sardine_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Sardine_wdat[[i]]$OM$R0)/Sardine_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Sardine_wdat[[i]]$OM$Mref)/Sardine_wdat[[i]]$OM$Mref
      }
    }
  }
}

#SSB
par(mfrow=c(3,3))
boxplot(re_SSB[1,,], ylim=c(-0.25,0.25), las=1, main="Cod - N5000|10yrs, No Index, No CKMR", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[2,,], ylim=c(-0.25,0.25), las=1, main="Flatfish - N5000|10yrs, No Index, No CKMR", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[3,,], ylim=c(-0.25,0.25), las=1, main="Sardine - N5000|10yrs, No Index, No CKMR", ylab="RE - SSB")
abline(h=0)

#R0
boxplot(re_R0[,1], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,2], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,3], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)

#M
boxplot(re_M[,1], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,2], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,3], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)

#Relative error for point estimates
RE_ssb_N5000_NoIndex_10yrs_noCKMR<-re_SSB
RE_R0_N5000_NoIndex_10yrs_noCKMR<-re_R0
RE_M_N5000_NoIndex_10yrs_noCKMR<-re_M

#Interquartile Range of relative errors
IQR_RE_ssb_N5000_NoIndex_10yrs_noCKMR<-apply(re_SSB,c(1,3),quantile,probs=0.75, na.rm=TRUE)-apply(re_SSB,c(1,3),quantile,probs=0.25, na.rm=TRUE)
IQR_RE_R0_N5000_NoIndex_10yrs_noCKMR<-apply(re_R0,2,quantile,probs=0.75, na.rm=TRUE)-apply(re_R0,2,quantile,probs=0.25, na.rm=TRUE)
IQR_RE_M_N5000_NoIndex_10yrs_noCKMR<-apply(re_M,2,quantile,probs=0.75, na.rm=TRUE)-apply(re_M,2,quantile,probs=0.25, na.rm=TRUE)

#Interquartile Range of absolute relative errors
IQR_ARE_ssb_N5000_NoIndex_10yrs_noCKMR<-apply(abs(re_SSB),c(1,3),quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_SSB),c(1,3),quantile,probs=0.25, na.rm=TRUE)
IQR_ARE_R0_N5000_NoIndex_10yrs_noCKMR<-apply(abs(re_R0),2,quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_R0),2,quantile,probs=0.25, na.rm=TRUE)
IQR_ARE_M_N5000_NoIndex_10yrs_noCKMR<-apply(abs(re_M),2,quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_M),2,quantile,probs=0.25, na.rm=TRUE)

#SD of relative error for point estimates
sd_RE_ssb_N5000_NoIndex_10yrs_noCKMR<-apply(re_SSB,c(1,3),sd, na.rm=TRUE)
sd_RE_R0_N5000_NoIndex_10yrs_noCKMR<-apply(re_R0,2,sd, na.rm=TRUE)
sd_RE_M_N5000_NoIndex_10yrs_noCKMR<-apply(re_M,2,sd, na.rm=TRUE)

#SD of absolute relative error
sd_ARE_ssb_N5000_NoIndex_10yrs_noCKMR<-apply(abs(re_SSB),c(1,3),sd, na.rm=TRUE)
sd_ARE_R0_N5000_NoIndex_10yrs_noCKMR<-apply(abs(re_R0),2,sd, na.rm=TRUE)
sd_ARE_M_N5000_NoIndex_10yrs_noCKMR<-apply(abs(re_M),2,sd, na.rm=TRUE)

#Precision within sims
SD_ssb_N5000_NoIndex_10yrs_noCKMR<-CV_ssb_N5000_NoIndex_10yrs_noCKMR<-array(NA, dim=c(3,100,76)) 
SD_R0_N5000_NoIndex_10yrs_noCKMR<-matrix(NA, nrow=3, ncol=100)
SD_M_N5000_NoIndex_10yrs_noCKMR<-matrix(NA, nrow=3, ncol=100)
for(f in 1:3){
  for (i in 1:100){
    if(length(res_list[[f]][[i]])>2){
      CV_ssb_N5000_NoIndex_10yrs_noCKMR[f,i,]<-res_list[[f]][[i]]$SD$sd/res_list[[f]][[i]]$SD$value
    SD_ssb_N5000_NoIndex_10yrs_noCKMR[f,i,]<-res_list[[f]][[i]]$SD$sd
    SD_R0_N5000_NoIndex_10yrs_noCKMR[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_R0","log_R0"])
    SD_M_N5000_NoIndex_10yrs_noCKMR[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_M","log_M"])
    }
  }
}

#N100 for 20yrs, No index
res_list<-list()
res_list[[1]]<-readRDS(paste0(wd,"/SCAAfit_Cod_N100_NoIndex_20yrs_noCKMR.RData"))
res_list[[2]]<-readRDS(paste0(wd,"/SCAAfit_Flatfish_N100_NoIndex_20yrs_noCKMR.RData"))
res_list[[3]]<-readRDS(paste0(wd,"/SCAAfit_Sardine_N100_NoIndex_20yrs_noCKMR.RData"))

Cod_wdat<-Cod_100_25_20
Flatfish_wdat<-Flatfish_100_25_20
Sardine_wdat<-Sardine_100_25_20

re_Dep<-re_SSB<-array(NA, dim=c(3,100,76))
re_R0<-re_M<-matrix(NA, nrow=100, ncol=3)
for(f in 1:3){
  for (i in 1:100){
    if(f==1){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Cod_wdat[[i]]$OM$SSB[26:101])/Cod_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Cod_wdat[[i]]$OM$R0)/Cod_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Cod_wdat[[i]]$OM$Mref)/Cod_wdat[[i]]$OM$Mref
      }
    }else if (f==2){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Flatfish_wdat[[i]]$OM$SSB[26:101])/Flatfish_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Flatfish_wdat[[i]]$OM$R0)/Flatfish_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Flatfish_wdat[[i]]$OM$Mref)/Flatfish_wdat[[i]]$OM$Mref
      }
    } else if (f==3){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Sardine_wdat[[i]]$OM$SSB[26:101])/Sardine_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Sardine_wdat[[i]]$OM$R0)/Sardine_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Sardine_wdat[[i]]$OM$Mref)/Sardine_wdat[[i]]$OM$Mref
      }
    }
  }
}

#SSB
par(mfrow=c(3,3))
boxplot(re_SSB[1,,], ylim=c(-0.25,0.25), las=1, main="Cod - N100, No Index, No CKMR", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[2,,], ylim=c(-0.25,0.25), las=1, main="Flatfish - N100, No Index, No CKMR", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[3,,], ylim=c(-0.25,0.25), las=1, main="Sardine - N100, No Index, No CKMR", ylab="RE - SSB")
abline(h=0)

#R0
boxplot(re_R0[,1], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,2], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,3], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)

#M
boxplot(re_M[,1], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,2], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,3], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)

#Relative error for point estimates
RE_ssb_N100_NoIndex_20yrs_noCKMR<-re_SSB
RE_R0_N100_NoIndex_20yrs_noCKMR<-re_R0
RE_M_N100_NoIndex_20yrs_noCKMR<-re_M

#Interquartile Range of relative errors
IQR_RE_ssb_N100_NoIndex_20yrs_noCKMR<-apply(re_SSB,c(1,3),quantile,probs=0.75, na.rm=TRUE)-apply(re_SSB,c(1,3),quantile,probs=0.25, na.rm=TRUE)
IQR_RE_R0_N100_NoIndex_20yrs_noCKMR<-apply(re_R0,2,quantile,probs=0.75, na.rm=TRUE)-apply(re_R0,2,quantile,probs=0.25, na.rm=TRUE)
IQR_RE_M_N100_NoIndex_20yrs_noCKMR<-apply(re_M,2,quantile,probs=0.75, na.rm=TRUE)-apply(re_M,2,quantile,probs=0.25, na.rm=TRUE)

#Interquartile Range of absolute relative errors
IQR_ARE_ssb_N100_NoIndex_20yrs_noCKMR<-apply(abs(re_SSB),c(1,3),quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_SSB),c(1,3),quantile,probs=0.25, na.rm=TRUE)
IQR_ARE_R0_N100_NoIndex_20yrs_noCKMR<-apply(abs(re_R0),2,quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_R0),2,quantile,probs=0.25, na.rm=TRUE)
IQR_ARE_M_N100_NoIndex_20yrs_noCKMR<-apply(abs(re_M),2,quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_M),2,quantile,probs=0.25, na.rm=TRUE)

#SD of relative error for point estimates
sd_RE_ssb_N100_NoIndex_20yrs_noCKMR<-apply(re_SSB,c(1,3),sd, na.rm=TRUE)
sd_RE_R0_N100_NoIndex_20yrs_noCKMR<-apply(re_R0,2,sd, na.rm=TRUE)
sd_RE_M_N100_NoIndex_20yrs_noCKMR<-apply(re_M,2,sd, na.rm=TRUE)

#SD of absolute relative error
sd_ARE_ssb_N100_NoIndex_20yrs_noCKMR<-apply(abs(re_SSB),c(1,3),sd, na.rm=TRUE)
sd_ARE_R0_N100_NoIndex_20yrs_noCKMR<-apply(abs(re_R0),2,sd, na.rm=TRUE)
sd_ARE_M_N100_NoIndex_20yrs_noCKMR<-apply(abs(re_M),2,sd, na.rm=TRUE)

#Precision within sims
SD_ssb_N100_NoIndex_20yrs_noCKMR<-CV_ssb_N100_NoIndex_20yrs_noCKMR<-array(NA, dim=c(3,100,76)) 
SD_R0_N100_NoIndex_20yrs_noCKMR<-matrix(NA, nrow=3, ncol=100)
SD_M_N100_NoIndex_20yrs_noCKMR<-matrix(NA, nrow=3, ncol=100)
for(f in 1:3){
  for (i in 1:100){
    if(length(res_list[[f]][[i]])>2){
      CV_ssb_N100_NoIndex_20yrs_noCKMR[f,i,]<-res_list[[f]][[i]]$SD$sd/res_list[[f]][[i]]$SD$value
    SD_ssb_N100_NoIndex_20yrs_noCKMR[f,i,]<-res_list[[f]][[i]]$SD$sd
    SD_R0_N100_NoIndex_20yrs_noCKMR[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_R0","log_R0"])
    SD_M_N100_NoIndex_20yrs_noCKMR[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_M","log_M"])
    }
  }
}

#N1000 for 20yrs, No Index
res_list[[1]]<-readRDS(paste0(wd,"/SCAAfit_Cod_N1000_NoIndex_20yrs_noCKMR.RData"))
res_list[[2]]<-readRDS(paste0(wd,"/SCAAfit_Flatfish_N1000_NoIndex_20yrs_noCKMR.RData"))
res_list[[3]]<-readRDS(paste0(wd,"/SCAAfit_Sardine_N1000_NoIndex_20yrs_noCKMR.RData"))

Cod_wdat<-Cod_1000_25_20
Flatfish_wdat<-Flatfish_1000_25_20
Sardine_wdat<-Sardine_1000_25_20

re_Dep<-re_SSB<-array(NA, dim=c(3,100,76))
re_R0<-re_M<-matrix(NA, nrow=100, ncol=3)
for(f in 1:3){
  for (i in 1:100){
    if(f==1){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Cod_wdat[[i]]$OM$SSB[26:101])/Cod_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Cod_wdat[[i]]$OM$R0)/Cod_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Cod_wdat[[i]]$OM$Mref)/Cod_wdat[[i]]$OM$Mref
      }
    }else if (f==2){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Flatfish_wdat[[i]]$OM$SSB[26:101])/Flatfish_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Flatfish_wdat[[i]]$OM$R0)/Flatfish_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Flatfish_wdat[[i]]$OM$Mref)/Flatfish_wdat[[i]]$OM$Mref
      }
    } else if (f==3){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Sardine_wdat[[i]]$OM$SSB[26:101])/Sardine_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Sardine_wdat[[i]]$OM$R0)/Sardine_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Sardine_wdat[[i]]$OM$Mref)/Sardine_wdat[[i]]$OM$Mref
      }
    }
  }
}

#SSB
par(mfrow=c(3,3))
boxplot(re_SSB[1,,], ylim=c(-0.25,0.25), las=1, main="Cod - N1000|20yrs, No Index, No CKMR", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[2,,], ylim=c(-0.25,0.25), las=1, main="Flatfish - N1000|20yrs, No Index, No CKMR", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[3,,], ylim=c(-0.25,0.25), las=1, main="Sardine - N1000|20yrs, No Index, No CKMR", ylab="RE - SSB")
abline(h=0)

#R0
boxplot(re_R0[,1], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,2], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,3], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)

#M
boxplot(re_M[,1], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,2], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,3], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)

#Relative error for point estimates
RE_ssb_N1000_NoIndex_20yrs_noCKMR<-re_SSB
RE_R0_N1000_NoIndex_20yrs_noCKMR<-re_R0
RE_M_N1000_NoIndex_20yrs_noCKMR<-re_M

#Interquartile Range of relative errors
IQR_RE_ssb_N1000_NoIndex_20yrs_noCKMR<-apply(re_SSB,c(1,3),quantile,probs=0.75, na.rm=TRUE)-apply(re_SSB,c(1,3),quantile,probs=0.25, na.rm=TRUE)
IQR_RE_R0_N1000_NoIndex_20yrs_noCKMR<-apply(re_R0,2,quantile,probs=0.75, na.rm=TRUE)-apply(re_R0,2,quantile,probs=0.25, na.rm=TRUE)
IQR_RE_M_N1000_NoIndex_20yrs_noCKMR<-apply(re_M,2,quantile,probs=0.75, na.rm=TRUE)-apply(re_M,2,quantile,probs=0.25, na.rm=TRUE)

#Interquartile Range of absolute relative errors
IQR_ARE_ssb_N1000_NoIndex_20yrs_noCKMR<-apply(abs(re_SSB),c(1,3),quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_SSB),c(1,3),quantile,probs=0.25, na.rm=TRUE)
IQR_ARE_R0_N1000_NoIndex_20yrs_noCKMR<-apply(abs(re_R0),2,quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_R0),2,quantile,probs=0.25, na.rm=TRUE)
IQR_ARE_M_N1000_NoIndex_20yrs_noCKMR<-apply(abs(re_M),2,quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_M),2,quantile,probs=0.25, na.rm=TRUE)

#SD of relative error for point estimates
sd_RE_ssb_N1000_NoIndex_20yrs_noCKMR<-apply(re_SSB,c(1,3),sd, na.rm=TRUE)
sd_RE_R0_N1000_NoIndex_20yrs_noCKMR<-apply(re_R0,2,sd, na.rm=TRUE)
sd_RE_M_N1000_NoIndex_20yrs_noCKMR<-apply(re_M,2,sd, na.rm=TRUE)

#SD of absolute relative error
sd_ARE_ssb_N1000_NoIndex_20yrs_noCKMR<-apply(abs(re_SSB),c(1,3),sd, na.rm=TRUE)
sd_ARE_R0_N1000_NoIndex_20yrs_noCKMR<-apply(abs(re_R0),2,sd, na.rm=TRUE)
sd_ARE_M_N1000_NoIndex_20yrs_noCKMR<-apply(abs(re_M),2,sd, na.rm=TRUE)

#Precision within sims
SD_ssb_N1000_NoIndex_20yrs_noCKMR<-CV_ssb_N1000_NoIndex_20yrs_noCKMR<-array(NA, dim=c(3,100,76)) 
SD_R0_N1000_NoIndex_20yrs_noCKMR<-matrix(NA, nrow=3, ncol=100)
SD_M_N1000_NoIndex_20yrs_noCKMR<-matrix(NA, nrow=3, ncol=100)
for(f in 1:3){
  for (i in 1:100){
    if(length(res_list[[f]][[i]])>2){
      CV_ssb_N1000_NoIndex_20yrs_noCKMR[f,i,]<-res_list[[f]][[i]]$SD$sd/res_list[[f]][[i]]$SD$value
    SD_ssb_N1000_NoIndex_20yrs_noCKMR[f,i,]<-res_list[[f]][[i]]$SD$sd
    SD_R0_N1000_NoIndex_20yrs_noCKMR[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_R0","log_R0"])
    SD_M_N1000_NoIndex_20yrs_noCKMR[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_M","log_M"])
    }
  }
}

#N5000 for 20yrs, No Index
res_list[[1]]<-readRDS(paste0(wd,"/SCAAfit_Cod_N5000_NoIndex_20yrs_noCKMR.RData"))
res_list[[2]]<-readRDS(paste0(wd,"/SCAAfit_Flatfish_N5000_NoIndex_20yrs_noCKMR.RData"))
res_list[[3]]<-readRDS(paste0(wd,"/SCAAfit_Sardine_N5000_NoIndex_20yrs_noCKMR.RData"))

Cod_wdat<-Cod_5000_25_20
Flatfish_wdat<-Flatfish_5000_25_20
Sardine_wdat<-Sardine_5000_25_20

re_Dep<-re_SSB<-array(NA, dim=c(3,100,76))
re_R0<-re_M<-matrix(NA, nrow=100, ncol=3)
for(f in 1:3){
  for (i in 1:100){
    if(f==1){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Cod_wdat[[i]]$OM$SSB[26:101])/Cod_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Cod_wdat[[i]]$OM$R0)/Cod_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Cod_wdat[[i]]$OM$Mref)/Cod_wdat[[i]]$OM$Mref
      }
    }else if (f==2){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Flatfish_wdat[[i]]$OM$SSB[26:101])/Flatfish_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Flatfish_wdat[[i]]$OM$R0)/Flatfish_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Flatfish_wdat[[i]]$OM$Mref)/Flatfish_wdat[[i]]$OM$Mref
      }
    } else if (f==3){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Sardine_wdat[[i]]$OM$SSB[26:101])/Sardine_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Sardine_wdat[[i]]$OM$R0)/Sardine_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Sardine_wdat[[i]]$OM$Mref)/Sardine_wdat[[i]]$OM$Mref
      }
    }
  }
}

#SSB
par(mfrow=c(3,3))
boxplot(re_SSB[1,,], ylim=c(-0.25,0.25), las=1, main="Cod - N5000|20yrs, No Index, No CKMR", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[2,,], ylim=c(-0.25,0.25), las=1, main="Flatfish - N5000|20yrs, No Index, No CKMR", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[3,,], ylim=c(-0.25,0.25), las=1, main="Sardine - N5000|20yrs, No Index, No CKMR", ylab="RE - SSB")
abline(h=0)

#R0
boxplot(re_R0[,1], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,2], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,3], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)

#M
boxplot(re_M[,1], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,2], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,3], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)

#Relative error for point estimates
RE_ssb_N5000_NoIndex_20yrs_noCKMR<-re_SSB
RE_R0_N5000_NoIndex_20yrs_noCKMR<-re_R0
RE_M_N5000_NoIndex_20yrs_noCKMR<-re_M

#Interquartile Range of relative errors
IQR_RE_ssb_N5000_NoIndex_20yrs_noCKMR<-apply(re_SSB,c(1,3),quantile,probs=0.75, na.rm=TRUE)-apply(re_SSB,c(1,3),quantile,probs=0.25, na.rm=TRUE)
IQR_RE_R0_N5000_NoIndex_20yrs_noCKMR<-apply(re_R0,2,quantile,probs=0.75, na.rm=TRUE)-apply(re_R0,2,quantile,probs=0.25, na.rm=TRUE)
IQR_RE_M_N5000_NoIndex_20yrs_noCKMR<-apply(re_M,2,quantile,probs=0.75, na.rm=TRUE)-apply(re_M,2,quantile,probs=0.25, na.rm=TRUE)

#Interquartile Range of absolute relative errors
IQR_ARE_ssb_N5000_NoIndex_20yrs_noCKMR<-apply(abs(re_SSB),c(1,3),quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_SSB),c(1,3),quantile,probs=0.25, na.rm=TRUE)
IQR_ARE_R0_N5000_NoIndex_20yrs_noCKMR<-apply(abs(re_R0),2,quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_R0),2,quantile,probs=0.25, na.rm=TRUE)
IQR_ARE_M_N5000_NoIndex_20yrs_noCKMR<-apply(abs(re_M),2,quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_M),2,quantile,probs=0.25, na.rm=TRUE)

#SD of relative error for point estimates
sd_RE_ssb_N5000_NoIndex_20yrs_noCKMR<-apply(re_SSB,c(1,3),sd, na.rm=TRUE)
sd_RE_R0_N5000_NoIndex_20yrs_noCKMR<-apply(re_R0,2,sd, na.rm=TRUE)
sd_RE_M_N5000_NoIndex_20yrs_noCKMR<-apply(re_M,2,sd, na.rm=TRUE)

#SD of absolute relative error
sd_ARE_ssb_N5000_NoIndex_20yrs_noCKMR<-apply(abs(re_SSB),c(1,3),sd, na.rm=TRUE)
sd_ARE_R0_N5000_NoIndex_20yrs_noCKMR<-apply(abs(re_R0),2,sd, na.rm=TRUE)
sd_ARE_M_N5000_NoIndex_20yrs_noCKMR<-apply(abs(re_M),2,sd, na.rm=TRUE)

#Precision within sims
SD_ssb_N5000_NoIndex_20yrs_noCKMR<-CV_ssb_N5000_NoIndex_20yrs_noCKMR<-array(NA, dim=c(3,100,76)) 
SD_R0_N5000_NoIndex_20yrs_noCKMR<-matrix(NA, nrow=3, ncol=100)
SD_M_N5000_NoIndex_20yrs_noCKMR<-matrix(NA, nrow=3, ncol=100)
for(f in 1:3){
  for (i in 1:100){
    if(length(res_list[[f]][[i]])>2){
      CV_ssb_N5000_NoIndex_20yrs_noCKMR[f,i,]<-res_list[[f]][[i]]$SD$sd/res_list[[f]][[i]]$SD$value
    SD_ssb_N5000_NoIndex_20yrs_noCKMR[f,i,]<-res_list[[f]][[i]]$SD$sd
    SD_R0_N5000_NoIndex_20yrs_noCKMR[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_R0","log_R0"])
    SD_M_N5000_NoIndex_20yrs_noCKMR[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_M","log_M"])
    }
  }
}

##################################
#SCAAs with CKMR data
##################################

#N100, 5yrs CKMR data, sd index 0.25
res_list<-list()
res_list[[1]]<-readRDS(paste0(wd,"/SCAAfit_Cod_N100_Ind25_ckmrmultinom5.RData"))
res_list[[2]]<-readRDS(paste0(wd,"/SCAAfit_Flatfish_N100_Ind25_ckmrmultinom5.RData"))
res_list[[3]]<-readRDS(paste0(wd,"/SCAAfit_Sardine_N100_Ind25_ckmrmultinom5.RData"))

load(paste0(wd,"/Cod_wdat_N100_Ind25_ckmrmultinom5_1.RData"))
load(paste0(wd,"/Flatfish_wdat_N100_Ind25_ckmrmultinom5_1.RData"))
load(paste0(wd,"/Sardine_wdat_N100_Ind25_ckmrmultinom5_1.RData"))

re_Dep<-re_SSB<-array(NA, dim=c(3,100,76))
re_R0<-re_M<-matrix(NA, nrow=100, ncol=3)
for(f in 1:3){
  for (i in 1:100){
    if(f==1){
      if(length(res_list[[f]][[i]])>2){
       re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Cod_wdat[[i]]$OM$SSB[26:101])/Cod_wdat[[i]]$OM$SSB[26:101]
       re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Cod_wdat[[i]]$OM$R0)/Cod_wdat[[i]]$OM$R0
       re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Cod_wdat[[i]]$OM$Mref)/Cod_wdat[[i]]$OM$Mref
      }
    }else if (f==2){
      if(length(res_list[[f]][[i]])>2){
       re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Flatfish_wdat[[i]]$OM$SSB[26:101])/Flatfish_wdat[[i]]$OM$SSB[26:101]
       re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Flatfish_wdat[[i]]$OM$R0)/Flatfish_wdat[[i]]$OM$R0
       re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Flatfish_wdat[[i]]$OM$Mref)/Flatfish_wdat[[i]]$OM$Mref
      }
    } else if (f==3){
      if(length(res_list[[f]][[i]])>2){
       re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Sardine_wdat[[i]]$OM$SSB[26:101])/Sardine_wdat[[i]]$OM$SSB[26:101]
       re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Sardine_wdat[[i]]$OM$R0)/Sardine_wdat[[i]]$OM$R0
       re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Sardine_wdat[[i]]$OM$Mref)/Sardine_wdat[[i]]$OM$Mref
     }
    }
  }
}

#SSB
par(mfrow=c(3,3))
boxplot(re_SSB[1,,], ylim=c(-0.25,0.25), las=1, main="Cod - N100, Index SD - 0.25, CKMR 5yrs", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[2,,], ylim=c(-0.25,0.25), las=1, main="Flatfish - N100, Index SD - 0.25, CKMR 5yrs", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[3,,], ylim=c(-0.25,0.25), las=1, main="Sardine - N100, Index SD - 0.25, CKMR 5yrs", ylab="RE - SSB")
abline(h=0)

#R0
boxplot(re_R0[,1], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,2], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,3], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)

#M
boxplot(re_M[,1], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,2], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,3], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)

#Relative error for point estimates
RE_ssb_N100_Ind25_ckmrmultinom5<-re_SSB
RE_R0_N100_Ind25_ckmrmultinom5<-re_R0
RE_M_N100_Ind25_ckmrmultinom5<-re_M

#Interquartile Range of relative errors
IQR_RE_ssb_N100_Ind25_ckmrmultinom5<-apply(re_SSB,c(1,3),quantile,probs=0.75, na.rm=TRUE)-apply(re_SSB,c(1,3),quantile,probs=0.25, na.rm=TRUE)
IQR_RE_R0_N100_Ind25_ckmrmultinom5<-apply(re_R0,2,quantile,probs=0.75, na.rm=TRUE)-apply(re_R0,2,quantile,probs=0.25, na.rm=TRUE)
IQR_RE_M_N100_Ind25_ckmrmultinom5<-apply(re_M,2,quantile,probs=0.75, na.rm=TRUE)-apply(re_M,2,quantile,probs=0.25, na.rm=TRUE)

#Interquartile Range of absolute relative errors
IQR_ARE_ssb_N100_Ind25_ckmrmultinom5<-apply(abs(re_SSB),c(1,3),quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_SSB),c(1,3),quantile,probs=0.25, na.rm=TRUE)
IQR_ARE_R0_N100_Ind25_ckmrmultinom5<-apply(abs(re_R0),2,quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_R0),2,quantile,probs=0.25, na.rm=TRUE)
IQR_ARE_M_N100_Ind25_ckmrmultinom5<-apply(abs(re_M),2,quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_M),2,quantile,probs=0.25, na.rm=TRUE)

#SD of relative error for point estimates
sd_RE_ssb_N100_Ind25_ckmrmultinom5<-apply(re_SSB,c(1,3),sd, na.rm=TRUE)
sd_RE_R0_N100_Ind25_ckmrmultinom5<-apply(re_R0,2,sd, na.rm=TRUE)
sd_RE_M_N100_Ind25_ckmrmultinom5<-apply(re_M,2,sd, na.rm=TRUE)

#SD of absolute relative error
sd_ARE_ssb_N100_Ind25_ckmrmultinom5<-apply(abs(re_SSB),c(1,3),sd, na.rm=TRUE)
sd_ARE_R0_N100_Ind25_ckmrmultinom5<-apply(abs(re_R0),2,sd, na.rm=TRUE)
sd_ARE_M_N100_Ind25_ckmrmultinom5<-apply(abs(re_M),2,sd, na.rm=TRUE)

#Precision within sims
SD_ssb_N100_Ind25_ckmrmultinom5<-CV_ssb_N100_Ind25_ckmrmultinom5<-array(NA, dim=c(3,100,76)) 
SD_R0_N100_Ind25_ckmrmultinom5<-matrix(NA, nrow=3, ncol=100)
SD_M_N100_Ind25_ckmrmultinom5<-matrix(NA, nrow=3, ncol=100)
 for(f in 1:3){
  for (i in 1:100){
    if(length(res_list[[f]][[i]])>2){
      CV_ssb_N100_Ind25_ckmrmultinom5[f,i,]<-res_list[[f]][[i]]$SD$sd/res_list[[f]][[i]]$SD$value
    SD_ssb_N100_Ind25_ckmrmultinom5[f,i,]<-res_list[[f]][[i]]$SD$sd
    SD_R0_N100_Ind25_ckmrmultinom5[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_R0","log_R0"])
    SD_M_N100_Ind25_ckmrmultinom5[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_M","log_M"])
   }
  }
 }

#N1000, 5yrs CKMR data, sd index 0.25
res_list<-list()
res_list[[1]]<-readRDS(paste0(wd,"/SCAAfit_Cod_N1000_Ind25_ckmrmultinom5.RData"))
res_list[[2]]<-readRDS(paste0(wd,"/SCAAfit_Flatfish_N1000_Ind25_ckmrmultinom5.RData"))
res_list[[3]]<-readRDS(paste0(wd,"/SCAAfit_Sardine_N1000_Ind25_ckmrmultinom5.RData"))

load(paste0(wd,"/Cod_wdat_N1000_Ind25_ckmrmultinom5_1.RData"))
load(paste0(wd,"/Flatfish_wdat_N1000_Ind25_ckmrmultinom5_1.RData"))
load(paste0(wd,"/Sardine_wdat_N1000_Ind25_ckmrmultinom5_1.RData"))

re_Dep<-re_SSB<-array(NA, dim=c(3,100,76))
re_R0<-re_M<-matrix(NA, nrow=100, ncol=3)
for(f in 1:3){
  for (i in 1:100){
    if(f==1){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Cod_wdat[[i]]$OM$SSB[26:101])/Cod_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Cod_wdat[[i]]$OM$R0)/Cod_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Cod_wdat[[i]]$OM$Mref)/Cod_wdat[[i]]$OM$Mref
      }
    }else if (f==2){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Flatfish_wdat[[i]]$OM$SSB[26:101])/Flatfish_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Flatfish_wdat[[i]]$OM$R0)/Flatfish_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Flatfish_wdat[[i]]$OM$Mref)/Flatfish_wdat[[i]]$OM$Mref
      }
    } else if (f==3){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Sardine_wdat[[i]]$OM$SSB[26:101])/Sardine_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Sardine_wdat[[i]]$OM$R0)/Sardine_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Sardine_wdat[[i]]$OM$Mref)/Sardine_wdat[[i]]$OM$Mref
      }
    }
  }
}

#SSB
par(mfrow=c(3,3))
boxplot(re_SSB[1,,], ylim=c(-0.25,0.25), las=1, main="Cod - N1000, Index SD - 0.25, CKMR 5yrs", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[2,,], ylim=c(-0.25,0.25), las=1, main="Flatfish - N1000, Index SD - 0.25, CKMR 5yrs", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[3,,], ylim=c(-0.25,0.25), las=1, main="Sardine - N1000, Index SD - 0.25, CKMR 5yrs", ylab="RE - SSB")
abline(h=0)

#R0
boxplot(re_R0[,1], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,2], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,3], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)

#M
boxplot(re_M[,1], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,2], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,3], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)

#Relative error for point estimates
RE_ssb_N1000_Ind25_ckmrmultinom5<-re_SSB
RE_R0_N1000_Ind25_ckmrmultinom5<-re_R0
RE_M_N1000_Ind25_ckmrmultinom5<-re_M

#Interquartile Range of relative errors
IQR_RE_ssb_N1000_Ind25_ckmrmultinom5<-apply(re_SSB,c(1,3),quantile,probs=0.75, na.rm=TRUE)-apply(re_SSB,c(1,3),quantile,probs=0.25, na.rm=TRUE)
IQR_RE_R0_N1000_Ind25_ckmrmultinom5<-apply(re_R0,2,quantile,probs=0.75, na.rm=TRUE)-apply(re_R0,2,quantile,probs=0.25, na.rm=TRUE)
IQR_RE_M_N1000_Ind25_ckmrmultinom5<-apply(re_M,2,quantile,probs=0.75, na.rm=TRUE)-apply(re_M,2,quantile,probs=0.25, na.rm=TRUE)

#Interquartile Range of absolute relative errors
IQR_ARE_ssb_N1000_Ind25_ckmrmultinom5<-apply(abs(re_SSB),c(1,3),quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_SSB),c(1,3),quantile,probs=0.25, na.rm=TRUE)
IQR_ARE_R0_N1000_Ind25_ckmrmultinom5<-apply(abs(re_R0),2,quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_R0),2,quantile,probs=0.25, na.rm=TRUE)
IQR_ARE_M_N1000_Ind25_ckmrmultinom5<-apply(abs(re_M),2,quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_M),2,quantile,probs=0.25, na.rm=TRUE)

#SD of relative error for point estimates
sd_RE_ssb_N1000_Ind25_ckmrmultinom5<-apply(re_SSB,c(1,3),sd, na.rm=TRUE)
sd_RE_R0_N1000_Ind25_ckmrmultinom5<-apply(re_R0,2,sd, na.rm=TRUE)
sd_RE_M_N1000_Ind25_ckmrmultinom5<-apply(re_M,2,sd, na.rm=TRUE)

#SD of absolute relative error
sd_ARE_ssb_N1000_Ind25_ckmrmultinom5<-apply(abs(re_SSB),c(1,3),sd, na.rm=TRUE)
sd_ARE_R0_N1000_Ind25_ckmrmultinom5<-apply(abs(re_R0),2,sd, na.rm=TRUE)
sd_ARE_M_N1000_Ind25_ckmrmultinom5<-apply(abs(re_M),2,sd, na.rm=TRUE)

#Precision within sims
SD_ssb_N1000_Ind25_ckmrmultinom5<-CV_ssb_N1000_Ind25_ckmrmultinom5<-array(NA, dim=c(3,100,76)) 
SD_R0_N1000_Ind25_ckmrmultinom5<-matrix(NA, nrow=3, ncol=100)
SD_M_N1000_Ind25_ckmrmultinom5<-matrix(NA, nrow=3, ncol=100)
for(f in 1:3){
  for (i in 1:100){
    if(length(res_list[[f]][[i]])>2){
      CV_ssb_N1000_Ind25_ckmrmultinom5[f,i,]<-res_list[[f]][[i]]$SD$sd/res_list[[f]][[i]]$SD$value
    SD_ssb_N1000_Ind25_ckmrmultinom5[f,i,]<-res_list[[f]][[i]]$SD$sd
    SD_R0_N1000_Ind25_ckmrmultinom5[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_R0","log_R0"])
    SD_M_N1000_Ind25_ckmrmultinom5[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_M","log_M"])
    }
  }
}

#N5000, 5yrs CKMR data, sd index 0.25
res_list<-list()
res_list[[1]]<-readRDS(paste0(wd,"/SCAAfit_Cod_N5000_Ind25_ckmrmultinom5.RData"))
res_list[[2]]<-readRDS(paste0(wd,"/SCAAfit_Flatfish_N5000_Ind25_ckmrmultinom5.RData"))
res_list[[3]]<-readRDS(paste0(wd,"/SCAAfit_Sardine_N5000_Ind25_ckmrmultinom5.RData"))

load(paste0(wd,"/Cod_wdat_N5000_Ind25_ckmrmultinom5_1.RData"))
load(paste0(wd,"/Flatfish_wdat_N5000_Ind25_ckmrmultinom5_1.RData"))
load(paste0(wd,"/Sardine_wdat_N5000_Ind25_ckmrmultinom5_1.RData"))

re_Dep<-re_SSB<-array(NA, dim=c(3,100,76))
re_R0<-re_M<-matrix(NA, nrow=100, ncol=3)
for(f in 1:3){
  for (i in 1:100){
    if(f==1){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Cod_wdat[[i]]$OM$SSB[26:101])/Cod_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Cod_wdat[[i]]$OM$R0)/Cod_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Cod_wdat[[i]]$OM$Mref)/Cod_wdat[[i]]$OM$Mref
      }
    }else if (f==2){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Flatfish_wdat[[i]]$OM$SSB[26:101])/Flatfish_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Flatfish_wdat[[i]]$OM$R0)/Flatfish_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Flatfish_wdat[[i]]$OM$Mref)/Flatfish_wdat[[i]]$OM$Mref
      }
    } else if (f==3){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Sardine_wdat[[i]]$OM$SSB[26:101])/Sardine_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Sardine_wdat[[i]]$OM$R0)/Sardine_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Sardine_wdat[[i]]$OM$Mref)/Sardine_wdat[[i]]$OM$Mref
      }
    }
  }
}

#SSB
par(mfrow=c(3,3))
boxplot(re_SSB[1,,], ylim=c(-0.25,0.25), las=1, main="Cod - N5000, Index SD - 0.25, CKMR 5yrs", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[2,,], ylim=c(-0.25,0.25), las=1, main="Flatfish - N5000, Index SD - 0.25, CKMR 5yrs", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[3,,], ylim=c(-0.25,0.25), las=1, main="Sardine - N5000, Index SD - 0.25, CKMR 5yrs", ylab="RE - SSB")
abline(h=0)

#R0
boxplot(re_R0[,1], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,2], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,3], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)

#M
boxplot(re_M[,1], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,2], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,3], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)

#Relative error for point estimates
RE_ssb_N5000_Ind25_ckmrmultinom5<-re_SSB
RE_R0_N5000_Ind25_ckmrmultinom5<-re_R0
RE_M_N5000_Ind25_ckmrmultinom5<-re_M

#Interquartile Range of relative errors
IQR_RE_ssb_N5000_Ind25_ckmrmultinom5<-apply(re_SSB,c(1,3),quantile,probs=0.75, na.rm=TRUE)-apply(re_SSB,c(1,3),quantile,probs=0.25, na.rm=TRUE)
IQR_RE_R0_N5000_Ind25_ckmrmultinom5<-apply(re_R0,2,quantile,probs=0.75, na.rm=TRUE)-apply(re_R0,2,quantile,probs=0.25, na.rm=TRUE)
IQR_RE_M_N5000_Ind25_ckmrmultinom5<-apply(re_M,2,quantile,probs=0.75, na.rm=TRUE)-apply(re_M,2,quantile,probs=0.25, na.rm=TRUE)

#Interquartile Range of absolute relative errors
IQR_ARE_ssb_N5000_Ind25_ckmrmultinom5<-apply(abs(re_SSB),c(1,3),quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_SSB),c(1,3),quantile,probs=0.25, na.rm=TRUE)
IQR_ARE_R0_N5000_Ind25_ckmrmultinom5<-apply(abs(re_R0),2,quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_R0),2,quantile,probs=0.25, na.rm=TRUE)
IQR_ARE_M_N5000_Ind25_ckmrmultinom5<-apply(abs(re_M),2,quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_M),2,quantile,probs=0.25, na.rm=TRUE)

#SD of relative error for point estimates
sd_RE_ssb_N5000_Ind25_ckmrmultinom5<-apply(re_SSB,c(1,3),sd, na.rm=TRUE)
sd_RE_R0_N5000_Ind25_ckmrmultinom5<-apply(re_R0,2,sd, na.rm=TRUE)
sd_RE_M_N5000_Ind25_ckmrmultinom5<-apply(re_M,2,sd, na.rm=TRUE)

#SD of absolute relative error
sd_ARE_ssb_N5000_Ind25_ckmrmultinom5<-apply(abs(re_SSB),c(1,3),sd, na.rm=TRUE)
sd_ARE_R0_N5000_Ind25_ckmrmultinom5<-apply(abs(re_R0),2,sd, na.rm=TRUE)
sd_ARE_M_N5000_Ind25_ckmrmultinom5<-apply(abs(re_M),2,sd, na.rm=TRUE)

#Precision within sims
SD_ssb_N5000_Ind25_ckmrmultinom5<-CV_ssb_N5000_Ind25_ckmrmultinom5<-array(NA, dim=c(3,100,76)) 
SD_R0_N5000_Ind25_ckmrmultinom5<-matrix(NA, nrow=3, ncol=100)
SD_M_N5000_Ind25_ckmrmultinom5<-matrix(NA, nrow=3, ncol=100)
for(f in 1:3){
  for (i in 1:100){
    if(length(res_list[[f]][[i]])>2){
      CV_ssb_N5000_Ind25_ckmrmultinom5[f,i,]<-res_list[[f]][[i]]$SD$sd/res_list[[f]][[i]]$SD$value
    SD_ssb_N5000_Ind25_ckmrmultinom5[f,i,]<-res_list[[f]][[i]]$SD$sd
    SD_R0_N5000_Ind25_ckmrmultinom5[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_R0","log_R0"])
    SD_M_N5000_Ind25_ckmrmultinom5[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_M","log_M"])
    }
  }
}

#N100, 5yrs CKMR data, sd index 0.50
res_list<-list()
res_list[[1]]<-readRDS(paste0(wd,"/SCAAfit_Cod_N100_Ind50_ckmrmultinom5.RData"))
res_list[[2]]<-readRDS(paste0(wd,"/SCAAfit_Flatfish_N100_Ind50_ckmrmultinom5.RData"))
res_list[[3]]<-readRDS(paste0(wd,"/SCAAfit_Sardine_N100_Ind50_ckmrmultinom5.RData"))

load(paste0(wd,"/Cod_wdat_N100_Ind50_ckmrmultinom5_1.RData"))
load(paste0(wd,"/Flatfish_wdat_N100_Ind50_ckmrmultinom5_1.RData"))
load(paste0(wd,"/Sardine_wdat_N100_Ind50_ckmrmultinom5_1.RData"))

re_Dep<-re_SSB<-array(NA, dim=c(3,100,76))
re_R0<-re_M<-matrix(NA, nrow=100, ncol=3)
for(f in 1:3){
  for (i in 1:100){
    if(f==1){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Cod_wdat[[i]]$OM$SSB[26:101])/Cod_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Cod_wdat[[i]]$OM$R0)/Cod_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Cod_wdat[[i]]$OM$Mref)/Cod_wdat[[i]]$OM$Mref
      }
    }else if (f==2){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Flatfish_wdat[[i]]$OM$SSB[26:101])/Flatfish_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Flatfish_wdat[[i]]$OM$R0)/Flatfish_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Flatfish_wdat[[i]]$OM$Mref)/Flatfish_wdat[[i]]$OM$Mref
      }
    } else if (f==3){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Sardine_wdat[[i]]$OM$SSB[26:101])/Sardine_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Sardine_wdat[[i]]$OM$R0)/Sardine_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Sardine_wdat[[i]]$OM$Mref)/Sardine_wdat[[i]]$OM$Mref
      }
    }
  }
}

#SSB
par(mfrow=c(3,3))
boxplot(re_SSB[1,,], ylim=c(-0.25,0.25), las=1, main="Cod - N100, Index SD - 0.50, CKMR 5yrs", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[2,,], ylim=c(-0.25,0.25), las=1, main="Flatfish - N100, Index SD - 0.50, CKMR 5yrs", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[3,,], ylim=c(-0.25,0.25), las=1, main="Sardine - N100, Index SD - 0.50, CKMR 5yrs", ylab="RE - SSB")
abline(h=0)

#R0
boxplot(re_R0[,1], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,2], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,3], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)

#M
boxplot(re_M[,1], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,2], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,3], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)

#Relative error for point estimates
RE_ssb_N100_Ind50_ckmrmultinom5<-re_SSB
RE_R0_N100_Ind50_ckmrmultinom5<-re_R0
RE_M_N100_Ind50_ckmrmultinom5<-re_M

#Interquartile Range of relative errors
IQR_RE_ssb_N100_Ind50_ckmrmultinom5<-apply(re_SSB,c(1,3),quantile,probs=0.75, na.rm=TRUE)-apply(re_SSB,c(1,3),quantile,probs=0.25, na.rm=TRUE)
IQR_RE_R0_N100_Ind50_ckmrmultinom5<-apply(re_R0,2,quantile,probs=0.75, na.rm=TRUE)-apply(re_R0,2,quantile,probs=0.25, na.rm=TRUE)
IQR_RE_M_N100_Ind50_ckmrmultinom5<-apply(re_M,2,quantile,probs=0.75, na.rm=TRUE)-apply(re_M,2,quantile,probs=0.25, na.rm=TRUE)

#Interquartile Range of absolute relative errors
IQR_ARE_ssb_N100_Ind50_ckmrmultinom5<-apply(abs(re_SSB),c(1,3),quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_SSB),c(1,3),quantile,probs=0.25, na.rm=TRUE)
IQR_ARE_R0_N100_Ind50_ckmrmultinom5<-apply(abs(re_R0),2,quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_R0),2,quantile,probs=0.25, na.rm=TRUE)
IQR_ARE_M_N100_Ind50_ckmrmultinom5<-apply(abs(re_M),2,quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_M),2,quantile,probs=0.25, na.rm=TRUE)

#SD of relative error for point estimates
sd_RE_ssb_N100_Ind50_ckmrmultinom5<-apply(re_SSB,c(1,3),sd, na.rm=TRUE)
sd_RE_R0_N100_Ind50_ckmrmultinom5<-apply(re_R0,2,sd, na.rm=TRUE)
sd_RE_M_N100_Ind50_ckmrmultinom5<-apply(re_M,2,sd, na.rm=TRUE)

#SD of absolute relative error
sd_ARE_ssb_N100_Ind50_ckmrmultinom5<-apply(abs(re_SSB),c(1,3),sd, na.rm=TRUE)
sd_ARE_R0_N100_Ind50_ckmrmultinom5<-apply(abs(re_R0),2,sd, na.rm=TRUE)
sd_ARE_M_N100_Ind50_ckmrmultinom5<-apply(abs(re_M),2,sd, na.rm=TRUE)

#Precision within sims
SD_ssb_N100_Ind50_ckmrmultinom5<-CV_ssb_N100_Ind50_ckmrmultinom5<-array(NA, dim=c(3,100,76)) 
SD_R0_N100_Ind50_ckmrmultinom5<-matrix(NA, nrow=3, ncol=100)
SD_M_N100_Ind50_ckmrmultinom5<-matrix(NA, nrow=3, ncol=100)
for(f in 1:3){
  for (i in 1:100){
    if(length(res_list[[f]][[i]])>2){
      CV_ssb_N100_Ind50_ckmrmultinom5[f,i,]<-res_list[[f]][[i]]$SD$sd/res_list[[f]][[i]]$SD$value
    SD_ssb_N100_Ind50_ckmrmultinom5[f,i,]<-res_list[[f]][[i]]$SD$sd
    SD_R0_N100_Ind50_ckmrmultinom5[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_R0","log_R0"])
    SD_M_N100_Ind50_ckmrmultinom5[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_M","log_M"])
    }
  }
}

#N1000, 5yrs CKMR data, sd index 0.50
res_list<-list()
res_list[[1]]<-readRDS(paste0(wd,"/SCAAfit_Cod_N1000_Ind50_ckmrmultinom5.RData"))
res_list[[2]]<-readRDS(paste0(wd,"/SCAAfit_Flatfish_N1000_Ind50_ckmrmultinom5.RData"))
res_list[[3]]<-readRDS(paste0(wd,"/SCAAfit_Sardine_N1000_Ind50_ckmrmultinom5.RData"))

load(paste0(wd,"/Cod_wdat_N1000_Ind50_ckmrmultinom5_1.RData"))
load(paste0(wd,"/Flatfish_wdat_N1000_Ind50_ckmrmultinom5_1.RData"))
load(paste0(wd,"/Sardine_wdat_N1000_Ind50_ckmrmultinom5_1.RData"))

re_Dep<-re_SSB<-array(NA, dim=c(3,100,76))
re_R0<-re_M<-matrix(NA, nrow=100, ncol=3)
for(f in 1:3){
  for (i in 1:100){
    if(f==1){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Cod_wdat[[i]]$OM$SSB[26:101])/Cod_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Cod_wdat[[i]]$OM$R0)/Cod_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Cod_wdat[[i]]$OM$Mref)/Cod_wdat[[i]]$OM$Mref
      }
    }else if (f==2){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Flatfish_wdat[[i]]$OM$SSB[26:101])/Flatfish_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Flatfish_wdat[[i]]$OM$R0)/Flatfish_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Flatfish_wdat[[i]]$OM$Mref)/Flatfish_wdat[[i]]$OM$Mref
      }
    } else if (f==3){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Sardine_wdat[[i]]$OM$SSB[26:101])/Sardine_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Sardine_wdat[[i]]$OM$R0)/Sardine_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Sardine_wdat[[i]]$OM$Mref)/Sardine_wdat[[i]]$OM$Mref
      }
    }
  }
}

#SSB
par(mfrow=c(3,3))
boxplot(re_SSB[1,,], ylim=c(-0.25,0.25), las=1, main="Cod - N1000, Index SD - 0.50, CKMR 5yrs", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[2,,], ylim=c(-0.25,0.25), las=1, main="Flatfish - N1000, Index SD - 0.50, CKMR 5yrs", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[3,,], ylim=c(-0.25,0.25), las=1, main="Sardine - N1000, Index SD - 0.50, CKMR 5yrs", ylab="RE - SSB")
abline(h=0)

#R0
boxplot(re_R0[,1], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,2], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,3], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)

#M
boxplot(re_M[,1], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,2], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,3], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)

#Relative error for point estimates
RE_ssb_N1000_Ind50_ckmrmultinom5<-re_SSB
RE_R0_N1000_Ind50_ckmrmultinom5<-re_R0
RE_M_N1000_Ind50_ckmrmultinom5<-re_M

#Interquartile Range of relative errors
IQR_RE_ssb_N1000_Ind50_ckmrmultinom5<-apply(re_SSB,c(1,3),quantile,probs=0.75, na.rm=TRUE)-apply(re_SSB,c(1,3),quantile,probs=0.25, na.rm=TRUE)
IQR_RE_R0_N1000_Ind50_ckmrmultinom5<-apply(re_R0,2,quantile,probs=0.75, na.rm=TRUE)-apply(re_R0,2,quantile,probs=0.25, na.rm=TRUE)
IQR_RE_M_N1000_Ind50_ckmrmultinom5<-apply(re_M,2,quantile,probs=0.75, na.rm=TRUE)-apply(re_M,2,quantile,probs=0.25, na.rm=TRUE)

#Interquartile Range of absolute relative errors
IQR_ARE_ssb_N1000_Ind50_ckmrmultinom5<-apply(abs(re_SSB),c(1,3),quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_SSB),c(1,3),quantile,probs=0.25, na.rm=TRUE)
IQR_ARE_R0_N1000_Ind50_ckmrmultinom5<-apply(abs(re_R0),2,quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_R0),2,quantile,probs=0.25, na.rm=TRUE)
IQR_ARE_M_N1000_Ind50_ckmrmultinom5<-apply(abs(re_M),2,quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_M),2,quantile,probs=0.25, na.rm=TRUE)

#SD of relative error for point estimates
sd_RE_ssb_N1000_Ind50_ckmrmultinom5<-apply(re_SSB,c(1,3),sd, na.rm=TRUE)
sd_RE_R0_N1000_Ind50_ckmrmultinom5<-apply(re_R0,2,sd, na.rm=TRUE)
sd_RE_M_N1000_Ind50_ckmrmultinom5<-apply(re_M,2,sd, na.rm=TRUE)

#SD of absolute relative error
sd_ARE_ssb_N1000_Ind50_ckmrmultinom5<-apply(abs(re_SSB),c(1,3),sd, na.rm=TRUE)
sd_ARE_R0_N1000_Ind50_ckmrmultinom5<-apply(abs(re_R0),2,sd, na.rm=TRUE)
sd_ARE_M_N1000_Ind50_ckmrmultinom5<-apply(abs(re_M),2,sd, na.rm=TRUE)

#Precision within sims
SD_ssb_N1000_Ind50_ckmrmultinom5<-CV_ssb_N1000_Ind50_ckmrmultinom5<-array(NA, dim=c(3,100,76)) 
SD_R0_N1000_Ind50_ckmrmultinom5<-matrix(NA, nrow=3, ncol=100)
SD_M_N1000_Ind50_ckmrmultinom5<-matrix(NA, nrow=3, ncol=100)
for(f in 1:3){
  for (i in 1:100){
    if(length(res_list[[f]][[i]])>2){
      CV_ssb_N1000_Ind50_ckmrmultinom5[f,i,]<-res_list[[f]][[i]]$SD$sd/res_list[[f]][[i]]$SD$value
    SD_ssb_N1000_Ind50_ckmrmultinom5[f,i,]<-res_list[[f]][[i]]$SD$sd
    SD_R0_N1000_Ind50_ckmrmultinom5[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_R0","log_R0"])
    SD_M_N1000_Ind50_ckmrmultinom5[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_M","log_M"])
    }
  }
}

#N5000, 5yrs CKMR data, sd index 0.50
res_list<-list()
res_list[[1]]<-readRDS(paste0(wd,"/SCAAfit_Cod_N5000_Ind50_ckmrmultinom5.RData"))
res_list[[2]]<-readRDS(paste0(wd,"/SCAAfit_Flatfish_N5000_Ind50_ckmrmultinom5.RData"))
res_list[[3]]<-readRDS(paste0(wd,"/SCAAfit_Sardine_N5000_Ind50_ckmrmultinom5.RData"))

load(paste0(wd,"/Cod_wdat_N5000_Ind50_ckmrmultinom5_1.RData"))
load(paste0(wd,"/Flatfish_wdat_N5000_Ind50_ckmrmultinom5_1.RData"))
load(paste0(wd,"/Sardine_wdat_N5000_Ind50_ckmrmultinom5_1.RData"))

re_Dep<-re_SSB<-array(NA, dim=c(3,100,76))
re_R0<-re_M<-matrix(NA, nrow=100, ncol=3)
for(f in 1:3){
  for (i in 1:100){
    if(f==1){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Cod_wdat[[i]]$OM$SSB[26:101])/Cod_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Cod_wdat[[i]]$OM$R0)/Cod_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Cod_wdat[[i]]$OM$Mref)/Cod_wdat[[i]]$OM$Mref
      }
    }else if (f==2){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Flatfish_wdat[[i]]$OM$SSB[26:101])/Flatfish_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Flatfish_wdat[[i]]$OM$R0)/Flatfish_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Flatfish_wdat[[i]]$OM$Mref)/Flatfish_wdat[[i]]$OM$Mref
      }
    } else if (f==3){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Sardine_wdat[[i]]$OM$SSB[26:101])/Sardine_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Sardine_wdat[[i]]$OM$R0)/Sardine_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Sardine_wdat[[i]]$OM$Mref)/Sardine_wdat[[i]]$OM$Mref
      }
    }
  }
}

#SSB
par(mfrow=c(3,3))
boxplot(re_SSB[1,,], ylim=c(-0.25,0.25), las=1, main="Cod - N5000, Index SD - 0.50, CKMR 5yrs", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[2,,], ylim=c(-0.25,0.25), las=1, main="Flatfish - N5000, Index SD - 0.50, CKMR 5yrs", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[3,,], ylim=c(-0.25,0.25), las=1, main="Sardine - N5000, Index SD - 0.50, CKMR 5yrs", ylab="RE - SSB")
abline(h=0)

#R0
boxplot(re_R0[,1], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,2], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,3], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)

#M
boxplot(re_M[,1], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,2], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,3], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)

#Relative error for point estimates
RE_ssb_N5000_Ind50_ckmrmultinom5<-re_SSB
RE_R0_N5000_Ind50_ckmrmultinom5<-re_R0
RE_M_N5000_Ind50_ckmrmultinom5<-re_M

#Interquartile Range of relative errors
IQR_RE_ssb_N5000_Ind50_ckmrmultinom5<-apply(re_SSB,c(1,3),quantile,probs=0.75, na.rm=TRUE)-apply(re_SSB,c(1,3),quantile,probs=0.25, na.rm=TRUE)
IQR_RE_R0_N5000_Ind50_ckmrmultinom5<-apply(re_R0,2,quantile,probs=0.75, na.rm=TRUE)-apply(re_R0,2,quantile,probs=0.25, na.rm=TRUE)
IQR_RE_M_N5000_Ind50_ckmrmultinom5<-apply(re_M,2,quantile,probs=0.75, na.rm=TRUE)-apply(re_M,2,quantile,probs=0.25, na.rm=TRUE)

#Interquartile Range of absolute relative errors
IQR_ARE_ssb_N5000_Ind50_ckmrmultinom5<-apply(abs(re_SSB),c(1,3),quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_SSB),c(1,3),quantile,probs=0.25, na.rm=TRUE)
IQR_ARE_R0_N5000_Ind50_ckmrmultinom5<-apply(abs(re_R0),2,quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_R0),2,quantile,probs=0.25, na.rm=TRUE)
IQR_ARE_M_N5000_Ind50_ckmrmultinom5<-apply(abs(re_M),2,quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_M),2,quantile,probs=0.25, na.rm=TRUE)

#SD of relative error for point estimates
sd_RE_ssb_N5000_Ind50_ckmrmultinom5<-apply(re_SSB,c(1,3),sd, na.rm=TRUE)
sd_RE_R0_N5000_Ind50_ckmrmultinom5<-apply(re_R0,2,sd, na.rm=TRUE)
sd_RE_M_N5000_Ind50_ckmrmultinom5<-apply(re_M,2,sd, na.rm=TRUE)

#SD of absolute relative error
sd_ARE_ssb_N5000_Ind50_ckmrmultinom5<-apply(abs(re_SSB),c(1,3),sd, na.rm=TRUE)
sd_ARE_R0_N5000_Ind50_ckmrmultinom5<-apply(abs(re_R0),2,sd, na.rm=TRUE)
sd_ARE_M_N5000_Ind50_ckmrmultinom5<-apply(abs(re_M),2,sd, na.rm=TRUE)

#Precision within sims
SD_ssb_N5000_Ind50_ckmrmultinom5<-CV_ssb_N5000_Ind50_ckmrmultinom5<-array(NA, dim=c(3,100,76)) 
SD_R0_N5000_Ind50_ckmrmultinom5<-matrix(NA, nrow=3, ncol=100)
SD_M_N5000_Ind50_ckmrmultinom5<-matrix(NA, nrow=3, ncol=100)
for(f in 1:3){
  for (i in 1:100){
    if(length(res_list[[f]][[i]])>2){
      CV_ssb_N5000_Ind50_ckmrmultinom5[f,i,]<-res_list[[f]][[i]]$SD$sd/res_list[[f]][[i]]$SD$value
    SD_ssb_N5000_Ind50_ckmrmultinom5[f,i,]<-res_list[[f]][[i]]$SD$sd
    SD_R0_N5000_Ind50_ckmrmultinom5[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_R0","log_R0"])
    SD_M_N5000_Ind50_ckmrmultinom5[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_M","log_M"])
    }
  }
}

#N100, 10yrs CKMR data, sd index 0.25
res_list<-list()
res_list[[1]]<-readRDS(paste0(wd,"/SCAAfit_Cod_N100_Ind25_ckmrmultinom10.RData"))
res_list[[2]]<-readRDS(paste0(wd,"/SCAAfit_Flatfish_N100_Ind25_ckmrmultinom10.RData"))
res_list[[3]]<-readRDS(paste0(wd,"/SCAAfit_Sardine_N100_Ind25_ckmrmultinom10.RData"))

load(paste0(wd,"/Cod_wdat_N100_Ind25_ckmrmultinom10_1.RData"))
load(paste0(wd,"/Flatfish_wdat_N100_Ind25_ckmrmultinom10_1.RData"))
load(paste0(wd,"/Sardine_wdat_N100_Ind25_ckmrmultinom10_1.RData"))

re_Dep<-re_SSB<-array(NA, dim=c(3,100,76))
re_R0<-re_M<-matrix(NA, nrow=100, ncol=3)
for(f in 1:3){
  for (i in 1:100){
    if(f==1){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Cod_wdat[[i]]$OM$SSB[26:101])/Cod_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Cod_wdat[[i]]$OM$R0)/Cod_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Cod_wdat[[i]]$OM$Mref)/Cod_wdat[[i]]$OM$Mref
      }
    }else if (f==2){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Flatfish_wdat[[i]]$OM$SSB[26:101])/Flatfish_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Flatfish_wdat[[i]]$OM$R0)/Flatfish_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Flatfish_wdat[[i]]$OM$Mref)/Flatfish_wdat[[i]]$OM$Mref
      }
    } else if (f==3){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Sardine_wdat[[i]]$OM$SSB[26:101])/Sardine_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Sardine_wdat[[i]]$OM$R0)/Sardine_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Sardine_wdat[[i]]$OM$Mref)/Sardine_wdat[[i]]$OM$Mref
      }
    }
  }
}

#SSB
par(mfrow=c(3,3))
boxplot(re_SSB[1,,], ylim=c(-0.25,0.25), las=1, main="Cod - N100, Index SD - 0.25, CKMR 10yrs", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[2,,], ylim=c(-0.25,0.25), las=1, main="Flatfish - N100, Index SD - 0.25, CKMR 10yrs", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[3,,], ylim=c(-0.25,0.25), las=1, main="Sardine - N100, Index SD - 0.25, CKMR 10yrs", ylab="RE - SSB")
abline(h=0)

#R0
boxplot(re_R0[,1], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,2], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,3], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)

#M
boxplot(re_M[,1], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,2], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,3], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)

#Relative error for point estimates
RE_ssb_N100_Ind25_ckmrmultinom10<-re_SSB
RE_R0_N100_Ind25_ckmrmultinom10<-re_R0
RE_M_N100_Ind25_ckmrmultinom10<-re_M

#Interquartile Range of relative errors
IQR_RE_ssb_N100_Ind25_ckmrmultinom10<-apply(re_SSB,c(1,3),quantile,probs=0.75, na.rm=TRUE)-apply(re_SSB,c(1,3),quantile,probs=0.25, na.rm=TRUE)
IQR_RE_R0_N100_Ind25_ckmrmultinom10<-apply(re_R0,2,quantile,probs=0.75, na.rm=TRUE)-apply(re_R0,2,quantile,probs=0.25, na.rm=TRUE)
IQR_RE_M_N100_Ind25_ckmrmultinom10<-apply(re_M,2,quantile,probs=0.75, na.rm=TRUE)-apply(re_M,2,quantile,probs=0.25, na.rm=TRUE)

#Interquartile Range of absolute relative errors
IQR_ARE_ssb_N100_Ind25_ckmrmultinom10<-apply(abs(re_SSB),c(1,3),quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_SSB),c(1,3),quantile,probs=0.25, na.rm=TRUE)
IQR_ARE_R0_N100_Ind25_ckmrmultinom10<-apply(abs(re_R0),2,quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_R0),2,quantile,probs=0.25, na.rm=TRUE)
IQR_ARE_M_N100_Ind25_ckmrmultinom10<-apply(abs(re_M),2,quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_M),2,quantile,probs=0.25, na.rm=TRUE)

#SD of relative error for point estimates
sd_RE_ssb_N100_Ind25_ckmrmultinom10<-apply(re_SSB,c(1,3),sd, na.rm=TRUE)
sd_RE_R0_N100_Ind25_ckmrmultinom10<-apply(re_R0,2,sd, na.rm=TRUE)
sd_RE_M_N100_Ind25_ckmrmultinom10<-apply(re_M,2,sd, na.rm=TRUE)

#SD of absolute relative error
sd_ARE_ssb_N100_Ind25_ckmrmultinom10<-apply(abs(re_SSB),c(1,3),sd, na.rm=TRUE)
sd_ARE_R0_N100_Ind25_ckmrmultinom10<-apply(abs(re_R0),2,sd, na.rm=TRUE)
sd_ARE_M_N100_Ind25_ckmrmultinom10<-apply(abs(re_M),2,sd, na.rm=TRUE)

#Precision within sims
SD_ssb_N100_Ind25_ckmrmultinom10<-CV_ssb_N100_Ind25_ckmrmultinom10<-array(NA, dim=c(3,100,76)) 
SD_R0_N100_Ind25_ckmrmultinom10<-matrix(NA, nrow=3, ncol=100)
SD_M_N100_Ind25_ckmrmultinom10<-matrix(NA, nrow=3, ncol=100)
for(f in 1:3){
  for (i in 1:100){
    if(length(res_list[[f]][[i]])>2){
      CV_ssb_N100_Ind25_ckmrmultinom10[f,i,]<-res_list[[f]][[i]]$SD$sd/res_list[[f]][[i]]$SD$value
    SD_ssb_N100_Ind25_ckmrmultinom10[f,i,]<-res_list[[f]][[i]]$SD$sd
    SD_R0_N100_Ind25_ckmrmultinom10[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_R0","log_R0"])
    SD_M_N100_Ind25_ckmrmultinom10[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_M","log_M"])
    }
  }
}

#N1000, 10yrs CKMR data, sd index 0.25
res_list<-list()
res_list[[1]]<-readRDS(paste0(wd,"/SCAAfit_Cod_N1000_Ind25_ckmrmultinom10.RData"))
res_list[[2]]<-readRDS(paste0(wd,"/SCAAfit_Flatfish_N1000_Ind25_ckmrmultinom10.RData"))
res_list[[3]]<-readRDS(paste0(wd,"/SCAAfit_Sardine_N1000_Ind25_ckmrmultinom10.RData"))

load(paste0(wd,"/Cod_wdat_N1000_Ind25_ckmrmultinom10_1.RData"))
load(paste0(wd,"/Flatfish_wdat_N1000_Ind25_ckmrmultinom10_1.RData"))
load(paste0(wd,"/Sardine_wdat_N1000_Ind25_ckmrmultinom10_1.RData"))

re_Dep<-re_SSB<-array(NA, dim=c(3,100,76))
re_R0<-re_M<-matrix(NA, nrow=100, ncol=3)
for(f in 1:3){
  for (i in 1:100){
    if(f==1){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Cod_wdat[[i]]$OM$SSB[26:101])/Cod_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Cod_wdat[[i]]$OM$R0)/Cod_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Cod_wdat[[i]]$OM$Mref)/Cod_wdat[[i]]$OM$Mref
      }
    }else if (f==2){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Flatfish_wdat[[i]]$OM$SSB[26:101])/Flatfish_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Flatfish_wdat[[i]]$OM$R0)/Flatfish_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Flatfish_wdat[[i]]$OM$Mref)/Flatfish_wdat[[i]]$OM$Mref
      }
    } else if (f==3){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Sardine_wdat[[i]]$OM$SSB[26:101])/Sardine_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Sardine_wdat[[i]]$OM$R0)/Sardine_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Sardine_wdat[[i]]$OM$Mref)/Sardine_wdat[[i]]$OM$Mref
      }
    }
  }
}

#SSB
par(mfrow=c(3,3))
boxplot(re_SSB[1,,], ylim=c(-0.25,0.25), las=1, main="Cod - N1000, Index SD - 0.25, CKMR 10yrs", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[2,,], ylim=c(-0.25,0.25), las=1, main="Flatfish - N1000, Index SD - 0.25, CKMR 10yrs", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[3,,], ylim=c(-0.25,0.25), las=1, main="Sardine - N1000, Index SD - 0.25, CKMR 10yrs", ylab="RE - SSB")
abline(h=0)

#R0
boxplot(re_R0[,1], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,2], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,3], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)

#M
boxplot(re_M[,1], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,2], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,3], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)

#Relative error for point estimates
RE_ssb_N1000_Ind25_ckmrmultinom10<-re_SSB
RE_R0_N1000_Ind25_ckmrmultinom10<-re_R0
RE_M_N1000_Ind25_ckmrmultinom10<-re_M

#Interquartile Range of relative errors
IQR_RE_ssb_N1000_Ind25_ckmrmultinom10<-apply(re_SSB,c(1,3),quantile,probs=0.75, na.rm=TRUE)-apply(re_SSB,c(1,3),quantile,probs=0.25, na.rm=TRUE)
IQR_RE_R0_N1000_Ind25_ckmrmultinom10<-apply(re_R0,2,quantile,probs=0.75, na.rm=TRUE)-apply(re_R0,2,quantile,probs=0.25, na.rm=TRUE)
IQR_RE_M_N1000_Ind25_ckmrmultinom10<-apply(re_M,2,quantile,probs=0.75, na.rm=TRUE)-apply(re_M,2,quantile,probs=0.25, na.rm=TRUE)

#Interquartile Range of absolute relative errors
IQR_ARE_ssb_N1000_Ind25_ckmrmultinom10<-apply(abs(re_SSB),c(1,3),quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_SSB),c(1,3),quantile,probs=0.25, na.rm=TRUE)
IQR_ARE_R0_N1000_Ind25_ckmrmultinom10<-apply(abs(re_R0),2,quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_R0),2,quantile,probs=0.25, na.rm=TRUE)
IQR_ARE_M_N1000_Ind25_ckmrmultinom10<-apply(abs(re_M),2,quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_M),2,quantile,probs=0.25, na.rm=TRUE)

#SD of relative error for point estimates
sd_RE_ssb_N1000_Ind25_ckmrmultinom10<-apply(re_SSB,c(1,3),sd, na.rm=TRUE)
sd_RE_R0_N1000_Ind25_ckmrmultinom10<-apply(re_R0,2,sd, na.rm=TRUE)
sd_RE_M_N1000_Ind25_ckmrmultinom10<-apply(re_M,2,sd, na.rm=TRUE)

#SD of absolute relative error
sd_ARE_ssb_N1000_Ind25_ckmrmultinom10<-apply(abs(re_SSB),c(1,3),sd, na.rm=TRUE)
sd_ARE_R0_N1000_Ind25_ckmrmultinom10<-apply(abs(re_R0),2,sd, na.rm=TRUE)
sd_ARE_M_N1000_Ind25_ckmrmultinom10<-apply(abs(re_M),2,sd, na.rm=TRUE)

#Precision within sims
SD_ssb_N1000_Ind25_ckmrmultinom10<-CV_ssb_N1000_Ind25_ckmrmultinom10<-array(NA, dim=c(3,100,76)) 
SD_R0_N1000_Ind25_ckmrmultinom10<-matrix(NA, nrow=3, ncol=100)
SD_M_N1000_Ind25_ckmrmultinom10<-matrix(NA, nrow=3, ncol=100)
for(f in 1:3){
  for (i in 1:100){
    if(length(res_list[[f]][[i]])>2){
      CV_ssb_N1000_Ind25_ckmrmultinom10[f,i,]<-res_list[[f]][[i]]$SD$sd/res_list[[f]][[i]]$SD$value
    SD_ssb_N1000_Ind25_ckmrmultinom10[f,i,]<-res_list[[f]][[i]]$SD$sd
    SD_R0_N1000_Ind25_ckmrmultinom10[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_R0","log_R0"])
    SD_M_N1000_Ind25_ckmrmultinom10[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_M","log_M"])
    }
  }
}

#N5000, 10yrs CKMR data, sd index 0.25
res_list<-list()
res_list[[1]]<-readRDS(paste0(wd,"/SCAAfit_Cod_N5000_Ind25_ckmrmultinom10.RData"))
res_list[[2]]<-readRDS(paste0(wd,"/SCAAfit_Flatfish_N5000_Ind25_ckmrmultinom10.RData"))
res_list[[3]]<-readRDS(paste0(wd,"/SCAAfit_Sardine_N5000_Ind25_ckmrmultinom10.RData"))

load(paste0(wd,"/Cod_wdat_N5000_Ind25_ckmrmultinom10_1.RData"))
load(paste0(wd,"/Flatfish_wdat_N5000_Ind25_ckmrmultinom10_1.RData"))
load(paste0(wd,"/Sardine_wdat_N5000_Ind25_ckmrmultinom10_1.RData"))

re_Dep<-re_SSB<-array(NA, dim=c(3,100,76))
re_R0<-re_M<-matrix(NA, nrow=100, ncol=3)
for(f in 1:3){
  for (i in 1:100){
    if(f==1){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Cod_wdat[[i]]$OM$SSB[26:101])/Cod_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Cod_wdat[[i]]$OM$R0)/Cod_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Cod_wdat[[i]]$OM$Mref)/Cod_wdat[[i]]$OM$Mref
      }
    }else if (f==2){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Flatfish_wdat[[i]]$OM$SSB[26:101])/Flatfish_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Flatfish_wdat[[i]]$OM$R0)/Flatfish_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Flatfish_wdat[[i]]$OM$Mref)/Flatfish_wdat[[i]]$OM$Mref
      }
    } else if (f==3){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Sardine_wdat[[i]]$OM$SSB[26:101])/Sardine_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Sardine_wdat[[i]]$OM$R0)/Sardine_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Sardine_wdat[[i]]$OM$Mref)/Sardine_wdat[[i]]$OM$Mref
      }
    }
  }
}

#SSB
par(mfrow=c(3,3))
boxplot(re_SSB[1,,], ylim=c(-0.25,0.25), las=1, main="Cod - N5000, Index SD - 0.25, CKMR 10yrs", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[2,,], ylim=c(-0.25,0.25), las=1, main="Flatfish - N5000, Index SD - 0.25, CKMR 10yrs", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[3,,], ylim=c(-0.25,0.25), las=1, main="Sardine - N5000, Index SD - 0.25, CKMR 10yrs", ylab="RE - SSB")
abline(h=0)

#R0
boxplot(re_R0[,1], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,2], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,3], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)

#M
boxplot(re_M[,1], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,2], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,3], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)

#Relative error for point estimates
RE_ssb_N5000_Ind25_ckmrmultinom10<-re_SSB
RE_R0_N5000_Ind25_ckmrmultinom10<-re_R0
RE_M_N5000_Ind25_ckmrmultinom10<-re_M

#Interquartile Range of relative errors
IQR_RE_ssb_N5000_Ind25_ckmrmultinom10<-apply(re_SSB,c(1,3),quantile,probs=0.75, na.rm=TRUE)-apply(re_SSB,c(1,3),quantile,probs=0.25, na.rm=TRUE)
IQR_RE_R0_N5000_Ind25_ckmrmultinom10<-apply(re_R0,2,quantile,probs=0.75, na.rm=TRUE)-apply(re_R0,2,quantile,probs=0.25, na.rm=TRUE)
IQR_RE_M_N5000_Ind25_ckmrmultinom10<-apply(re_M,2,quantile,probs=0.75, na.rm=TRUE)-apply(re_M,2,quantile,probs=0.25, na.rm=TRUE)

#Interquartile Range of absolute relative errors
IQR_ARE_ssb_N5000_Ind25_ckmrmultinom10<-apply(abs(re_SSB),c(1,3),quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_SSB),c(1,3),quantile,probs=0.25, na.rm=TRUE)
IQR_ARE_R0_N5000_Ind25_ckmrmultinom10<-apply(abs(re_R0),2,quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_R0),2,quantile,probs=0.25, na.rm=TRUE)
IQR_ARE_M_N5000_Ind25_ckmrmultinom10<-apply(abs(re_M),2,quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_M),2,quantile,probs=0.25, na.rm=TRUE)

#SD of relative error for point estimates
sd_RE_ssb_N5000_Ind25_ckmrmultinom10<-apply(re_SSB,c(1,3),sd, na.rm=TRUE)
sd_RE_R0_N5000_Ind25_ckmrmultinom10<-apply(re_R0,2,sd, na.rm=TRUE)
sd_RE_M_N5000_Ind25_ckmrmultinom10<-apply(re_M,2,sd, na.rm=TRUE)

#SD of absolute relative error
sd_ARE_ssb_N5000_Ind25_ckmrmultinom10<-apply(abs(re_SSB),c(1,3),sd, na.rm=TRUE)
sd_ARE_R0_N5000_Ind25_ckmrmultinom10<-apply(abs(re_R0),2,sd, na.rm=TRUE)
sd_ARE_M_N5000_Ind25_ckmrmultinom10<-apply(abs(re_M),2,sd, na.rm=TRUE)

#Precision within sims
SD_ssb_N5000_Ind25_ckmrmultinom10<-CV_ssb_N5000_Ind25_ckmrmultinom10<-array(NA, dim=c(3,100,76)) 
SD_R0_N5000_Ind25_ckmrmultinom10<-matrix(NA, nrow=3, ncol=100)
SD_M_N5000_Ind25_ckmrmultinom10<-matrix(NA, nrow=3, ncol=100)
for(f in 1:3){
  for (i in 1:100){
    if(length(res_list[[f]][[i]])>2){
      CV_ssb_N5000_Ind25_ckmrmultinom10[f,i,]<-res_list[[f]][[i]]$SD$sd/res_list[[f]][[i]]$SD$value
    SD_ssb_N5000_Ind25_ckmrmultinom10[f,i,]<-res_list[[f]][[i]]$SD$sd
    SD_R0_N5000_Ind25_ckmrmultinom10[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_R0","log_R0"])
    SD_M_N5000_Ind25_ckmrmultinom10[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_M","log_M"])
    }
  }
}

#N100, 10yrs CKMR data, sd index 0.50
res_list<-list()
res_list[[1]]<-readRDS(paste0(wd,"/SCAAfit_Cod_N100_Ind50_ckmrmultinom10.RData"))
res_list[[2]]<-readRDS(paste0(wd,"/SCAAfit_Flatfish_N100_Ind50_ckmrmultinom10.RData"))
res_list[[3]]<-readRDS(paste0(wd,"/SCAAfit_Sardine_N100_Ind50_ckmrmultinom10.RData"))

load(paste0(wd,"/Cod_wdat_N100_Ind50_ckmrmultinom10_1.RData"))
load(paste0(wd,"/Flatfish_wdat_N100_Ind50_ckmrmultinom10_1.RData"))
load(paste0(wd,"/Sardine_wdat_N100_Ind50_ckmrmultinom10_1.RData"))

re_Dep<-re_SSB<-array(NA, dim=c(3,100,76))
re_R0<-re_M<-matrix(NA, nrow=100, ncol=3)
for(f in 1:3){
  for (i in 1:100){
    if(f==1){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Cod_wdat[[i]]$OM$SSB[26:101])/Cod_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Cod_wdat[[i]]$OM$R0)/Cod_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Cod_wdat[[i]]$OM$Mref)/Cod_wdat[[i]]$OM$Mref
      }
    }else if (f==2){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Flatfish_wdat[[i]]$OM$SSB[26:101])/Flatfish_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Flatfish_wdat[[i]]$OM$R0)/Flatfish_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Flatfish_wdat[[i]]$OM$Mref)/Flatfish_wdat[[i]]$OM$Mref
      }
    } else if (f==3){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Sardine_wdat[[i]]$OM$SSB[26:101])/Sardine_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Sardine_wdat[[i]]$OM$R0)/Sardine_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Sardine_wdat[[i]]$OM$Mref)/Sardine_wdat[[i]]$OM$Mref
      }
    }
  }
}

#SSB
par(mfrow=c(3,3))
boxplot(re_SSB[1,,], ylim=c(-0.25,0.25), las=1, main="Cod - N100, Index SD - 0.50, CKMR 10yrs", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[2,,], ylim=c(-0.25,0.25), las=1, main="Flatfish - N100, Index SD - 0.50, CKMR 10yrs", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[3,,], ylim=c(-0.25,0.25), las=1, main="Sardine - N100, Index SD - 0.50, CKMR 10yrs", ylab="RE - SSB")
abline(h=0)

#R0
boxplot(re_R0[,1], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,2], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,3], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)

#M
boxplot(re_M[,1], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,2], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,3], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)

#Relative error for point estimates
RE_ssb_N100_Ind50_ckmrmultinom10<-re_SSB
RE_R0_N100_Ind50_ckmrmultinom10<-re_R0
RE_M_N100_Ind50_ckmrmultinom10<-re_M

#Interquartile Range of relative errors
IQR_RE_ssb_N100_Ind50_ckmrmultinom10<-apply(re_SSB,c(1,3),quantile,probs=0.75, na.rm=TRUE)-apply(re_SSB,c(1,3),quantile,probs=0.25, na.rm=TRUE)
IQR_RE_R0_N100_Ind50_ckmrmultinom10<-apply(re_R0,2,quantile,probs=0.75, na.rm=TRUE)-apply(re_R0,2,quantile,probs=0.25, na.rm=TRUE)
IQR_RE_M_N100_Ind50_ckmrmultinom10<-apply(re_M,2,quantile,probs=0.75, na.rm=TRUE)-apply(re_M,2,quantile,probs=0.25, na.rm=TRUE)

#Interquartile Range of absolute relative errors
IQR_ARE_ssb_N100_Ind50_ckmrmultinom10<-apply(abs(re_SSB),c(1,3),quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_SSB),c(1,3),quantile,probs=0.25, na.rm=TRUE)
IQR_ARE_R0_N100_Ind50_ckmrmultinom10<-apply(abs(re_R0),2,quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_R0),2,quantile,probs=0.25, na.rm=TRUE)
IQR_ARE_M_N100_Ind50_ckmrmultinom10<-apply(abs(re_M),2,quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_M),2,quantile,probs=0.25, na.rm=TRUE)

#SD of relative error for point estimates
sd_RE_ssb_N100_Ind50_ckmrmultinom10<-apply(re_SSB,c(1,3),sd, na.rm=TRUE)
sd_RE_R0_N100_Ind50_ckmrmultinom10<-apply(re_R0,2,sd, na.rm=TRUE)
sd_RE_M_N100_Ind50_ckmrmultinom10<-apply(re_M,2,sd, na.rm=TRUE)

#SD of absolute relative error
sd_ARE_ssb_N100_Ind50_ckmrmultinom10<-apply(abs(re_SSB),c(1,3),sd, na.rm=TRUE)
sd_ARE_R0_N100_Ind50_ckmrmultinom10<-apply(abs(re_R0),2,sd, na.rm=TRUE)
sd_ARE_M_N100_Ind50_ckmrmultinom10<-apply(abs(re_M),2,sd, na.rm=TRUE)

#Precision within sims
SD_ssb_N100_Ind50_ckmrmultinom10<-CV_ssb_N100_Ind50_ckmrmultinom10<-array(NA, dim=c(3,100,76)) 
SD_R0_N100_Ind50_ckmrmultinom10<-matrix(NA, nrow=3, ncol=100)
SD_M_N100_Ind50_ckmrmultinom10<-matrix(NA, nrow=3, ncol=100)
for(f in 1:3){
  for (i in 1:100){
    if(length(res_list[[f]][[i]])>2){
      CV_ssb_N100_Ind50_ckmrmultinom10[f,i,]<-res_list[[f]][[i]]$SD$sd/res_list[[f]][[i]]$SD$value
    SD_ssb_N100_Ind50_ckmrmultinom10[f,i,]<-res_list[[f]][[i]]$SD$sd
    SD_R0_N100_Ind50_ckmrmultinom10[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_R0","log_R0"])
    SD_M_N100_Ind50_ckmrmultinom10[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_M","log_M"])
    }
  }
}

#N1000, 10yrs CKMR data, sd index 0.50
res_list<-list()
res_list[[1]]<-readRDS(paste0(wd,"/SCAAfit_Cod_N1000_Ind50_ckmrmultinom10.RData"))
res_list[[2]]<-readRDS(paste0(wd,"/SCAAfit_Flatfish_N1000_Ind50_ckmrmultinom10.RData"))
res_list[[3]]<-readRDS(paste0(wd,"/SCAAfit_Sardine_N1000_Ind50_ckmrmultinom10.RData"))

load(paste0(wd,"/Cod_wdat_N1000_Ind50_ckmrmultinom10_1.RData"))
load(paste0(wd,"/Flatfish_wdat_N1000_Ind50_ckmrmultinom10_1.RData"))
load(paste0(wd,"/Sardine_wdat_N1000_Ind50_ckmrmultinom10_1.RData"))

re_Dep<-re_SSB<-array(NA, dim=c(3,100,76))
re_R0<-re_M<-matrix(NA, nrow=100, ncol=3)
for(f in 1:3){
  for (i in 1:100){
    if(f==1){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Cod_wdat[[i]]$OM$SSB[26:101])/Cod_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Cod_wdat[[i]]$OM$R0)/Cod_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Cod_wdat[[i]]$OM$Mref)/Cod_wdat[[i]]$OM$Mref
      }
    }else if (f==2){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Flatfish_wdat[[i]]$OM$SSB[26:101])/Flatfish_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Flatfish_wdat[[i]]$OM$R0)/Flatfish_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Flatfish_wdat[[i]]$OM$Mref)/Flatfish_wdat[[i]]$OM$Mref
      }
    } else if (f==3){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Sardine_wdat[[i]]$OM$SSB[26:101])/Sardine_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Sardine_wdat[[i]]$OM$R0)/Sardine_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Sardine_wdat[[i]]$OM$Mref)/Sardine_wdat[[i]]$OM$Mref
      }
    }
  }
}

#SSB
par(mfrow=c(3,3))
boxplot(re_SSB[1,,], ylim=c(-0.25,0.25), las=1, main="Cod - N1000, Index SD - 0.50, CKMR 10yrs", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[2,,], ylim=c(-0.25,0.25), las=1, main="Flatfish - N1000, Index SD - 0.50, CKMR 10yrs", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[3,,], ylim=c(-0.25,0.25), las=1, main="Sardine - N1000, Index SD - 0.50, CKMR 10yrs", ylab="RE - SSB")
abline(h=0)

#R0
boxplot(re_R0[,1], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,2], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,3], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)

#M
boxplot(re_M[,1], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,2], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,3], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)

#Relative error for point estimates
RE_ssb_N1000_Ind50_ckmrmultinom10<-re_SSB
RE_R0_N1000_Ind50_ckmrmultinom10<-re_R0
RE_M_N1000_Ind50_ckmrmultinom10<-re_M

#Interquartile Range of relative errors
IQR_RE_ssb_N1000_Ind50_ckmrmultinom10<-apply(re_SSB,c(1,3),quantile,probs=0.75, na.rm=TRUE)-apply(re_SSB,c(1,3),quantile,probs=0.25, na.rm=TRUE)
IQR_RE_R0_N1000_Ind50_ckmrmultinom10<-apply(re_R0,2,quantile,probs=0.75, na.rm=TRUE)-apply(re_R0,2,quantile,probs=0.25, na.rm=TRUE)
IQR_RE_M_N1000_Ind50_ckmrmultinom10<-apply(re_M,2,quantile,probs=0.75, na.rm=TRUE)-apply(re_M,2,quantile,probs=0.25, na.rm=TRUE)

#Interquartile Range of absolute relative errors
IQR_ARE_ssb_N1000_Ind50_ckmrmultinom10<-apply(abs(re_SSB),c(1,3),quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_SSB),c(1,3),quantile,probs=0.25, na.rm=TRUE)
IQR_ARE_R0_N1000_Ind50_ckmrmultinom10<-apply(abs(re_R0),2,quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_R0),2,quantile,probs=0.25, na.rm=TRUE)
IQR_ARE_M_N1000_Ind50_ckmrmultinom10<-apply(abs(re_M),2,quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_M),2,quantile,probs=0.25, na.rm=TRUE)

#SD of relative error for point estimates
sd_RE_ssb_N1000_Ind50_ckmrmultinom10<-apply(re_SSB,c(1,3),sd, na.rm=TRUE)
sd_RE_R0_N1000_Ind50_ckmrmultinom10<-apply(re_R0,2,sd, na.rm=TRUE)
sd_RE_M_N1000_Ind50_ckmrmultinom10<-apply(re_M,2,sd, na.rm=TRUE)

#SD of absolute relative error
sd_ARE_ssb_N1000_Ind50_ckmrmultinom10<-apply(abs(re_SSB),c(1,3),sd, na.rm=TRUE)
sd_ARE_R0_N1000_Ind50_ckmrmultinom10<-apply(abs(re_R0),2,sd, na.rm=TRUE)
sd_ARE_M_N1000_Ind50_ckmrmultinom10<-apply(abs(re_M),2,sd, na.rm=TRUE)

#Precision within sims
SD_ssb_N1000_Ind50_ckmrmultinom10<-CV_ssb_N1000_Ind50_ckmrmultinom10<-array(NA, dim=c(3,100,76)) 
SD_R0_N1000_Ind50_ckmrmultinom10<-matrix(NA, nrow=3, ncol=100)
SD_M_N1000_Ind50_ckmrmultinom10<-matrix(NA, nrow=3, ncol=100)
for(f in 1:3){
  for (i in 1:100){
    if(length(res_list[[f]][[i]])>2){
      CV_ssb_N1000_Ind50_ckmrmultinom10[f,i,]<-res_list[[f]][[i]]$SD$sd/res_list[[f]][[i]]$SD$value
    SD_ssb_N1000_Ind50_ckmrmultinom10[f,i,]<-res_list[[f]][[i]]$SD$sd
    SD_R0_N1000_Ind50_ckmrmultinom10[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_R0","log_R0"])
    SD_M_N1000_Ind50_ckmrmultinom10[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_M","log_M"])
    }
  }
}

#N5000, 10yrs CKMR data, sd index 0.50
res_list<-list()
res_list[[1]]<-readRDS(paste0(wd,"/SCAAfit_Cod_N5000_Ind50_ckmrmultinom10.RData"))
res_list[[2]]<-readRDS(paste0(wd,"/SCAAfit_Flatfish_N5000_Ind50_ckmrmultinom10.RData"))
res_list[[3]]<-readRDS(paste0(wd,"/SCAAfit_Sardine_N5000_Ind50_ckmrmultinom10.RData"))

load(paste0(wd,"/Cod_wdat_N5000_Ind50_ckmrmultinom10_1.RData"))
load(paste0(wd,"/Flatfish_wdat_N5000_Ind50_ckmrmultinom10_1.RData"))
load(paste0(wd,"/Sardine_wdat_N5000_Ind50_ckmrmultinom10_1.RData"))

re_Dep<-re_SSB<-array(NA, dim=c(3,100,76))
re_R0<-re_M<-matrix(NA, nrow=100, ncol=3)
for(f in 1:3){
  for (i in 1:100){
    if(f==1){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Cod_wdat[[i]]$OM$SSB[26:101])/Cod_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Cod_wdat[[i]]$OM$R0)/Cod_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Cod_wdat[[i]]$OM$Mref)/Cod_wdat[[i]]$OM$Mref
      }
    }else if (f==2){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Flatfish_wdat[[i]]$OM$SSB[26:101])/Flatfish_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Flatfish_wdat[[i]]$OM$R0)/Flatfish_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Flatfish_wdat[[i]]$OM$Mref)/Flatfish_wdat[[i]]$OM$Mref
      }
    } else if (f==3){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Sardine_wdat[[i]]$OM$SSB[26:101])/Sardine_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Sardine_wdat[[i]]$OM$R0)/Sardine_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Sardine_wdat[[i]]$OM$Mref)/Sardine_wdat[[i]]$OM$Mref
      }
    }
  }
}

#SSB
par(mfrow=c(3,3))
boxplot(re_SSB[1,,], ylim=c(-0.25,0.25), las=1, main="Cod - N5000, Index SD - 0.50, CKMR 10yrs", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[2,,], ylim=c(-0.25,0.25), las=1, main="Flatfish - N5000, Index SD - 0.50, CKMR 10yrs", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[3,,], ylim=c(-0.25,0.25), las=1, main="Sardine - N5000, Index SD - 0.50, CKMR 10yrs", ylab="RE - SSB")
abline(h=0)

#R0
boxplot(re_R0[,1], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,2], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,3], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)

#M
boxplot(re_M[,1], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,2], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,3], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)

#Relative error for point estimates
RE_ssb_N5000_Ind50_ckmrmultinom10<-re_SSB
RE_R0_N5000_Ind50_ckmrmultinom10<-re_R0
RE_M_N5000_Ind50_ckmrmultinom10<-re_M

#Interquartile Range of relative errors
IQR_RE_ssb_N5000_Ind50_ckmrmultinom10<-apply(re_SSB,c(1,3),quantile,probs=0.75, na.rm=TRUE)-apply(re_SSB,c(1,3),quantile,probs=0.25, na.rm=TRUE)
IQR_RE_R0_N5000_Ind50_ckmrmultinom10<-apply(re_R0,2,quantile,probs=0.75, na.rm=TRUE)-apply(re_R0,2,quantile,probs=0.25, na.rm=TRUE)
IQR_RE_M_N5000_Ind50_ckmrmultinom10<-apply(re_M,2,quantile,probs=0.75, na.rm=TRUE)-apply(re_M,2,quantile,probs=0.25, na.rm=TRUE)

#Interquartile Range of absolute relative errors
IQR_ARE_ssb_N5000_Ind50_ckmrmultinom10<-apply(abs(re_SSB),c(1,3),quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_SSB),c(1,3),quantile,probs=0.25, na.rm=TRUE)
IQR_ARE_R0_N5000_Ind50_ckmrmultinom10<-apply(abs(re_R0),2,quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_R0),2,quantile,probs=0.25, na.rm=TRUE)
IQR_ARE_M_N5000_Ind50_ckmrmultinom10<-apply(abs(re_M),2,quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_M),2,quantile,probs=0.25, na.rm=TRUE)

#SD of relative error for point estimates
sd_RE_ssb_N5000_Ind50_ckmrmultinom10<-apply(re_SSB,c(1,3),sd, na.rm=TRUE)
sd_RE_R0_N5000_Ind50_ckmrmultinom10<-apply(re_R0,2,sd, na.rm=TRUE)
sd_RE_M_N5000_Ind50_ckmrmultinom10<-apply(re_M,2,sd, na.rm=TRUE)

#SD of absolute relative error
sd_ARE_ssb_N5000_Ind50_ckmrmultinom10<-apply(abs(re_SSB),c(1,3),sd, na.rm=TRUE)
sd_ARE_R0_N5000_Ind50_ckmrmultinom10<-apply(abs(re_R0),2,sd, na.rm=TRUE)
sd_ARE_M_N5000_Ind50_ckmrmultinom10<-apply(abs(re_M),2,sd, na.rm=TRUE)

#Precision within sims
SD_ssb_N5000_Ind50_ckmrmultinom10<-CV_ssb_N5000_Ind50_ckmrmultinom10<-array(NA, dim=c(3,100,76)) 
SD_R0_N5000_Ind50_ckmrmultinom10<-matrix(NA, nrow=3, ncol=100)
SD_M_N5000_Ind50_ckmrmultinom10<-matrix(NA, nrow=3, ncol=100)
for(f in 1:3){
  for (i in 1:100){
    if(length(res_list[[f]][[i]])>2){
      CV_ssb_N5000_Ind50_ckmrmultinom10[f,i,]<-res_list[[f]][[i]]$SD$sd/res_list[[f]][[i]]$SD$value
    SD_ssb_N5000_Ind50_ckmrmultinom10[f,i,]<-res_list[[f]][[i]]$SD$sd
    SD_R0_N5000_Ind50_ckmrmultinom10[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_R0","log_R0"])
    SD_M_N5000_Ind50_ckmrmultinom10[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_M","log_M"])
    }
  }
}

#20yrs CKMR data
#N100, 20yrs CKMR data, sd index 0.25
res_list<-list()
res_list[[1]]<-readRDS(paste0(wd,"/SCAAfit_Cod_N100_Ind25_ckmrmultinom20.RData"))
res_list[[2]]<-readRDS(paste0(wd,"/SCAAfit_Flatfish_N100_Ind25_ckmrmultinom20.RData"))
res_list[[3]]<-readRDS(paste0(wd,"/SCAAfit_Sardine_N100_Ind25_ckmrmultinom20.RData"))

load(paste0(wd,"/Cod_wdat_N100_Ind25_ckmrmultinom20_1.RData"))
load(paste0(wd,"/Flatfish_wdat_N100_Ind25_ckmrmultinom20_1.RData"))
load(paste0(wd,"/Sardine_wdat_N100_Ind25_ckmrmultinom20_1.RData"))

re_Dep<-re_SSB<-array(NA, dim=c(3,100,76))
re_R0<-re_M<-matrix(NA, nrow=100, ncol=3)
for(f in 1:3){
  for (i in 1:100){
    if(f==1){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Cod_wdat[[i]]$OM$SSB[26:101])/Cod_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Cod_wdat[[i]]$OM$R0)/Cod_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Cod_wdat[[i]]$OM$Mref)/Cod_wdat[[i]]$OM$Mref
      }
    }else if (f==2){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Flatfish_wdat[[i]]$OM$SSB[26:101])/Flatfish_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Flatfish_wdat[[i]]$OM$R0)/Flatfish_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Flatfish_wdat[[i]]$OM$Mref)/Flatfish_wdat[[i]]$OM$Mref
      }
    } else if (f==3){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Sardine_wdat[[i]]$OM$SSB[26:101])/Sardine_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Sardine_wdat[[i]]$OM$R0)/Sardine_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Sardine_wdat[[i]]$OM$Mref)/Sardine_wdat[[i]]$OM$Mref
      }
    }
  }
}

#SSB
par(mfrow=c(3,3))
boxplot(re_SSB[1,,], ylim=c(-0.25,0.25), las=1, main="Cod - N100, Index SD - 0.25, CKMR 20yrs", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[2,,], ylim=c(-0.25,0.25), las=1, main="Flatfish - N100, Index SD - 0.25, CKMR 20yrs", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[3,,], ylim=c(-0.25,0.25), las=1, main="Sardine - N100, Index SD - 0.25, CKMR 20yrs", ylab="RE - SSB")
abline(h=0)

#R0
boxplot(re_R0[,1], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,2], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,3], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)

#M
boxplot(re_M[,1], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,2], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,3], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)

#Relative error for point estimates
RE_ssb_N100_Ind25_ckmrmultinom20<-re_SSB
RE_R0_N100_Ind25_ckmrmultinom20<-re_R0
RE_M_N100_Ind25_ckmrmultinom20<-re_M

#Interquartile Range of relative errors
IQR_RE_ssb_N100_Ind25_ckmrmultinom20<-apply(re_SSB,c(1,3),quantile,probs=0.75, na.rm=TRUE)-apply(re_SSB,c(1,3),quantile,probs=0.25, na.rm=TRUE)
IQR_RE_R0_N100_Ind25_ckmrmultinom20<-apply(re_R0,2,quantile,probs=0.75, na.rm=TRUE)-apply(re_R0,2,quantile,probs=0.25, na.rm=TRUE)
IQR_RE_M_N100_Ind25_ckmrmultinom20<-apply(re_M,2,quantile,probs=0.75, na.rm=TRUE)-apply(re_M,2,quantile,probs=0.25, na.rm=TRUE)

#Interquartile Range of absolute relative errors
IQR_ARE_ssb_N100_Ind25_ckmrmultinom20<-apply(abs(re_SSB),c(1,3),quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_SSB),c(1,3),quantile,probs=0.25, na.rm=TRUE)
IQR_ARE_R0_N100_Ind25_ckmrmultinom20<-apply(abs(re_R0),2,quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_R0),2,quantile,probs=0.25, na.rm=TRUE)
IQR_ARE_M_N100_Ind25_ckmrmultinom20<-apply(abs(re_M),2,quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_M),2,quantile,probs=0.25, na.rm=TRUE)

#SD of relative error for point estimates
sd_RE_ssb_N100_Ind25_ckmrmultinom20<-apply(re_SSB,c(1,3),sd, na.rm=TRUE)
sd_RE_R0_N100_Ind25_ckmrmultinom20<-apply(re_R0,2,sd, na.rm=TRUE)
sd_RE_M_N100_Ind25_ckmrmultinom20<-apply(re_M,2,sd, na.rm=TRUE)

#SD of absolute relative error
sd_ARE_ssb_N100_Ind25_ckmrmultinom20<-apply(abs(re_SSB),c(1,3),sd, na.rm=TRUE)
sd_ARE_R0_N100_Ind25_ckmrmultinom20<-apply(abs(re_R0),2,sd, na.rm=TRUE)
sd_ARE_M_N100_Ind25_ckmrmultinom20<-apply(abs(re_M),2,sd, na.rm=TRUE)

#Precision within sims
SD_ssb_N100_Ind25_ckmrmultinom20<-CV_ssb_N100_Ind25_ckmrmultinom20<-array(NA, dim=c(3,100,76))
SD_R0_N100_Ind25_ckmrmultinom20<-matrix(NA, nrow=3, ncol=100)
SD_M_N100_Ind25_ckmrmultinom20<-matrix(NA, nrow=3, ncol=100)
for(f in 1:3){
  for (i in 1:100){
    if(length(res_list[[f]][[i]])>2){
      CV_ssb_N100_Ind25_ckmrmultinom20[f,i,]<-res_list[[f]][[i]]$SD$sd/res_list[[f]][[i]]$SD$value
    SD_ssb_N100_Ind25_ckmrmultinom20[f,i,]<-res_list[[f]][[i]]$SD$sd
    SD_R0_N100_Ind25_ckmrmultinom20[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_R0","log_R0"])
    SD_M_N100_Ind25_ckmrmultinom20[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_M","log_M"])
    }
  }
}

#N1000, 20yrs CKMR data, sd index 0.25
res_list<-list()
res_list[[1]]<-readRDS(paste0(wd,"/SCAAfit_Cod_N1000_Ind25_ckmrmultinom20.RData"))
res_list[[2]]<-readRDS(paste0(wd,"/SCAAfit_Flatfish_N1000_Ind25_ckmrmultinom20.RData"))
res_list[[3]]<-readRDS(paste0(wd,"/SCAAfit_Sardine_N1000_Ind25_ckmrmultinom20.RData"))

load(paste0(wd,"/Cod_wdat_N1000_Ind25_ckmrmultinom20_1.RData"))
load(paste0(wd,"/Flatfish_wdat_N1000_Ind25_ckmrmultinom20_1.RData"))
load(paste0(wd,"/Sardine_wdat_N1000_Ind25_ckmrmultinom20_1.RData"))

re_Dep<-re_SSB<-array(NA, dim=c(3,100,76))
re_R0<-re_M<-matrix(NA, nrow=100, ncol=3)
for(f in 1:3){
  for (i in 1:100){
    if(f==1){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Cod_wdat[[i]]$OM$SSB[26:101])/Cod_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Cod_wdat[[i]]$OM$R0)/Cod_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Cod_wdat[[i]]$OM$Mref)/Cod_wdat[[i]]$OM$Mref
      }
    }else if (f==2){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Flatfish_wdat[[i]]$OM$SSB[26:101])/Flatfish_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Flatfish_wdat[[i]]$OM$R0)/Flatfish_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Flatfish_wdat[[i]]$OM$Mref)/Flatfish_wdat[[i]]$OM$Mref
      }
    } else if (f==3){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Sardine_wdat[[i]]$OM$SSB[26:101])/Sardine_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Sardine_wdat[[i]]$OM$R0)/Sardine_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Sardine_wdat[[i]]$OM$Mref)/Sardine_wdat[[i]]$OM$Mref
      }
    }
  }
}

#SSB
par(mfrow=c(3,3))
boxplot(re_SSB[1,,], ylim=c(-0.25,0.25), las=1, main="Cod - N1000, Index SD - 0.25, CKMR 20yrs", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[2,,], ylim=c(-0.25,0.25), las=1, main="Flatfish - N1000, Index SD - 0.25, CKMR 20yrs", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[3,,], ylim=c(-0.25,0.25), las=1, main="Sardine - N1000, Index SD - 0.25, CKMR 20yrs", ylab="RE - SSB")
abline(h=0)

#R0
boxplot(re_R0[,1], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,2], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,3], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)

#M
boxplot(re_M[,1], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,2], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,3], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)

#Relative error for point estimates
RE_ssb_N1000_Ind25_ckmrmultinom20<-re_SSB
RE_R0_N1000_Ind25_ckmrmultinom20<-re_R0
RE_M_N1000_Ind25_ckmrmultinom20<-re_M

#Interquartile Range of relative errors
IQR_RE_ssb_N1000_Ind25_ckmrmultinom20<-apply(re_SSB,c(1,3),quantile,probs=0.75, na.rm=TRUE)-apply(re_SSB,c(1,3),quantile,probs=0.25, na.rm=TRUE)
IQR_RE_R0_N1000_Ind25_ckmrmultinom20<-apply(re_R0,2,quantile,probs=0.75, na.rm=TRUE)-apply(re_R0,2,quantile,probs=0.25, na.rm=TRUE)
IQR_RE_M_N1000_Ind25_ckmrmultinom20<-apply(re_M,2,quantile,probs=0.75, na.rm=TRUE)-apply(re_M,2,quantile,probs=0.25, na.rm=TRUE)

#Interquartile Range of absolute relative errors
IQR_ARE_ssb_N1000_Ind25_ckmrmultinom20<-apply(abs(re_SSB),c(1,3),quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_SSB),c(1,3),quantile,probs=0.25, na.rm=TRUE)
IQR_ARE_R0_N1000_Ind25_ckmrmultinom20<-apply(abs(re_R0),2,quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_R0),2,quantile,probs=0.25, na.rm=TRUE)
IQR_ARE_M_N1000_Ind25_ckmrmultinom20<-apply(abs(re_M),2,quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_M),2,quantile,probs=0.25, na.rm=TRUE)

#SD of relative error for point estimates
sd_RE_ssb_N1000_Ind25_ckmrmultinom20<-apply(re_SSB,c(1,3),sd, na.rm=TRUE)
sd_RE_R0_N1000_Ind25_ckmrmultinom20<-apply(re_R0,2,sd, na.rm=TRUE)
sd_RE_M_N1000_Ind25_ckmrmultinom20<-apply(re_M,2,sd, na.rm=TRUE)

#SD of absolute relative error
sd_ARE_ssb_N1000_Ind25_ckmrmultinom20<-apply(abs(re_SSB),c(1,3),sd, na.rm=TRUE)
sd_ARE_R0_N1000_Ind25_ckmrmultinom20<-apply(abs(re_R0),2,sd, na.rm=TRUE)
sd_ARE_M_N1000_Ind25_ckmrmultinom20<-apply(abs(re_M),2,sd, na.rm=TRUE)

#Precision within sims
SD_ssb_N1000_Ind25_ckmrmultinom20<-CV_ssb_N1000_Ind25_ckmrmultinom20<-array(NA, dim=c(3,100,76))
SD_R0_N1000_Ind25_ckmrmultinom20<-matrix(NA, nrow=3, ncol=100)
SD_M_N1000_Ind25_ckmrmultinom20<-matrix(NA, nrow=3, ncol=100)
for(f in 1:3){
  for (i in 1:100){
    if(length(res_list[[f]][[i]])>2){
      CV_ssb_N1000_Ind25_ckmrmultinom20[f,i,]<-res_list[[f]][[i]]$SD$sd/res_list[[f]][[i]]$SD$value
    SD_ssb_N1000_Ind25_ckmrmultinom20[f,i,]<-res_list[[f]][[i]]$SD$sd
    SD_R0_N1000_Ind25_ckmrmultinom20[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_R0","log_R0"])
    SD_M_N1000_Ind25_ckmrmultinom20[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_M","log_M"])
    }
  }
}

#N5000, 20yrs CKMR data, sd index 0.25
res_list<-list()
res_list[[1]]<-readRDS(paste0(wd,"/SCAAfit_Cod_N5000_Ind25_ckmrmultinom20.RData"))
res_list[[2]]<-readRDS(paste0(wd,"/SCAAfit_Flatfish_N5000_Ind25_ckmrmultinom20.RData"))
res_list[[3]]<-readRDS(paste0(wd,"/SCAAfit_Sardine_N5000_Ind25_ckmrmultinom20.RData"))

load(paste0(wd,"/Cod_wdat_N5000_Ind25_ckmrmultinom20_1.RData"))
load(paste0(wd,"/Flatfish_wdat_N5000_Ind25_ckmrmultinom20_1.RData"))
load(paste0(wd,"/Sardine_wdat_N5000_Ind25_ckmrmultinom20_1.RData"))

re_Dep<-re_SSB<-array(NA, dim=c(3,100,76))
re_R0<-re_M<-matrix(NA, nrow=100, ncol=3)
for(f in 1:3){
  for (i in 1:100){
    if(f==1){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Cod_wdat[[i]]$OM$SSB[26:101])/Cod_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Cod_wdat[[i]]$OM$R0)/Cod_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Cod_wdat[[i]]$OM$Mref)/Cod_wdat[[i]]$OM$Mref
      }
    }else if (f==2){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Flatfish_wdat[[i]]$OM$SSB[26:101])/Flatfish_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Flatfish_wdat[[i]]$OM$R0)/Flatfish_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Flatfish_wdat[[i]]$OM$Mref)/Flatfish_wdat[[i]]$OM$Mref
      }
    } else if (f==3){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Sardine_wdat[[i]]$OM$SSB[26:101])/Sardine_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Sardine_wdat[[i]]$OM$R0)/Sardine_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Sardine_wdat[[i]]$OM$Mref)/Sardine_wdat[[i]]$OM$Mref
      }
    }
  }
}

#SSB
par(mfrow=c(3,3))
boxplot(re_SSB[1,,], ylim=c(-0.25,0.25), las=1, main="Cod - N5000, Index SD - 0.25, CKMR 20yrs", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[2,,], ylim=c(-0.25,0.25), las=1, main="Flatfish - N5000, Index SD - 0.25, CKMR 20yrs", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[3,,], ylim=c(-0.25,0.25), las=1, main="Sardine - N5000, Index SD - 0.25, CKMR 20yrs", ylab="RE - SSB")
abline(h=0)

#R0
boxplot(re_R0[,1], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,2], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,3], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)

#M
boxplot(re_M[,1], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,2], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,3], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)

#Relative error for point estimates
RE_ssb_N5000_Ind25_ckmrmultinom20<-re_SSB
RE_R0_N5000_Ind25_ckmrmultinom20<-re_R0
RE_M_N5000_Ind25_ckmrmultinom20<-re_M

#Interquartile Range of relative errors
IQR_RE_ssb_N5000_Ind25_ckmrmultinom20<-apply(re_SSB,c(1,3),quantile,probs=0.75, na.rm=TRUE)-apply(re_SSB,c(1,3),quantile,probs=0.25, na.rm=TRUE)
IQR_RE_R0_N5000_Ind25_ckmrmultinom20<-apply(re_R0,2,quantile,probs=0.75, na.rm=TRUE)-apply(re_R0,2,quantile,probs=0.25, na.rm=TRUE)
IQR_RE_M_N5000_Ind25_ckmrmultinom20<-apply(re_M,2,quantile,probs=0.75, na.rm=TRUE)-apply(re_M,2,quantile,probs=0.25, na.rm=TRUE)

#Interquartile Range of absolute relative errors
IQR_ARE_ssb_N5000_Ind25_ckmrmultinom20<-apply(abs(re_SSB),c(1,3),quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_SSB),c(1,3),quantile,probs=0.25, na.rm=TRUE)
IQR_ARE_R0_N5000_Ind25_ckmrmultinom20<-apply(abs(re_R0),2,quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_R0),2,quantile,probs=0.25, na.rm=TRUE)
IQR_ARE_M_N5000_Ind25_ckmrmultinom20<-apply(abs(re_M),2,quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_M),2,quantile,probs=0.25, na.rm=TRUE)

#SD of relative error for point estimates
sd_RE_ssb_N5000_Ind25_ckmrmultinom20<-apply(re_SSB,c(1,3),sd, na.rm=TRUE)
sd_RE_R0_N5000_Ind25_ckmrmultinom20<-apply(re_R0,2,sd, na.rm=TRUE)
sd_RE_M_N5000_Ind25_ckmrmultinom20<-apply(re_M,2,sd, na.rm=TRUE)

#SD of absolute relative error
sd_ARE_ssb_N5000_Ind25_ckmrmultinom20<-apply(abs(re_SSB),c(1,3),sd, na.rm=TRUE)
sd_ARE_R0_N5000_Ind25_ckmrmultinom20<-apply(abs(re_R0),2,sd, na.rm=TRUE)
sd_ARE_M_N5000_Ind25_ckmrmultinom20<-apply(abs(re_M),2,sd, na.rm=TRUE)

#Precision within sims
SD_ssb_N5000_Ind25_ckmrmultinom20<-CV_ssb_N5000_Ind25_ckmrmultinom20<-array(NA, dim=c(3,100,76))
SD_R0_N5000_Ind25_ckmrmultinom20<-matrix(NA, nrow=3, ncol=100)
SD_M_N5000_Ind25_ckmrmultinom20<-matrix(NA, nrow=3, ncol=100)
for(f in 1:3){
  for (i in 1:100){
    if(length(res_list[[f]][[i]])>2){
      CV_ssb_N5000_Ind25_ckmrmultinom20[f,i,]<-res_list[[f]][[i]]$SD$sd/res_list[[f]][[i]]$SD$value
    SD_ssb_N5000_Ind25_ckmrmultinom20[f,i,]<-res_list[[f]][[i]]$SD$sd
    SD_R0_N5000_Ind25_ckmrmultinom20[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_R0","log_R0"])
    SD_M_N5000_Ind25_ckmrmultinom20[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_M","log_M"])
    }
  }
}

#N100, 20yrs CKMR data, sd index 0.50
res_list<-list()
res_list[[1]]<-readRDS(paste0(wd,"/SCAAfit_Cod_N100_Ind50_ckmrmultinom20.RData"))
res_list[[2]]<-readRDS(paste0(wd,"/SCAAfit_Flatfish_N100_Ind50_ckmrmultinom20.RData"))
res_list[[3]]<-readRDS(paste0(wd,"/SCAAfit_Sardine_N100_Ind50_ckmrmultinom20.RData"))

load(paste0(wd,"/Cod_wdat_N100_Ind50_ckmrmultinom20_1.RData"))
load(paste0(wd,"/Flatfish_wdat_N100_Ind50_ckmrmultinom20_1.RData"))
load(paste0(wd,"/Sardine_wdat_N100_Ind50_ckmrmultinom20_1.RData"))

re_Dep<-re_SSB<-array(NA, dim=c(3,100,76))
re_R0<-re_M<-matrix(NA, nrow=100, ncol=3)
for(f in 1:3){
  for (i in 1:100){
    if(f==1){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Cod_wdat[[i]]$OM$SSB[26:101])/Cod_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Cod_wdat[[i]]$OM$R0)/Cod_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Cod_wdat[[i]]$OM$Mref)/Cod_wdat[[i]]$OM$Mref
      }
    }else if (f==2){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Flatfish_wdat[[i]]$OM$SSB[26:101])/Flatfish_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Flatfish_wdat[[i]]$OM$R0)/Flatfish_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Flatfish_wdat[[i]]$OM$Mref)/Flatfish_wdat[[i]]$OM$Mref
      }
    } else if (f==3){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Sardine_wdat[[i]]$OM$SSB[26:101])/Sardine_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Sardine_wdat[[i]]$OM$R0)/Sardine_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Sardine_wdat[[i]]$OM$Mref)/Sardine_wdat[[i]]$OM$Mref
      }
    }
  }
}

#SSB
par(mfrow=c(3,3))
boxplot(re_SSB[1,,], ylim=c(-0.25,0.25), las=1, main="Cod - N100, Index SD - 0.50, CKMR 20yrs", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[2,,], ylim=c(-0.25,0.25), las=1, main="Flatfish - N100, Index SD - 0.50, CKMR 20yrs", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[3,,], ylim=c(-0.25,0.25), las=1, main="Sardine - N100, Index SD - 0.50, CKMR 20yrs", ylab="RE - SSB")
abline(h=0)

#R0
boxplot(re_R0[,1], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,2], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,3], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)

#M
boxplot(re_M[,1], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,2], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,3], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)

#Relative error for point estimates
RE_ssb_N100_Ind50_ckmrmultinom20<-re_SSB
RE_R0_N100_Ind50_ckmrmultinom20<-re_R0
RE_M_N100_Ind50_ckmrmultinom20<-re_M

#Interquartile Range of relative errors
IQR_RE_ssb_N100_Ind50_ckmrmultinom20<-apply(re_SSB,c(1,3),quantile,probs=0.75, na.rm=TRUE)-apply(re_SSB,c(1,3),quantile,probs=0.25, na.rm=TRUE)
IQR_RE_R0_N100_Ind50_ckmrmultinom20<-apply(re_R0,2,quantile,probs=0.75, na.rm=TRUE)-apply(re_R0,2,quantile,probs=0.25, na.rm=TRUE)
IQR_RE_M_N100_Ind50_ckmrmultinom20<-apply(re_M,2,quantile,probs=0.75, na.rm=TRUE)-apply(re_M,2,quantile,probs=0.25, na.rm=TRUE)

#Interquartile Range of absolute relative errors
IQR_ARE_ssb_N100_Ind50_ckmrmultinom20<-apply(abs(re_SSB),c(1,3),quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_SSB),c(1,3),quantile,probs=0.25, na.rm=TRUE)
IQR_ARE_R0_N100_Ind50_ckmrmultinom20<-apply(abs(re_R0),2,quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_R0),2,quantile,probs=0.25, na.rm=TRUE)
IQR_ARE_M_N100_Ind50_ckmrmultinom20<-apply(abs(re_M),2,quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_M),2,quantile,probs=0.25, na.rm=TRUE)

#SD of relative error for point estimates
sd_RE_ssb_N100_Ind50_ckmrmultinom20<-apply(re_SSB,c(1,3),sd, na.rm=TRUE)
sd_RE_R0_N100_Ind50_ckmrmultinom20<-apply(re_R0,2,sd, na.rm=TRUE)
sd_RE_M_N100_Ind50_ckmrmultinom20<-apply(re_M,2,sd, na.rm=TRUE)

#SD of absolute relative error
sd_ARE_ssb_N100_Ind50_ckmrmultinom20<-apply(abs(re_SSB),c(1,3),sd, na.rm=TRUE)
sd_ARE_R0_N100_Ind50_ckmrmultinom20<-apply(abs(re_R0),2,sd, na.rm=TRUE)
sd_ARE_M_N100_Ind50_ckmrmultinom20<-apply(abs(re_M),2,sd, na.rm=TRUE)

#Precision within sims
SD_ssb_N100_Ind50_ckmrmultinom20<-CV_ssb_N100_Ind50_ckmrmultinom20<-array(NA, dim=c(3,100,76))
SD_R0_N100_Ind50_ckmrmultinom20<-matrix(NA, nrow=3, ncol=100)
SD_M_N100_Ind50_ckmrmultinom20<-matrix(NA, nrow=3, ncol=100)
for(f in 1:3){
  for (i in 1:100){
    if(length(res_list[[f]][[i]])>2){
      CV_ssb_N100_Ind50_ckmrmultinom20[f,i,]<-res_list[[f]][[i]]$SD$sd/res_list[[f]][[i]]$SD$value
    SD_ssb_N100_Ind50_ckmrmultinom20[f,i,]<-res_list[[f]][[i]]$SD$sd
    SD_R0_N100_Ind50_ckmrmultinom20[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_R0","log_R0"])
    SD_M_N100_Ind50_ckmrmultinom20[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_M","log_M"])
    }
  }
}

#N1000, 20yrs CKMR data, sd index 0.50
res_list<-list()
res_list[[1]]<-readRDS(paste0(wd,"/SCAAfit_Cod_N1000_Ind50_ckmrmultinom20.RData"))
res_list[[2]]<-readRDS(paste0(wd,"/SCAAfit_Flatfish_N1000_Ind50_ckmrmultinom20.RData"))
res_list[[3]]<-readRDS(paste0(wd,"/SCAAfit_Sardine_N1000_Ind50_ckmrmultinom20.RData"))

load(paste0(wd,"/Cod_wdat_N1000_Ind50_ckmrmultinom20_1.RData"))
load(paste0(wd,"/Flatfish_wdat_N1000_Ind50_ckmrmultinom20_1.RData"))
load(paste0(wd,"/Sardine_wdat_N1000_Ind50_ckmrmultinom20_1.RData"))

re_Dep<-re_SSB<-array(NA, dim=c(3,100,76))
re_R0<-re_M<-matrix(NA, nrow=100, ncol=3)
for(f in 1:3){
  for (i in 1:100){
    if(f==1){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Cod_wdat[[i]]$OM$SSB[26:101])/Cod_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Cod_wdat[[i]]$OM$R0)/Cod_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Cod_wdat[[i]]$OM$Mref)/Cod_wdat[[i]]$OM$Mref
      }
    }else if (f==2){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Flatfish_wdat[[i]]$OM$SSB[26:101])/Flatfish_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Flatfish_wdat[[i]]$OM$R0)/Flatfish_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Flatfish_wdat[[i]]$OM$Mref)/Flatfish_wdat[[i]]$OM$Mref
      }
    } else if (f==3){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Sardine_wdat[[i]]$OM$SSB[26:101])/Sardine_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Sardine_wdat[[i]]$OM$R0)/Sardine_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Sardine_wdat[[i]]$OM$Mref)/Sardine_wdat[[i]]$OM$Mref
      }
    }
  }
}

#SSB
par(mfrow=c(3,3))
boxplot(re_SSB[1,,], ylim=c(-0.25,0.25), las=1, main="Cod - N1000, Index SD - 0.50, CKMR 20yrs", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[2,,], ylim=c(-0.25,0.25), las=1, main="Flatfish - N1000, Index SD - 0.50, CKMR 20yrs", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[3,,], ylim=c(-0.25,0.25), las=1, main="Sardine - N1000, Index SD - 0.50, CKMR 20yrs", ylab="RE - SSB")
abline(h=0)

#R0
boxplot(re_R0[,1], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,2], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,3], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)

#M
boxplot(re_M[,1], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,2], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,3], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)

#Relative error for point estimates
RE_ssb_N1000_Ind50_ckmrmultinom20<-re_SSB
RE_R0_N1000_Ind50_ckmrmultinom20<-re_R0
RE_M_N1000_Ind50_ckmrmultinom20<-re_M

#Interquartile Range of relative errors
IQR_RE_ssb_N1000_Ind50_ckmrmultinom20<-apply(re_SSB,c(1,3),quantile,probs=0.75, na.rm=TRUE)-apply(re_SSB,c(1,3),quantile,probs=0.25, na.rm=TRUE)
IQR_RE_R0_N1000_Ind50_ckmrmultinom20<-apply(re_R0,2,quantile,probs=0.75, na.rm=TRUE)-apply(re_R0,2,quantile,probs=0.25, na.rm=TRUE)
IQR_RE_M_N1000_Ind50_ckmrmultinom20<-apply(re_M,2,quantile,probs=0.75, na.rm=TRUE)-apply(re_M,2,quantile,probs=0.25, na.rm=TRUE)

#Interquartile Range of absolute relative errors
IQR_ARE_ssb_N1000_Ind50_ckmrmultinom20<-apply(abs(re_SSB),c(1,3),quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_SSB),c(1,3),quantile,probs=0.25, na.rm=TRUE)
IQR_ARE_R0_N1000_Ind50_ckmrmultinom20<-apply(abs(re_R0),2,quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_R0),2,quantile,probs=0.25, na.rm=TRUE)
IQR_ARE_M_N1000_Ind50_ckmrmultinom20<-apply(abs(re_M),2,quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_M),2,quantile,probs=0.25, na.rm=TRUE)

#SD of relative error for point estimates
sd_RE_ssb_N1000_Ind50_ckmrmultinom20<-apply(re_SSB,c(1,3),sd, na.rm=TRUE)
sd_RE_R0_N1000_Ind50_ckmrmultinom20<-apply(re_R0,2,sd, na.rm=TRUE)
sd_RE_M_N1000_Ind50_ckmrmultinom20<-apply(re_M,2,sd, na.rm=TRUE)

#SD of absolute relative error
sd_ARE_ssb_N1000_Ind50_ckmrmultinom20<-apply(abs(re_SSB),c(1,3),sd, na.rm=TRUE)
sd_ARE_R0_N1000_Ind50_ckmrmultinom20<-apply(abs(re_R0),2,sd, na.rm=TRUE)
sd_ARE_M_N1000_Ind50_ckmrmultinom20<-apply(abs(re_M),2,sd, na.rm=TRUE)

#Precision within sims
SD_ssb_N1000_Ind50_ckmrmultinom20<-CV_ssb_N1000_Ind50_ckmrmultinom20<-array(NA, dim=c(3,100,76))
SD_R0_N1000_Ind50_ckmrmultinom20<-matrix(NA, nrow=3, ncol=100)
SD_M_N1000_Ind50_ckmrmultinom20<-matrix(NA, nrow=3, ncol=100)
for(f in 1:3){
  for (i in 1:100){
    if(length(res_list[[f]][[i]])>2){
      CV_ssb_N1000_Ind50_ckmrmultinom20[f,i,]<-res_list[[f]][[i]]$SD$sd/res_list[[f]][[i]]$SD$value
    SD_ssb_N1000_Ind50_ckmrmultinom20[f,i,]<-res_list[[f]][[i]]$SD$sd
    SD_R0_N1000_Ind50_ckmrmultinom20[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_R0","log_R0"])
    SD_M_N1000_Ind50_ckmrmultinom20[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_M","log_M"])
    }
  }
}

#N5000, 20yrs CKMR data, sd index 0.50
res_list<-list()
res_list[[1]]<-readRDS(paste0(wd,"/SCAAfit_Cod_N5000_Ind50_ckmrmultinom20.RData"))
res_list[[2]]<-readRDS(paste0(wd,"/SCAAfit_Flatfish_N5000_Ind50_ckmrmultinom20.RData"))
res_list[[3]]<-readRDS(paste0(wd,"/SCAAfit_Sardine_N5000_Ind50_ckmrmultinom20.RData"))

load(paste0(wd,"/Cod_wdat_N5000_Ind50_ckmrmultinom20_1.RData"))
load(paste0(wd,"/Flatfish_wdat_N5000_Ind50_ckmrmultinom20_1.RData"))
load(paste0(wd,"/Sardine_wdat_N5000_Ind50_ckmrmultinom20_1.RData"))

re_Dep<-re_SSB<-array(NA, dim=c(3,100,76))
re_R0<-re_M<-matrix(NA, nrow=100, ncol=3)
for(f in 1:3){
  for (i in 1:100){
    if(f==1){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Cod_wdat[[i]]$OM$SSB[26:101])/Cod_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Cod_wdat[[i]]$OM$R0)/Cod_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Cod_wdat[[i]]$OM$Mref)/Cod_wdat[[i]]$OM$Mref
      }
    }else if (f==2){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Flatfish_wdat[[i]]$OM$SSB[26:101])/Flatfish_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Flatfish_wdat[[i]]$OM$R0)/Flatfish_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Flatfish_wdat[[i]]$OM$Mref)/Flatfish_wdat[[i]]$OM$Mref
      }
    } else if (f==3){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Sardine_wdat[[i]]$OM$SSB[26:101])/Sardine_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Sardine_wdat[[i]]$OM$R0)/Sardine_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Sardine_wdat[[i]]$OM$Mref)/Sardine_wdat[[i]]$OM$Mref
      }
    }
  }
}

#SSB
par(mfrow=c(3,3))
boxplot(re_SSB[1,,], ylim=c(-0.25,0.25), las=1, main="Cod - N5000, Index SD - 0.50, CKMR 20yrs", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[2,,], ylim=c(-0.25,0.25), las=1, main="Flatfish - N5000, Index SD - 0.50, CKMR 20yrs", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[3,,], ylim=c(-0.25,0.25), las=1, main="Sardine - N5000, Index SD - 0.50, CKMR 20yrs", ylab="RE - SSB")
abline(h=0)

#R0
boxplot(re_R0[,1], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,2], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,3], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)

#M
boxplot(re_M[,1], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,2], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,3], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)

#Relative error for point estimates
RE_ssb_N5000_Ind50_ckmrmultinom20<-re_SSB
RE_R0_N5000_Ind50_ckmrmultinom20<-re_R0
RE_M_N5000_Ind50_ckmrmultinom20<-re_M

#Interquartile Range of relative errors
IQR_RE_ssb_N5000_Ind50_ckmrmultinom20<-apply(re_SSB,c(1,3),quantile,probs=0.75, na.rm=TRUE)-apply(re_SSB,c(1,3),quantile,probs=0.25, na.rm=TRUE)
IQR_RE_R0_N5000_Ind50_ckmrmultinom20<-apply(re_R0,2,quantile,probs=0.75, na.rm=TRUE)-apply(re_R0,2,quantile,probs=0.25, na.rm=TRUE)
IQR_RE_M_N5000_Ind50_ckmrmultinom20<-apply(re_M,2,quantile,probs=0.75, na.rm=TRUE)-apply(re_M,2,quantile,probs=0.25, na.rm=TRUE)

#Interquartile Range of absolute relative errors
IQR_ARE_ssb_N5000_Ind50_ckmrmultinom20<-apply(abs(re_SSB),c(1,3),quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_SSB),c(1,3),quantile,probs=0.25, na.rm=TRUE)
IQR_ARE_R0_N5000_Ind50_ckmrmultinom20<-apply(abs(re_R0),2,quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_R0),2,quantile,probs=0.25, na.rm=TRUE)
IQR_ARE_M_N5000_Ind50_ckmrmultinom20<-apply(abs(re_M),2,quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_M),2,quantile,probs=0.25, na.rm=TRUE)

#SD of relative error for point estimates
sd_RE_ssb_N5000_Ind50_ckmrmultinom20<-apply(re_SSB,c(1,3),sd, na.rm=TRUE)
sd_RE_R0_N5000_Ind50_ckmrmultinom20<-apply(re_R0,2,sd, na.rm=TRUE)
sd_RE_M_N5000_Ind50_ckmrmultinom20<-apply(re_M,2,sd, na.rm=TRUE)

#SD of absolute relative error
sd_ARE_ssb_N5000_Ind50_ckmrmultinom20<-apply(abs(re_SSB),c(1,3),sd, na.rm=TRUE)
sd_ARE_R0_N5000_Ind50_ckmrmultinom20<-apply(abs(re_R0),2,sd, na.rm=TRUE)
sd_ARE_M_N5000_Ind50_ckmrmultinom20<-apply(abs(re_M),2,sd, na.rm=TRUE)

#Precision within sims
SD_ssb_N5000_Ind50_ckmrmultinom20<-CV_ssb_N5000_Ind50_ckmrmultinom20<-array(NA, dim=c(3,100,76))
SD_R0_N5000_Ind50_ckmrmultinom20<-matrix(NA, nrow=3, ncol=100)
SD_M_N5000_Ind50_ckmrmultinom20<-matrix(NA, nrow=3, ncol=100)
for(f in 1:3){
  for (i in 1:100){
    if(length(res_list[[f]][[i]])>2){
      CV_ssb_N5000_Ind50_ckmrmultinom20[f,i,]<-res_list[[f]][[i]]$SD$sd/res_list[[f]][[i]]$SD$value
    SD_ssb_N5000_Ind50_ckmrmultinom20[f,i,]<-res_list[[f]][[i]]$SD$sd
    SD_R0_N5000_Ind50_ckmrmultinom20[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_R0","log_R0"])
    SD_M_N5000_Ind50_ckmrmultinom20[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_M","log_M"])
    }
  }
}

#######################################
#Models with NO INDEX but CKMR Data
#######################################

#N100, 5yrs CKMR data, no index
res_list<-list()
res_list[[1]]<-readRDS(paste0(wd,"/SCAAfit_Cod_N100_NoIndex_ckmrmultinom5.RData"))
res_list[[2]]<-readRDS(paste0(wd,"/SCAAfit_Flatfish_N100_NoIndex_ckmrmultinom5.RData"))
res_list[[3]]<-readRDS(paste0(wd,"/SCAAfit_Sardine_N100_NoIndex_ckmrmultinom5.RData"))

load(paste0(wd,"/Cod_wdat_N100_Ind25_ckmrmultinom5_1.RData"))
load(paste0(wd,"/Flatfish_wdat_N100_Ind25_ckmrmultinom5_1.RData"))
load(paste0(wd,"/Sardine_wdat_N100_Ind25_ckmrmultinom5_1.RData"))

re_Dep<-re_SSB<-array(NA, dim=c(3,100,76))
re_R0<-re_M<-matrix(NA, nrow=100, ncol=3)
for(f in 1:3){
  for (i in 1:100){
    if(f==1){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Cod_wdat[[i]]$OM$SSB[26:101])/Cod_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Cod_wdat[[i]]$OM$R0)/Cod_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Cod_wdat[[i]]$OM$Mref)/Cod_wdat[[i]]$OM$Mref
      }
    }else if (f==2){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Flatfish_wdat[[i]]$OM$SSB[26:101])/Flatfish_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Flatfish_wdat[[i]]$OM$R0)/Flatfish_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Flatfish_wdat[[i]]$OM$Mref)/Flatfish_wdat[[i]]$OM$Mref
      }
    } else if (f==3){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Sardine_wdat[[i]]$OM$SSB[26:101])/Sardine_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Sardine_wdat[[i]]$OM$R0)/Sardine_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Sardine_wdat[[i]]$OM$Mref)/Sardine_wdat[[i]]$OM$Mref
      }
    }
  }
}

#SSB
par(mfrow=c(3,3))
boxplot(re_SSB[1,,], ylim=c(-0.25,0.25), las=1, main="Cod - N100, No Index, CKMR 5yrs", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[2,,], ylim=c(-0.25,0.25), las=1, main="Flatfish - N100, No Index, CKMR 5yrs", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[3,,], ylim=c(-0.25,0.25), las=1, main="Sardine - N100, No Index, CKMR 5yrs", ylab="RE - SSB")
abline(h=0)

#R0
boxplot(re_R0[,1], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,2], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,3], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)

#M
boxplot(re_M[,1], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,2], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,3], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)

#Relative error for point estimates
RE_ssb_N100_NoIndex_ckmrmultinom5<-re_SSB
RE_R0_N100_NoIndex_ckmrmultinom5<-re_R0
RE_M_N100_NoIndex_ckmrmultinom5<-re_M

#Interquartile Range of relative errors
IQR_RE_ssb_N100_NoIndex_ckmrmultinom5<-apply(re_SSB,c(1,3),quantile,probs=0.75, na.rm=TRUE)-apply(re_SSB,c(1,3),quantile,probs=0.25, na.rm=TRUE)
IQR_RE_R0_N100_NoIndex_ckmrmultinom5<-apply(re_R0,2,quantile,probs=0.75, na.rm=TRUE)-apply(re_R0,2,quantile,probs=0.25, na.rm=TRUE)
IQR_RE_M_N100_NoIndex_ckmrmultinom5<-apply(re_M,2,quantile,probs=0.75, na.rm=TRUE)-apply(re_M,2,quantile,probs=0.25, na.rm=TRUE)

#Interquartile Range of absolute relative errors
IQR_ARE_ssb_N100_NoIndex_ckmrmultinom5<-apply(abs(re_SSB),c(1,3),quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_SSB),c(1,3),quantile,probs=0.25, na.rm=TRUE)
IQR_ARE_R0_N100_NoIndex_ckmrmultinom5<-apply(abs(re_R0),2,quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_R0),2,quantile,probs=0.25, na.rm=TRUE)
IQR_ARE_M_N100_NoIndex_ckmrmultinom5<-apply(abs(re_M),2,quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_M),2,quantile,probs=0.25, na.rm=TRUE)

#SD of relative error for point estimates
sd_RE_ssb_N100_NoIndex_ckmrmultinom5<-apply(re_SSB,c(1,3),sd, na.rm=TRUE)
sd_RE_R0_N100_NoIndex_ckmrmultinom5<-apply(re_R0,2,sd, na.rm=TRUE)
sd_RE_M_N100_NoIndex_ckmrmultinom5<-apply(re_M,2,sd, na.rm=TRUE)

#SD of absolute relative error
sd_ARE_ssb_N100_NoIndex_ckmrmultinom5<-apply(abs(re_SSB),c(1,3),sd, na.rm=TRUE)
sd_ARE_R0_N100_NoIndex_ckmrmultinom5<-apply(abs(re_R0),2,sd, na.rm=TRUE)
sd_ARE_M_N100_NoIndex_ckmrmultinom5<-apply(abs(re_M),2,sd, na.rm=TRUE)

#Precision within sims
SD_ssb_N100_NoIndex_ckmrmultinom5<-CV_ssb_N100_NoIndex_ckmrmultinom5<-array(NA, dim=c(3,100,76)) 
SD_R0_N100_NoIndex_ckmrmultinom5<-matrix(NA, nrow=3, ncol=100)
SD_M_N100_NoIndex_ckmrmultinom5<-matrix(NA, nrow=3, ncol=100)
for(f in 1:3){
  for (i in 1:100){
    if(length(res_list[[f]][[i]])>2){
      CV_ssb_N100_NoIndex_ckmrmultinom5[f,i,]<-res_list[[f]][[i]]$SD$sd/res_list[[f]][[i]]$SD$value
    SD_ssb_N100_NoIndex_ckmrmultinom5[f,i,]<-res_list[[f]][[i]]$SD$sd
    SD_R0_N100_NoIndex_ckmrmultinom5[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_R0","log_R0"])
    SD_M_N100_NoIndex_ckmrmultinom5[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_M","log_M"])
    }
  }
}

#N1000, 5yrs CKMR data, No Index
res_list<-list()
res_list[[1]]<-readRDS(paste0(wd,"/SCAAfit_Cod_N1000_NoIndex_ckmrmultinom5.RData"))
res_list[[2]]<-readRDS(paste0(wd,"/SCAAfit_Flatfish_N1000_NoIndex_ckmrmultinom5.RData"))
res_list[[3]]<-readRDS(paste0(wd,"/SCAAfit_Sardine_N1000_NoIndex_ckmrmultinom5.RData"))

load(paste0(wd,"/Cod_wdat_N1000_Ind25_ckmrmultinom5_1.RData"))
load(paste0(wd,"/Flatfish_wdat_N1000_Ind25_ckmrmultinom5_1.RData"))
load(paste0(wd,"/Sardine_wdat_N1000_Ind25_ckmrmultinom5_1.RData"))

re_Dep<-re_SSB<-array(NA, dim=c(3,100,76))
re_R0<-re_M<-matrix(NA, nrow=100, ncol=3)
for(f in 1:3){
  for (i in 1:100){
    if(f==1){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Cod_wdat[[i]]$OM$SSB[26:101])/Cod_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Cod_wdat[[i]]$OM$R0)/Cod_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Cod_wdat[[i]]$OM$Mref)/Cod_wdat[[i]]$OM$Mref
      }
    }else if (f==2){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Flatfish_wdat[[i]]$OM$SSB[26:101])/Flatfish_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Flatfish_wdat[[i]]$OM$R0)/Flatfish_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Flatfish_wdat[[i]]$OM$Mref)/Flatfish_wdat[[i]]$OM$Mref
      }
    } else if (f==3){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Sardine_wdat[[i]]$OM$SSB[26:101])/Sardine_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Sardine_wdat[[i]]$OM$R0)/Sardine_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Sardine_wdat[[i]]$OM$Mref)/Sardine_wdat[[i]]$OM$Mref
      }
    }
  }
}

#SSB
par(mfrow=c(3,3))
boxplot(re_SSB[1,,], ylim=c(-0.25,0.25), las=1, main="Cod - N1000, No Index, CKMR 5yrs", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[2,,], ylim=c(-0.25,0.25), las=1, main="Flatfish - N1000, No Index, CKMR 5yrs", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[3,,], ylim=c(-0.25,0.25), las=1, main="Sardine - N1000, No Index, CKMR 5yrs", ylab="RE - SSB")
abline(h=0)

#R0
boxplot(re_R0[,1], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,2], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,3], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)

#M
boxplot(re_M[,1], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,2], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,3], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)

#Relative error for point estimates
RE_ssb_N1000_NoIndex_ckmrmultinom5<-re_SSB
RE_R0_N1000_NoIndex_ckmrmultinom5<-re_R0
RE_M_N1000_NoIndex_ckmrmultinom5<-re_M

#Interquartile Range of relative errors
IQR_RE_ssb_N1000_NoIndex_ckmrmultinom5<-apply(re_SSB,c(1,3),quantile,probs=0.75, na.rm=TRUE)-apply(re_SSB,c(1,3),quantile,probs=0.25, na.rm=TRUE)
IQR_RE_R0_N1000_NoIndex_ckmrmultinom5<-apply(re_R0,2,quantile,probs=0.75, na.rm=TRUE)-apply(re_R0,2,quantile,probs=0.25, na.rm=TRUE)
IQR_RE_M_N1000_NoIndex_ckmrmultinom5<-apply(re_M,2,quantile,probs=0.75, na.rm=TRUE)-apply(re_M,2,quantile,probs=0.25, na.rm=TRUE)

#Interquartile Range of absolute relative errors
IQR_ARE_ssb_N1000_NoIndex_ckmrmultinom5<-apply(abs(re_SSB),c(1,3),quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_SSB),c(1,3),quantile,probs=0.25, na.rm=TRUE)
IQR_ARE_R0_N1000_NoIndex_ckmrmultinom5<-apply(abs(re_R0),2,quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_R0),2,quantile,probs=0.25, na.rm=TRUE)
IQR_ARE_M_N1000_NoIndex_ckmrmultinom5<-apply(abs(re_M),2,quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_M),2,quantile,probs=0.25, na.rm=TRUE)

#SD of relative error for point estimates
sd_RE_ssb_N1000_NoIndex_ckmrmultinom5<-apply(re_SSB,c(1,3),sd, na.rm=TRUE)
sd_RE_R0_N1000_NoIndex_ckmrmultinom5<-apply(re_R0,2,sd, na.rm=TRUE)
sd_RE_M_N1000_NoIndex_ckmrmultinom5<-apply(re_M,2,sd, na.rm=TRUE)

#SD of absolute relative error
sd_ARE_ssb_N1000_NoIndex_ckmrmultinom5<-apply(abs(re_SSB),c(1,3),sd, na.rm=TRUE)
sd_ARE_R0_N1000_NoIndex_ckmrmultinom5<-apply(abs(re_R0),2,sd, na.rm=TRUE)
sd_ARE_M_N1000_NoIndex_ckmrmultinom5<-apply(abs(re_M),2,sd, na.rm=TRUE)

#Precision within sims
SD_ssb_N1000_NoIndex_ckmrmultinom5<-CV_ssb_N1000_NoIndex_ckmrmultinom5<-array(NA, dim=c(3,100,76)) 
SD_R0_N1000_NoIndex_ckmrmultinom5<-matrix(NA, nrow=3, ncol=100)
SD_M_N1000_NoIndex_ckmrmultinom5<-matrix(NA, nrow=3, ncol=100)
for(f in 1:3){
  for (i in 1:100){
    if(length(res_list[[f]][[i]])>2){
      CV_ssb_N1000_NoIndex_ckmrmultinom5[f,i,]<-res_list[[f]][[i]]$SD$sd/res_list[[f]][[i]]$SD$value
    SD_ssb_N1000_NoIndex_ckmrmultinom5[f,i,]<-res_list[[f]][[i]]$SD$sd
    SD_R0_N1000_NoIndex_ckmrmultinom5[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_R0","log_R0"])
    SD_M_N1000_NoIndex_ckmrmultinom5[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_M","log_M"])
    }
  }
}

#N5000, 5yrs CKMR data, No Index
res_list<-list()
res_list[[1]]<-readRDS(paste0(wd,"/SCAAfit_Cod_N5000_NoIndex_ckmrmultinom5.RData"))
res_list[[2]]<-readRDS(paste0(wd,"/SCAAfit_Flatfish_N5000_NoIndex_ckmrmultinom5.RData"))
res_list[[3]]<-readRDS(paste0(wd,"/SCAAfit_Sardine_N5000_NoIndex_ckmrmultinom5.RData"))

load(paste0(wd,"/Cod_wdat_N5000_Ind25_ckmrmultinom5_1.RData"))
load(paste0(wd,"/Flatfish_wdat_N5000_Ind25_ckmrmultinom5_1.RData"))
load(paste0(wd,"/Sardine_wdat_N5000_Ind25_ckmrmultinom5_1.RData"))

re_Dep<-re_SSB<-array(NA, dim=c(3,100,76))
re_R0<-re_M<-matrix(NA, nrow=100, ncol=3)
for(f in 1:3){
  for (i in 1:100){
    if(f==1){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Cod_wdat[[i]]$OM$SSB[26:101])/Cod_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Cod_wdat[[i]]$OM$R0)/Cod_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Cod_wdat[[i]]$OM$Mref)/Cod_wdat[[i]]$OM$Mref
      }
    }else if (f==2){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Flatfish_wdat[[i]]$OM$SSB[26:101])/Flatfish_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Flatfish_wdat[[i]]$OM$R0)/Flatfish_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Flatfish_wdat[[i]]$OM$Mref)/Flatfish_wdat[[i]]$OM$Mref
      }
    } else if (f==3){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Sardine_wdat[[i]]$OM$SSB[26:101])/Sardine_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Sardine_wdat[[i]]$OM$R0)/Sardine_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Sardine_wdat[[i]]$OM$Mref)/Sardine_wdat[[i]]$OM$Mref
      }
    }
  }
}

#SSB
par(mfrow=c(3,3))
boxplot(re_SSB[1,,], ylim=c(-0.25,0.25), las=1, main="Cod - N5000, No Index, CKMR 5yrs", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[2,,], ylim=c(-0.25,0.25), las=1, main="Flatfish - N5000, No Index, CKMR 5yrs", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[3,,], ylim=c(-0.25,0.25), las=1, main="Sardine - N5000, No Index, CKMR 5yrs", ylab="RE - SSB")
abline(h=0)

#R0
boxplot(re_R0[,1], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,2], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,3], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)

#M
boxplot(re_M[,1], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,2], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,3], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)

#Relative error for point estimates
RE_ssb_N5000_NoIndex_ckmrmultinom5<-re_SSB
RE_R0_N5000_NoIndex_ckmrmultinom5<-re_R0
RE_M_N5000_NoIndex_ckmrmultinom5<-re_M

#Interquartile Range of relative errors
IQR_RE_ssb_N5000_NoIndex_ckmrmultinom5<-apply(re_SSB,c(1,3),quantile,probs=0.75, na.rm=TRUE)-apply(re_SSB,c(1,3),quantile,probs=0.25, na.rm=TRUE)
IQR_RE_R0_N5000_NoIndex_ckmrmultinom5<-apply(re_R0,2,quantile,probs=0.75, na.rm=TRUE)-apply(re_R0,2,quantile,probs=0.25, na.rm=TRUE)
IQR_RE_M_N5000_NoIndex_ckmrmultinom5<-apply(re_M,2,quantile,probs=0.75, na.rm=TRUE)-apply(re_M,2,quantile,probs=0.25, na.rm=TRUE)

#Interquartile Range of absolute relative errors
IQR_ARE_ssb_N5000_NoIndex_ckmrmultinom5<-apply(abs(re_SSB),c(1,3),quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_SSB),c(1,3),quantile,probs=0.25, na.rm=TRUE)
IQR_ARE_R0_N5000_NoIndex_ckmrmultinom5<-apply(abs(re_R0),2,quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_R0),2,quantile,probs=0.25, na.rm=TRUE)
IQR_ARE_M_N5000_NoIndex_ckmrmultinom5<-apply(abs(re_M),2,quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_M),2,quantile,probs=0.25, na.rm=TRUE)

#SD of relative error for point estimates
sd_RE_ssb_N5000_NoIndex_ckmrmultinom5<-apply(re_SSB,c(1,3),sd, na.rm=TRUE)
sd_RE_R0_N5000_NoIndex_ckmrmultinom5<-apply(re_R0,2,sd, na.rm=TRUE)
sd_RE_M_N5000_NoIndex_ckmrmultinom5<-apply(re_M,2,sd, na.rm=TRUE)

#SD of absolute relative error
sd_ARE_ssb_N5000_NoIndex_ckmrmultinom5<-apply(abs(re_SSB),c(1,3),sd, na.rm=TRUE)
sd_ARE_R0_N5000_NoIndex_ckmrmultinom5<-apply(abs(re_R0),2,sd, na.rm=TRUE)
sd_ARE_M_N5000_NoIndex_ckmrmultinom5<-apply(abs(re_M),2,sd, na.rm=TRUE)

#Precision within sims
SD_ssb_N5000_NoIndex_ckmrmultinom5<-CV_ssb_N5000_NoIndex_ckmrmultinom5<-array(NA, dim=c(3,100,76)) 
SD_R0_N5000_NoIndex_ckmrmultinom5<-matrix(NA, nrow=3, ncol=100)
SD_M_N5000_NoIndex_ckmrmultinom5<-matrix(NA, nrow=3, ncol=100)
for(f in 1:3){
  for (i in 1:100){
    if(length(res_list[[f]][[i]])>2){
      CV_ssb_N5000_NoIndex_ckmrmultinom5[f,i,]<-res_list[[f]][[i]]$SD$sd/res_list[[f]][[i]]$SD$value
    SD_ssb_N5000_NoIndex_ckmrmultinom5[f,i,]<-res_list[[f]][[i]]$SD$sd
    SD_R0_N5000_NoIndex_ckmrmultinom5[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_R0","log_R0"])
    SD_M_N5000_NoIndex_ckmrmultinom5[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_M","log_M"])
    }
  }
}

#N100, 10yrs CKMR data, No Index
res_list<-list()
res_list[[1]]<-readRDS(paste0(wd,"/SCAAfit_Cod_N100_NoIndex_ckmrmultinom10.RData"))
res_list[[2]]<-readRDS(paste0(wd,"/SCAAfit_Flatfish_N100_NoIndex_ckmrmultinom10.RData"))
res_list[[3]]<-readRDS(paste0(wd,"/SCAAfit_Sardine_N100_NoIndex_ckmrmultinom10.RData"))

load(paste0(wd,"/Cod_wdat_N100_Ind25_ckmrmultinom10_1.RData"))
load(paste0(wd,"/Flatfish_wdat_N100_Ind25_ckmrmultinom10_1.RData"))
load(paste0(wd,"/Sardine_wdat_N100_Ind25_ckmrmultinom10_1.RData"))

re_Dep<-re_SSB<-array(NA, dim=c(3,100,76))
re_R0<-re_M<-matrix(NA, nrow=100, ncol=3)
for(f in 1:3){
  for (i in 1:100){
    if(f==1){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Cod_wdat[[i]]$OM$SSB[26:101])/Cod_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Cod_wdat[[i]]$OM$R0)/Cod_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Cod_wdat[[i]]$OM$Mref)/Cod_wdat[[i]]$OM$Mref
      }
    }else if (f==2){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Flatfish_wdat[[i]]$OM$SSB[26:101])/Flatfish_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Flatfish_wdat[[i]]$OM$R0)/Flatfish_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Flatfish_wdat[[i]]$OM$Mref)/Flatfish_wdat[[i]]$OM$Mref
      }
    } else if (f==3){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Sardine_wdat[[i]]$OM$SSB[26:101])/Sardine_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Sardine_wdat[[i]]$OM$R0)/Sardine_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Sardine_wdat[[i]]$OM$Mref)/Sardine_wdat[[i]]$OM$Mref
      }
    }
  }
}

#SSB
par(mfrow=c(3,3))
boxplot(re_SSB[1,,], ylim=c(-0.25,0.25), las=1, main="Cod - N100, No Index, CKMR 10yrs", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[2,,], ylim=c(-0.25,0.25), las=1, main="Flatfish - N100, No Index, CKMR 10yrs", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[3,,], ylim=c(-0.25,0.25), las=1, main="Sardine - N100, No Index, CKMR 10yrs", ylab="RE - SSB")
abline(h=0)

#R0
boxplot(re_R0[,1], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,2], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,3], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)

#M
boxplot(re_M[,1], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,2], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,3], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)

#Relative error for point estimates
RE_ssb_N100_NoIndex_ckmrmultinom10<-re_SSB
RE_R0_N100_NoIndex_ckmrmultinom10<-re_R0
RE_M_N100_NoIndex_ckmrmultinom10<-re_M

#Interquartile Range of relative errors
IQR_RE_ssb_N100_NoIndex_ckmrmultinom10<-apply(re_SSB,c(1,3),quantile,probs=0.75, na.rm=TRUE)-apply(re_SSB,c(1,3),quantile,probs=0.25, na.rm=TRUE)
IQR_RE_R0_N100_NoIndex_ckmrmultinom10<-apply(re_R0,2,quantile,probs=0.75, na.rm=TRUE)-apply(re_R0,2,quantile,probs=0.25, na.rm=TRUE)
IQR_RE_M_N100_NoIndex_ckmrmultinom10<-apply(re_M,2,quantile,probs=0.75, na.rm=TRUE)-apply(re_M,2,quantile,probs=0.25, na.rm=TRUE)

#Interquartile Range of absolute relative errors
IQR_ARE_ssb_N100_NoIndex_ckmrmultinom10<-apply(abs(re_SSB),c(1,3),quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_SSB),c(1,3),quantile,probs=0.25, na.rm=TRUE)
IQR_ARE_R0_N100_NoIndex_ckmrmultinom10<-apply(abs(re_R0),2,quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_R0),2,quantile,probs=0.25, na.rm=TRUE)
IQR_ARE_M_N100_NoIndex_ckmrmultinom10<-apply(abs(re_M),2,quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_M),2,quantile,probs=0.25, na.rm=TRUE)

#SD of relative error for point estimates
sd_RE_ssb_N100_NoIndex_ckmrmultinom10<-apply(re_SSB,c(1,3),sd, na.rm=TRUE)
sd_RE_R0_N100_NoIndex_ckmrmultinom10<-apply(re_R0,2,sd, na.rm=TRUE)
sd_RE_M_N100_NoIndex_ckmrmultinom10<-apply(re_M,2,sd, na.rm=TRUE)

#SD of absolute relative error
sd_ARE_ssb_N100_NoIndex_ckmrmultinom10<-apply(abs(re_SSB),c(1,3),sd, na.rm=TRUE)
sd_ARE_R0_N100_NoIndex_ckmrmultinom10<-apply(abs(re_R0),2,sd, na.rm=TRUE)
sd_ARE_M_N100_NoIndex_ckmrmultinom10<-apply(abs(re_M),2,sd, na.rm=TRUE)

#Precision within sims
SD_ssb_N100_NoIndex_ckmrmultinom10<-CV_ssb_N100_NoIndex_ckmrmultinom10<-array(NA, dim=c(3,100,76)) 
SD_R0_N100_NoIndex_ckmrmultinom10<-matrix(NA, nrow=3, ncol=100)
SD_M_N100_NoIndex_ckmrmultinom10<-matrix(NA, nrow=3, ncol=100)
for(f in 1:3){
  for (i in 1:100){
    if(length(res_list[[f]][[i]])>2){
      CV_ssb_N100_NoIndex_ckmrmultinom10[f,i,]<-res_list[[f]][[i]]$SD$sd/res_list[[f]][[i]]$SD$value
    SD_ssb_N100_NoIndex_ckmrmultinom10[f,i,]<-res_list[[f]][[i]]$SD$sd
    SD_R0_N100_NoIndex_ckmrmultinom10[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_R0","log_R0"])
    SD_M_N100_NoIndex_ckmrmultinom10[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_M","log_M"])
    }
  }
}

#N1000, 10yrs CKMR data, No Index
res_list<-list()
res_list[[1]]<-readRDS(paste0(wd,"/SCAAfit_Cod_N1000_NoIndex_ckmrmultinom10.RData"))
res_list[[2]]<-readRDS(paste0(wd,"/SCAAfit_Flatfish_N1000_NoIndex_ckmrmultinom10.RData"))
res_list[[3]]<-readRDS(paste0(wd,"/SCAAfit_Sardine_N1000_NoIndex_ckmrmultinom10.RData"))

load(paste0(wd,"/Cod_wdat_N1000_Ind25_ckmrmultinom10_1.RData"))
load(paste0(wd,"/Flatfish_wdat_N1000_Ind25_ckmrmultinom10_1.RData"))
load(paste0(wd,"/Sardine_wdat_N1000_Ind25_ckmrmultinom10_1.RData"))

re_Dep<-re_SSB<-array(NA, dim=c(3,100,76))
re_R0<-re_M<-matrix(NA, nrow=100, ncol=3)
for(f in 1:3){
  for (i in 1:100){
    if(f==1){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Cod_wdat[[i]]$OM$SSB[26:101])/Cod_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Cod_wdat[[i]]$OM$R0)/Cod_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Cod_wdat[[i]]$OM$Mref)/Cod_wdat[[i]]$OM$Mref
      }
    }else if (f==2){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Flatfish_wdat[[i]]$OM$SSB[26:101])/Flatfish_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Flatfish_wdat[[i]]$OM$R0)/Flatfish_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Flatfish_wdat[[i]]$OM$Mref)/Flatfish_wdat[[i]]$OM$Mref
      }
    } else if (f==3){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Sardine_wdat[[i]]$OM$SSB[26:101])/Sardine_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Sardine_wdat[[i]]$OM$R0)/Sardine_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Sardine_wdat[[i]]$OM$Mref)/Sardine_wdat[[i]]$OM$Mref
      }
    }
  }
}

#SSB
par(mfrow=c(3,3))
boxplot(re_SSB[1,,], ylim=c(-0.25,0.25), las=1, main="Cod - N1000, No Index, CKMR 10yrs", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[2,,], ylim=c(-0.25,0.25), las=1, main="Flatfish - N1000, No Index, CKMR 10yrs", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[3,,], ylim=c(-0.25,0.25), las=1, main="Sardine - N1000, No Index, CKMR 10yrs", ylab="RE - SSB")
abline(h=0)

#R0
boxplot(re_R0[,1], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,2], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,3], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)

#M
boxplot(re_M[,1], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,2], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,3], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)

#Relative error for point estimates
RE_ssb_N1000_NoIndex_ckmrmultinom10<-re_SSB
RE_R0_N1000_NoIndex_ckmrmultinom10<-re_R0
RE_M_N1000_NoIndex_ckmrmultinom10<-re_M

#Interquartile Range of relative errors
IQR_RE_ssb_N1000_NoIndex_ckmrmultinom10<-apply(re_SSB,c(1,3),quantile,probs=0.75, na.rm=TRUE)-apply(re_SSB,c(1,3),quantile,probs=0.25, na.rm=TRUE)
IQR_RE_R0_N1000_NoIndex_ckmrmultinom10<-apply(re_R0,2,quantile,probs=0.75, na.rm=TRUE)-apply(re_R0,2,quantile,probs=0.25, na.rm=TRUE)
IQR_RE_M_N1000_NoIndex_ckmrmultinom10<-apply(re_M,2,quantile,probs=0.75, na.rm=TRUE)-apply(re_M,2,quantile,probs=0.25, na.rm=TRUE)

#Interquartile Range of absolute relative errors
IQR_ARE_ssb_N1000_NoIndex_ckmrmultinom10<-apply(abs(re_SSB),c(1,3),quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_SSB),c(1,3),quantile,probs=0.25, na.rm=TRUE)
IQR_ARE_R0_N1000_NoIndex_ckmrmultinom10<-apply(abs(re_R0),2,quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_R0),2,quantile,probs=0.25, na.rm=TRUE)
IQR_ARE_M_N1000_NoIndex_ckmrmultinom10<-apply(abs(re_M),2,quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_M),2,quantile,probs=0.25, na.rm=TRUE)

#SD of relative error for point estimates
sd_RE_ssb_N1000_NoIndex_ckmrmultinom10<-apply(re_SSB,c(1,3),sd, na.rm=TRUE)
sd_RE_R0_N1000_NoIndex_ckmrmultinom10<-apply(re_R0,2,sd, na.rm=TRUE)
sd_RE_M_N1000_NoIndex_ckmrmultinom10<-apply(re_M,2,sd, na.rm=TRUE)

#SD of absolute relative error
sd_ARE_ssb_N1000_NoIndex_ckmrmultinom10<-apply(abs(re_SSB),c(1,3),sd, na.rm=TRUE)
sd_ARE_R0_N1000_NoIndex_ckmrmultinom10<-apply(abs(re_R0),2,sd, na.rm=TRUE)
sd_ARE_M_N1000_NoIndex_ckmrmultinom10<-apply(abs(re_M),2,sd, na.rm=TRUE)

#Precision within sims
SD_ssb_N1000_NoIndex_ckmrmultinom10<-CV_ssb_N1000_NoIndex_ckmrmultinom10<-array(NA, dim=c(3,100,76)) 
SD_R0_N1000_NoIndex_ckmrmultinom10<-matrix(NA, nrow=3, ncol=100)
SD_M_N1000_NoIndex_ckmrmultinom10<-matrix(NA, nrow=3, ncol=100)
for(f in 1:3){
  for (i in 1:100){
    if(length(res_list[[f]][[i]])>2){
      CV_ssb_N1000_NoIndex_ckmrmultinom10[f,i,]<-res_list[[f]][[i]]$SD$sd/res_list[[f]][[i]]$SD$value
    SD_ssb_N1000_NoIndex_ckmrmultinom10[f,i,]<-res_list[[f]][[i]]$SD$sd
    SD_R0_N1000_NoIndex_ckmrmultinom10[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_R0","log_R0"])
    SD_M_N1000_NoIndex_ckmrmultinom10[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_M","log_M"])
    }
  }
}

#N5000, 10yrs CKMR data, No Index
res_list<-list()
res_list[[1]]<-readRDS(paste0(wd,"/SCAAfit_Cod_N5000_NoIndex_ckmrmultinom10.RData"))
res_list[[2]]<-readRDS(paste0(wd,"/SCAAfit_Flatfish_N5000_NoIndex_ckmrmultinom10.RData"))
res_list[[3]]<-readRDS(paste0(wd,"/SCAAfit_Sardine_N5000_NoIndex_ckmrmultinom10.RData"))

load(paste0(wd,"/Cod_wdat_N5000_Ind25_ckmrmultinom10_1.RData"))
load(paste0(wd,"/Flatfish_wdat_N5000_Ind25_ckmrmultinom10_1.RData"))
load(paste0(wd,"/Sardine_wdat_N5000_Ind25_ckmrmultinom10_1.RData"))

re_Dep<-re_SSB<-array(NA, dim=c(3,100,76))
re_R0<-re_M<-matrix(NA, nrow=100, ncol=3)
for(f in 1:3){
  for (i in 1:100){
    if(f==1){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Cod_wdat[[i]]$OM$SSB[26:101])/Cod_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Cod_wdat[[i]]$OM$R0)/Cod_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Cod_wdat[[i]]$OM$Mref)/Cod_wdat[[i]]$OM$Mref
      }
    }else if (f==2){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Flatfish_wdat[[i]]$OM$SSB[26:101])/Flatfish_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Flatfish_wdat[[i]]$OM$R0)/Flatfish_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Flatfish_wdat[[i]]$OM$Mref)/Flatfish_wdat[[i]]$OM$Mref
      }
    } else if (f==3){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Sardine_wdat[[i]]$OM$SSB[26:101])/Sardine_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Sardine_wdat[[i]]$OM$R0)/Sardine_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Sardine_wdat[[i]]$OM$Mref)/Sardine_wdat[[i]]$OM$Mref
      }
    }
  }
}

#SSB
par(mfrow=c(3,3))
boxplot(re_SSB[1,,], ylim=c(-0.25,0.25), las=1, main="Cod - N5000, No Index, CKMR 10yrs", ylab="RE - SSB")
abline(h=0) 
boxplot(re_SSB[2,,], ylim=c(-0.25,0.25), las=1, main="Flatfish - N5000, No Index, CKMR 10yrs", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[3,,], ylim=c(-0.25,0.25), las=1, main="Sardine - N5000, No Index, CKMR 10yrs", ylab="RE - SSB")
abline(h=0)

#R0
boxplot(re_R0[,1], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,2], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,3], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)

#M
boxplot(re_M[,1], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,2], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,3], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)

#Relative error for point estimates
RE_ssb_N5000_NoIndex_ckmrmultinom10<-re_SSB
RE_R0_N5000_NoIndex_ckmrmultinom10<-re_R0
RE_M_N5000_NoIndex_ckmrmultinom10<-re_M

#Interquartile Range of relative errors
IQR_RE_ssb_N5000_NoIndex_ckmrmultinom10<-apply(re_SSB,c(1,3),quantile,probs=0.75, na.rm=TRUE)-apply(re_SSB,c(1,3),quantile,probs=0.25, na.rm=TRUE)
IQR_RE_R0_N5000_NoIndex_ckmrmultinom10<-apply(re_R0,2,quantile,probs=0.75, na.rm=TRUE)-apply(re_R0,2,quantile,probs=0.25, na.rm=TRUE)
IQR_RE_M_N5000_NoIndex_ckmrmultinom10<-apply(re_M,2,quantile,probs=0.75, na.rm=TRUE)-apply(re_M,2,quantile,probs=0.25, na.rm=TRUE)

#Interquartile Range of absolute relative errors
IQR_ARE_ssb_N5000_NoIndex_ckmrmultinom10<-apply(abs(re_SSB),c(1,3),quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_SSB),c(1,3),quantile,probs=0.25, na.rm=TRUE)
IQR_ARE_R0_N5000_NoIndex_ckmrmultinom10<-apply(abs(re_R0),2,quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_R0),2,quantile,probs=0.25, na.rm=TRUE)
IQR_ARE_M_N5000_NoIndex_ckmrmultinom10<-apply(abs(re_M),2,quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_M),2,quantile,probs=0.25, na.rm=TRUE)

#SD of relative error for point estimates
sd_RE_ssb_N5000_NoIndex_ckmrmultinom10<-apply(re_SSB,c(1,3),sd, na.rm=TRUE)
sd_RE_R0_N5000_NoIndex_ckmrmultinom10<-apply(re_R0,2,sd, na.rm=TRUE)
sd_RE_M_N5000_NoIndex_ckmrmultinom10<-apply(re_M,2,sd, na.rm=TRUE)

#SD of absolute relative error
sd_ARE_ssb_N5000_NoIndex_ckmrmultinom10<-apply(abs(re_SSB),c(1,3),sd, na.rm=TRUE)
sd_ARE_R0_N5000_NoIndex_ckmrmultinom10<-apply(abs(re_R0),2,sd, na.rm=TRUE)
sd_ARE_M_N5000_NoIndex_ckmrmultinom10<-apply(abs(re_M),2,sd, na.rm=TRUE)

#Precision within sims
SD_ssb_N5000_NoIndex_ckmrmultinom10<-CV_ssb_N5000_NoIndex_ckmrmultinom10<-array(NA, dim=c(3,100,76)) 
SD_R0_N5000_NoIndex_ckmrmultinom10<-matrix(NA, nrow=3, ncol=100)
SD_M_N5000_NoIndex_ckmrmultinom10<-matrix(NA, nrow=3, ncol=100)
for(f in 1:3){
  for (i in 1:100){
    if(length(res_list[[f]][[i]])>2){
      CV_ssb_N5000_NoIndex_ckmrmultinom10[f,i,]<-res_list[[f]][[i]]$SD$sd/res_list[[f]][[i]]$SD$value
    SD_ssb_N5000_NoIndex_ckmrmultinom10[f,i,]<-res_list[[f]][[i]]$SD$sd
    SD_R0_N5000_NoIndex_ckmrmultinom10[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_R0","log_R0"])
    SD_M_N5000_NoIndex_ckmrmultinom10[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_M","log_M"])
    }
  }
}

#N100, 20yrs CKMR data, No Index
res_list<-list()
res_list[[1]]<-readRDS(paste0(wd,"/SCAAfit_Cod_N100_NoIndex_ckmrmultinom20.RData"))
res_list[[2]]<-readRDS(paste0(wd,"/SCAAfit_Flatfish_N100_NoIndex_ckmrmultinom20.RData"))
res_list[[3]]<-readRDS(paste0(wd,"/SCAAfit_Sardine_N100_NoIndex_ckmrmultinom20.RData"))

load(paste0(wd,"/Cod_wdat_N100_Ind25_ckmrmultinom20_1.RData"))
load(paste0(wd,"/Flatfish_wdat_N100_Ind25_ckmrmultinom20_1.RData"))
load(paste0(wd,"/Sardine_wdat_N100_Ind25_ckmrmultinom20_1.RData"))

re_Dep<-re_SSB<-array(NA, dim=c(3,100,76))
re_R0<-re_M<-matrix(NA, nrow=100, ncol=3)
for(f in 1:3){
  for (i in 1:100){
    if(f==1){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Cod_wdat[[i]]$OM$SSB[26:101])/Cod_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Cod_wdat[[i]]$OM$R0)/Cod_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Cod_wdat[[i]]$OM$Mref)/Cod_wdat[[i]]$OM$Mref
      }
    }else if (f==2){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Flatfish_wdat[[i]]$OM$SSB[26:101])/Flatfish_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Flatfish_wdat[[i]]$OM$R0)/Flatfish_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Flatfish_wdat[[i]]$OM$Mref)/Flatfish_wdat[[i]]$OM$Mref
      }
    } else if (f==3){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Sardine_wdat[[i]]$OM$SSB[26:101])/Sardine_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Sardine_wdat[[i]]$OM$R0)/Sardine_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Sardine_wdat[[i]]$OM$Mref)/Sardine_wdat[[i]]$OM$Mref
      }
    }
  }
}

#SSB
par(mfrow=c(3,3))
boxplot(re_SSB[1,,], ylim=c(-0.25,0.25), las=1, main="Cod - N100, No Index, CKMR 20yrs", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[2,,], ylim=c(-0.25,0.25), las=1, main="Flatfish - N100, No Index, CKMR 20yrs", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[3,,], ylim=c(-0.25,0.25), las=1, main="Sardine - N100, No Index, CKMR 20yrs", ylab="RE - SSB")
abline(h=0)

#R0
boxplot(re_R0[,1], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,2], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,3], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)

#M
boxplot(re_M[,1], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,2], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,3], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)

#Relative error for point estimates
RE_ssb_N100_NoIndex_ckmrmultinom20<-re_SSB
RE_R0_N100_NoIndex_ckmrmultinom20<-re_R0
RE_M_N100_NoIndex_ckmrmultinom20<-re_M

#Interquartile Range of relative errors
IQR_RE_ssb_N100_NoIndex_ckmrmultinom20<-apply(re_SSB,c(1,3),quantile,probs=0.75, na.rm=TRUE)-apply(re_SSB,c(1,3),quantile,probs=0.25, na.rm=TRUE)
IQR_RE_R0_N100_NoIndex_ckmrmultinom20<-apply(re_R0,2,quantile,probs=0.75, na.rm=TRUE)-apply(re_R0,2,quantile,probs=0.25, na.rm=TRUE)
IQR_RE_M_N100_NoIndex_ckmrmultinom20<-apply(re_M,2,quantile,probs=0.75, na.rm=TRUE)-apply(re_M,2,quantile,probs=0.25, na.rm=TRUE)

#Interquartile Range of absolute relative errors
IQR_ARE_ssb_N100_NoIndex_ckmrmultinom20<-apply(abs(re_SSB),c(1,3),quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_SSB),c(1,3),quantile,probs=0.25, na.rm=TRUE)
IQR_ARE_R0_N100_NoIndex_ckmrmultinom20<-apply(abs(re_R0),2,quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_R0),2,quantile,probs=0.25, na.rm=TRUE)
IQR_ARE_M_N100_NoIndex_ckmrmultinom20<-apply(abs(re_M),2,quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_M),2,quantile,probs=0.25, na.rm=TRUE)

#SD of relative error for point estimates
sd_RE_ssb_N100_NoIndex_ckmrmultinom20<-apply(re_SSB,c(1,3),sd, na.rm=TRUE)
sd_RE_R0_N100_NoIndex_ckmrmultinom20<-apply(re_R0,2,sd, na.rm=TRUE)
sd_RE_M_N100_NoIndex_ckmrmultinom20<-apply(re_M,2,sd, na.rm=TRUE)

#SD of absolute relative error
sd_ARE_ssb_N100_NoIndex_ckmrmultinom20<-apply(abs(re_SSB),c(1,3),sd, na.rm=TRUE)
sd_ARE_R0_N100_NoIndex_ckmrmultinom20<-apply(abs(re_R0),2,sd, na.rm=TRUE)
sd_ARE_M_N100_NoIndex_ckmrmultinom20<-apply(abs(re_M),2,sd, na.rm=TRUE)

#Precision within sims
SD_ssb_N100_NoIndex_ckmrmultinom20<-CV_ssb_N100_NoIndex_ckmrmultinom20<-array(NA, dim=c(3,100,76))
SD_R0_N100_NoIndex_ckmrmultinom20<-matrix(NA, nrow=3, ncol=100)
SD_M_N100_NoIndex_ckmrmultinom20<-matrix(NA, nrow=3, ncol=100)
for(f in 1:3){
  for (i in 1:100){
    if(length(res_list[[f]][[i]])>2){
      CV_ssb_N100_NoIndex_ckmrmultinom20[f,i,]<-res_list[[f]][[i]]$SD$sd/res_list[[f]][[i]]$SD$value
    SD_ssb_N100_NoIndex_ckmrmultinom20[f,i,]<-res_list[[f]][[i]]$SD$sd
    SD_R0_N100_NoIndex_ckmrmultinom20[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_R0","log_R0"])
    SD_M_N100_NoIndex_ckmrmultinom20[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_M","log_M"])
    }
  }
}

#N1000, 20yrs CKMR data, No Index
res_list<-list()
res_list[[1]]<-readRDS(paste0(wd,"/SCAAfit_Cod_N1000_NoIndex_ckmrmultinom20.RData"))
res_list[[2]]<-readRDS(paste0(wd,"/SCAAfit_Flatfish_N1000_NoIndex_ckmrmultinom20.RData"))
res_list[[3]]<-readRDS(paste0(wd,"/SCAAfit_Sardine_N1000_NoIndex_ckmrmultinom20.RData"))

load(paste0(wd,"/Cod_wdat_N1000_Ind25_ckmrmultinom20_1.RData"))
load(paste0(wd,"/Flatfish_wdat_N1000_Ind25_ckmrmultinom20_1.RData"))
load(paste0(wd,"/Sardine_wdat_N1000_Ind25_ckmrmultinom20_1.RData"))

re_Dep<-re_SSB<-array(NA, dim=c(3,100,76))
re_R0<-re_M<-matrix(NA, nrow=100, ncol=3)
for(f in 1:3){
  for (i in 1:100){
    if(f==1){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Cod_wdat[[i]]$OM$SSB[26:101])/Cod_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Cod_wdat[[i]]$OM$R0)/Cod_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Cod_wdat[[i]]$OM$Mref)/Cod_wdat[[i]]$OM$Mref
      }
    }else if (f==2){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Flatfish_wdat[[i]]$OM$SSB[26:101])/Flatfish_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Flatfish_wdat[[i]]$OM$R0)/Flatfish_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Flatfish_wdat[[i]]$OM$Mref)/Flatfish_wdat[[i]]$OM$Mref
      }
    } else if (f==3){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Sardine_wdat[[i]]$OM$SSB[26:101])/Sardine_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Sardine_wdat[[i]]$OM$R0)/Sardine_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Sardine_wdat[[i]]$OM$Mref)/Sardine_wdat[[i]]$OM$Mref
      }
    }
  }
}

#SSB
par(mfrow=c(3,3))
boxplot(re_SSB[1,,], ylim=c(-0.25,0.25), las=1, main="Cod - N1000, No Index, CKMR 20yrs", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[2,,], ylim=c(-0.25,0.25), las=1, main="Flatfish - N1000, No Index, CKMR 20yrs", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[3,,], ylim=c(-0.25,0.25), las=1, main="Sardine - N1000, No Index, CKMR 20yrs", ylab="RE - SSB")
abline(h=0)

#R0
boxplot(re_R0[,1], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,2], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,3], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)

#M
boxplot(re_M[,1], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,2], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,3], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)

#Relative error for point estimates
RE_ssb_N1000_NoIndex_ckmrmultinom20<-re_SSB
RE_R0_N1000_NoIndex_ckmrmultinom20<-re_R0
RE_M_N1000_NoIndex_ckmrmultinom20<-re_M

#Interquartile Range of relative errors
IQR_RE_ssb_N1000_NoIndex_ckmrmultinom20<-apply(re_SSB,c(1,3),quantile,probs=0.75, na.rm=TRUE)-apply(re_SSB,c(1,3),quantile,probs=0.25, na.rm=TRUE)
IQR_RE_R0_N1000_NoIndex_ckmrmultinom20<-apply(re_R0,2,quantile,probs=0.75, na.rm=TRUE)-apply(re_R0,2,quantile,probs=0.25, na.rm=TRUE)
IQR_RE_M_N1000_NoIndex_ckmrmultinom20<-apply(re_M,2,quantile,probs=0.75, na.rm=TRUE)-apply(re_M,2,quantile,probs=0.25, na.rm=TRUE)

#Interquartile Range of absolute relative errors
IQR_ARE_ssb_N1000_NoIndex_ckmrmultinom20<-apply(abs(re_SSB),c(1,3),quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_SSB),c(1,3),quantile,probs=0.25, na.rm=TRUE)
IQR_ARE_R0_N1000_NoIndex_ckmrmultinom20<-apply(abs(re_R0),2,quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_R0),2,quantile,probs=0.25, na.rm=TRUE)
IQR_ARE_M_N1000_NoIndex_ckmrmultinom20<-apply(abs(re_M),2,quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_M),2,quantile,probs=0.25, na.rm=TRUE)

#SD of relative error for point estimates
sd_RE_ssb_N1000_NoIndex_ckmrmultinom20<-apply(re_SSB,c(1,3),sd, na.rm=TRUE)
sd_RE_R0_N1000_NoIndex_ckmrmultinom20<-apply(re_R0,2,sd, na.rm=TRUE)
sd_RE_M_N1000_NoIndex_ckmrmultinom20<-apply(re_M,2,sd, na.rm=TRUE)

#SD of absolute relative error
sd_ARE_ssb_N1000_NoIndex_ckmrmultinom20<-apply(abs(re_SSB),c(1,3),sd, na.rm=TRUE)
sd_ARE_R0_N1000_NoIndex_ckmrmultinom20<-apply(abs(re_R0),2,sd, na.rm=TRUE)
sd_ARE_M_N1000_NoIndex_ckmrmultinom20<-apply(abs(re_M),2,sd, na.rm=TRUE)

#Precision within sims
SD_ssb_N1000_NoIndex_ckmrmultinom20<-CV_ssb_N1000_NoIndex_ckmrmultinom20<-array(NA, dim=c(3,100,76))
SD_R0_N1000_NoIndex_ckmrmultinom20<-matrix(NA, nrow=3, ncol=100)
SD_M_N1000_NoIndex_ckmrmultinom20<-matrix(NA, nrow=3, ncol=100)
for(f in 1:3){
  for (i in 1:100){
    if(length(res_list[[f]][[i]])>2){
      CV_ssb_N1000_NoIndex_ckmrmultinom20[f,i,]<-res_list[[f]][[i]]$SD$sd/res_list[[f]][[i]]$SD$value
    SD_ssb_N1000_NoIndex_ckmrmultinom20[f,i,]<-res_list[[f]][[i]]$SD$sd
    SD_R0_N1000_NoIndex_ckmrmultinom20[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_R0","log_R0"])
    SD_M_N1000_NoIndex_ckmrmultinom20[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_M","log_M"])
    }
  }
}

#N5000, 20yrs CKMR data, No Index
res_list<-list()
res_list[[1]]<-readRDS(paste0(wd,"/SCAAfit_Cod_N5000_NoIndex_ckmrmultinom20.RData"))
res_list[[2]]<-readRDS(paste0(wd,"/SCAAfit_Flatfish_N5000_NoIndex_ckmrmultinom20.RData"))
res_list[[3]]<-readRDS(paste0(wd,"/SCAAfit_Sardine_N5000_NoIndex_ckmrmultinom20.RData"))

load(paste0(wd,"/Cod_wdat_N5000_Ind25_ckmrmultinom20_1.RData"))
load(paste0(wd,"/Flatfish_wdat_N5000_Ind25_ckmrmultinom20_1.RData"))
load(paste0(wd,"/Sardine_wdat_N5000_Ind25_ckmrmultinom20_1.RData"))

re_Dep<-re_SSB<-array(NA, dim=c(3,100,76))
re_R0<-re_M<-matrix(NA, nrow=100, ncol=3)
for(f in 1:3){
  for (i in 1:100){
    if(f==1){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Cod_wdat[[i]]$OM$SSB[26:101])/Cod_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Cod_wdat[[i]]$OM$R0)/Cod_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Cod_wdat[[i]]$OM$Mref)/Cod_wdat[[i]]$OM$Mref
      }
    }else if (f==2){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Flatfish_wdat[[i]]$OM$SSB[26:101])/Flatfish_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Flatfish_wdat[[i]]$OM$R0)/Flatfish_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Flatfish_wdat[[i]]$OM$Mref)/Flatfish_wdat[[i]]$OM$Mref
      }
    } else if (f==3){
      if(length(res_list[[f]][[i]])>2){
        re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$value-Sardine_wdat[[i]]$OM$SSB[26:101])/Sardine_wdat[[i]]$OM$SSB[26:101]
        re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_R0"])-Sardine_wdat[[i]]$OM$R0)/Sardine_wdat[[i]]$OM$R0
        re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed["log_M"])-Sardine_wdat[[i]]$OM$Mref)/Sardine_wdat[[i]]$OM$Mref
      }
    }
  }
}

#SSB
par(mfrow=c(3,3))
boxplot(re_SSB[1,,], ylim=c(-0.25,0.25), las=1, main="Cod - N5000, No Index, CKMR 20yrs", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[2,,], ylim=c(-0.25,0.25), las=1, main="Flatfish - N5000, No Index, CKMR 20yrs", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[3,,], ylim=c(-0.25,0.25), las=1, main="Sardine - N5000, No Index, CKMR 20yrs", ylab="RE - SSB")
abline(h=0)

#R0
boxplot(re_R0[,1], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,2], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,3], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)

#M
boxplot(re_M[,1], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,2], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,3], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)

#Relative error for point estimates
RE_ssb_N5000_NoIndex_ckmrmultinom20<-re_SSB
RE_R0_N5000_NoIndex_ckmrmultinom20<-re_R0
RE_M_N5000_NoIndex_ckmrmultinom20<-re_M

#Interquartile Range of relative errors
IQR_RE_ssb_N5000_NoIndex_ckmrmultinom20<-apply(re_SSB,c(1,3),quantile,probs=0.75, na.rm=TRUE)-apply(re_SSB,c(1,3),quantile,probs=0.25, na.rm=TRUE)
IQR_RE_R0_N5000_NoIndex_ckmrmultinom20<-apply(re_R0,2,quantile,probs=0.75, na.rm=TRUE)-apply(re_R0,2,quantile,probs=0.25, na.rm=TRUE)
IQR_RE_M_N5000_NoIndex_ckmrmultinom20<-apply(re_M,2,quantile,probs=0.75, na.rm=TRUE)-apply(re_M,2,quantile,probs=0.25, na.rm=TRUE)

#Interquartile Range of absolute relative errors
IQR_ARE_ssb_N5000_NoIndex_ckmrmultinom20<-apply(abs(re_SSB),c(1,3),quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_SSB),c(1,3),quantile,probs=0.25, na.rm=TRUE)
IQR_ARE_R0_N5000_NoIndex_ckmrmultinom20<-apply(abs(re_R0),2,quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_R0),2,quantile,probs=0.25, na.rm=TRUE)
IQR_ARE_M_N5000_NoIndex_ckmrmultinom20<-apply(abs(re_M),2,quantile,probs=0.75, na.rm=TRUE)-apply(abs(re_M),2,quantile,probs=0.25, na.rm=TRUE)

#SD of relative error for point estimates
sd_RE_ssb_N5000_NoIndex_ckmrmultinom20<-apply(re_SSB,c(1,3),sd, na.rm=TRUE)
sd_RE_R0_N5000_NoIndex_ckmrmultinom20<-apply(re_R0,2,sd, na.rm=TRUE)
sd_RE_M_N5000_NoIndex_ckmrmultinom20<-apply(re_M,2,sd, na.rm=TRUE)

#SD of absolute relative error
sd_ARE_ssb_N5000_NoIndex_ckmrmultinom20<-apply(abs(re_SSB),c(1,3),sd, na.rm=TRUE)
sd_ARE_R0_N5000_NoIndex_ckmrmultinom20<-apply(abs(re_R0),2,sd, na.rm=TRUE)
sd_ARE_M_N5000_NoIndex_ckmrmultinom20<-apply(abs(re_M),2,sd, na.rm=TRUE)

#Precision within sims
SD_ssb_N5000_NoIndex_ckmrmultinom20<-CV_ssb_N5000_NoIndex_ckmrmultinom20<-array(NA, dim=c(3,100,76))
SD_R0_N5000_NoIndex_ckmrmultinom20<-matrix(NA, nrow=3, ncol=100)
SD_M_N5000_NoIndex_ckmrmultinom20<-matrix(NA, nrow=3, ncol=100)
for(f in 1:3){
  for (i in 1:100){
    if(length(res_list[[f]][[i]])>2){
      CV_ssb_N5000_NoIndex_ckmrmultinom20[f,i,]<-res_list[[f]][[i]]$SD$sd/res_list[[f]][[i]]$SD$value
    SD_ssb_N5000_NoIndex_ckmrmultinom20[f,i,]<-res_list[[f]][[i]]$SD$sd
    SD_R0_N5000_NoIndex_ckmrmultinom20[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_R0","log_R0"])
    SD_M_N5000_NoIndex_ckmrmultinom20[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_M","log_M"])
    }
  }
}

###################################
###################################
#New plots
###################################
###################################

#####################
#Median ARE SSB
#####################
#tiff(filename="C:/Users/fischn/Documents/GitHub/CKMR_Project/ARE.tiff", height=30, width=50, units='cm', compression="lzw", res=500)
par(mfrow=c(3,9), mar=c(1,1,1,0.5), oma=c(3.5,4,1,1))
#Cod
plot(1:76,apply(abs(RE_ssb_N100_NoIndex_ckmrmultinom5),c(1,3),median, na.rm=TRUE)[1,]/apply(abs(RE_ssb_N100_NoIndex_5yrs_noCKMR),c(1,3),median, na.rm=TRUE)[1,], pch=16, las=1, ylim=c(0,1.4), ylab="", xlab="", main="5yrs",xaxt="n", xlim=c(0,250),bty="[")
abline(h=1, lty=2)
points(86:161,apply(abs(RE_ssb_N1000_NoIndex_ckmrmultinom5),c(1,3),median, na.rm=TRUE)[1,]/apply(abs(RE_ssb_N1000_NoIndex_5yrs_noCKMR),c(1,3),median, na.rm=TRUE)[1,], pch=16, col=2)
points(171:246,apply(abs(RE_ssb_N5000_NoIndex_ckmrmultinom5),c(1,3),median, na.rm=TRUE)[1,]/apply(abs(RE_ssb_N5000_NoIndex_5yrs_noCKMR),c(1,3),median, na.rm=TRUE)[1,], pch=16, col=3)

plot(1:76,apply(abs(RE_ssb_N100_NoIndex_ckmrmultinom10),c(1,3),median, na.rm=TRUE)[1,]/apply(abs(RE_ssb_N100_NoIndex_10yrs_noCKMR),c(1,3),median, na.rm=TRUE)[1,], pch=16, col=1,las=1, ylim=c(0,1.4), ylab="", xlab="", main="10yrs",xaxt="n",  xlim=c(0,250),yaxt="n",bty="n")
abline(h=1, lty=2)
points(86:161,apply(abs(RE_ssb_N1000_NoIndex_ckmrmultinom10),c(1,3),median, na.rm=TRUE)[1,]/apply(abs(RE_ssb_N1000_NoIndex_10yrs_noCKMR),c(1,3),median, na.rm=TRUE)[1,], pch=16, col=2)
points(171:246,apply(abs(RE_ssb_N5000_NoIndex_ckmrmultinom10),c(1,3),median, na.rm=TRUE)[1,]/apply(abs(RE_ssb_N5000_NoIndex_10yrs_noCKMR),c(1,3),median, na.rm=TRUE)[1,], pch=16, col=3)
mtext(side=3, text="No Index", line=-1.5, font=2)
axis(side=1,lwd.ticks = 0, labels=FALSE)
axis(side=3,lwd.ticks = 0, labels=FALSE)

plot(1:76,apply(abs(RE_ssb_N100_NoIndex_ckmrmultinom20),c(1,3),median, na.rm=TRUE)[1,]/apply(abs(RE_ssb_N100_NoIndex_20yrs_noCKMR),c(1,3),median, na.rm=TRUE)[1,], pch=16, col=1,las=1, ylim=c(0,1.4), ylab="", xlab="", main="20yrs",xaxt="n",  xlim=c(0,250),yaxt="n",bty="]")
abline(h=1, lty=2)
points(86:161,apply(abs(RE_ssb_N1000_NoIndex_ckmrmultinom20),c(1,3),median, na.rm=TRUE)[1,]/apply(abs(RE_ssb_N1000_NoIndex_20yrs_noCKMR),c(1,3),median, na.rm=TRUE)[1,], pch=16, col=2)
points(171:246,apply(abs(RE_ssb_N5000_NoIndex_ckmrmultinom20),c(1,3),median, na.rm=TRUE)[1,]/apply(abs(RE_ssb_N5000_NoIndex_20yrs_noCKMR),c(1,3),median, na.rm=TRUE)[1,], pch=16, col=3)

plot(1:76,apply(abs(RE_ssb_N100_Ind50_ckmrmultinom5),c(1,3),median, na.rm=TRUE)[1,]/apply(abs(RE_ssb_N100_Ind50_5yrs_noCKMR),c(1,3),median, na.rm=TRUE)[1,], pch=16, las=1, ylim=c(0,1.4), ylab="", xlab="", main="5yrs",xaxt="n", xlim=c(0,250),yaxt="n",bty="[")
abline(h=1, lty=2)
points(86:161,apply(abs(RE_ssb_N1000_Ind50_ckmrmultinom5),c(1,3),median, na.rm=TRUE)[1,]/apply(abs(RE_ssb_N1000_Ind50_5yrs_noCKMR),c(1,3),median, na.rm=TRUE)[1,], pch=16, col=2)
points(171:246,apply(abs(RE_ssb_N5000_Ind50_ckmrmultinom5),c(1,3),median, na.rm=TRUE)[1,]/apply(abs(RE_ssb_N5000_Ind50_5yrs_noCKMR),c(1,3),median, na.rm=TRUE)[1,], pch=16, col=3)

plot(1:76,apply(abs(RE_ssb_N100_Ind50_ckmrmultinom10),c(1,3),median, na.rm=TRUE)[1,]/apply(abs(RE_ssb_N100_Ind50_10yrs_noCKMR),c(1,3),median, na.rm=TRUE)[1,], pch=16, col=1,las=1, ylim=c(0,1.4), ylab="", xlab="", main="10yrs",xaxt="n",  xlim=c(0,250),yaxt="n",bty="n")
abline(h=1, lty=2)
points(86:161,apply(abs(RE_ssb_N1000_Ind50_ckmrmultinom10),c(1,3),median, na.rm=TRUE)[1,]/apply(abs(RE_ssb_N1000_Ind50_10yrs_noCKMR),c(1,3),median, na.rm=TRUE)[1,], pch=16, col=2)
points(171:246,apply(abs(RE_ssb_N5000_Ind50_ckmrmultinom10),c(1,3),median, na.rm=TRUE)[1,]/apply(abs(RE_ssb_N5000_Ind50_10yrs_noCKMR),c(1,3),median, na.rm=TRUE)[1,], pch=16, col=3)
mtext(side=1, text="Cod", line=-1, font=2)
mtext(side=3, text="Index - 0.5", line=-1.5, font=2)
axis(side=1,lwd.ticks = 0, labels=FALSE)
axis(side=3,lwd.ticks = 0, labels=FALSE)
legend(x=60,y=0.5,c("N=100", "N=1000", "N=5000"), pch=16, col=1:3, bty="n", cex=1.5)

plot(1:76,apply(abs(RE_ssb_N100_Ind50_ckmrmultinom20),c(1,3),median, na.rm=TRUE)[1,]/apply(abs(RE_ssb_N100_Ind50_20yrs_noCKMR),c(1,3),median, na.rm=TRUE)[1,], pch=16, col=1,las=1, ylim=c(0,1.4), ylab="", xlab="", main="20yrs",xaxt="n",  xlim=c(0,250),yaxt="n",bty="]")
abline(h=1, lty=2)
points(86:161,apply(abs(RE_ssb_N1000_Ind50_ckmrmultinom20),c(1,3),median, na.rm=TRUE)[1,]/apply(abs(RE_ssb_N1000_Ind50_20yrs_noCKMR),c(1,3),median, na.rm=TRUE)[1,], pch=16, col=2)
points(171:246,apply(abs(RE_ssb_N5000_Ind50_ckmrmultinom20),c(1,3),median, na.rm=TRUE)[1,]/apply(abs(RE_ssb_N5000_Ind50_20yrs_noCKMR),c(1,3),median, na.rm=TRUE)[1,], pch=16, col=3)

plot(1:76,apply(abs(RE_ssb_N100_Ind25_ckmrmultinom5),c(1,3),median, na.rm=TRUE)[1,]/apply(abs(RE_ssb_N100_Ind25_5yrs_noCKMR),c(1,3),median, na.rm=TRUE)[1,], pch=16, las=1, ylim=c(0,1.4), ylab="", xlab="", main="5yrs",xaxt="n", xlim=c(0,250),yaxt="n",bty="[")
abline(h=1, lty=2)
points(86:161,apply(abs(RE_ssb_N1000_Ind25_ckmrmultinom5),c(1,3),median, na.rm=TRUE)[1,]/apply(abs(RE_ssb_N1000_Ind25_5yrs_noCKMR),c(1,3),median, na.rm=TRUE)[1,], pch=16, col=2)
points(171:246,apply(abs(RE_ssb_N5000_Ind25_ckmrmultinom5),c(1,3),median, na.rm=TRUE)[1,]/apply(abs(RE_ssb_N5000_Ind25_5yrs_noCKMR),c(1,3),median, na.rm=TRUE)[1,], pch=16, col=3)

plot(1:76,apply(abs(RE_ssb_N100_Ind25_ckmrmultinom10),c(1,3),median, na.rm=TRUE)[1,]/apply(abs(RE_ssb_N100_Ind25_10yrs_noCKMR),c(1,3),median, na.rm=TRUE)[1,], pch=16, col=1,las=1, ylim=c(0,1.4), ylab="", xlab="", main="10yrs",xaxt="n",  xlim=c(0,250),yaxt="n",bty="n")
abline(h=1, lty=2)
points(86:161,apply(abs(RE_ssb_N1000_Ind25_ckmrmultinom10),c(1,3),median, na.rm=TRUE)[1,]/apply(abs(RE_ssb_N1000_Ind25_10yrs_noCKMR),c(1,3),median, na.rm=TRUE)[1,], pch=16, col=2)
points(171:246,apply(abs(RE_ssb_N5000_Ind25_ckmrmultinom10),c(1,3),median, na.rm=TRUE)[1,]/apply(abs(RE_ssb_N5000_Ind25_10yrs_noCKMR),c(1,3),median, na.rm=TRUE)[1,], pch=16, col=3)
mtext(side=3, text="Index - 0.25", line=-1.5, font=2)
axis(side=1,lwd.ticks = 0, labels=FALSE)
axis(side=3,lwd.ticks = 0, labels=FALSE)

plot(1:76,apply(abs(RE_ssb_N100_Ind25_ckmrmultinom20),c(1,3),median, na.rm=TRUE)[1,]/apply(abs(RE_ssb_N100_Ind25_20yrs_noCKMR),c(1,3),median, na.rm=TRUE)[1,], pch=16, col=1,las=1, ylim=c(0,1.4), ylab="", xlab="", main="20yrs",xaxt="n",  xlim=c(0,250),yaxt="n",bty="]")
abline(h=1, lty=2)
points(86:161,apply(abs(RE_ssb_N1000_Ind25_ckmrmultinom20),c(1,3),median, na.rm=TRUE)[1,]/apply(abs(RE_ssb_N1000_Ind25_20yrs_noCKMR),c(1,3),median, na.rm=TRUE)[1,], pch=16, col=2)
points(171:246,apply(abs(RE_ssb_N5000_Ind25_ckmrmultinom20),c(1,3),median, na.rm=TRUE)[1,]/apply(abs(RE_ssb_N5000_Ind25_20yrs_noCKMR),c(1,3),median, na.rm=TRUE)[1,], pch=16, col=3)

#Flatfish
plot(1:76,apply(abs(RE_ssb_N100_NoIndex_ckmrmultinom5),c(1,3),median, na.rm=TRUE)[2,]/apply(abs(RE_ssb_N100_NoIndex_5yrs_noCKMR),c(1,3),median, na.rm=TRUE)[2,], pch=16, las=1, ylim=c(0,1.4), ylab="", xlab="", main="",xaxt="n", xlim=c(0,250),bty="[")
abline(h=1, lty=2)
points(86:161,apply(abs(RE_ssb_N1000_NoIndex_ckmrmultinom5),c(1,3),median, na.rm=TRUE)[2,]/apply(abs(RE_ssb_N1000_NoIndex_5yrs_noCKMR),c(1,3),median, na.rm=TRUE)[2,], pch=16, col=2)
points(171:246,apply(abs(RE_ssb_N5000_NoIndex_ckmrmultinom5),c(1,3),median, na.rm=TRUE)[2,]/apply(abs(RE_ssb_N5000_NoIndex_5yrs_noCKMR),c(1,3),median, na.rm=TRUE)[2,], pch=16, col=3)
mtext(side=2, text="Median ARE of SSB / No CKMR", line=3)

plot(1:76,apply(abs(RE_ssb_N100_NoIndex_ckmrmultinom10),c(1,3),median, na.rm=TRUE)[2,]/apply(abs(RE_ssb_N100_NoIndex_10yrs_noCKMR),c(1,3),median, na.rm=TRUE)[2,], pch=16, col=1,las=1, ylim=c(0,1.4), ylab="", xlab="", main="",xaxt="n",  xlim=c(0,250),yaxt="n",bty="n")
abline(h=1, lty=2)
points(86:161,apply(abs(RE_ssb_N1000_NoIndex_ckmrmultinom10),c(1,3),median, na.rm=TRUE)[2,]/apply(abs(RE_ssb_N1000_NoIndex_10yrs_noCKMR),c(1,3),median, na.rm=TRUE)[2,], pch=16, col=2)
points(171:246,apply(abs(RE_ssb_N5000_NoIndex_ckmrmultinom10),c(1,3),median, na.rm=TRUE)[2,]/apply(abs(RE_ssb_N5000_NoIndex_10yrs_noCKMR),c(1,3),median, na.rm=TRUE)[2,], pch=16, col=3)
axis(side=1,lwd.ticks = 0, labels=FALSE)
axis(side=3,lwd.ticks = 0, labels=FALSE)

plot(1:76,apply(abs(RE_ssb_N100_NoIndex_ckmrmultinom20),c(1,3),median, na.rm=TRUE)[2,]/apply(abs(RE_ssb_N100_NoIndex_20yrs_noCKMR),c(1,3),median, na.rm=TRUE)[2,], pch=16, col=1,las=1, ylim=c(0,1.4), ylab="", xlab="", main="",xaxt="n",  xlim=c(0,250),yaxt="n",bty="]")
abline(h=1, lty=2)
points(86:161,apply(abs(RE_ssb_N1000_NoIndex_ckmrmultinom20),c(1,3),median, na.rm=TRUE)[2,]/apply(abs(RE_ssb_N1000_NoIndex_20yrs_noCKMR),c(1,3),median, na.rm=TRUE)[2,], pch=16, col=2)
points(171:246,apply(abs(RE_ssb_N5000_NoIndex_ckmrmultinom20),c(1,3),median, na.rm=TRUE)[2,]/apply(abs(RE_ssb_N5000_NoIndex_20yrs_noCKMR),c(1,3),median, na.rm=TRUE)[2,], pch=16, col=3)

plot(1:76,apply(abs(RE_ssb_N100_Ind50_ckmrmultinom5),c(1,3),median, na.rm=TRUE)[2,]/apply(abs(RE_ssb_N100_Ind50_5yrs_noCKMR),c(1,3),median, na.rm=TRUE)[2,], pch=16, las=1, ylim=c(0,1.4),yaxt="n", ylab="", xlab="", main="",xaxt="n", xlim=c(0,250),bty="[")
abline(h=1, lty=2)
points(86:161,apply(abs(RE_ssb_N1000_Ind50_ckmrmultinom5),c(1,3),median, na.rm=TRUE)[2,]/apply(abs(RE_ssb_N1000_Ind50_5yrs_noCKMR),c(1,3),median, na.rm=TRUE)[2,], pch=16, col=2)
points(171:246,apply(abs(RE_ssb_N5000_Ind50_ckmrmultinom5),c(1,3),median, na.rm=TRUE)[2,]/apply(abs(RE_ssb_N5000_Ind50_5yrs_noCKMR),c(1,3),median, na.rm=TRUE)[2,], pch=16, col=3)

plot(1:76,apply(abs(RE_ssb_N100_Ind50_ckmrmultinom10),c(1,3),median, na.rm=TRUE)[2,]/apply(abs(RE_ssb_N100_Ind50_10yrs_noCKMR),c(1,3),median, na.rm=TRUE)[2,], pch=16, col=1,las=1, ylim=c(0,1.4), ylab="", xlab="", main="",xaxt="n",  xlim=c(0,250),yaxt="n",bty="n")
abline(h=1, lty=2)
points(86:161,apply(abs(RE_ssb_N1000_Ind50_ckmrmultinom10),c(1,3),median, na.rm=TRUE)[2,]/apply(abs(RE_ssb_N1000_Ind50_10yrs_noCKMR),c(1,3),median, na.rm=TRUE)[2,], pch=16, col=2)
points(171:246,apply(abs(RE_ssb_N5000_Ind50_ckmrmultinom10),c(1,3),median, na.rm=TRUE)[2,]/apply(abs(RE_ssb_N5000_Ind50_10yrs_noCKMR),c(1,3),median, na.rm=TRUE)[2,], pch=16, col=3)
mtext(side=1, text="Flatfish", line=-1, font=2)
axis(side=1,lwd.ticks = 0, labels=FALSE)
axis(side=3,lwd.ticks = 0, labels=FALSE)

plot(1:76,apply(abs(RE_ssb_N100_Ind50_ckmrmultinom20),c(1,3),median, na.rm=TRUE)[2,]/apply(abs(RE_ssb_N100_Ind50_20yrs_noCKMR),c(1,3),median, na.rm=TRUE)[2,], pch=16, col=1,las=1, ylim=c(0,1.4), ylab="", xlab="", main="",xaxt="n",  xlim=c(0,250),yaxt="n",bty="]")
abline(h=1, lty=2)
points(86:161,apply(abs(RE_ssb_N1000_Ind50_ckmrmultinom20),c(1,3),median, na.rm=TRUE)[2,]/apply(abs(RE_ssb_N1000_Ind50_20yrs_noCKMR),c(1,3),median, na.rm=TRUE)[2,], pch=16, col=2)
points(171:246,apply(abs(RE_ssb_N5000_Ind50_ckmrmultinom20),c(1,3),median, na.rm=TRUE)[2,]/apply(abs(RE_ssb_N5000_Ind50_20yrs_noCKMR),c(1,3),median, na.rm=TRUE)[2,], pch=16, col=3)

plot(1:76,apply(abs(RE_ssb_N100_Ind25_ckmrmultinom5),c(1,3),median, na.rm=TRUE)[2,]/apply(abs(RE_ssb_N100_Ind25_5yrs_noCKMR),c(1,3),median, na.rm=TRUE)[2,], pch=16, las=1, ylim=c(0,1.4),yaxt="n", ylab="", xlab="", main="",xaxt="n", xlim=c(0,250),bty="[")
abline(h=1, lty=2)
points(86:161,apply(abs(RE_ssb_N1000_Ind25_ckmrmultinom5),c(1,3),median, na.rm=TRUE)[2,]/apply(abs(RE_ssb_N1000_Ind25_5yrs_noCKMR),c(1,3),median, na.rm=TRUE)[2,], pch=16, col=2)
points(171:246,apply(abs(RE_ssb_N5000_Ind25_ckmrmultinom5),c(1,3),median, na.rm=TRUE)[2,]/apply(abs(RE_ssb_N5000_Ind25_5yrs_noCKMR),c(1,3),median, na.rm=TRUE)[2,], pch=16, col=3)

plot(1:76,apply(abs(RE_ssb_N100_Ind25_ckmrmultinom10),c(1,3),median, na.rm=TRUE)[2,]/apply(abs(RE_ssb_N100_Ind25_10yrs_noCKMR),c(1,3),median, na.rm=TRUE)[2,], pch=16, col=1,las=1, ylim=c(0,1.4), ylab="", xlab="", main="",xaxt="n",  xlim=c(0,250),yaxt="n",bty="n")
abline(h=1, lty=2)
points(86:161,apply(abs(RE_ssb_N1000_Ind25_ckmrmultinom10),c(1,3),median, na.rm=TRUE)[2,]/apply(abs(RE_ssb_N1000_Ind25_10yrs_noCKMR),c(1,3),median, na.rm=TRUE)[2,], pch=16, col=2)
points(171:246,apply(abs(RE_ssb_N5000_Ind25_ckmrmultinom10),c(1,3),median, na.rm=TRUE)[2,]/apply(abs(RE_ssb_N5000_Ind25_10yrs_noCKMR),c(1,3),median, na.rm=TRUE)[2,], pch=16, col=3)
axis(side=1,lwd.ticks = 0, labels=FALSE)
axis(side=3,lwd.ticks = 0, labels=FALSE)

plot(1:76,apply(abs(RE_ssb_N100_Ind25_ckmrmultinom20),c(1,3),median, na.rm=TRUE)[2,]/apply(abs(RE_ssb_N100_Ind25_20yrs_noCKMR),c(1,3),median, na.rm=TRUE)[2,], pch=16, col=1,las=1, ylim=c(0,1.4), ylab="", xlab="", main="",xaxt="n",  xlim=c(0,250),yaxt="n",bty="]")
abline(h=1, lty=2)
points(86:161,apply(abs(RE_ssb_N1000_Ind25_ckmrmultinom20),c(1,3),median, na.rm=TRUE)[2,]/apply(abs(RE_ssb_N1000_Ind25_20yrs_noCKMR),c(1,3),median, na.rm=TRUE)[2,], pch=16, col=2)
points(171:246,apply(abs(RE_ssb_N5000_Ind25_ckmrmultinom20),c(1,3),median, na.rm=TRUE)[2,]/apply(abs(RE_ssb_N5000_Ind25_20yrs_noCKMR),c(1,3),median, na.rm=TRUE)[2,], pch=16, col=3)

#Sardine
plot(1:76,apply(abs(RE_ssb_N100_NoIndex_ckmrmultinom5),c(1,3),median, na.rm=TRUE)[3,]/apply(abs(RE_ssb_N100_NoIndex_5yrs_noCKMR),c(1,3),median, na.rm=TRUE)[3,], pch=16, las=1, ylim=c(0,1.4), ylab="", xlab="", main="",xaxt="n", xlim=c(0,250),bty="[")
abline(h=1, lty=2)
points(86:161,apply(abs(RE_ssb_N1000_NoIndex_ckmrmultinom5),c(1,3),median, na.rm=TRUE)[3,]/apply(abs(RE_ssb_N1000_NoIndex_5yrs_noCKMR),c(1,3),median, na.rm=TRUE)[3,], pch=16, col=2)
points(171:246,apply(abs(RE_ssb_N5000_NoIndex_ckmrmultinom5),c(1,3),median, na.rm=TRUE)[3,]/apply(abs(RE_ssb_N5000_NoIndex_5yrs_noCKMR),c(1,3),median, na.rm=TRUE)[3,], pch=16, col=3)
axis(side=1, at=c(40,127,211), labels=c("N100", "N1000", "N5000"))

plot(1:76,apply(abs(RE_ssb_N100_NoIndex_ckmrmultinom10),c(1,3),median, na.rm=TRUE)[3,]/apply(abs(RE_ssb_N100_NoIndex_10yrs_noCKMR),c(1,3),median, na.rm=TRUE)[3,], pch=16, col=1,las=1, ylim=c(0,1.4), ylab="", xlab="", main="",xaxt="n",  xlim=c(0,250),yaxt="n",bty="n")
abline(h=1, lty=2)
points(86:161,apply(abs(RE_ssb_N1000_NoIndex_ckmrmultinom10),c(1,3),median, na.rm=TRUE)[3,]/apply(abs(RE_ssb_N1000_NoIndex_10yrs_noCKMR),c(1,3),median, na.rm=TRUE)[3,], pch=16, col=2)
points(171:246,apply(abs(RE_ssb_N5000_NoIndex_ckmrmultinom10),c(1,3),median, na.rm=TRUE)[3,]/apply(abs(RE_ssb_N5000_NoIndex_10yrs_noCKMR),c(1,3),median, na.rm=TRUE)[3,], pch=16, col=3)
axis(side=1, at=c(40,127,211), labels=c("N100", "N1000", "N5000"))
axis(side=1,lwd.ticks = 0, labels=FALSE)
axis(side=3,lwd.ticks = 0, labels=FALSE)

plot(1:76,apply(abs(RE_ssb_N100_NoIndex_ckmrmultinom20),c(1,3),median, na.rm=TRUE)[3,]/apply(abs(RE_ssb_N100_NoIndex_20yrs_noCKMR),c(1,3),median, na.rm=TRUE)[3,], pch=16, col=1,las=1, ylim=c(0,1.4), ylab="", xlab="", main="",xaxt="n",  xlim=c(0,250),yaxt="n",bty="]")
abline(h=1, lty=2)
points(86:161,apply(abs(RE_ssb_N1000_NoIndex_ckmrmultinom20),c(1,3),median, na.rm=TRUE)[3,]/apply(abs(RE_ssb_N1000_NoIndex_20yrs_noCKMR),c(1,3),median, na.rm=TRUE)[3,], pch=16, col=2)
points(171:246,apply(abs(RE_ssb_N5000_NoIndex_ckmrmultinom20),c(1,3),median, na.rm=TRUE)[3,]/apply(abs(RE_ssb_N5000_NoIndex_20yrs_noCKMR),c(1,3),median, na.rm=TRUE)[3,], pch=16, col=3)
axis(side=1, at=c(40,127,211), labels=c("N100", "N1000", "N5000"))

plot(1:76,apply(abs(RE_ssb_N100_Ind50_ckmrmultinom5),c(1,3),median, na.rm=TRUE)[3,]/apply(abs(RE_ssb_N100_Ind50_5yrs_noCKMR),c(1,3),median, na.rm=TRUE)[3,], pch=16, las=1, ylim=c(0,1.4), ylab="", xlab="", main="",xaxt="n", xlim=c(0,250),yaxt="n",bty="[")
abline(h=1, lty=2)
points(86:161,apply(abs(RE_ssb_N1000_Ind50_ckmrmultinom5),c(1,3),median, na.rm=TRUE)[3,]/apply(abs(RE_ssb_N1000_Ind50_5yrs_noCKMR),c(1,3),median, na.rm=TRUE)[3,], pch=16, col=2)
points(171:246,apply(abs(RE_ssb_N5000_Ind50_ckmrmultinom5),c(1,3),median, na.rm=TRUE)[3,]/apply(abs(RE_ssb_N5000_Ind50_5yrs_noCKMR),c(1,3),median, na.rm=TRUE)[3,], pch=16, col=3)
axis(side=1, at=c(40,127,211), labels=c("N100", "N1000", "N5000"))

plot(1:76,apply(abs(RE_ssb_N100_Ind50_ckmrmultinom10),c(1,3),median, na.rm=TRUE)[3,]/apply(abs(RE_ssb_N100_Ind50_10yrs_noCKMR),c(1,3),median, na.rm=TRUE)[3,], pch=16, col=1,las=1, ylim=c(0,1.4), ylab="", xlab="", main="",xaxt="n",  xlim=c(0,250),yaxt="n",bty="n")
abline(h=1, lty=2)
points(86:161,apply(abs(RE_ssb_N1000_Ind50_ckmrmultinom10),c(1,3),median, na.rm=TRUE)[3,]/apply(abs(RE_ssb_N1000_Ind50_10yrs_noCKMR),c(1,3),median, na.rm=TRUE)[3,], pch=16, col=2)
points(171:246,apply(abs(RE_ssb_N5000_Ind50_ckmrmultinom10),c(1,3),median, na.rm=TRUE)[3,]/apply(abs(RE_ssb_N5000_Ind50_10yrs_noCKMR),c(1,3),median, na.rm=TRUE)[3,], pch=16, col=3)
axis(side=1, at=c(40,127,211), labels=c("N100", "N1000", "N5000"))
mtext(side=1, text="Sardine", line=-1, font=2)
mtext(side=1, text="Sample Size", line=3)
axis(side=1,lwd.ticks = 0, labels=FALSE)
axis(side=3,lwd.ticks = 0, labels=FALSE)

plot(1:76,apply(abs(RE_ssb_N100_Ind50_ckmrmultinom20),c(1,3),median, na.rm=TRUE)[3,]/apply(abs(RE_ssb_N100_Ind50_20yrs_noCKMR),c(1,3),median, na.rm=TRUE)[3,], pch=16, col=1,las=1, ylim=c(0,1.4), ylab="", xlab="", main="",xaxt="n",  xlim=c(0,250),yaxt="n",bty="]")
abline(h=1, lty=2)
points(86:161,apply(abs(RE_ssb_N1000_Ind50_ckmrmultinom20),c(1,3),median, na.rm=TRUE)[3,]/apply(abs(RE_ssb_N1000_Ind50_20yrs_noCKMR),c(1,3),median, na.rm=TRUE)[3,], pch=16, col=2)
points(171:246,apply(abs(RE_ssb_N5000_Ind50_ckmrmultinom20),c(1,3),median, na.rm=TRUE)[3,]/apply(abs(RE_ssb_N5000_Ind50_20yrs_noCKMR),c(1,3),median, na.rm=TRUE)[3,], pch=16, col=3)
axis(side=1, at=c(40,127,211), labels=c("N100", "N1000", "N5000"))

plot(1:76,apply(abs(RE_ssb_N100_Ind25_ckmrmultinom5),c(1,3),median, na.rm=TRUE)[3,]/apply(abs(RE_ssb_N100_Ind25_5yrs_noCKMR),c(1,3),median, na.rm=TRUE)[3,], pch=16, las=1, ylim=c(0,1.4), ylab="", xlab="", main="",xaxt="n", xlim=c(0,250),yaxt="n",bty="[")
abline(h=1, lty=2)
points(86:161,apply(abs(RE_ssb_N1000_Ind25_ckmrmultinom5),c(1,3),median, na.rm=TRUE)[3,]/apply(abs(RE_ssb_N1000_Ind25_5yrs_noCKMR),c(1,3),median, na.rm=TRUE)[3,], pch=16, col=2)
points(171:246,apply(abs(RE_ssb_N5000_Ind25_ckmrmultinom5),c(1,3),median, na.rm=TRUE)[3,]/apply(abs(RE_ssb_N5000_Ind25_5yrs_noCKMR),c(1,3),median, na.rm=TRUE)[3,], pch=16, col=3)
axis(side=1, at=c(40,127,211), labels=c("N100", "N1000", "N5000"))

plot(1:76,apply(abs(RE_ssb_N100_Ind25_ckmrmultinom10),c(1,3),median, na.rm=TRUE)[3,]/apply(abs(RE_ssb_N100_Ind25_10yrs_noCKMR),c(1,3),median, na.rm=TRUE)[3,], pch=16, col=1,las=1, ylim=c(0,1.4), ylab="", xlab="", main="",xaxt="n",  xlim=c(0,250),yaxt="n",bty="n")
abline(h=1, lty=2)
points(86:161,apply(abs(RE_ssb_N1000_Ind25_ckmrmultinom10),c(1,3),median, na.rm=TRUE)[3,]/apply(abs(RE_ssb_N1000_Ind25_10yrs_noCKMR),c(1,3),median, na.rm=TRUE)[3,], pch=16, col=2)
points(171:246,apply(abs(RE_ssb_N5000_Ind25_ckmrmultinom10),c(1,3),median, na.rm=TRUE)[3,]/apply(abs(RE_ssb_N5000_Ind25_10yrs_noCKMR),c(1,3),median, na.rm=TRUE)[3,], pch=16, col=3)
axis(side=1, at=c(40,127,211), labels=c("N100", "N1000", "N5000"))
axis(side=1,lwd.ticks = 0, labels=FALSE)
axis(side=3,lwd.ticks = 0, labels=FALSE)

plot(1:76,apply(abs(RE_ssb_N100_Ind25_ckmrmultinom20),c(1,3),median, na.rm=TRUE)[3,]/apply(abs(RE_ssb_N100_Ind25_20yrs_noCKMR),c(1,3),median, na.rm=TRUE)[3,], pch=16, col=1,las=1, ylim=c(0,1.4), ylab="", xlab="", main="",xaxt="n",  xlim=c(0,250),yaxt="n",bty="]")
abline(h=1, lty=2)
points(86:161,apply(abs(RE_ssb_N1000_Ind25_ckmrmultinom20),c(1,3),median, na.rm=TRUE)[3,]/apply(abs(RE_ssb_N1000_Ind25_20yrs_noCKMR),c(1,3),median, na.rm=TRUE)[3,], pch=16, col=2)
points(171:246,apply(abs(RE_ssb_N5000_Ind25_ckmrmultinom20),c(1,3),median, na.rm=TRUE)[3,]/apply(abs(RE_ssb_N5000_Ind25_20yrs_noCKMR),c(1,3),median, na.rm=TRUE)[3,], pch=16, col=3)
axis(side=1, at=c(40,127,211), labels=c("N100", "N1000", "N5000"))
#dev.off()


#######################
#SE of SSB within sims
#######################
#tiff(filename="C:/Users/fischn/Documents/GitHub/CKMR_Project/SE.tiff", height=30, width=50, units='cm', compression="lzw", res=500)
par(mfrow=c(3,9), mar=c(1,1,1,0.5), oma=c(3.5,4,1,1))
#Cod
plot(1:76,apply(SD_ssb_N100_NoIndex_ckmrmultinom5,c(1,3),median, na.rm=TRUE)[1,]/apply(SD_ssb_N100_NoIndex_5yrs_noCKMR,c(1,3),median, na.rm=TRUE)[1,], pch=16, las=1, ylim=c(0,1.2), ylab="", xlab="", main="5yrs",xaxt="n", xlim=c(0,250),bty="[")
abline(h=1, lty=2)
points(86:161,apply(SD_ssb_N1000_NoIndex_ckmrmultinom5,c(1,3),median, na.rm=TRUE)[1,]/apply(SD_ssb_N1000_NoIndex_5yrs_noCKMR,c(1,3),median, na.rm=TRUE)[1,], pch=16, col=2)
points(171:246,apply(SD_ssb_N5000_NoIndex_ckmrmultinom5,c(1,3),median, na.rm=TRUE)[1,]/apply(SD_ssb_N5000_NoIndex_5yrs_noCKMR,c(1,3),median, na.rm=TRUE)[1,], pch=16, col=3)

plot(1:76,apply(SD_ssb_N100_NoIndex_ckmrmultinom10,c(1,3),median, na.rm=TRUE)[1,]/apply(SD_ssb_N100_NoIndex_10yrs_noCKMR,c(1,3),median, na.rm=TRUE)[1,], pch=16, col=1,las=1, ylim=c(0,1.2), ylab="", xlab="", main="10yrs",xaxt="n",  xlim=c(0,250),yaxt="n",bty="n")
abline(h=1, lty=2)
points(86:161,apply(SD_ssb_N1000_NoIndex_ckmrmultinom10,c(1,3),median, na.rm=TRUE)[1,]/apply(SD_ssb_N1000_NoIndex_10yrs_noCKMR,c(1,3),median, na.rm=TRUE)[1,], pch=16, col=2)
points(171:246,apply(SD_ssb_N5000_NoIndex_ckmrmultinom10,c(1,3),median, na.rm=TRUE)[1,]/apply(SD_ssb_N5000_NoIndex_10yrs_noCKMR,c(1,3),median, na.rm=TRUE)[1,], pch=16, col=3)
mtext(side=3, text="No Index", line=-1.5, font=2)
axis(side=1,lwd.ticks = 0, labels=FALSE)
axis(side=3,lwd.ticks = 0, labels=FALSE)

plot(1:76,apply(SD_ssb_N100_NoIndex_ckmrmultinom20,c(1,3),median, na.rm=TRUE)[1,]/apply(SD_ssb_N100_NoIndex_20yrs_noCKMR,c(1,3),median, na.rm=TRUE)[1,], pch=16, col=1,las=1, ylim=c(0,1.2), ylab="", xlab="", main="20yrs",xaxt="n",  xlim=c(0,250),yaxt="n",bty="]")
abline(h=1, lty=2)
points(86:161,apply(SD_ssb_N1000_NoIndex_ckmrmultinom20,c(1,3),median, na.rm=TRUE)[1,]/apply(SD_ssb_N1000_NoIndex_20yrs_noCKMR,c(1,3),median, na.rm=TRUE)[1,], pch=16, col=2)
points(171:246,apply(SD_ssb_N5000_NoIndex_ckmrmultinom20,c(1,3),median, na.rm=TRUE)[1,]/apply(SD_ssb_N5000_NoIndex_20yrs_noCKMR,c(1,3),median, na.rm=TRUE)[1,], pch=16, col=3)

plot(1:76,apply(SD_ssb_N100_Ind50_ckmrmultinom5,c(1,3),median, na.rm=TRUE)[1,]/apply(SD_ssb_N100_Ind50_5yrs_noCKMR,c(1,3),median, na.rm=TRUE)[1,], pch=16, las=1, ylim=c(0,1.2), ylab="", xlab="", main="5yrs",xaxt="n", xlim=c(0,250),yaxt="n",bty="[")
abline(h=1, lty=2)
points(86:161,apply(SD_ssb_N1000_Ind50_ckmrmultinom5,c(1,3),median, na.rm=TRUE)[1,]/apply(SD_ssb_N1000_Ind50_5yrs_noCKMR,c(1,3),median, na.rm=TRUE)[1,], pch=16, col=2)
points(171:246,apply(SD_ssb_N5000_Ind50_ckmrmultinom5,c(1,3),median, na.rm=TRUE)[1,]/apply(SD_ssb_N5000_Ind50_5yrs_noCKMR,c(1,3),median, na.rm=TRUE)[1,], pch=16, col=3)

plot(1:76,apply(SD_ssb_N100_Ind50_ckmrmultinom10,c(1,3),median, na.rm=TRUE)[1,]/apply(SD_ssb_N100_Ind50_10yrs_noCKMR,c(1,3),median, na.rm=TRUE)[1,], pch=16, col=1,las=1, ylim=c(0,1.2), ylab="", xlab="", main="10yrs",xaxt="n",  xlim=c(0,250),yaxt="n",bty="n")
abline(h=1, lty=2)
points(86:161,apply(SD_ssb_N1000_Ind50_ckmrmultinom10,c(1,3),median, na.rm=TRUE)[1,]/apply(SD_ssb_N1000_Ind50_10yrs_noCKMR,c(1,3),median, na.rm=TRUE)[1,], pch=16, col=2)
points(171:246,apply(SD_ssb_N5000_Ind50_ckmrmultinom10,c(1,3),median, na.rm=TRUE)[1,]/apply(SD_ssb_N5000_Ind50_10yrs_noCKMR,c(1,3),median, na.rm=TRUE)[1,], pch=16, col=3)
mtext(side=1, text="Cod", line=-1, font=2)
mtext(side=3, text="Index - 0.5", line=-1.5, font=2)
axis(side=1,lwd.ticks = 0, labels=FALSE)
axis(side=3,lwd.ticks = 0, labels=FALSE)
legend(x=60,y=0.5,c("N=100", "N=1000", "N=5000"), pch=16, col=1:3, bty="n", cex=1.5)

plot(1:76,apply(SD_ssb_N100_Ind50_ckmrmultinom20,c(1,3),median, na.rm=TRUE)[1,]/apply(SD_ssb_N100_Ind50_20yrs_noCKMR,c(1,3),median, na.rm=TRUE)[1,], pch=16, col=1,las=1, ylim=c(0,1.2), ylab="", xlab="", main="20yrs",xaxt="n",  xlim=c(0,250),yaxt="n",bty="]")
abline(h=1, lty=2)
points(86:161,apply(SD_ssb_N1000_Ind50_ckmrmultinom20,c(1,3),median, na.rm=TRUE)[1,]/apply(SD_ssb_N1000_Ind50_20yrs_noCKMR,c(1,3),median, na.rm=TRUE)[1,], pch=16, col=2)
points(171:246,apply(SD_ssb_N5000_Ind50_ckmrmultinom20,c(1,3),median, na.rm=TRUE)[1,]/apply(SD_ssb_N5000_Ind50_20yrs_noCKMR,c(1,3),median, na.rm=TRUE)[1,], pch=16, col=3)

plot(1:76,apply(SD_ssb_N100_Ind25_ckmrmultinom5,c(1,3),median, na.rm=TRUE)[1,]/apply(SD_ssb_N100_Ind25_5yrs_noCKMR,c(1,3),median, na.rm=TRUE)[1,], pch=16, las=1, ylim=c(0,1.2), ylab="", xlab="", main="5yrs",xaxt="n", xlim=c(0,250),yaxt="n",bty="[")
abline(h=1, lty=2)
points(86:161,apply(SD_ssb_N1000_Ind25_ckmrmultinom5,c(1,3),median, na.rm=TRUE)[1,]/apply(SD_ssb_N1000_Ind25_5yrs_noCKMR,c(1,3),median, na.rm=TRUE)[1,], pch=16, col=2)
points(171:246,apply(SD_ssb_N5000_Ind25_ckmrmultinom5,c(1,3),median, na.rm=TRUE)[1,]/apply(SD_ssb_N5000_Ind25_5yrs_noCKMR,c(1,3),median, na.rm=TRUE)[1,], pch=16, col=3)

plot(1:76,apply(SD_ssb_N100_Ind25_ckmrmultinom10,c(1,3),median, na.rm=TRUE)[1,]/apply(SD_ssb_N100_Ind25_10yrs_noCKMR,c(1,3),median, na.rm=TRUE)[1,], pch=16, col=1,las=1, ylim=c(0,1.2), ylab="", xlab="", main="10yrs",xaxt="n",  xlim=c(0,250),yaxt="n",bty="n")
abline(h=1, lty=2)
points(86:161,apply(SD_ssb_N1000_Ind25_ckmrmultinom10,c(1,3),median, na.rm=TRUE)[1,]/apply(SD_ssb_N1000_Ind25_10yrs_noCKMR,c(1,3),median, na.rm=TRUE)[1,], pch=16, col=2)
points(171:246,apply(SD_ssb_N5000_Ind25_ckmrmultinom10,c(1,3),median, na.rm=TRUE)[1,]/apply(SD_ssb_N5000_Ind25_10yrs_noCKMR,c(1,3),median, na.rm=TRUE)[1,], pch=16, col=3)
mtext(side=3, text="Index - 0.25", line=-1.5, font=2)
axis(side=1,lwd.ticks = 0, labels=FALSE)
axis(side=3,lwd.ticks = 0, labels=FALSE)

plot(1:76,apply(SD_ssb_N100_Ind25_ckmrmultinom20,c(1,3),median, na.rm=TRUE)[1,]/apply(SD_ssb_N100_Ind25_20yrs_noCKMR,c(1,3),median, na.rm=TRUE)[1,], pch=16, col=1,las=1, ylim=c(0,1.2), ylab="", xlab="", main="20yrs",xaxt="n",  xlim=c(0,250),yaxt="n",bty="]")
abline(h=1, lty=2)
points(86:161,apply(SD_ssb_N1000_Ind25_ckmrmultinom20,c(1,3),median, na.rm=TRUE)[1,]/apply(SD_ssb_N1000_Ind25_20yrs_noCKMR,c(1,3),median, na.rm=TRUE)[1,], pch=16, col=2)
points(171:246,apply(SD_ssb_N5000_Ind25_ckmrmultinom20,c(1,3),median, na.rm=TRUE)[1,]/apply(SD_ssb_N5000_Ind25_20yrs_noCKMR,c(1,3),median, na.rm=TRUE)[1,], pch=16, col=3)

#Flatfish
plot(1:76,apply(SD_ssb_N100_NoIndex_ckmrmultinom5,c(1,3),median, na.rm=TRUE)[2,]/apply(SD_ssb_N100_NoIndex_5yrs_noCKMR,c(1,3),median, na.rm=TRUE)[2,], pch=16, las=1, ylim=c(0,1.2), ylab="", xlab="", main="",xaxt="n", xlim=c(0,250),bty="[")
abline(h=1, lty=2)
points(86:161,apply(SD_ssb_N1000_NoIndex_ckmrmultinom5,c(1,3),median, na.rm=TRUE)[2,]/apply(SD_ssb_N1000_NoIndex_5yrs_noCKMR,c(1,3),median, na.rm=TRUE)[2,], pch=16, col=2)
points(171:246,apply(SD_ssb_N5000_NoIndex_ckmrmultinom5,c(1,3),median, na.rm=TRUE)[2,]/apply(SD_ssb_N5000_NoIndex_5yrs_noCKMR,c(1,3),median, na.rm=TRUE)[2,], pch=16, col=3)
mtext(side=2, text="Median SE of SSB / No CKMR", line=3)

plot(1:76,apply(SD_ssb_N100_NoIndex_ckmrmultinom10,c(1,3),median, na.rm=TRUE)[2,]/apply(SD_ssb_N100_NoIndex_10yrs_noCKMR,c(1,3),median, na.rm=TRUE)[2,], pch=16, col=1,las=1, ylim=c(0,1.2), ylab="", xlab="", main="",xaxt="n",  xlim=c(0,250),yaxt="n",bty="n")
abline(h=1, lty=2)
points(86:161,apply(SD_ssb_N1000_NoIndex_ckmrmultinom10,c(1,3),median, na.rm=TRUE)[2,]/apply(SD_ssb_N1000_NoIndex_10yrs_noCKMR,c(1,3),median, na.rm=TRUE)[2,], pch=16, col=2)
points(171:246,apply(SD_ssb_N5000_NoIndex_ckmrmultinom10,c(1,3),median, na.rm=TRUE)[2,]/apply(SD_ssb_N5000_NoIndex_10yrs_noCKMR,c(1,3),median, na.rm=TRUE)[2,], pch=16, col=3)
axis(side=1,lwd.ticks = 0, labels=FALSE)
axis(side=3,lwd.ticks = 0, labels=FALSE)

plot(1:76,apply(SD_ssb_N100_NoIndex_ckmrmultinom20,c(1,3),median, na.rm=TRUE)[2,]/apply(SD_ssb_N100_NoIndex_20yrs_noCKMR,c(1,3),median, na.rm=TRUE)[2,], pch=16, col=1,las=1, ylim=c(0,1.2), ylab="", xlab="", main="",xaxt="n",  xlim=c(0,250),yaxt="n",bty="]")
abline(h=1, lty=2)
points(86:161,apply(SD_ssb_N1000_NoIndex_ckmrmultinom20,c(1,3),median, na.rm=TRUE)[2,]/apply(SD_ssb_N1000_NoIndex_20yrs_noCKMR,c(1,3),median, na.rm=TRUE)[2,], pch=16, col=2)
points(171:246,apply(SD_ssb_N5000_NoIndex_ckmrmultinom20,c(1,3),median, na.rm=TRUE)[2,]/apply(SD_ssb_N5000_NoIndex_20yrs_noCKMR,c(1,3),median, na.rm=TRUE)[2,], pch=16, col=3)

plot(1:76,apply(SD_ssb_N100_Ind50_ckmrmultinom5,c(1,3),median, na.rm=TRUE)[2,]/apply(SD_ssb_N100_Ind50_5yrs_noCKMR,c(1,3),median, na.rm=TRUE)[2,], pch=16, las=1, ylim=c(0,1.2),yaxt="n", ylab="", xlab="", main="",xaxt="n", xlim=c(0,250),bty="[")
abline(h=1, lty=2)
points(86:161,apply(SD_ssb_N1000_Ind50_ckmrmultinom5,c(1,3),median, na.rm=TRUE)[2,]/apply(SD_ssb_N1000_Ind50_5yrs_noCKMR,c(1,3),median, na.rm=TRUE)[2,], pch=16, col=2)
points(171:246,apply(SD_ssb_N5000_Ind50_ckmrmultinom5,c(1,3),median, na.rm=TRUE)[2,]/apply(SD_ssb_N5000_Ind50_5yrs_noCKMR,c(1,3),median, na.rm=TRUE)[2,], pch=16, col=3)

plot(1:76,apply(SD_ssb_N100_Ind50_ckmrmultinom10,c(1,3),median, na.rm=TRUE)[2,]/apply(SD_ssb_N100_Ind50_10yrs_noCKMR,c(1,3),median, na.rm=TRUE)[2,], pch=16, col=1,las=1, ylim=c(0,1.2), ylab="", xlab="", main="",xaxt="n",  xlim=c(0,250),yaxt="n",bty="n")
abline(h=1, lty=2)
points(86:161,apply(SD_ssb_N1000_Ind50_ckmrmultinom10,c(1,3),median, na.rm=TRUE)[2,]/apply(SD_ssb_N1000_Ind50_10yrs_noCKMR,c(1,3),median, na.rm=TRUE)[2,], pch=16, col=2)
points(171:246,apply(SD_ssb_N5000_Ind50_ckmrmultinom10,c(1,3),median, na.rm=TRUE)[2,]/apply(SD_ssb_N5000_Ind50_10yrs_noCKMR,c(1,3),median, na.rm=TRUE)[2,], pch=16, col=3)
mtext(side=1, text="Flatfish", line=-1, font=2)
axis(side=1,lwd.ticks = 0, labels=FALSE)
axis(side=3,lwd.ticks = 0, labels=FALSE)

plot(1:76,apply(SD_ssb_N100_Ind50_ckmrmultinom20,c(1,3),median, na.rm=TRUE)[2,]/apply(SD_ssb_N100_Ind50_20yrs_noCKMR,c(1,3),median, na.rm=TRUE)[2,], pch=16, col=1,las=1, ylim=c(0,1.2), ylab="", xlab="", main="",xaxt="n",  xlim=c(0,250),yaxt="n",bty="]")
abline(h=1, lty=2)
points(86:161,apply(SD_ssb_N1000_Ind50_ckmrmultinom20,c(1,3),median, na.rm=TRUE)[2,]/apply(SD_ssb_N1000_Ind50_20yrs_noCKMR,c(1,3),median, na.rm=TRUE)[2,], pch=16, col=2)
points(171:246,apply(SD_ssb_N5000_Ind50_ckmrmultinom20,c(1,3),median, na.rm=TRUE)[2,]/apply(SD_ssb_N5000_Ind50_20yrs_noCKMR,c(1,3),median, na.rm=TRUE)[2,], pch=16, col=3)

plot(1:76,apply(SD_ssb_N100_Ind25_ckmrmultinom5,c(1,3),median, na.rm=TRUE)[2,]/apply(SD_ssb_N100_Ind25_5yrs_noCKMR,c(1,3),median, na.rm=TRUE)[2,], pch=16, las=1, ylim=c(0,1.2),yaxt="n", ylab="", xlab="", main="",xaxt="n", xlim=c(0,250),bty="[")
abline(h=1, lty=2)
points(86:161,apply(SD_ssb_N1000_Ind25_ckmrmultinom5,c(1,3),median, na.rm=TRUE)[2,]/apply(SD_ssb_N1000_Ind25_5yrs_noCKMR,c(1,3),median, na.rm=TRUE)[2,], pch=16, col=2)
points(171:246,apply(SD_ssb_N5000_Ind25_ckmrmultinom5,c(1,3),median, na.rm=TRUE)[2,]/apply(SD_ssb_N5000_Ind25_5yrs_noCKMR,c(1,3),median, na.rm=TRUE)[2,], pch=16, col=3)

plot(1:76,apply(SD_ssb_N100_Ind25_ckmrmultinom10,c(1,3),median, na.rm=TRUE)[2,]/apply(SD_ssb_N100_Ind25_10yrs_noCKMR,c(1,3),median, na.rm=TRUE)[2,], pch=16, col=1,las=1, ylim=c(0,1.2), ylab="", xlab="", main="",xaxt="n",  xlim=c(0,250),yaxt="n",bty="n")
abline(h=1, lty=2)
points(86:161,apply(SD_ssb_N1000_Ind25_ckmrmultinom10,c(1,3),median, na.rm=TRUE)[2,]/apply(SD_ssb_N1000_Ind25_10yrs_noCKMR,c(1,3),median, na.rm=TRUE)[2,], pch=16, col=2)
points(171:246,apply(SD_ssb_N5000_Ind25_ckmrmultinom10,c(1,3),median, na.rm=TRUE)[2,]/apply(SD_ssb_N5000_Ind25_10yrs_noCKMR,c(1,3),median, na.rm=TRUE)[2,], pch=16, col=3)
axis(side=1,lwd.ticks = 0, labels=FALSE)
axis(side=3,lwd.ticks = 0, labels=FALSE)

plot(1:76,apply(SD_ssb_N100_Ind25_ckmrmultinom20,c(1,3),median, na.rm=TRUE)[2,]/apply(SD_ssb_N100_Ind25_20yrs_noCKMR,c(1,3),median, na.rm=TRUE)[2,], pch=16, col=1,las=1, ylim=c(0,1.2), ylab="", xlab="", main="",xaxt="n",  xlim=c(0,250),yaxt="n",bty="]")
abline(h=1, lty=2)
points(86:161,apply(SD_ssb_N1000_Ind25_ckmrmultinom20,c(1,3),median, na.rm=TRUE)[2,]/apply(SD_ssb_N1000_Ind25_20yrs_noCKMR,c(1,3),median, na.rm=TRUE)[2,], pch=16, col=2)
points(171:246,apply(SD_ssb_N5000_Ind25_ckmrmultinom20,c(1,3),median, na.rm=TRUE)[2,]/apply(SD_ssb_N5000_Ind25_20yrs_noCKMR,c(1,3),median, na.rm=TRUE)[2,], pch=16, col=3)

#Sardine
plot(1:76,apply(SD_ssb_N100_NoIndex_ckmrmultinom5,c(1,3),median, na.rm=TRUE)[3,]/apply(SD_ssb_N100_NoIndex_5yrs_noCKMR,c(1,3),median, na.rm=TRUE)[3,], pch=16, las=1, ylim=c(0,1.2), ylab="", xlab="", main="",xaxt="n", xlim=c(0,250),bty="[")
abline(h=1, lty=2)
points(86:161,apply(SD_ssb_N1000_NoIndex_ckmrmultinom5,c(1,3),median, na.rm=TRUE)[3,]/apply(SD_ssb_N1000_NoIndex_5yrs_noCKMR,c(1,3),median, na.rm=TRUE)[3,], pch=16, col=2)
points(171:246,apply(SD_ssb_N5000_NoIndex_ckmrmultinom5,c(1,3),median, na.rm=TRUE)[3,]/apply(SD_ssb_N5000_NoIndex_5yrs_noCKMR,c(1,3),median, na.rm=TRUE)[3,], pch=16, col=3)
axis(side=1, at=c(40,127,211), labels=c("N100", "N1000", "N5000"))

plot(1:76,apply(SD_ssb_N100_NoIndex_ckmrmultinom10,c(1,3),median, na.rm=TRUE)[3,]/apply(SD_ssb_N100_NoIndex_10yrs_noCKMR,c(1,3),median, na.rm=TRUE)[3,], pch=16, col=1,las=1, ylim=c(0,1.2), ylab="", xlab="", main="",xaxt="n",  xlim=c(0,250),yaxt="n",bty="n")
abline(h=1, lty=2)
points(86:161,apply(SD_ssb_N1000_NoIndex_ckmrmultinom10,c(1,3),median, na.rm=TRUE)[3,]/apply(SD_ssb_N1000_NoIndex_10yrs_noCKMR,c(1,3),median, na.rm=TRUE)[3,], pch=16, col=2)
points(171:246,apply(SD_ssb_N5000_NoIndex_ckmrmultinom10,c(1,3),median, na.rm=TRUE)[3,]/apply(SD_ssb_N5000_NoIndex_10yrs_noCKMR,c(1,3),median, na.rm=TRUE)[3,], pch=16, col=3)
axis(side=1, at=c(40,127,211), labels=c("N100", "N1000", "N5000"))
axis(side=1,lwd.ticks = 0, labels=FALSE)
axis(side=3,lwd.ticks = 0, labels=FALSE)

plot(1:76,apply(SD_ssb_N100_NoIndex_ckmrmultinom20,c(1,3),median, na.rm=TRUE)[3,]/apply(SD_ssb_N100_NoIndex_20yrs_noCKMR,c(1,3),median, na.rm=TRUE)[3,], pch=16, col=1,las=1, ylim=c(0,1.2), ylab="", xlab="", main="",xaxt="n",  xlim=c(0,250),yaxt="n",bty="]")
abline(h=1, lty=2)
points(86:161,apply(SD_ssb_N1000_NoIndex_ckmrmultinom20,c(1,3),median, na.rm=TRUE)[3,]/apply(SD_ssb_N1000_NoIndex_20yrs_noCKMR,c(1,3),median, na.rm=TRUE)[3,], pch=16, col=2)
points(171:246,apply(SD_ssb_N5000_NoIndex_ckmrmultinom20,c(1,3),median, na.rm=TRUE)[3,]/apply(SD_ssb_N5000_NoIndex_20yrs_noCKMR,c(1,3),median, na.rm=TRUE)[3,], pch=16, col=3)
axis(side=1, at=c(40,127,211), labels=c("N100", "N1000", "N5000"))

plot(1:76,apply(SD_ssb_N100_Ind50_ckmrmultinom5,c(1,3),median, na.rm=TRUE)[3,]/apply(SD_ssb_N100_Ind50_5yrs_noCKMR,c(1,3),median, na.rm=TRUE)[3,], pch=16, las=1, ylim=c(0,1.2), ylab="", xlab="", main="",xaxt="n", xlim=c(0,250),yaxt="n",bty="[")
abline(h=1, lty=2)
points(86:161,apply(SD_ssb_N1000_Ind50_ckmrmultinom5,c(1,3),median, na.rm=TRUE)[3,]/apply(SD_ssb_N1000_Ind50_5yrs_noCKMR,c(1,3),median, na.rm=TRUE)[3,], pch=16, col=2)
points(171:246,apply(SD_ssb_N5000_Ind50_ckmrmultinom5,c(1,3),median, na.rm=TRUE)[3,]/apply(SD_ssb_N5000_Ind50_5yrs_noCKMR,c(1,3),median, na.rm=TRUE)[3,], pch=16, col=3)
axis(side=1, at=c(40,127,211), labels=c("N100", "N1000", "N5000"))

plot(1:76,apply(SD_ssb_N100_Ind50_ckmrmultinom10,c(1,3),median, na.rm=TRUE)[3,]/apply(SD_ssb_N100_Ind50_10yrs_noCKMR,c(1,3),median, na.rm=TRUE)[3,], pch=16, col=1,las=1, ylim=c(0,1.2), ylab="", xlab="", main="",xaxt="n",  xlim=c(0,250),yaxt="n",bty="n")
abline(h=1, lty=2)
points(86:161,apply(SD_ssb_N1000_Ind50_ckmrmultinom10,c(1,3),median, na.rm=TRUE)[3,]/apply(SD_ssb_N1000_Ind50_10yrs_noCKMR,c(1,3),median, na.rm=TRUE)[3,], pch=16, col=2)
points(171:246,apply(SD_ssb_N5000_Ind50_ckmrmultinom10,c(1,3),median, na.rm=TRUE)[3,]/apply(SD_ssb_N5000_Ind50_10yrs_noCKMR,c(1,3),median, na.rm=TRUE)[3,], pch=16, col=3)
axis(side=1, at=c(40,127,211), labels=c("N100", "N1000", "N5000"))
mtext(side=1, text="Sardine", line=-1, font=2)
mtext(side=1, text="Sample Size", line=3)
axis(side=1,lwd.ticks = 0, labels=FALSE)
axis(side=3,lwd.ticks = 0, labels=FALSE)

plot(1:76,apply(SD_ssb_N100_Ind50_ckmrmultinom20,c(1,3),median, na.rm=TRUE)[3,]/apply(SD_ssb_N100_Ind50_20yrs_noCKMR,c(1,3),median, na.rm=TRUE)[3,], pch=16, col=1,las=1, ylim=c(0,1.2), ylab="", xlab="", main="",xaxt="n",  xlim=c(0,250),yaxt="n",bty="]")
abline(h=1, lty=2)
points(86:161,apply(SD_ssb_N1000_Ind50_ckmrmultinom20,c(1,3),median, na.rm=TRUE)[3,]/apply(SD_ssb_N1000_Ind50_20yrs_noCKMR,c(1,3),median, na.rm=TRUE)[3,], pch=16, col=2)
points(171:246,apply(SD_ssb_N5000_Ind50_ckmrmultinom20,c(1,3),median, na.rm=TRUE)[3,]/apply(SD_ssb_N5000_Ind50_20yrs_noCKMR,c(1,3),median, na.rm=TRUE)[3,], pch=16, col=3)
axis(side=1, at=c(40,127,211), labels=c("N100", "N1000", "N5000"))

plot(1:76,apply(SD_ssb_N100_Ind25_ckmrmultinom5,c(1,3),median, na.rm=TRUE)[3,]/apply(SD_ssb_N100_Ind25_5yrs_noCKMR,c(1,3),median, na.rm=TRUE)[3,], pch=16, las=1, ylim=c(0,1.2), ylab="", xlab="", main="",xaxt="n", xlim=c(0,250),yaxt="n",bty="[")
abline(h=1, lty=2)
points(86:161,apply(SD_ssb_N1000_Ind25_ckmrmultinom5,c(1,3),median, na.rm=TRUE)[3,]/apply(SD_ssb_N1000_Ind25_5yrs_noCKMR,c(1,3),median, na.rm=TRUE)[3,], pch=16, col=2)
points(171:246,apply(SD_ssb_N5000_Ind25_ckmrmultinom5,c(1,3),median, na.rm=TRUE)[3,]/apply(SD_ssb_N5000_Ind25_5yrs_noCKMR,c(1,3),median, na.rm=TRUE)[3,], pch=16, col=3)
axis(side=1, at=c(40,127,211), labels=c("N100", "N1000", "N5000"))

plot(1:76,apply(SD_ssb_N100_Ind25_ckmrmultinom10,c(1,3),median, na.rm=TRUE)[3,]/apply(SD_ssb_N100_Ind25_10yrs_noCKMR,c(1,3),median, na.rm=TRUE)[3,], pch=16, col=1,las=1, ylim=c(0,1.2), ylab="", xlab="", main="",xaxt="n",  xlim=c(0,250),yaxt="n",bty="n")
abline(h=1, lty=2)
points(86:161,apply(SD_ssb_N1000_Ind25_ckmrmultinom10,c(1,3),median, na.rm=TRUE)[3,]/apply(SD_ssb_N1000_Ind25_10yrs_noCKMR,c(1,3),median, na.rm=TRUE)[3,], pch=16, col=2)
points(171:246,apply(SD_ssb_N5000_Ind25_ckmrmultinom10,c(1,3),median, na.rm=TRUE)[3,]/apply(SD_ssb_N5000_Ind25_10yrs_noCKMR,c(1,3),median, na.rm=TRUE)[3,], pch=16, col=3)
axis(side=1, at=c(40,127,211), labels=c("N100", "N1000", "N5000"))
axis(side=1,lwd.ticks = 0, labels=FALSE)
axis(side=3,lwd.ticks = 0, labels=FALSE)

plot(1:76,apply(SD_ssb_N100_Ind25_ckmrmultinom20,c(1,3),median, na.rm=TRUE)[3,]/apply(SD_ssb_N100_Ind25_20yrs_noCKMR,c(1,3),median, na.rm=TRUE)[3,], pch=16, col=1,las=1, ylim=c(0,1.2), ylab="", xlab="", main="",xaxt="n",  xlim=c(0,250),yaxt="n",bty="]")
abline(h=1, lty=2)
points(86:161,apply(SD_ssb_N1000_Ind25_ckmrmultinom20,c(1,3),median, na.rm=TRUE)[3,]/apply(SD_ssb_N1000_Ind25_20yrs_noCKMR,c(1,3),median, na.rm=TRUE)[3,], pch=16, col=2)
points(171:246,apply(SD_ssb_N5000_Ind25_ckmrmultinom20,c(1,3),median, na.rm=TRUE)[3,]/apply(SD_ssb_N5000_Ind25_20yrs_noCKMR,c(1,3),median, na.rm=TRUE)[3,], pch=16, col=3)
axis(side=1, at=c(40,127,211), labels=c("N100", "N1000", "N5000"))
#dev.off()


########################################
#IQR of SSB RE (so across sims metric)
########################################
#tiff(filename="C:/Users/fischn/Documents/GitHub/CKMR_Project/IQR.tiff", height=30, width=50, units='cm', compression="lzw", res=500)
par(mfrow=c(3,9), mar=c(1,1,1,0.5), oma=c(3.5,4,1,1))
#Cod
plot(1:76,IQR_RE_ssb_N100_NoIndex_ckmrmultinom5[1,]/IQR_RE_ssb_N100_NoIndex_5yrs_noCKMR[1,], pch=16, las=1, ylim=c(0,1.4), ylab="", xlab="", main="5yrs",xaxt="n", xlim=c(0,250),bty="[")
abline(h=1, lty=2)
points(86:161,IQR_RE_ssb_N1000_NoIndex_ckmrmultinom5[1,]/IQR_RE_ssb_N1000_NoIndex_5yrs_noCKMR[1,], pch=16, col=2)
points(171:246,IQR_RE_ssb_N5000_NoIndex_ckmrmultinom5[1,]/IQR_RE_ssb_N5000_NoIndex_5yrs_noCKMR[1,], pch=16, col=3)

plot(1:76,IQR_RE_ssb_N100_NoIndex_ckmrmultinom10[1,]/IQR_RE_ssb_N100_NoIndex_10yrs_noCKMR[1,], pch=16, col=1,las=1, ylim=c(0,1.4), ylab="", xlab="", main="10yrs",xaxt="n",  xlim=c(0,250),yaxt="n",bty="n")
abline(h=1, lty=2)
points(86:161,IQR_RE_ssb_N1000_NoIndex_ckmrmultinom10[1,]/IQR_RE_ssb_N1000_NoIndex_10yrs_noCKMR[1,], pch=16, col=2)
points(171:246,IQR_RE_ssb_N5000_NoIndex_ckmrmultinom10[1,]/IQR_RE_ssb_N5000_NoIndex_10yrs_noCKMR[1,], pch=16, col=3)
mtext(side=3, text="No Index", line=-1.5, font=2)
axis(side=1,lwd.ticks = 0, labels=FALSE)
axis(side=3,lwd.ticks = 0, labels=FALSE)

plot(1:76,IQR_RE_ssb_N100_NoIndex_ckmrmultinom20[1,]/IQR_RE_ssb_N100_NoIndex_20yrs_noCKMR[1,], pch=16, col=1,las=1, ylim=c(0,1.4), ylab="", xlab="", main="20yrs",xaxt="n",  xlim=c(0,250),yaxt="n",bty="]")
abline(h=1, lty=2)
points(86:161,IQR_RE_ssb_N1000_NoIndex_ckmrmultinom20[1,]/IQR_RE_ssb_N1000_NoIndex_20yrs_noCKMR[1,], pch=16, col=2)
points(171:246,IQR_RE_ssb_N5000_NoIndex_ckmrmultinom20[1,]/IQR_RE_ssb_N5000_NoIndex_20yrs_noCKMR[1,], pch=16, col=3)

plot(1:76,IQR_RE_ssb_N100_Ind50_ckmrmultinom5[1,]/IQR_RE_ssb_N100_Ind50_5yrs_noCKMR[1,], pch=16, las=1, ylim=c(0,1.4), ylab="", xlab="", main="5yrs",xaxt="n", xlim=c(0,250),yaxt="n",bty="[")
abline(h=1, lty=2)
points(86:161,IQR_RE_ssb_N1000_Ind50_ckmrmultinom5[1,]/IQR_RE_ssb_N1000_Ind50_5yrs_noCKMR[1,], pch=16, col=2)
points(171:246,IQR_RE_ssb_N5000_Ind50_ckmrmultinom5[1,]/IQR_RE_ssb_N5000_Ind50_5yrs_noCKMR[1,], pch=16, col=3)

plot(1:76,IQR_RE_ssb_N100_Ind50_ckmrmultinom10[1,]/IQR_RE_ssb_N100_Ind50_10yrs_noCKMR[1,], pch=16, col=1,las=1, ylim=c(0,1.4), ylab="", xlab="", main="10yrs",xaxt="n",  xlim=c(0,250),yaxt="n",bty="n")
abline(h=1, lty=2)
points(86:161,IQR_RE_ssb_N1000_Ind50_ckmrmultinom10[1,]/IQR_RE_ssb_N1000_Ind50_10yrs_noCKMR[1,], pch=16, col=2)
points(171:246,IQR_RE_ssb_N5000_Ind50_ckmrmultinom10[1,]/IQR_RE_ssb_N5000_Ind50_10yrs_noCKMR[1,], pch=16, col=3)
mtext(side=1, text="Cod", line=-1, font=2)
mtext(side=3, text="Index - 0.5", line=-1.5, font=2)
axis(side=1,lwd.ticks = 0, labels=FALSE)
axis(side=3,lwd.ticks = 0, labels=FALSE)
legend(x=60,y=0.5,c("N=100", "N=1000", "N=5000"), pch=16, col=1:3, bty="n", cex=1.5)

plot(1:76,IQR_RE_ssb_N100_Ind50_ckmrmultinom20[1,]/IQR_RE_ssb_N100_Ind50_20yrs_noCKMR[1,], pch=16, col=1,las=1, ylim=c(0,1.4), ylab="", xlab="", main="20yrs",xaxt="n",  xlim=c(0,250),yaxt="n",bty="]")
abline(h=1, lty=2)
points(86:161,IQR_RE_ssb_N1000_Ind50_ckmrmultinom20[1,]/IQR_RE_ssb_N1000_Ind50_20yrs_noCKMR[1,], pch=16, col=2)
points(171:246,IQR_RE_ssb_N5000_Ind50_ckmrmultinom20[1,]/IQR_RE_ssb_N5000_Ind50_20yrs_noCKMR[1,], pch=16, col=3)

plot(1:76,IQR_RE_ssb_N100_Ind25_ckmrmultinom5[1,]/IQR_RE_ssb_N100_Ind25_5yrs_noCKMR[1,], pch=16, las=1, ylim=c(0,1.4), ylab="", xlab="", main="5yrs",xaxt="n", xlim=c(0,250),yaxt="n",bty="[")
abline(h=1, lty=2)
points(86:161,IQR_RE_ssb_N1000_Ind25_ckmrmultinom5[1,]/IQR_RE_ssb_N1000_Ind25_5yrs_noCKMR[1,], pch=16, col=2)
points(171:246,IQR_RE_ssb_N5000_Ind25_ckmrmultinom5[1,]/IQR_RE_ssb_N5000_Ind25_5yrs_noCKMR[1,], pch=16, col=3)

plot(1:76,IQR_RE_ssb_N100_Ind25_ckmrmultinom10[1,]/IQR_RE_ssb_N100_Ind25_10yrs_noCKMR[1,], pch=16, col=1,las=1, ylim=c(0,1.4), ylab="", xlab="", main="10yrs",xaxt="n",  xlim=c(0,250),yaxt="n",bty="n")
abline(h=1, lty=2)
points(86:161,IQR_RE_ssb_N1000_Ind25_ckmrmultinom10[1,]/IQR_RE_ssb_N1000_Ind25_10yrs_noCKMR[1,], pch=16, col=2)
points(171:246,IQR_RE_ssb_N5000_Ind25_ckmrmultinom10[1,]/IQR_RE_ssb_N5000_Ind25_10yrs_noCKMR[1,], pch=16, col=3)
mtext(side=3, text="Index - 0.25", line=-1.5, font=2)
axis(side=1,lwd.ticks = 0, labels=FALSE)
axis(side=3,lwd.ticks = 0, labels=FALSE)

plot(1:76,IQR_RE_ssb_N100_Ind25_ckmrmultinom20[1,]/IQR_RE_ssb_N100_Ind25_20yrs_noCKMR[1,], pch=16, col=1,las=1, ylim=c(0,1.4), ylab="", xlab="", main="20yrs",xaxt="n",  xlim=c(0,250),yaxt="n",bty="]")
abline(h=1, lty=2)
points(86:161,IQR_RE_ssb_N1000_Ind25_ckmrmultinom20[1,]/IQR_RE_ssb_N1000_Ind25_20yrs_noCKMR[1,], pch=16, col=2)
points(171:246,IQR_RE_ssb_N5000_Ind25_ckmrmultinom20[1,]/IQR_RE_ssb_N5000_Ind25_20yrs_noCKMR[1,], pch=16, col=3)

#Flatfish
plot(1:76,IQR_RE_ssb_N100_NoIndex_ckmrmultinom5[2,]/IQR_RE_ssb_N100_NoIndex_5yrs_noCKMR[2,], pch=16, las=1, ylim=c(0,1.4), ylab="", xlab="", main="",xaxt="n", xlim=c(0,250),bty="[")
abline(h=1, lty=2)
points(86:161,IQR_RE_ssb_N1000_NoIndex_ckmrmultinom5[2,]/IQR_RE_ssb_N1000_NoIndex_5yrs_noCKMR[2,], pch=16, col=2)
points(171:246,IQR_RE_ssb_N5000_NoIndex_ckmrmultinom5[2,]/IQR_RE_ssb_N5000_NoIndex_5yrs_noCKMR[2,], pch=16, col=3)
mtext(side=2, text="IQR of RE for SSB / No CKMR", line=3)

plot(1:76,IQR_RE_ssb_N100_NoIndex_ckmrmultinom10[2,]/IQR_RE_ssb_N100_NoIndex_10yrs_noCKMR[2,], pch=16, col=1,las=1, ylim=c(0,1.4), ylab="", xlab="", main="",xaxt="n",  xlim=c(0,250),yaxt="n",bty="n")
abline(h=1, lty=2)
points(86:161,IQR_RE_ssb_N1000_NoIndex_ckmrmultinom10[2,]/IQR_RE_ssb_N1000_NoIndex_10yrs_noCKMR[2,], pch=16, col=2)
points(171:246,IQR_RE_ssb_N5000_NoIndex_ckmrmultinom10[2,]/IQR_RE_ssb_N5000_NoIndex_10yrs_noCKMR[2,], pch=16, col=3)
axis(side=1,lwd.ticks = 0, labels=FALSE)
axis(side=3,lwd.ticks = 0, labels=FALSE)

plot(1:76,IQR_RE_ssb_N100_NoIndex_ckmrmultinom20[2,]/IQR_RE_ssb_N100_NoIndex_20yrs_noCKMR[2,], pch=16, col=1,las=1, ylim=c(0,1.4), ylab="", xlab="", main="",xaxt="n",  xlim=c(0,250),yaxt="n",bty="]")
abline(h=1, lty=2)
points(86:161,IQR_RE_ssb_N1000_NoIndex_ckmrmultinom20[2,]/IQR_RE_ssb_N1000_NoIndex_20yrs_noCKMR[2,], pch=16, col=2)
points(171:246,IQR_RE_ssb_N5000_NoIndex_ckmrmultinom20[2,]/IQR_RE_ssb_N5000_NoIndex_20yrs_noCKMR[2,], pch=16, col=3)

plot(1:76,IQR_RE_ssb_N100_Ind50_ckmrmultinom5[2,]/IQR_RE_ssb_N100_Ind50_5yrs_noCKMR[2,], pch=16, las=1, ylim=c(0,1.4),yaxt="n", ylab="", xlab="", main="",xaxt="n", xlim=c(0,250),bty="[")
abline(h=1, lty=2)
points(86:161,IQR_RE_ssb_N1000_Ind50_ckmrmultinom5[2,]/IQR_RE_ssb_N1000_Ind50_5yrs_noCKMR[2,], pch=16, col=2)
points(171:246,IQR_RE_ssb_N5000_Ind50_ckmrmultinom5[2,]/IQR_RE_ssb_N5000_Ind50_5yrs_noCKMR[2,], pch=16, col=3)

plot(1:76,IQR_RE_ssb_N100_Ind50_ckmrmultinom10[2,]/IQR_RE_ssb_N100_Ind50_10yrs_noCKMR[2,], pch=16, col=1,las=1, ylim=c(0,1.4), ylab="", xlab="", main="",xaxt="n",  xlim=c(0,250),yaxt="n",bty="n")
abline(h=1, lty=2)
points(86:161,IQR_RE_ssb_N1000_Ind50_ckmrmultinom10[2,]/IQR_RE_ssb_N1000_Ind50_10yrs_noCKMR[2,], pch=16, col=2)
points(171:246,IQR_RE_ssb_N5000_Ind50_ckmrmultinom10[2,]/IQR_RE_ssb_N5000_Ind50_10yrs_noCKMR[2,], pch=16, col=3)
mtext(side=1, text="Flatfish", line=-1, font=2)
axis(side=1,lwd.ticks = 0, labels=FALSE)
axis(side=3,lwd.ticks = 0, labels=FALSE)

plot(1:76,IQR_RE_ssb_N100_Ind50_ckmrmultinom20[2,]/IQR_RE_ssb_N100_Ind50_20yrs_noCKMR[2,], pch=16, col=1,las=1, ylim=c(0,1.4), ylab="", xlab="", main="",xaxt="n",  xlim=c(0,250),yaxt="n",bty="]")
abline(h=1, lty=2)
points(86:161,IQR_RE_ssb_N1000_Ind50_ckmrmultinom20[2,]/IQR_RE_ssb_N1000_Ind50_20yrs_noCKMR[2,], pch=16, col=2)
points(171:246,IQR_RE_ssb_N5000_Ind50_ckmrmultinom20[2,]/IQR_RE_ssb_N5000_Ind50_20yrs_noCKMR[2,], pch=16, col=3)

plot(1:76,IQR_RE_ssb_N100_Ind25_ckmrmultinom5[2,]/IQR_RE_ssb_N100_Ind25_5yrs_noCKMR[2,], pch=16, las=1, ylim=c(0,1.4),yaxt="n", ylab="", xlab="", main="",xaxt="n", xlim=c(0,250),bty="[")
abline(h=1, lty=2)
points(86:161,IQR_RE_ssb_N1000_Ind25_ckmrmultinom5[2,]/IQR_RE_ssb_N1000_Ind25_5yrs_noCKMR[2,], pch=16, col=2)
points(171:246,IQR_RE_ssb_N5000_Ind25_ckmrmultinom5[2,]/IQR_RE_ssb_N5000_Ind25_5yrs_noCKMR[2,], pch=16, col=3)

plot(1:76,IQR_RE_ssb_N100_Ind25_ckmrmultinom10[2,]/IQR_RE_ssb_N100_Ind25_10yrs_noCKMR[2,], pch=16, col=1,las=1, ylim=c(0,1.4), ylab="", xlab="", main="",xaxt="n",  xlim=c(0,250),yaxt="n",bty="n")
abline(h=1, lty=2)
points(86:161,IQR_RE_ssb_N1000_Ind25_ckmrmultinom10[2,]/IQR_RE_ssb_N1000_Ind25_10yrs_noCKMR[2,], pch=16, col=2)
points(171:246,IQR_RE_ssb_N5000_Ind25_ckmrmultinom10[2,]/IQR_RE_ssb_N5000_Ind25_10yrs_noCKMR[2,], pch=16, col=3)
axis(side=1,lwd.ticks = 0, labels=FALSE)
axis(side=3,lwd.ticks = 0, labels=FALSE)

plot(1:76,IQR_RE_ssb_N100_Ind25_ckmrmultinom20[2,]/IQR_RE_ssb_N100_Ind25_20yrs_noCKMR[2,], pch=16, col=1,las=1, ylim=c(0,1.4), ylab="", xlab="", main="",xaxt="n",  xlim=c(0,250),yaxt="n",bty="]")
abline(h=1, lty=2)
points(86:161,IQR_RE_ssb_N1000_Ind25_ckmrmultinom20[2,]/IQR_RE_ssb_N1000_Ind25_20yrs_noCKMR[2,], pch=16, col=2)
points(171:246,IQR_RE_ssb_N5000_Ind25_ckmrmultinom20[2,]/IQR_RE_ssb_N5000_Ind25_20yrs_noCKMR[2,], pch=16, col=3)

#Sardine
plot(1:76,IQR_RE_ssb_N100_NoIndex_ckmrmultinom5[3,]/IQR_RE_ssb_N100_NoIndex_5yrs_noCKMR[3,], pch=16, las=1, ylim=c(0,1.4), ylab="", xlab="", main="",xaxt="n", xlim=c(0,250),bty="[")
abline(h=1, lty=2)
points(86:161,IQR_RE_ssb_N1000_NoIndex_ckmrmultinom5[3,]/IQR_RE_ssb_N1000_NoIndex_5yrs_noCKMR[3,], pch=16, col=2)
points(171:246,IQR_RE_ssb_N5000_NoIndex_ckmrmultinom5[3,]/IQR_RE_ssb_N5000_NoIndex_5yrs_noCKMR[3,], pch=16, col=3)
axis(side=1, at=c(40,127,211), labels=c("N100", "N1000", "N5000"))

plot(1:76,IQR_RE_ssb_N100_NoIndex_ckmrmultinom10[3,]/IQR_RE_ssb_N100_NoIndex_10yrs_noCKMR[3,], pch=16, col=1,las=1, ylim=c(0,1.4), ylab="", xlab="", main="",xaxt="n",  xlim=c(0,250),yaxt="n",bty="n")
abline(h=1, lty=2)
points(86:161,IQR_RE_ssb_N1000_NoIndex_ckmrmultinom10[3,]/IQR_RE_ssb_N1000_NoIndex_10yrs_noCKMR[3,], pch=16, col=2)
points(171:246,IQR_RE_ssb_N5000_NoIndex_ckmrmultinom10[3,]/IQR_RE_ssb_N5000_NoIndex_10yrs_noCKMR[3,], pch=16, col=3)
axis(side=1, at=c(40,127,211), labels=c("N100", "N1000", "N5000"))
axis(side=1,lwd.ticks = 0, labels=FALSE)
axis(side=3,lwd.ticks = 0, labels=FALSE)

plot(1:76,IQR_RE_ssb_N100_NoIndex_ckmrmultinom20[3,]/IQR_RE_ssb_N100_NoIndex_20yrs_noCKMR[3,], pch=16, col=1,las=1, ylim=c(0,1.4), ylab="", xlab="", main="",xaxt="n",  xlim=c(0,250),yaxt="n",bty="]")
abline(h=1, lty=2)
points(86:161,IQR_RE_ssb_N1000_NoIndex_ckmrmultinom20[3,]/IQR_RE_ssb_N1000_NoIndex_20yrs_noCKMR[3,], pch=16, col=2)
points(171:246,IQR_RE_ssb_N5000_NoIndex_ckmrmultinom20[3,]/IQR_RE_ssb_N5000_NoIndex_20yrs_noCKMR[3,], pch=16, col=3)
axis(side=1, at=c(40,127,211), labels=c("N100", "N1000", "N5000"))

plot(1:76,IQR_RE_ssb_N100_Ind50_ckmrmultinom5[3,]/IQR_RE_ssb_N100_Ind50_5yrs_noCKMR[3,], pch=16, las=1, ylim=c(0,1.4), ylab="", xlab="", main="",xaxt="n", xlim=c(0,250),yaxt="n",bty="[")
abline(h=1, lty=2)
points(86:161,IQR_RE_ssb_N1000_Ind50_ckmrmultinom5[3,]/IQR_RE_ssb_N1000_Ind50_5yrs_noCKMR[3,], pch=16, col=2)
points(171:246,IQR_RE_ssb_N5000_Ind50_ckmrmultinom5[3,]/IQR_RE_ssb_N5000_Ind50_5yrs_noCKMR[3,], pch=16, col=3)
axis(side=1, at=c(40,127,211), labels=c("N100", "N1000", "N5000"))

plot(1:76,IQR_RE_ssb_N100_Ind50_ckmrmultinom10[3,]/IQR_RE_ssb_N100_Ind50_10yrs_noCKMR[3,], pch=16, col=1,las=1, ylim=c(0,1.4), ylab="", xlab="", main="",xaxt="n",  xlim=c(0,250),yaxt="n",bty="n")
abline(h=1, lty=2)
points(86:161,IQR_RE_ssb_N1000_Ind50_ckmrmultinom10[3,]/IQR_RE_ssb_N1000_Ind50_10yrs_noCKMR[3,], pch=16, col=2)
points(171:246,IQR_RE_ssb_N5000_Ind50_ckmrmultinom10[3,]/IQR_RE_ssb_N5000_Ind50_10yrs_noCKMR[3,], pch=16, col=3)
axis(side=1, at=c(40,127,211), labels=c("N100", "N1000", "N5000"))
mtext(side=1, text="Sardine", line=-1, font=2)
mtext(side=1, text="Sample Size", line=3)
axis(side=1,lwd.ticks = 0, labels=FALSE)
axis(side=3,lwd.ticks = 0, labels=FALSE)

plot(1:76,IQR_RE_ssb_N100_Ind50_ckmrmultinom20[3,]/IQR_RE_ssb_N100_Ind50_20yrs_noCKMR[3,], pch=16, col=1,las=1, ylim=c(0,1.4), ylab="", xlab="", main="",xaxt="n",  xlim=c(0,250),yaxt="n",bty="]")
abline(h=1, lty=2)
points(86:161,IQR_RE_ssb_N1000_Ind50_ckmrmultinom20[3,]/IQR_RE_ssb_N1000_Ind50_20yrs_noCKMR[3,], pch=16, col=2)
points(171:246,IQR_RE_ssb_N5000_Ind50_ckmrmultinom20[3,]/IQR_RE_ssb_N5000_Ind50_20yrs_noCKMR[3,], pch=16, col=3)
axis(side=1, at=c(40,127,211), labels=c("N100", "N1000", "N5000"))

plot(1:76,IQR_RE_ssb_N100_Ind25_ckmrmultinom5[3,]/IQR_RE_ssb_N100_Ind25_5yrs_noCKMR[3,], pch=16, las=1, ylim=c(0,1.4), ylab="", xlab="", main="",xaxt="n", xlim=c(0,250),yaxt="n",bty="[")
abline(h=1, lty=2)
points(86:161,IQR_RE_ssb_N1000_Ind25_ckmrmultinom5[3,]/IQR_RE_ssb_N1000_Ind25_5yrs_noCKMR[3,], pch=16, col=2)
points(171:246,IQR_RE_ssb_N5000_Ind25_ckmrmultinom5[3,]/IQR_RE_ssb_N5000_Ind25_5yrs_noCKMR[3,], pch=16, col=3)
axis(side=1, at=c(40,127,211), labels=c("N100", "N1000", "N5000"))

plot(1:76,IQR_RE_ssb_N100_Ind25_ckmrmultinom10[3,]/IQR_RE_ssb_N100_Ind25_10yrs_noCKMR[3,], pch=16, col=1,las=1, ylim=c(0,1.4), ylab="", xlab="", main="",xaxt="n",  xlim=c(0,250),yaxt="n",bty="n")
abline(h=1, lty=2)
points(86:161,IQR_RE_ssb_N1000_Ind25_ckmrmultinom10[3,]/IQR_RE_ssb_N1000_Ind25_10yrs_noCKMR[3,], pch=16, col=2)
points(171:246,IQR_RE_ssb_N5000_Ind25_ckmrmultinom10[3,]/IQR_RE_ssb_N5000_Ind25_10yrs_noCKMR[3,], pch=16, col=3)
axis(side=1, at=c(40,127,211), labels=c("N100", "N1000", "N5000"))
axis(side=1,lwd.ticks = 0, labels=FALSE)
axis(side=3,lwd.ticks = 0, labels=FALSE)

plot(1:76,IQR_RE_ssb_N100_Ind25_ckmrmultinom20[3,]/IQR_RE_ssb_N100_Ind25_20yrs_noCKMR[3,], pch=16, col=1,las=1, ylim=c(0,1.4), ylab="", xlab="", main="",xaxt="n",  xlim=c(0,250),yaxt="n",bty="]")
abline(h=1, lty=2)
points(86:161,IQR_RE_ssb_N1000_Ind25_ckmrmultinom20[3,]/IQR_RE_ssb_N1000_Ind25_20yrs_noCKMR[3,], pch=16, col=2)
points(171:246,IQR_RE_ssb_N5000_Ind25_ckmrmultinom20[3,]/IQR_RE_ssb_N5000_Ind25_20yrs_noCKMR[3,], pch=16, col=3)
axis(side=1, at=c(40,127,211), labels=c("N100", "N1000", "N5000"))
#dev.off()


############
#M & R0
############
#tiff(filename="C:/Users/fischn/Documents/GitHub/CKMR_Project/M_R0.tiff", height=40, width=25, units='cm', compression="lzw", res=500)
par(mfcol=c(9,3), mar=c(0.25,1,0.25,0.5), oma=c(4,4,1.5,1))
#No Index
#Cod
plot(0.9,apply(abs(RE_M_N100_NoIndex_ckmrmultinom5),2,median, na.rm=TRUE)[1]/apply(abs(RE_M_N100_NoIndex_5yrs_noCKMR),2,median, na.rm=TRUE)[1], ylim=c(0.1,1.2), las=1, ylab="", xaxt="n", pch=16, main="", xlab="",xlim=c(0.75,3.25),cex=1.25, bty="[")
legend("bottomleft", c("CKMR 5yrs", "CKMR 10yrs", "CKMR 20yrs","N100", "N1000", "N5000", "M", "R0"), col=c(1,1,1,1,2,3,1,1), pch=c(16,15,17,16,16,16,16,1), bty="n", ncol=3)
abline(h=1, lty=2)
mtext(side=3, text="No Index", line=-1.15, font=2)
points(1,apply(abs(RE_M_N1000_NoIndex_ckmrmultinom5),2,median, na.rm=TRUE)[1]/apply(abs(RE_M_N1000_NoIndex_5yrs_noCKMR),2,median, na.rm=TRUE)[1], pch=16, col=2,cex=1.25)
points(1.1,apply(abs(RE_M_N5000_NoIndex_ckmrmultinom5),2,median, na.rm=TRUE)[1]/apply(abs(RE_M_N5000_NoIndex_5yrs_noCKMR),2,median, na.rm=TRUE)[1], pch=16, col=3,cex=1.25)
points(1.9,apply(abs(RE_M_N100_NoIndex_ckmrmultinom10),2,median, na.rm=TRUE)[1]/apply(abs(RE_M_N100_NoIndex_10yrs_noCKMR),2,median, na.rm=TRUE)[1], pch=15, cex=1.25, col=1)
points(2,apply(abs(RE_M_N1000_NoIndex_ckmrmultinom10),2,median, na.rm=TRUE)[1]/apply(abs(RE_M_N1000_NoIndex_10yrs_noCKMR),2,median, na.rm=TRUE)[1], pch=15, col=2,cex=1.25)
points(2.1,apply(abs(RE_M_N5000_NoIndex_ckmrmultinom10),2,median, na.rm=TRUE)[1]/apply(abs(RE_M_N5000_NoIndex_10yrs_noCKMR),2,median, na.rm=TRUE)[1], pch=15, col=3,cex=1.25)
points(2.9,apply(abs(RE_M_N100_NoIndex_ckmrmultinom20),2,median, na.rm=TRUE)[1]/apply(abs(RE_M_N100_NoIndex_20yrs_noCKMR),2,median, na.rm=TRUE)[1], pch=17, cex=1.25,col=1)
points(3,apply(abs(RE_M_N1000_NoIndex_ckmrmultinom20),2,median, na.rm=TRUE)[1]/apply(abs(RE_M_N1000_NoIndex_20yrs_noCKMR),2,median, na.rm=TRUE)[1], pch=17, col=2,cex=1.25)
points(3.1,apply(abs(RE_M_N5000_NoIndex_ckmrmultinom20),2,median, na.rm=TRUE)[1]/apply(abs(RE_M_N5000_NoIndex_20yrs_noCKMR),2,median, na.rm=TRUE)[1], pch=17, col=3,cex=1.25)
#R0
points(0.91,apply(abs(RE_R0_N100_NoIndex_ckmrmultinom5),2,median, na.rm=TRUE)[1]/apply(abs(RE_R0_N100_NoIndex_5yrs_noCKMR),2,median, na.rm=TRUE)[1], pch=1, cex=1.25)
points(1.01,apply(abs(RE_R0_N1000_NoIndex_ckmrmultinom5),2,median, na.rm=TRUE)[1]/apply(abs(RE_R0_N1000_NoIndex_5yrs_noCKMR),2,median, na.rm=TRUE)[1], pch=1, col=2,cex=1.25)
points(1.11,apply(abs(RE_R0_N5000_NoIndex_ckmrmultinom5),2,median, na.rm=TRUE)[1]/apply(abs(RE_R0_N5000_NoIndex_5yrs_noCKMR),2,median, na.rm=TRUE)[1], pch=1, col=3,cex=1.25)
points(1.91,apply(abs(RE_R0_N100_NoIndex_ckmrmultinom10),2,median, na.rm=TRUE)[1]/apply(abs(RE_R0_N100_NoIndex_10yrs_noCKMR),2,median, na.rm=TRUE)[1], pch=0, cex=1.25,col=1)
points(2.01,apply(abs(RE_R0_N1000_NoIndex_ckmrmultinom10),2,median, na.rm=TRUE)[1]/apply(abs(RE_R0_N1000_NoIndex_10yrs_noCKMR),2,median, na.rm=TRUE)[1], pch=0, col=2,cex=1.25)
points(2.11,apply(abs(RE_R0_N5000_NoIndex_ckmrmultinom10),2,median, na.rm=TRUE)[1]/apply(abs(RE_R0_N5000_NoIndex_10yrs_noCKMR),2,median, na.rm=TRUE)[1], pch=0, col=3,cex=1.25)
points(2.91,apply(abs(RE_R0_N100_NoIndex_ckmrmultinom20),2,median, na.rm=TRUE)[1]/apply(abs(RE_R0_N100_NoIndex_20yrs_noCKMR),2,median, na.rm=TRUE)[1], pch=2, col=1,cex=1.25)
points(3.01,apply(abs(RE_R0_N1000_NoIndex_ckmrmultinom20),2,median, na.rm=TRUE)[1]/apply(abs(RE_R0_N1000_NoIndex_20yrs_noCKMR),2,median, na.rm=TRUE)[1], pch=2, col=2,cex=1.25)
points(3.11,apply(abs(RE_R0_N5000_NoIndex_ckmrmultinom20),2,median, na.rm=TRUE)[1]/apply(abs(RE_R0_N5000_NoIndex_20yrs_noCKMR),2,median, na.rm=TRUE)[1], pch=2, col=3,cex=1.25)
#Flatfish
plot(0.9,apply(abs(RE_M_N100_NoIndex_ckmrmultinom5),2,median, na.rm=TRUE)[2]/apply(abs(RE_M_N100_NoIndex_5yrs_noCKMR),2,median, na.rm=TRUE)[2], ylim=c(0.1,1.2), las=1, ylab="", xaxt="n", pch=16, main="", xlab="",xlim=c(0.75,3.25),cex=1.25, bty="[")
mtext(side=2, text="Median ARE / No CKMR", line=3.5)
abline(h=1, lty=2)
points(1,apply(abs(RE_M_N1000_NoIndex_ckmrmultinom5),2,median, na.rm=TRUE)[2]/apply(abs(RE_M_N1000_NoIndex_5yrs_noCKMR),2,median, na.rm=TRUE)[2], pch=16, col=2,cex=1.25)
points(1.1,apply(abs(RE_M_N5000_NoIndex_ckmrmultinom5),2,median, na.rm=TRUE)[2]/apply(abs(RE_M_N5000_NoIndex_5yrs_noCKMR),2,median, na.rm=TRUE)[2], pch=16, col=3,cex=1.25)
points(1.9,apply(abs(RE_M_N100_NoIndex_ckmrmultinom10),2,median, na.rm=TRUE)[2]/apply(abs(RE_M_N100_NoIndex_10yrs_noCKMR),2,median, na.rm=TRUE)[2], pch=15, cex=1.25, col=1)
points(2,apply(abs(RE_M_N1000_NoIndex_ckmrmultinom10),2,median, na.rm=TRUE)[2]/apply(abs(RE_M_N1000_NoIndex_10yrs_noCKMR),2,median, na.rm=TRUE)[2], pch=15, col=2,cex=1.25)
points(2.1,apply(abs(RE_M_N5000_NoIndex_ckmrmultinom10),2,median, na.rm=TRUE)[2]/apply(abs(RE_M_N5000_NoIndex_10yrs_noCKMR),2,median, na.rm=TRUE)[2], pch=15, col=3,cex=1.25)
points(2.9,apply(abs(RE_M_N100_NoIndex_ckmrmultinom20),2,median, na.rm=TRUE)[2]/apply(abs(RE_M_N100_NoIndex_20yrs_noCKMR),2,median, na.rm=TRUE)[2], pch=17, cex=1.25,col=1)
points(3,apply(abs(RE_M_N1000_NoIndex_ckmrmultinom20),2,median, na.rm=TRUE)[2]/apply(abs(RE_M_N1000_NoIndex_20yrs_noCKMR),2,median, na.rm=TRUE)[2], pch=17, col=2,cex=1.25)
points(3.1,apply(abs(RE_M_N5000_NoIndex_ckmrmultinom20),2,median, na.rm=TRUE)[2]/apply(abs(RE_M_N5000_NoIndex_20yrs_noCKMR),2,median, na.rm=TRUE)[2], pch=17, col=3,cex=1.25)
#R0
points(0.91,apply(abs(RE_R0_N100_NoIndex_ckmrmultinom5),2,median, na.rm=TRUE)[2]/apply(abs(RE_R0_N100_NoIndex_5yrs_noCKMR),2,median, na.rm=TRUE)[2], pch=1, cex=1.25)
points(1.01,apply(abs(RE_R0_N1000_NoIndex_ckmrmultinom5),2,median, na.rm=TRUE)[2]/apply(abs(RE_R0_N1000_NoIndex_5yrs_noCKMR),2,median, na.rm=TRUE)[2], pch=1, col=2,cex=1.25)
points(1.11,apply(abs(RE_R0_N5000_NoIndex_ckmrmultinom5),2,median, na.rm=TRUE)[2]/apply(abs(RE_R0_N5000_NoIndex_5yrs_noCKMR),2,median, na.rm=TRUE)[2], pch=1, col=3,cex=1.25)
points(1.91,apply(abs(RE_R0_N100_NoIndex_ckmrmultinom10),2,median, na.rm=TRUE)[2]/apply(abs(RE_R0_N100_NoIndex_10yrs_noCKMR),2,median, na.rm=TRUE)[2], pch=0, cex=1.25,col=1)
points(2.01,apply(abs(RE_R0_N1000_NoIndex_ckmrmultinom10),2,median, na.rm=TRUE)[2]/apply(abs(RE_R0_N1000_NoIndex_10yrs_noCKMR),2,median, na.rm=TRUE)[2], pch=0, col=2,cex=1.25)
points(2.11,apply(abs(RE_R0_N5000_NoIndex_ckmrmultinom10),2,median, na.rm=TRUE)[2]/apply(abs(RE_R0_N5000_NoIndex_10yrs_noCKMR),2,median, na.rm=TRUE)[2], pch=0, col=3,cex=1.25)
points(2.91,apply(abs(RE_R0_N100_NoIndex_ckmrmultinom20),2,median, na.rm=TRUE)[2]/apply(abs(RE_R0_N100_NoIndex_20yrs_noCKMR),2,median, na.rm=TRUE)[2], pch=2, col=1,cex=1.25)
points(3.01,apply(abs(RE_R0_N1000_NoIndex_ckmrmultinom20),2,median, na.rm=TRUE)[2]/apply(abs(RE_R0_N1000_NoIndex_20yrs_noCKMR),2,median, na.rm=TRUE)[2], pch=2, col=2,cex=1.25)
points(3.11,apply(abs(RE_R0_N5000_NoIndex_ckmrmultinom20),2,median, na.rm=TRUE)[2]/apply(abs(RE_R0_N5000_NoIndex_20yrs_noCKMR),2,median, na.rm=TRUE)[2], pch=2, col=3,cex=1.25)
#Sardine
plot(0.9,apply(abs(RE_M_N100_NoIndex_ckmrmultinom5),2,median, na.rm=TRUE)[3]/apply(abs(RE_M_N100_NoIndex_5yrs_noCKMR),2,median, na.rm=TRUE)[3], ylim=c(0.1,1.2), las=1, ylab="", xaxt="n", pch=16, main="", xlab="",xlim=c(0.75,3.25),cex=1.25,bty="[")
abline(h=1, lty=2)
points(1,apply(abs(RE_M_N1000_NoIndex_ckmrmultinom5),2,median, na.rm=TRUE)[3]/apply(abs(RE_M_N1000_NoIndex_5yrs_noCKMR),2,median, na.rm=TRUE)[3], pch=16, col=2,cex=1.25)
points(1.1,apply(abs(RE_M_N5000_NoIndex_ckmrmultinom5),2,median, na.rm=TRUE)[3]/apply(abs(RE_M_N5000_NoIndex_5yrs_noCKMR),2,median, na.rm=TRUE)[3], pch=16, col=3,cex=1.25)
points(1.9,apply(abs(RE_M_N100_NoIndex_ckmrmultinom10),2,median, na.rm=TRUE)[3]/apply(abs(RE_M_N100_NoIndex_10yrs_noCKMR),2,median, na.rm=TRUE)[3], pch=15, cex=1.25, col=1)
points(2,apply(abs(RE_M_N1000_NoIndex_ckmrmultinom10),2,median, na.rm=TRUE)[3]/apply(abs(RE_M_N1000_NoIndex_10yrs_noCKMR),2,median, na.rm=TRUE)[3], pch=15, col=2,cex=1.25)
points(2.1,apply(abs(RE_M_N5000_NoIndex_ckmrmultinom10),2,median, na.rm=TRUE)[3]/apply(abs(RE_M_N5000_NoIndex_10yrs_noCKMR),2,median, na.rm=TRUE)[3], pch=15, col=3,cex=1.25)
points(2.9,apply(abs(RE_M_N100_NoIndex_ckmrmultinom20),2,median, na.rm=TRUE)[3]/apply(abs(RE_M_N100_NoIndex_20yrs_noCKMR),2,median, na.rm=TRUE)[3], pch=17, cex=1.25,col=1)
points(3,apply(abs(RE_M_N1000_NoIndex_ckmrmultinom20),2,median, na.rm=TRUE)[3]/apply(abs(RE_M_N1000_NoIndex_20yrs_noCKMR),2,median, na.rm=TRUE)[3], pch=17, col=2,cex=1.25)
points(3.1,apply(abs(RE_M_N5000_NoIndex_ckmrmultinom20),2,median, na.rm=TRUE)[3]/apply(abs(RE_M_N5000_NoIndex_20yrs_noCKMR),2,median, na.rm=TRUE)[3], pch=17, col=3,cex=1.25)
#R0
points(0.91,apply(abs(RE_R0_N100_NoIndex_ckmrmultinom5),2,median, na.rm=TRUE)[3]/apply(abs(RE_R0_N100_NoIndex_5yrs_noCKMR),2,median, na.rm=TRUE)[3], pch=1, cex=1.25)
points(1.01,apply(abs(RE_R0_N1000_NoIndex_ckmrmultinom5),2,median, na.rm=TRUE)[3]/apply(abs(RE_R0_N1000_NoIndex_5yrs_noCKMR),2,median, na.rm=TRUE)[3], pch=1, col=2,cex=1.25)
points(1.11,apply(abs(RE_R0_N5000_NoIndex_ckmrmultinom5),2,median, na.rm=TRUE)[3]/apply(abs(RE_R0_N5000_NoIndex_5yrs_noCKMR),2,median, na.rm=TRUE)[3], pch=1, col=3,cex=1.25)
points(1.91,apply(abs(RE_R0_N100_NoIndex_ckmrmultinom10),2,median, na.rm=TRUE)[3]/apply(abs(RE_R0_N100_NoIndex_10yrs_noCKMR),2,median, na.rm=TRUE)[3], pch=0, cex=1.25,col=1)
points(2.01,apply(abs(RE_R0_N1000_NoIndex_ckmrmultinom10),2,median, na.rm=TRUE)[3]/apply(abs(RE_R0_N1000_NoIndex_10yrs_noCKMR),2,median, na.rm=TRUE)[3], pch=0, col=2,cex=1.25)
points(2.11,apply(abs(RE_R0_N5000_NoIndex_ckmrmultinom10),2,median, na.rm=TRUE)[3]/apply(abs(RE_R0_N5000_NoIndex_10yrs_noCKMR),2,median, na.rm=TRUE)[3], pch=0, col=3,cex=1.25)
points(2.91,apply(abs(RE_R0_N100_NoIndex_ckmrmultinom20),2,median, na.rm=TRUE)[3]/apply(abs(RE_R0_N100_NoIndex_20yrs_noCKMR),2,median, na.rm=TRUE)[3], pch=2, col=1,cex=1.25)
points(3.01,apply(abs(RE_R0_N1000_NoIndex_ckmrmultinom20),2,median, na.rm=TRUE)[3]/apply(abs(RE_R0_N1000_NoIndex_20yrs_noCKMR),2,median, na.rm=TRUE)[3], pch=2, col=2,cex=1.25)
points(3.11,apply(abs(RE_R0_N5000_NoIndex_ckmrmultinom20),2,median, na.rm=TRUE)[3]/apply(abs(RE_R0_N5000_NoIndex_20yrs_noCKMR),2,median, na.rm=TRUE)[3], pch=2, col=3,cex=1.25)
#Median SDs of M and R0
#Cod
plot(0.9,apply(SD_M_N100_NoIndex_ckmrmultinom5,1,median, na.rm=TRUE)[1]/apply(SD_M_N100_NoIndex_5yrs_noCKMR,1,median, na.rm=TRUE)[1], ylim=c(0.1,1.2), las=1, ylab="", xaxt="n", pch=16, main="", xlab="",xlim=c(0.75,3.25),cex=1.25, bty="[")
abline(h=1, lty=2)
points(1,apply(SD_M_N1000_NoIndex_ckmrmultinom5,1,median, na.rm=TRUE)[1]/apply(SD_M_N1000_NoIndex_5yrs_noCKMR,1,median, na.rm=TRUE)[1], pch=16, col=2,cex=1.25)
points(1.1,apply(SD_M_N5000_NoIndex_ckmrmultinom5,1,median, na.rm=TRUE)[1]/apply(SD_M_N5000_NoIndex_5yrs_noCKMR,1,median, na.rm=TRUE)[1], pch=16, col=3,cex=1.25)
points(1.9,apply(SD_M_N100_NoIndex_ckmrmultinom10,1,median, na.rm=TRUE)[1]/apply(SD_M_N100_NoIndex_10yrs_noCKMR,1,median, na.rm=TRUE)[1], pch=15, cex=1.25, col=1)
points(2,apply(SD_M_N1000_NoIndex_ckmrmultinom10,1,median, na.rm=TRUE)[1]/apply(SD_M_N1000_NoIndex_10yrs_noCKMR,1,median, na.rm=TRUE)[1], pch=15, col=2,cex=1.25)
points(2.1,apply(SD_M_N5000_NoIndex_ckmrmultinom10,1,median, na.rm=TRUE)[1]/apply(SD_M_N5000_NoIndex_10yrs_noCKMR,1,median, na.rm=TRUE)[1], pch=15, col=3,cex=1.25)
points(2.9,apply(SD_M_N100_NoIndex_ckmrmultinom20,1,median, na.rm=TRUE)[1]/apply(SD_M_N100_NoIndex_20yrs_noCKMR,1,median, na.rm=TRUE)[1], pch=17, cex=1.25,col=1)
points(3,apply(SD_M_N1000_NoIndex_ckmrmultinom20,1,median, na.rm=TRUE)[1]/apply(SD_M_N1000_NoIndex_20yrs_noCKMR,1,median, na.rm=TRUE)[1], pch=17, col=2,cex=1.25)
points(3.1,apply(SD_M_N5000_NoIndex_ckmrmultinom20,1,median, na.rm=TRUE)[1]/apply(SD_M_N5000_NoIndex_20yrs_noCKMR,1,median, na.rm=TRUE)[1], pch=17, col=3,cex=1.25)
#R0
points(0.91,apply(SD_R0_N100_NoIndex_ckmrmultinom5,1,median, na.rm=TRUE)[1]/apply(SD_R0_N100_NoIndex_5yrs_noCKMR,1,median, na.rm=TRUE)[1], pch=1, cex=1.25)
points(1.01,apply(SD_R0_N1000_NoIndex_ckmrmultinom5,1,median, na.rm=TRUE)[1]/apply(SD_R0_N1000_NoIndex_5yrs_noCKMR,1,median, na.rm=TRUE)[1], pch=1, col=2,cex=1.25)
points(1.11,apply(SD_R0_N5000_NoIndex_ckmrmultinom5,1,median, na.rm=TRUE)[1]/apply(SD_R0_N5000_NoIndex_5yrs_noCKMR,1,median, na.rm=TRUE)[1], pch=1, col=3,cex=1.25)
points(1.91,apply(SD_R0_N100_NoIndex_ckmrmultinom10,1,median, na.rm=TRUE)[1]/apply(SD_R0_N100_NoIndex_10yrs_noCKMR,1,median, na.rm=TRUE)[1], pch=0, cex=1.25,col=1)
points(2.01,apply(SD_R0_N1000_NoIndex_ckmrmultinom10,1,median, na.rm=TRUE)[1]/apply(SD_R0_N1000_NoIndex_10yrs_noCKMR,1,median, na.rm=TRUE)[1], pch=0, col=2,cex=1.25)
points(2.11,apply(SD_R0_N5000_NoIndex_ckmrmultinom10,1,median, na.rm=TRUE)[1]/apply(SD_R0_N5000_NoIndex_10yrs_noCKMR,1,median, na.rm=TRUE)[1], pch=0, col=3,cex=1.25)
points(2.91,apply(SD_R0_N100_NoIndex_ckmrmultinom20,1,median, na.rm=TRUE)[1]/apply(SD_R0_N100_NoIndex_20yrs_noCKMR,1,median, na.rm=TRUE)[1], pch=2, col=1,cex=1.25)
points(3.01,apply(SD_R0_N1000_NoIndex_ckmrmultinom20,1,median, na.rm=TRUE)[1]/apply(SD_R0_N1000_NoIndex_20yrs_noCKMR,1,median, na.rm=TRUE)[1], pch=2, col=2,cex=1.25)
points(3.11,apply(SD_R0_N5000_NoIndex_ckmrmultinom20,1,median, na.rm=TRUE)[1]/apply(SD_R0_N5000_NoIndex_20yrs_noCKMR,1,median, na.rm=TRUE)[1], pch=2, col=3,cex=1.25)
#Flatfish
plot(0.9,apply(SD_M_N100_NoIndex_ckmrmultinom5,1,median, na.rm=TRUE)[2]/apply(SD_M_N100_NoIndex_5yrs_noCKMR,1,median, na.rm=TRUE)[2], ylim=c(0.1,1.2), las=1, ylab="", xaxt="n", pch=16, main="", xlab="",xlim=c(0.75,3.25),cex=1.25, bty="[")
mtext(side=2, text="Median SE / No CKMR", line=3.5)
abline(h=1, lty=2)
points(1,apply(SD_M_N1000_NoIndex_ckmrmultinom5,1,median, na.rm=TRUE)[2]/apply(SD_M_N1000_NoIndex_5yrs_noCKMR,1,median, na.rm=TRUE)[2], pch=16, col=2,cex=1.25)
points(1.1,apply(SD_M_N5000_NoIndex_ckmrmultinom5,1,median, na.rm=TRUE)[2]/apply(SD_M_N5000_NoIndex_5yrs_noCKMR,1,median, na.rm=TRUE)[2], pch=16, col=3,cex=1.25)
points(1.9,apply(SD_M_N100_NoIndex_ckmrmultinom10,1,median, na.rm=TRUE)[2]/apply(SD_M_N100_NoIndex_10yrs_noCKMR,1,median, na.rm=TRUE)[2], pch=15, cex=1.25, col=1)
points(2,apply(SD_M_N1000_NoIndex_ckmrmultinom10,1,median, na.rm=TRUE)[2]/apply(SD_M_N1000_NoIndex_10yrs_noCKMR,1,median, na.rm=TRUE)[2], pch=15, col=2,cex=1.25)
points(2.1,apply(SD_M_N5000_NoIndex_ckmrmultinom10,1,median, na.rm=TRUE)[2]/apply(SD_M_N5000_NoIndex_10yrs_noCKMR,1,median, na.rm=TRUE)[2], pch=15, col=3,cex=1.25)
points(2.9,apply(SD_M_N100_NoIndex_ckmrmultinom20,1,median, na.rm=TRUE)[2]/apply(SD_M_N100_NoIndex_20yrs_noCKMR,1,median, na.rm=TRUE)[2], pch=17, cex=1.25,col=1)
points(3,apply(SD_M_N1000_NoIndex_ckmrmultinom20,1,median, na.rm=TRUE)[2]/apply(SD_M_N1000_NoIndex_20yrs_noCKMR,1,median, na.rm=TRUE)[2], pch=17, col=2,cex=1.25)
points(3.1,apply(SD_M_N5000_NoIndex_ckmrmultinom20,1,median, na.rm=TRUE)[2]/apply(SD_M_N5000_NoIndex_20yrs_noCKMR,1,median, na.rm=TRUE)[2], pch=17, col=3,cex=1.25)
#R0
points(0.91,apply(SD_R0_N100_NoIndex_ckmrmultinom5,1,median, na.rm=TRUE)[2]/apply(SD_R0_N100_NoIndex_5yrs_noCKMR,1,median, na.rm=TRUE)[2], pch=1, cex=1.25)
points(1.01,apply(SD_R0_N1000_NoIndex_ckmrmultinom5,1,median, na.rm=TRUE)[2]/apply(SD_R0_N1000_NoIndex_5yrs_noCKMR,1,median, na.rm=TRUE)[2], pch=1, col=2,cex=1.25)
points(1.11,apply(SD_R0_N5000_NoIndex_ckmrmultinom5,1,median, na.rm=TRUE)[2]/apply(SD_R0_N5000_NoIndex_5yrs_noCKMR,1,median, na.rm=TRUE)[2], pch=1, col=3,cex=1.25)
points(1.91,apply(SD_R0_N100_NoIndex_ckmrmultinom10,1,median, na.rm=TRUE)[2]/apply(SD_R0_N100_NoIndex_10yrs_noCKMR,1,median, na.rm=TRUE)[2], pch=0, cex=1.25,col=1)
points(2.01,apply(SD_R0_N1000_NoIndex_ckmrmultinom10,1,median, na.rm=TRUE)[2]/apply(SD_R0_N1000_NoIndex_10yrs_noCKMR,1,median, na.rm=TRUE)[2], pch=0, col=2,cex=1.25)
points(2.11,apply(SD_R0_N5000_NoIndex_ckmrmultinom10,1,median, na.rm=TRUE)[2]/apply(SD_R0_N5000_NoIndex_10yrs_noCKMR,1,median, na.rm=TRUE)[2], pch=0, col=3,cex=1.25)
points(2.91,apply(SD_R0_N100_NoIndex_ckmrmultinom20,1,median, na.rm=TRUE)[2]/apply(SD_R0_N100_NoIndex_20yrs_noCKMR,1,median, na.rm=TRUE)[2], pch=2, col=1,cex=1.25)
points(3.01,apply(SD_R0_N1000_NoIndex_ckmrmultinom20,1,median, na.rm=TRUE)[2]/apply(SD_R0_N1000_NoIndex_20yrs_noCKMR,1,median, na.rm=TRUE)[2], pch=2, col=2,cex=1.25)
points(3.11,apply(SD_R0_N5000_NoIndex_ckmrmultinom20,1,median, na.rm=TRUE)[2]/apply(SD_R0_N5000_NoIndex_20yrs_noCKMR,1,median, na.rm=TRUE)[2], pch=2, col=3,cex=1.25)
#Sardine
plot(0.9,apply(SD_M_N100_NoIndex_ckmrmultinom5,1,median, na.rm=TRUE)[3]/apply(SD_M_N100_NoIndex_5yrs_noCKMR,1,median, na.rm=TRUE)[3], ylim=c(0.1,1.2), las=1, ylab="", xaxt="n", pch=16, main="", xlab="",xlim=c(0.75,3.25),cex=1.25,bty="[")
abline(h=1, lty=2)
points(1,apply(SD_M_N1000_NoIndex_ckmrmultinom5,1,median, na.rm=TRUE)[3]/apply(SD_M_N1000_NoIndex_5yrs_noCKMR,1,median, na.rm=TRUE)[3], pch=16, col=2,cex=1.25)
points(1.1,apply(SD_M_N5000_NoIndex_ckmrmultinom5,1,median, na.rm=TRUE)[3]/apply(SD_M_N5000_NoIndex_5yrs_noCKMR,1,median, na.rm=TRUE)[3], pch=16, col=3,cex=1.25)
points(1.9,apply(SD_M_N100_NoIndex_ckmrmultinom10,1,median, na.rm=TRUE)[3]/apply(SD_M_N100_NoIndex_10yrs_noCKMR,1,median, na.rm=TRUE)[3], pch=15, cex=1.25, col=1)
points(2,apply(SD_M_N1000_NoIndex_ckmrmultinom10,1,median, na.rm=TRUE)[3]/apply(SD_M_N1000_NoIndex_10yrs_noCKMR,1,median, na.rm=TRUE)[3], pch=15, col=2,cex=1.25)
points(2.1,apply(SD_M_N5000_NoIndex_ckmrmultinom10,1,median, na.rm=TRUE)[3]/apply(SD_M_N5000_NoIndex_10yrs_noCKMR,1,median, na.rm=TRUE)[3], pch=15, col=3,cex=1.25)
points(2.9,apply(SD_M_N100_NoIndex_ckmrmultinom20,1,median, na.rm=TRUE)[3]/apply(SD_M_N100_NoIndex_20yrs_noCKMR,1,median, na.rm=TRUE)[3], pch=17, cex=1.25,col=1)
points(3,apply(SD_M_N1000_NoIndex_ckmrmultinom20,1,median, na.rm=TRUE)[3]/apply(SD_M_N1000_NoIndex_20yrs_noCKMR,1,median, na.rm=TRUE)[3], pch=17, col=2,cex=1.25)
points(3.1,apply(SD_M_N5000_NoIndex_ckmrmultinom20,1,median, na.rm=TRUE)[3]/apply(SD_M_N5000_NoIndex_20yrs_noCKMR,1,median, na.rm=TRUE)[3], pch=17, col=3,cex=1.25)
#R0
points(0.91,apply(SD_R0_N100_NoIndex_ckmrmultinom5,1,median, na.rm=TRUE)[3]/apply(SD_R0_N100_NoIndex_5yrs_noCKMR,1,median, na.rm=TRUE)[3], pch=1, cex=1.25)
points(1.01,apply(SD_R0_N1000_NoIndex_ckmrmultinom5,1,median, na.rm=TRUE)[3]/apply(SD_R0_N1000_NoIndex_5yrs_noCKMR,1,median, na.rm=TRUE)[3], pch=1, col=2,cex=1.25)
points(1.11,apply(SD_R0_N5000_NoIndex_ckmrmultinom5,1,median, na.rm=TRUE)[3]/apply(SD_R0_N5000_NoIndex_5yrs_noCKMR,1,median, na.rm=TRUE)[3], pch=1, col=3,cex=1.25)
points(1.91,apply(SD_R0_N100_NoIndex_ckmrmultinom10,1,median, na.rm=TRUE)[3]/apply(SD_R0_N100_NoIndex_10yrs_noCKMR,1,median, na.rm=TRUE)[3], pch=0, cex=1.25,col=1)
points(2.01,apply(SD_R0_N1000_NoIndex_ckmrmultinom10,1,median, na.rm=TRUE)[3]/apply(SD_R0_N1000_NoIndex_10yrs_noCKMR,1,median, na.rm=TRUE)[3], pch=0, col=2,cex=1.25)
points(2.11,apply(SD_R0_N5000_NoIndex_ckmrmultinom10,1,median, na.rm=TRUE)[3]/apply(SD_R0_N5000_NoIndex_10yrs_noCKMR,1,median, na.rm=TRUE)[3], pch=0, col=3,cex=1.25)
points(2.91,apply(SD_R0_N100_NoIndex_ckmrmultinom20,1,median, na.rm=TRUE)[3]/apply(SD_R0_N100_NoIndex_20yrs_noCKMR,1,median, na.rm=TRUE)[3], pch=2, col=1,cex=1.25)
points(3.01,apply(SD_R0_N1000_NoIndex_ckmrmultinom20,1,median, na.rm=TRUE)[3]/apply(SD_R0_N1000_NoIndex_20yrs_noCKMR,1,median, na.rm=TRUE)[3], pch=2, col=2,cex=1.25)
points(3.11,apply(SD_R0_N5000_NoIndex_ckmrmultinom20,1,median, na.rm=TRUE)[3]/apply(SD_R0_N5000_NoIndex_20yrs_noCKMR,1,median, na.rm=TRUE)[3], pch=2, col=3,cex=1.25)
#IQR of RE between sims
#Cod
#No Index
plot(0.9,IQR_RE_M_N100_NoIndex_ckmrmultinom5[1]/IQR_RE_M_N100_NoIndex_5yrs_noCKMR[1], ylim=c(0.1,1.2), las=1, ylab="", xaxt="n", pch=16, main="", xlab="",xlim=c(0.75,3.25),cex=1.25, bty="[")
abline(h=1, lty=2)
points(1,IQR_RE_M_N1000_NoIndex_ckmrmultinom5[1]/IQR_RE_M_N1000_NoIndex_5yrs_noCKMR[1], pch=17, col=2,cex=1.25)
points(1.1,IQR_RE_M_N5000_NoIndex_ckmrmultinom5[1]/IQR_RE_M_N5000_NoIndex_5yrs_noCKMR[1], pch=16, col=3,cex=1.25)
points(1.9,IQR_RE_M_N100_NoIndex_ckmrmultinom10[1]/IQR_RE_M_N100_NoIndex_10yrs_noCKMR[1], pch=15, cex=1.25, col=1)
points(2,IQR_RE_M_N1000_NoIndex_ckmrmultinom10[1]/IQR_RE_M_N1000_NoIndex_10yrs_noCKMR[1], pch=15, col=2,cex=1.25)
points(2.1,IQR_RE_M_N5000_NoIndex_ckmrmultinom10[1]/IQR_RE_M_N5000_NoIndex_10yrs_noCKMR[1], pch=15, col=3,cex=1.25)
points(2.9,IQR_RE_M_N100_NoIndex_ckmrmultinom20[1]/IQR_RE_M_N100_NoIndex_20yrs_noCKMR[1], pch=17, cex=1.25,col=1)
points(3,IQR_RE_M_N1000_NoIndex_ckmrmultinom20[1]/IQR_RE_M_N1000_NoIndex_20yrs_noCKMR[1], pch=17, col=2,cex=1.25)
points(3.1,IQR_RE_M_N5000_NoIndex_ckmrmultinom20[1]/IQR_RE_M_N5000_NoIndex_20yrs_noCKMR[1], pch=17, col=3,cex=1.25)
#R0
points(0.91,IQR_RE_R0_N100_NoIndex_ckmrmultinom5[1]/IQR_RE_R0_N100_NoIndex_5yrs_noCKMR[1], pch=1, cex=1.25)
points(1.01,IQR_RE_R0_N1000_NoIndex_ckmrmultinom5[1]/IQR_RE_R0_N1000_NoIndex_5yrs_noCKMR[1], pch=1, col=2,cex=1.25)
points(1.11,IQR_RE_R0_N5000_NoIndex_ckmrmultinom5[1]/IQR_RE_R0_N5000_NoIndex_5yrs_noCKMR[1], pch=1, col=3,cex=1.25)
points(1.91,IQR_RE_R0_N100_NoIndex_ckmrmultinom10[1]/IQR_RE_R0_N100_NoIndex_10yrs_noCKMR[1], pch=0, cex=1.25,col=1)
points(2.01,IQR_RE_R0_N1000_NoIndex_ckmrmultinom10[1]/IQR_RE_R0_N1000_NoIndex_10yrs_noCKMR[1], pch=0, col=2,cex=1.25)
points(2.11,IQR_RE_R0_N5000_NoIndex_ckmrmultinom10[1]/IQR_RE_R0_N5000_NoIndex_10yrs_noCKMR[1], pch=0, col=3,cex=1.25)
points(2.91,IQR_RE_R0_N100_NoIndex_ckmrmultinom20[1]/IQR_RE_R0_N100_NoIndex_20yrs_noCKMR[1], pch=2, col=1,cex=1.25)
points(3.01,IQR_RE_R0_N1000_NoIndex_ckmrmultinom20[1]/IQR_RE_R0_N1000_NoIndex_20yrs_noCKMR[1], pch=2, col=2,cex=1.25)
points(3.11,IQR_RE_R0_N5000_NoIndex_ckmrmultinom20[1]/IQR_RE_R0_N5000_NoIndex_20yrs_noCKMR[1], pch=2, col=3,cex=1.25)
#Flatfish
plot(0.9,IQR_RE_M_N100_NoIndex_ckmrmultinom5[2]/IQR_RE_M_N100_NoIndex_5yrs_noCKMR[2], ylim=c(0.1,1.2), las=1, ylab="", xaxt="n", pch=16, main="", xlab="",xlim=c(0.75,3.25),cex=1.25,  bty="[")
mtext(side=2, text="IQR of RE / No CKMR", line=3.5)
abline(h=1, lty=2)
points(1,IQR_RE_M_N1000_NoIndex_ckmrmultinom5[2]/IQR_RE_M_N1000_NoIndex_5yrs_noCKMR[2], pch=16, col=2,cex=1.25)
points(1.1,IQR_RE_M_N5000_NoIndex_ckmrmultinom5[2]/IQR_RE_M_N5000_NoIndex_5yrs_noCKMR[2], pch=16, col=3,cex=1.25)
points(1.9,IQR_RE_M_N100_NoIndex_ckmrmultinom10[2]/IQR_RE_M_N100_NoIndex_10yrs_noCKMR[2], pch=15, cex=1.25, col=1)
points(2,IQR_RE_M_N1000_NoIndex_ckmrmultinom10[2]/IQR_RE_M_N1000_NoIndex_10yrs_noCKMR[2], pch=15, col=2,cex=1.25)
points(2.1,IQR_RE_M_N5000_NoIndex_ckmrmultinom10[2]/IQR_RE_M_N5000_NoIndex_10yrs_noCKMR[2], pch=15, col=3,cex=1.25)
points(2.9,IQR_RE_M_N100_NoIndex_ckmrmultinom20[2]/IQR_RE_M_N100_NoIndex_20yrs_noCKMR[2], pch=17, cex=1.25,col=1)
points(3,IQR_RE_M_N1000_NoIndex_ckmrmultinom20[2]/IQR_RE_M_N1000_NoIndex_20yrs_noCKMR[2], pch=17, col=2,cex=1.25)
points(3.1,IQR_RE_M_N5000_NoIndex_ckmrmultinom20[2]/IQR_RE_M_N5000_NoIndex_20yrs_noCKMR[2], pch=17, col=3,cex=1.25)
#R0
points(0.91,IQR_RE_R0_N100_NoIndex_ckmrmultinom5[2]/IQR_RE_R0_N100_NoIndex_5yrs_noCKMR[2], pch=1, cex=1.25)
points(1.01,IQR_RE_R0_N1000_NoIndex_ckmrmultinom5[2]/IQR_RE_R0_N1000_NoIndex_5yrs_noCKMR[2], pch=1, col=2,cex=1.25)
points(1.11,IQR_RE_R0_N5000_NoIndex_ckmrmultinom5[2]/IQR_RE_R0_N5000_NoIndex_5yrs_noCKMR[2], pch=1, col=3,cex=1.25)
points(1.91,IQR_RE_R0_N100_NoIndex_ckmrmultinom10[2]/IQR_RE_R0_N100_NoIndex_10yrs_noCKMR[2], pch=0, cex=1.25,col=1)
points(2.01,IQR_RE_R0_N1000_NoIndex_ckmrmultinom10[2]/IQR_RE_R0_N1000_NoIndex_10yrs_noCKMR[2], pch=0, col=2,cex=1.25)
points(2.11,IQR_RE_R0_N5000_NoIndex_ckmrmultinom10[2]/IQR_RE_R0_N5000_NoIndex_10yrs_noCKMR[2], pch=0, col=3,cex=1.25)
points(2.91,IQR_RE_R0_N100_NoIndex_ckmrmultinom20[2]/IQR_RE_R0_N100_NoIndex_20yrs_noCKMR[2], pch=2, col=1,cex=1.25)
points(3.01,IQR_RE_R0_N1000_NoIndex_ckmrmultinom20[2]/IQR_RE_R0_N1000_NoIndex_20yrs_noCKMR[2], pch=2, col=2,cex=1.25)
points(3.11,IQR_RE_R0_N5000_NoIndex_ckmrmultinom20[2]/IQR_RE_R0_N5000_NoIndex_20yrs_noCKMR[2], pch=2, col=3,cex=1.25)
#Sardine
plot(0.9,IQR_RE_M_N100_NoIndex_ckmrmultinom5[3]/IQR_RE_M_N100_NoIndex_5yrs_noCKMR[3], ylim=c(0.1,1.2), las=1, ylab="", xaxt="n", pch=16, main="", xlab="",xlim=c(0.75,3.25),cex=1.25,bty="[")
abline(h=1, lty=2)
points(1,IQR_RE_M_N1000_NoIndex_ckmrmultinom5[3]/IQR_RE_M_N1000_NoIndex_5yrs_noCKMR[3], pch=16, col=2,cex=1.25)
points(1.1,IQR_RE_M_N5000_NoIndex_ckmrmultinom5[3]/IQR_RE_M_N5000_NoIndex_5yrs_noCKMR[3], pch=16, col=3,cex=1.25)
points(1.9,IQR_RE_M_N100_NoIndex_ckmrmultinom10[3]/IQR_RE_M_N100_NoIndex_10yrs_noCKMR[3], pch=15, cex=1.25, col=1)
points(2,IQR_RE_M_N1000_NoIndex_ckmrmultinom10[3]/IQR_RE_M_N1000_NoIndex_10yrs_noCKMR[3], pch=15, col=2,cex=1.25)
points(2.1,IQR_RE_M_N5000_NoIndex_ckmrmultinom10[3]/IQR_RE_M_N5000_NoIndex_10yrs_noCKMR[3], pch=15, col=3,cex=1.25)
points(2.9,IQR_RE_M_N100_NoIndex_ckmrmultinom20[3]/IQR_RE_M_N100_NoIndex_20yrs_noCKMR[3], pch=17, cex=1.25,col=1)
points(3,IQR_RE_M_N1000_NoIndex_ckmrmultinom20[3]/IQR_RE_M_N1000_NoIndex_20yrs_noCKMR[3], pch=17, col=2,cex=1.25)
points(3.1,IQR_RE_M_N5000_NoIndex_ckmrmultinom20[3]/IQR_RE_M_N5000_NoIndex_20yrs_noCKMR[3], pch=17, col=3,cex=1.25)
#R0
points(0.91,IQR_RE_R0_N100_NoIndex_ckmrmultinom5[3]/IQR_RE_R0_N100_NoIndex_5yrs_noCKMR[3], pch=1, cex=1.25)
points(1.01,IQR_RE_R0_N1000_NoIndex_ckmrmultinom5[3]/IQR_RE_R0_N1000_NoIndex_5yrs_noCKMR[3], pch=1, col=2,cex=1.25)
points(1.11,IQR_RE_R0_N5000_NoIndex_ckmrmultinom5[3]/IQR_RE_R0_N5000_NoIndex_5yrs_noCKMR[3], pch=1, col=3,cex=1.25)
points(1.91,IQR_RE_R0_N100_NoIndex_ckmrmultinom10[3]/IQR_RE_R0_N100_NoIndex_10yrs_noCKMR[3], pch=0, cex=1.25,col=1)
points(2.01,IQR_RE_R0_N1000_NoIndex_ckmrmultinom10[3]/IQR_RE_R0_N1000_NoIndex_10yrs_noCKMR[3], pch=0, col=2,cex=1.25)
points(2.11,IQR_RE_R0_N5000_NoIndex_ckmrmultinom10[3]/IQR_RE_R0_N5000_NoIndex_10yrs_noCKMR[3], pch=0, col=3,cex=1.25)
points(2.91,IQR_RE_R0_N100_NoIndex_ckmrmultinom20[3]/IQR_RE_R0_N100_NoIndex_20yrs_noCKMR[3], pch=2, col=1,cex=1.25)
points(3.01,IQR_RE_R0_N1000_NoIndex_ckmrmultinom20[3]/IQR_RE_R0_N1000_NoIndex_20yrs_noCKMR[3], pch=2, col=2,cex=1.25)
points(3.11,IQR_RE_R0_N5000_NoIndex_ckmrmultinom20[3]/IQR_RE_R0_N5000_NoIndex_20yrs_noCKMR[3], pch=2, col=3,cex=1.25)
axis(side=1, at=1:3, labels=c("CKMR 5yrs", "CKMR 10yrs", "CKMR 20yrs"))
#Index 0.5###################
#Cod
plot(0.9,apply(abs(RE_M_N100_Ind50_ckmrmultinom5),2,median, na.rm=TRUE)[1]/apply(abs(RE_M_N100_Ind50_5yrs_noCKMR),2,median, na.rm=TRUE)[1], ylim=c(0.1,1.2), las=1, ylab="", xaxt="n", pch=16, main="", xlab="",xlim=c(0.75,3.25),cex=1.25,yaxt="n", bty="n")
mtext(text="Cod", side=1, line=-1.05,cex=0.7, font=2)
mtext(side=3, text="Index 0.5", line=-1.15, font=2)
axis(side=1,lwd.ticks = 0, labels=FALSE, at=c(0.5,3.5))
axis(side=3,lwd.ticks = 0, labels=FALSE, at=c(0.5,3.5))
abline(h=1, lty=2)
points(1,apply(abs(RE_M_N1000_Ind50_ckmrmultinom5),2,median, na.rm=TRUE)[1]/apply(abs(RE_M_N1000_Ind50_5yrs_noCKMR),2,median, na.rm=TRUE)[1], pch=16, col=2,cex=1.25)
points(1.1,apply(abs(RE_M_N5000_Ind50_ckmrmultinom5),2,median, na.rm=TRUE)[1]/apply(abs(RE_M_N5000_Ind50_5yrs_noCKMR),2,median, na.rm=TRUE)[1], pch=16, col=3,cex=1.25)
points(1.9,apply(abs(RE_M_N100_Ind50_ckmrmultinom10),2,median, na.rm=TRUE)[1]/apply(abs(RE_M_N100_Ind50_10yrs_noCKMR),2,median, na.rm=TRUE)[1], pch=15, cex=1.25, col=1)
points(2,apply(abs(RE_M_N1000_Ind50_ckmrmultinom10),2,median, na.rm=TRUE)[1]/apply(abs(RE_M_N1000_Ind50_10yrs_noCKMR),2,median, na.rm=TRUE)[1], pch=15, col=2,cex=1.25)
points(2.1,apply(abs(RE_M_N5000_Ind50_ckmrmultinom10),2,median, na.rm=TRUE)[1]/apply(abs(RE_M_N5000_Ind50_10yrs_noCKMR),2,median, na.rm=TRUE)[1], pch=15, col=3,cex=1.25)
points(2.9,apply(abs(RE_M_N100_Ind50_ckmrmultinom20),2,median, na.rm=TRUE)[1]/apply(abs(RE_M_N100_Ind50_20yrs_noCKMR),2,median, na.rm=TRUE)[1], pch=17, cex=1.25,col=1)
points(3,apply(abs(RE_M_N1000_Ind50_ckmrmultinom20),2,median, na.rm=TRUE)[1]/apply(abs(RE_M_N1000_Ind50_20yrs_noCKMR),2,median, na.rm=TRUE)[1], pch=17, col=2,cex=1.25)
points(3.1,apply(abs(RE_M_N5000_Ind50_ckmrmultinom20),2,median, na.rm=TRUE)[1]/apply(abs(RE_M_N5000_Ind50_20yrs_noCKMR),2,median, na.rm=TRUE)[1], pch=17, col=3,cex=1.25)
#R0
points(0.91,apply(abs(RE_R0_N100_Ind50_ckmrmultinom5),2,median, na.rm=TRUE)[1]/apply(abs(RE_R0_N100_Ind50_5yrs_noCKMR),2,median, na.rm=TRUE)[1], pch=1, cex=1.25)
points(1.01,apply(abs(RE_R0_N1000_Ind50_ckmrmultinom5),2,median, na.rm=TRUE)[1]/apply(abs(RE_R0_N1000_Ind50_5yrs_noCKMR),2,median, na.rm=TRUE)[1], pch=1, col=2,cex=1.25)
points(1.11,apply(abs(RE_R0_N5000_Ind50_ckmrmultinom5),2,median, na.rm=TRUE)[1]/apply(abs(RE_R0_N5000_Ind50_5yrs_noCKMR),2,median, na.rm=TRUE)[1], pch=1, col=3,cex=1.25)
points(1.91,apply(abs(RE_R0_N100_Ind50_ckmrmultinom10),2,median, na.rm=TRUE)[1]/apply(abs(RE_R0_N100_Ind50_10yrs_noCKMR),2,median, na.rm=TRUE)[1], pch=0, cex=1.25,col=1)
points(2.01,apply(abs(RE_R0_N1000_Ind50_ckmrmultinom10),2,median, na.rm=TRUE)[1]/apply(abs(RE_R0_N1000_Ind50_10yrs_noCKMR),2,median, na.rm=TRUE)[1], pch=0, col=2,cex=1.25)
points(2.11,apply(abs(RE_R0_N5000_Ind50_ckmrmultinom10),2,median, na.rm=TRUE)[1]/apply(abs(RE_R0_N5000_Ind50_10yrs_noCKMR),2,median, na.rm=TRUE)[1], pch=0, col=3,cex=1.25)
points(2.91,apply(abs(RE_R0_N100_Ind50_ckmrmultinom20),2,median, na.rm=TRUE)[1]/apply(abs(RE_R0_N100_Ind50_20yrs_noCKMR),2,median, na.rm=TRUE)[1], pch=2, col=1,cex=1.25)
points(3.01,apply(abs(RE_R0_N1000_Ind50_ckmrmultinom20),2,median, na.rm=TRUE)[1]/apply(abs(RE_R0_N1000_Ind50_20yrs_noCKMR),2,median, na.rm=TRUE)[1], pch=2, col=2,cex=1.25)
points(3.11,apply(abs(RE_R0_N5000_Ind50_ckmrmultinom20),2,median, na.rm=TRUE)[1]/apply(abs(RE_R0_N5000_Ind50_20yrs_noCKMR),2,median, na.rm=TRUE)[1], pch=2, col=3,cex=1.25)
#Flatfish
plot(0.9,apply(abs(RE_M_N100_Ind50_ckmrmultinom5),2,median, na.rm=TRUE)[2]/apply(abs(RE_M_N100_Ind50_5yrs_noCKMR),2,median, na.rm=TRUE)[2], ylim=c(0.1,1.2), las=1, ylab="", xaxt="n", pch=16, main="", xlab="",xlim=c(0.75,3.25),cex=1.25, yaxt="n", bty="n")
mtext(text="Flatfish", side=1, line=-1.05,cex=0.7, font=2)
axis(side=1,lwd.ticks = 0, labels=FALSE, at=c(0.5,3.5))
axis(side=3,lwd.ticks = 0, labels=FALSE, at=c(0.5,3.5))
abline(h=1, lty=2)
points(1,apply(abs(RE_M_N1000_Ind50_ckmrmultinom5),2,median, na.rm=TRUE)[2]/apply(abs(RE_M_N1000_Ind50_5yrs_noCKMR),2,median, na.rm=TRUE)[2], pch=16, col=2,cex=1.25)
points(1.1,apply(abs(RE_M_N5000_Ind50_ckmrmultinom5),2,median, na.rm=TRUE)[2]/apply(abs(RE_M_N5000_Ind50_5yrs_noCKMR),2,median, na.rm=TRUE)[2], pch=16, col=3,cex=1.25)
points(1.9,apply(abs(RE_M_N100_Ind50_ckmrmultinom10),2,median, na.rm=TRUE)[2]/apply(abs(RE_M_N100_Ind50_10yrs_noCKMR),2,median, na.rm=TRUE)[2], pch=15, cex=1.25, col=1)
points(2,apply(abs(RE_M_N1000_Ind50_ckmrmultinom10),2,median, na.rm=TRUE)[2]/apply(abs(RE_M_N1000_Ind50_10yrs_noCKMR),2,median, na.rm=TRUE)[2], pch=15, col=2,cex=1.25)
points(2.1,apply(abs(RE_M_N5000_Ind50_ckmrmultinom10),2,median, na.rm=TRUE)[2]/apply(abs(RE_M_N5000_Ind50_10yrs_noCKMR),2,median, na.rm=TRUE)[2], pch=15, col=3,cex=1.25)
points(2.9,apply(abs(RE_M_N100_Ind50_ckmrmultinom20),2,median, na.rm=TRUE)[2]/apply(abs(RE_M_N100_Ind50_20yrs_noCKMR),2,median, na.rm=TRUE)[2], pch=17, cex=1.25,col=1)
points(3,apply(abs(RE_M_N1000_Ind50_ckmrmultinom20),2,median, na.rm=TRUE)[2]/apply(abs(RE_M_N1000_Ind50_20yrs_noCKMR),2,median, na.rm=TRUE)[2], pch=17, col=2,cex=1.25)
points(3.1,apply(abs(RE_M_N5000_Ind50_ckmrmultinom20),2,median, na.rm=TRUE)[2]/apply(abs(RE_M_N5000_Ind50_20yrs_noCKMR),2,median, na.rm=TRUE)[2], pch=17, col=3,cex=1.25)
#R0
points(0.91,apply(abs(RE_R0_N100_Ind50_ckmrmultinom5),2,median, na.rm=TRUE)[2]/apply(abs(RE_R0_N100_Ind50_5yrs_noCKMR),2,median, na.rm=TRUE)[2], pch=1, cex=1.25)
points(1.01,apply(abs(RE_R0_N1000_Ind50_ckmrmultinom5),2,median, na.rm=TRUE)[2]/apply(abs(RE_R0_N1000_Ind50_5yrs_noCKMR),2,median, na.rm=TRUE)[2], pch=1, col=2,cex=1.25)
points(1.11,apply(abs(RE_R0_N5000_Ind50_ckmrmultinom5),2,median, na.rm=TRUE)[2]/apply(abs(RE_R0_N5000_Ind50_5yrs_noCKMR),2,median, na.rm=TRUE)[2], pch=1, col=3,cex=1.25)
points(1.91,apply(abs(RE_R0_N100_Ind50_ckmrmultinom10),2,median, na.rm=TRUE)[2]/apply(abs(RE_R0_N100_Ind50_10yrs_noCKMR),2,median, na.rm=TRUE)[2], pch=0, cex=1.25,col=1)
points(2.01,apply(abs(RE_R0_N1000_Ind50_ckmrmultinom10),2,median, na.rm=TRUE)[2]/apply(abs(RE_R0_N1000_Ind50_10yrs_noCKMR),2,median, na.rm=TRUE)[2], pch=0, col=2,cex=1.25)
points(2.11,apply(abs(RE_R0_N5000_Ind50_ckmrmultinom10),2,median, na.rm=TRUE)[2]/apply(abs(RE_R0_N5000_Ind50_10yrs_noCKMR),2,median, na.rm=TRUE)[2], pch=0, col=3,cex=1.25)
points(2.91,apply(abs(RE_R0_N100_Ind50_ckmrmultinom20),2,median, na.rm=TRUE)[2]/apply(abs(RE_R0_N100_Ind50_20yrs_noCKMR),2,median, na.rm=TRUE)[2], pch=2, col=1,cex=1.25)
points(3.01,apply(abs(RE_R0_N1000_Ind50_ckmrmultinom20),2,median, na.rm=TRUE)[2]/apply(abs(RE_R0_N1000_Ind50_20yrs_noCKMR),2,median, na.rm=TRUE)[2], pch=2, col=2,cex=1.25)
points(3.11,apply(abs(RE_R0_N5000_Ind50_ckmrmultinom20),2,median, na.rm=TRUE)[2]/apply(abs(RE_R0_N5000_Ind50_20yrs_noCKMR),2,median, na.rm=TRUE)[2], pch=2, col=3,cex=1.25)
#Sardine
plot(0.9,apply(abs(RE_M_N100_Ind50_ckmrmultinom5),2,median, na.rm=TRUE)[3]/apply(abs(RE_M_N100_Ind50_5yrs_noCKMR),2,median, na.rm=TRUE)[3], ylim=c(0.1,1.2), las=1, ylab="", xaxt="n", pch=16, main="", xlab="",xlim=c(0.75,3.25),cex=1.25,yaxt="n",bty="n")
mtext(text="Sardine", side=1, line=-1.05,cex=0.7, font=2)
axis(side=1,lwd.ticks = 0, labels=FALSE, at=c(0.5,3.5))
axis(side=3,lwd.ticks = 0, labels=FALSE, at=c(0.5,3.5))
abline(h=1, lty=2)
points(1,apply(abs(RE_M_N1000_Ind50_ckmrmultinom5),2,median, na.rm=TRUE)[3]/apply(abs(RE_M_N1000_Ind50_5yrs_noCKMR),2,median, na.rm=TRUE)[3], pch=16, col=2,cex=1.25)
points(1.1,apply(abs(RE_M_N5000_Ind50_ckmrmultinom5),2,median, na.rm=TRUE)[3]/apply(abs(RE_M_N5000_Ind50_5yrs_noCKMR),2,median, na.rm=TRUE)[3], pch=16, col=3,cex=1.25)
points(1.9,apply(abs(RE_M_N100_Ind50_ckmrmultinom10),2,median, na.rm=TRUE)[3]/apply(abs(RE_M_N100_Ind50_10yrs_noCKMR),2,median, na.rm=TRUE)[3], pch=15, cex=1.25, col=1)
points(2,apply(abs(RE_M_N1000_Ind50_ckmrmultinom10),2,median, na.rm=TRUE)[3]/apply(abs(RE_M_N1000_Ind50_10yrs_noCKMR),2,median, na.rm=TRUE)[3], pch=15, col=2,cex=1.25)
points(2.1,apply(abs(RE_M_N5000_Ind50_ckmrmultinom10),2,median, na.rm=TRUE)[3]/apply(abs(RE_M_N5000_Ind50_10yrs_noCKMR),2,median, na.rm=TRUE)[3], pch=15, col=3,cex=1.25)
points(2.9,apply(abs(RE_M_N100_Ind50_ckmrmultinom20),2,median, na.rm=TRUE)[3]/apply(abs(RE_M_N100_Ind50_20yrs_noCKMR),2,median, na.rm=TRUE)[3], pch=17, cex=1.25,col=1)
points(3,apply(abs(RE_M_N1000_Ind50_ckmrmultinom20),2,median, na.rm=TRUE)[3]/apply(abs(RE_M_N1000_Ind50_20yrs_noCKMR),2,median, na.rm=TRUE)[3], pch=17, col=2,cex=1.25)
points(3.1,apply(abs(RE_M_N5000_Ind50_ckmrmultinom20),2,median, na.rm=TRUE)[3]/apply(abs(RE_M_N5000_Ind50_20yrs_noCKMR),2,median, na.rm=TRUE)[3], pch=17, col=3,cex=1.25)
#R0
points(0.91,apply(abs(RE_R0_N100_Ind50_ckmrmultinom5),2,median, na.rm=TRUE)[3]/apply(abs(RE_R0_N100_Ind50_5yrs_noCKMR),2,median, na.rm=TRUE)[3], pch=1, cex=1.25)
points(1.01,apply(abs(RE_R0_N1000_Ind50_ckmrmultinom5),2,median, na.rm=TRUE)[3]/apply(abs(RE_R0_N1000_Ind50_5yrs_noCKMR),2,median, na.rm=TRUE)[3], pch=1, col=2,cex=1.25)
points(1.11,apply(abs(RE_R0_N5000_Ind50_ckmrmultinom5),2,median, na.rm=TRUE)[3]/apply(abs(RE_R0_N5000_Ind50_5yrs_noCKMR),2,median, na.rm=TRUE)[3], pch=1, col=3,cex=1.25)
points(1.91,apply(abs(RE_R0_N100_Ind50_ckmrmultinom10),2,median, na.rm=TRUE)[3]/apply(abs(RE_R0_N100_Ind50_10yrs_noCKMR),2,median, na.rm=TRUE)[3], pch=0, cex=1.25,col=1)
points(2.01,apply(abs(RE_R0_N1000_Ind50_ckmrmultinom10),2,median, na.rm=TRUE)[3]/apply(abs(RE_R0_N1000_Ind50_10yrs_noCKMR),2,median, na.rm=TRUE)[3], pch=0, col=2,cex=1.25)
points(2.11,apply(abs(RE_R0_N5000_Ind50_ckmrmultinom10),2,median, na.rm=TRUE)[3]/apply(abs(RE_R0_N5000_Ind50_10yrs_noCKMR),2,median, na.rm=TRUE)[3], pch=0, col=3,cex=1.25)
points(2.91,apply(abs(RE_R0_N100_Ind50_ckmrmultinom20),2,median, na.rm=TRUE)[3]/apply(abs(RE_R0_N100_Ind50_20yrs_noCKMR),2,median, na.rm=TRUE)[3], pch=2, col=1,cex=1.25)
points(3.01,apply(abs(RE_R0_N1000_Ind50_ckmrmultinom20),2,median, na.rm=TRUE)[3]/apply(abs(RE_R0_N1000_Ind50_20yrs_noCKMR),2,median, na.rm=TRUE)[3], pch=2, col=2,cex=1.25)
points(3.11,apply(abs(RE_R0_N5000_Ind50_ckmrmultinom20),2,median, na.rm=TRUE)[3]/apply(abs(RE_R0_N5000_Ind50_20yrs_noCKMR),2,median, na.rm=TRUE)[3], pch=2, col=3,cex=1.25)
#Median SEs of M and R0
#Cod
plot(0.9,apply(SD_M_N100_Ind50_ckmrmultinom5,1,median, na.rm=TRUE)[1]/apply(SD_M_N100_Ind50_5yrs_noCKMR,1,median, na.rm=TRUE)[1], ylim=c(0.1,1.2), las=1, ylab="", xaxt="n", pch=16, main="", xlab="",xlim=c(0.75,3.25),cex=1.25, bty="n",yaxt="n")
mtext(text="Cod", side=1, line=-1.05,cex=0.7, font=2)
axis(side=1,lwd.ticks = 0, labels=FALSE, at=c(0.5,3.5))
axis(side=3,lwd.ticks = 0, labels=FALSE, at=c(0.5,3.5))
abline(h=1, lty=2)
points(1,apply(SD_M_N1000_Ind50_ckmrmultinom5,1,median, na.rm=TRUE)[1]/apply(SD_M_N1000_Ind50_5yrs_noCKMR,1,median, na.rm=TRUE)[1], pch=16, col=2,cex=1.25)
points(1.1,apply(SD_M_N5000_Ind50_ckmrmultinom5,1,median, na.rm=TRUE)[1]/apply(SD_M_N5000_Ind50_5yrs_noCKMR,1,median, na.rm=TRUE)[1], pch=16, col=3,cex=1.25)
points(1.9,apply(SD_M_N100_Ind50_ckmrmultinom10,1,median, na.rm=TRUE)[1]/apply(SD_M_N100_Ind50_10yrs_noCKMR,1,median, na.rm=TRUE)[1], pch=15, cex=1.25, col=1)
points(2,apply(SD_M_N1000_Ind50_ckmrmultinom10,1,median, na.rm=TRUE)[1]/apply(SD_M_N1000_Ind50_10yrs_noCKMR,1,median, na.rm=TRUE)[1], pch=15, col=2,cex=1.25)
points(2.1,apply(SD_M_N5000_Ind50_ckmrmultinom10,1,median, na.rm=TRUE)[1]/apply(SD_M_N5000_Ind50_10yrs_noCKMR,1,median, na.rm=TRUE)[1], pch=15, col=3,cex=1.25)
points(2.9,apply(SD_M_N100_Ind50_ckmrmultinom20,1,median, na.rm=TRUE)[1]/apply(SD_M_N100_Ind50_20yrs_noCKMR,1,median, na.rm=TRUE)[1], pch=17, cex=1.25,col=1)
points(3,apply(SD_M_N1000_Ind50_ckmrmultinom20,1,median, na.rm=TRUE)[1]/apply(SD_M_N1000_Ind50_20yrs_noCKMR,1,median, na.rm=TRUE)[1], pch=17, col=2,cex=1.25)
points(3.1,apply(SD_M_N5000_Ind50_ckmrmultinom20,1,median, na.rm=TRUE)[1]/apply(SD_M_N5000_Ind50_20yrs_noCKMR,1,median, na.rm=TRUE)[1], pch=17, col=3,cex=1.25)
#R0
points(0.91,apply(SD_R0_N100_Ind50_ckmrmultinom5,1,median, na.rm=TRUE)[1]/apply(SD_R0_N100_Ind50_5yrs_noCKMR,1,median, na.rm=TRUE)[1], pch=1, cex=1.25)
points(1.01,apply(SD_R0_N1000_Ind50_ckmrmultinom5,1,median, na.rm=TRUE)[1]/apply(SD_R0_N1000_Ind50_5yrs_noCKMR,1,median, na.rm=TRUE)[1], pch=1, col=2,cex=1.25)
points(1.11,apply(SD_R0_N5000_Ind50_ckmrmultinom5,1,median, na.rm=TRUE)[1]/apply(SD_R0_N5000_Ind50_5yrs_noCKMR,1,median, na.rm=TRUE)[1], pch=1, col=3,cex=1.25)
points(1.91,apply(SD_R0_N100_Ind50_ckmrmultinom10,1,median, na.rm=TRUE)[1]/apply(SD_R0_N100_Ind50_10yrs_noCKMR,1,median, na.rm=TRUE)[1], pch=0, cex=1.25,col=1)
points(2.01,apply(SD_R0_N1000_Ind50_ckmrmultinom10,1,median, na.rm=TRUE)[1]/apply(SD_R0_N1000_Ind50_10yrs_noCKMR,1,median, na.rm=TRUE)[1], pch=0, col=2,cex=1.25)
points(2.11,apply(SD_R0_N5000_Ind50_ckmrmultinom10,1,median, na.rm=TRUE)[1]/apply(SD_R0_N5000_Ind50_10yrs_noCKMR,1,median, na.rm=TRUE)[1], pch=0, col=3,cex=1.25)
points(2.91,apply(SD_R0_N100_Ind50_ckmrmultinom20,1,median, na.rm=TRUE)[1]/apply(SD_R0_N100_Ind50_20yrs_noCKMR,1,median, na.rm=TRUE)[1], pch=2, col=1,cex=1.25)
points(3.01,apply(SD_R0_N1000_Ind50_ckmrmultinom20,1,median, na.rm=TRUE)[1]/apply(SD_R0_N1000_Ind50_20yrs_noCKMR,1,median, na.rm=TRUE)[1], pch=2, col=2,cex=1.25)
points(3.11,apply(SD_R0_N5000_Ind50_ckmrmultinom20,1,median, na.rm=TRUE)[1]/apply(SD_R0_N5000_Ind50_20yrs_noCKMR,1,median, na.rm=TRUE)[1], pch=2, col=3,cex=1.25)
#Flatfish
plot(0.9,apply(SD_M_N100_Ind50_ckmrmultinom5,1,median, na.rm=TRUE)[2]/apply(SD_M_N100_Ind50_5yrs_noCKMR,1,median, na.rm=TRUE)[2], ylim=c(0.1,1.2), las=1, ylab="", xaxt="n", pch=16, main="", xlab="",xlim=c(0.75,3.25),cex=1.25, yaxt="n", bty="n")
mtext(text="Flatfish", side=1, line=-1.05,cex=0.7, font=2)
axis(side=1,lwd.ticks = 0, labels=FALSE, at=c(0.5,3.5))
axis(side=3,lwd.ticks = 0, labels=FALSE, at=c(0.5,3.5))
abline(h=1, lty=2)
points(1,apply(SD_M_N1000_Ind50_ckmrmultinom5,1,median, na.rm=TRUE)[2]/apply(SD_M_N1000_Ind50_5yrs_noCKMR,1,median, na.rm=TRUE)[2], pch=16, col=2,cex=1.25)
points(1.1,apply(SD_M_N5000_Ind50_ckmrmultinom5,1,median, na.rm=TRUE)[2]/apply(SD_M_N5000_Ind50_5yrs_noCKMR,1,median, na.rm=TRUE)[2], pch=16, col=3,cex=1.25)
points(1.9,apply(SD_M_N100_Ind50_ckmrmultinom10,1,median, na.rm=TRUE)[2]/apply(SD_M_N100_Ind50_10yrs_noCKMR,1,median, na.rm=TRUE)[2], pch=15, cex=1.25, col=1)
points(2,apply(SD_M_N1000_Ind50_ckmrmultinom10,1,median, na.rm=TRUE)[2]/apply(SD_M_N1000_Ind50_10yrs_noCKMR,1,median, na.rm=TRUE)[2], pch=15, col=2,cex=1.25)
points(2.1,apply(SD_M_N5000_Ind50_ckmrmultinom10,1,median, na.rm=TRUE)[2]/apply(SD_M_N5000_Ind50_10yrs_noCKMR,1,median, na.rm=TRUE)[2], pch=15, col=3,cex=1.25)
points(2.9,apply(SD_M_N100_Ind50_ckmrmultinom20,1,median, na.rm=TRUE)[2]/apply(SD_M_N100_Ind50_20yrs_noCKMR,1,median, na.rm=TRUE)[2], pch=17, cex=1.25,col=1)
points(3,apply(SD_M_N1000_Ind50_ckmrmultinom20,1,median, na.rm=TRUE)[2]/apply(SD_M_N1000_Ind50_20yrs_noCKMR,1,median, na.rm=TRUE)[2], pch=17, col=2,cex=1.25)
points(3.1,apply(SD_M_N5000_Ind50_ckmrmultinom20,1,median, na.rm=TRUE)[2]/apply(SD_M_N5000_Ind50_20yrs_noCKMR,1,median, na.rm=TRUE)[2], pch=17, col=3,cex=1.25)
#R0
points(0.91,apply(SD_R0_N100_Ind50_ckmrmultinom5,1,median, na.rm=TRUE)[2]/apply(SD_R0_N100_Ind50_5yrs_noCKMR,1,median, na.rm=TRUE)[2], pch=1, cex=1.25)
points(1.01,apply(SD_R0_N1000_Ind50_ckmrmultinom5,1,median, na.rm=TRUE)[2]/apply(SD_R0_N1000_Ind50_5yrs_noCKMR,1,median, na.rm=TRUE)[2], pch=1, col=2,cex=1.25)
points(1.11,apply(SD_R0_N5000_Ind50_ckmrmultinom5,1,median, na.rm=TRUE)[2]/apply(SD_R0_N5000_Ind50_5yrs_noCKMR,1,median, na.rm=TRUE)[2], pch=1, col=3,cex=1.25)
points(1.91,apply(SD_R0_N100_Ind50_ckmrmultinom10,1,median, na.rm=TRUE)[2]/apply(SD_R0_N100_Ind50_10yrs_noCKMR,1,median, na.rm=TRUE)[2], pch=0, cex=1.25,col=1)
points(2.01,apply(SD_R0_N1000_Ind50_ckmrmultinom10,1,median, na.rm=TRUE)[2]/apply(SD_R0_N1000_Ind50_10yrs_noCKMR,1,median, na.rm=TRUE)[2], pch=0, col=2,cex=1.25)
points(2.11,apply(SD_R0_N5000_Ind50_ckmrmultinom10,1,median, na.rm=TRUE)[2]/apply(SD_R0_N5000_Ind50_10yrs_noCKMR,1,median, na.rm=TRUE)[2], pch=0, col=3,cex=1.25)
points(2.91,apply(SD_R0_N100_Ind50_ckmrmultinom20,1,median, na.rm=TRUE)[2]/apply(SD_R0_N100_Ind50_20yrs_noCKMR,1,median, na.rm=TRUE)[2], pch=2, col=1,cex=1.25)
points(3.01,apply(SD_R0_N1000_Ind50_ckmrmultinom20,1,median, na.rm=TRUE)[2]/apply(SD_R0_N1000_Ind50_20yrs_noCKMR,1,median, na.rm=TRUE)[2], pch=2, col=2,cex=1.25)
points(3.11,apply(SD_R0_N5000_Ind50_ckmrmultinom20,1,median, na.rm=TRUE)[2]/apply(SD_R0_N5000_Ind50_20yrs_noCKMR,1,median, na.rm=TRUE)[2], pch=2, col=3,cex=1.25)
#Sardine
plot(0.9,apply(SD_M_N100_Ind50_ckmrmultinom5,1,median, na.rm=TRUE)[3]/apply(SD_M_N100_Ind50_5yrs_noCKMR,1,median, na.rm=TRUE)[3], ylim=c(0.1,1.2), las=1, ylab="", xaxt="n", pch=16, main="", xlab="",xlim=c(0.75,3.25),cex=1.25,yaxt="n",bty="n")
axis(side=1,lwd.ticks = 0, labels=FALSE, at=c(0.5,3.5))
axis(side=3,lwd.ticks = 0, labels=FALSE, at=c(0.5,3.5))
mtext(text="Sardine", side=1, line=-1.05,cex=0.7, font=2)
abline(h=1, lty=2)
points(1,apply(SD_M_N1000_Ind50_ckmrmultinom5,1,median, na.rm=TRUE)[3]/apply(SD_M_N1000_Ind50_5yrs_noCKMR,1,median, na.rm=TRUE)[3], pch=16, col=2,cex=1.25)
points(1.1,apply(SD_M_N5000_Ind50_ckmrmultinom5,1,median, na.rm=TRUE)[3]/apply(SD_M_N5000_Ind50_5yrs_noCKMR,1,median, na.rm=TRUE)[3], pch=16, col=3,cex=1.25)
points(1.9,apply(SD_M_N100_Ind50_ckmrmultinom10,1,median, na.rm=TRUE)[3]/apply(SD_M_N100_Ind50_10yrs_noCKMR,1,median, na.rm=TRUE)[3], pch=15, cex=1.25, col=1)
points(2,apply(SD_M_N1000_Ind50_ckmrmultinom10,1,median, na.rm=TRUE)[3]/apply(SD_M_N1000_Ind50_10yrs_noCKMR,1,median, na.rm=TRUE)[3], pch=15, col=2,cex=1.25)
points(2.1,apply(SD_M_N5000_Ind50_ckmrmultinom10,1,median, na.rm=TRUE)[3]/apply(SD_M_N5000_Ind50_10yrs_noCKMR,1,median, na.rm=TRUE)[3], pch=15, col=3,cex=1.25)
points(2.9,apply(SD_M_N100_Ind50_ckmrmultinom20,1,median, na.rm=TRUE)[3]/apply(SD_M_N100_Ind50_20yrs_noCKMR,1,median, na.rm=TRUE)[3], pch=17, cex=1.25,col=1)
points(3,apply(SD_M_N1000_Ind50_ckmrmultinom20,1,median, na.rm=TRUE)[3]/apply(SD_M_N1000_Ind50_20yrs_noCKMR,1,median, na.rm=TRUE)[3], pch=17, col=2,cex=1.25)
points(3.1,apply(SD_M_N5000_Ind50_ckmrmultinom20,1,median, na.rm=TRUE)[3]/apply(SD_M_N5000_Ind50_20yrs_noCKMR,1,median, na.rm=TRUE)[3], pch=17, col=3,cex=1.25)
#R0
points(0.91,apply(SD_R0_N100_Ind50_ckmrmultinom5,1,median, na.rm=TRUE)[3]/apply(SD_R0_N100_Ind50_5yrs_noCKMR,1,median, na.rm=TRUE)[3], pch=1, cex=1.25)
points(1.01,apply(SD_R0_N1000_Ind50_ckmrmultinom5,1,median, na.rm=TRUE)[3]/apply(SD_R0_N1000_Ind50_5yrs_noCKMR,1,median, na.rm=TRUE)[3], pch=1, col=2,cex=1.25)
points(1.11,apply(SD_R0_N5000_Ind50_ckmrmultinom5,1,median, na.rm=TRUE)[3]/apply(SD_R0_N5000_Ind50_5yrs_noCKMR,1,median, na.rm=TRUE)[3], pch=1, col=3,cex=1.25)
points(1.91,apply(SD_R0_N100_Ind50_ckmrmultinom10,1,median, na.rm=TRUE)[3]/apply(SD_R0_N100_Ind50_10yrs_noCKMR,1,median, na.rm=TRUE)[3], pch=0, cex=1.25,col=1)
points(2.01,apply(SD_R0_N1000_Ind50_ckmrmultinom10,1,median, na.rm=TRUE)[3]/apply(SD_R0_N1000_Ind50_10yrs_noCKMR,1,median, na.rm=TRUE)[3], pch=0, col=2,cex=1.25)
points(2.11,apply(SD_R0_N5000_Ind50_ckmrmultinom10,1,median, na.rm=TRUE)[3]/apply(SD_R0_N5000_Ind50_10yrs_noCKMR,1,median, na.rm=TRUE)[3], pch=0, col=3,cex=1.25)
points(2.91,apply(SD_R0_N100_Ind50_ckmrmultinom20,1,median, na.rm=TRUE)[3]/apply(SD_R0_N100_Ind50_20yrs_noCKMR,1,median, na.rm=TRUE)[3], pch=2, col=1,cex=1.25)
points(3.01,apply(SD_R0_N1000_Ind50_ckmrmultinom20,1,median, na.rm=TRUE)[3]/apply(SD_R0_N1000_Ind50_20yrs_noCKMR,1,median, na.rm=TRUE)[3], pch=2, col=2,cex=1.25)
points(3.11,apply(SD_R0_N5000_Ind50_ckmrmultinom20,1,median, na.rm=TRUE)[3]/apply(SD_R0_N5000_Ind50_20yrs_noCKMR,1,median, na.rm=TRUE)[3], pch=2, col=3,cex=1.25)
#IQR of RE between sims
#Cod
plot(0.9,IQR_RE_M_N100_Ind50_ckmrmultinom5[1]/IQR_RE_M_N100_Ind50_5yrs_noCKMR[1], ylim=c(0.1,1.2), las=1, ylab="", xaxt="n", pch=16, main="", xlab="",xlim=c(0.75,3.25),cex=1.25, bty="n",yaxt="n")
axis(side=1,lwd.ticks = 0, labels=FALSE, at=c(0.5,3.5))
axis(side=3,lwd.ticks = 0, labels=FALSE, at=c(0.5,3.5))
mtext(text="Cod", side=1, line=-1.05,cex=0.7, font=2)
abline(h=1, lty=2)
points(1,IQR_RE_M_N1000_Ind50_ckmrmultinom5[1]/IQR_RE_M_N1000_Ind50_5yrs_noCKMR[1], pch=16, col=2,cex=1.25)
points(1.1,IQR_RE_M_N5000_Ind50_ckmrmultinom5[1]/IQR_RE_M_N5000_Ind50_5yrs_noCKMR[1], pch=16, col=3,cex=1.25)
points(1.9,IQR_RE_M_N100_Ind50_ckmrmultinom10[1]/IQR_RE_M_N100_Ind50_10yrs_noCKMR[1], pch=15, cex=1.25, col=1)
points(2,IQR_RE_M_N1000_Ind50_ckmrmultinom10[1]/IQR_RE_M_N1000_Ind50_10yrs_noCKMR[1], pch=15, col=2,cex=1.25)
points(2.1,IQR_RE_M_N5000_Ind50_ckmrmultinom10[1]/IQR_RE_M_N5000_Ind50_10yrs_noCKMR[1], pch=15, col=3,cex=1.25)
points(2.9,IQR_RE_M_N100_Ind50_ckmrmultinom20[1]/IQR_RE_M_N100_Ind50_20yrs_noCKMR[1], pch=17, cex=1.25,col=1)
points(3,IQR_RE_M_N1000_Ind50_ckmrmultinom20[1]/IQR_RE_M_N1000_Ind50_20yrs_noCKMR[1], pch=17, col=2,cex=1.25)
points(3.1,IQR_RE_M_N5000_Ind50_ckmrmultinom20[1]/IQR_RE_M_N5000_Ind50_20yrs_noCKMR[1], pch=17, col=3,cex=1.25)
#R0
points(0.91,IQR_RE_R0_N100_Ind50_ckmrmultinom5[1]/IQR_RE_R0_N100_Ind50_5yrs_noCKMR[1], pch=1, cex=1.25)
points(1.01,IQR_RE_R0_N1000_Ind50_ckmrmultinom5[1]/IQR_RE_R0_N1000_Ind50_5yrs_noCKMR[1], pch=1, col=2,cex=1.25)
points(1.11,IQR_RE_R0_N5000_Ind50_ckmrmultinom5[1]/IQR_RE_R0_N5000_Ind50_5yrs_noCKMR[1], pch=1, col=3,cex=1.25)
points(1.91,IQR_RE_R0_N100_Ind50_ckmrmultinom10[1]/IQR_RE_R0_N100_Ind50_10yrs_noCKMR[1], pch=0, cex=1.25,col=1)
points(2.01,IQR_RE_R0_N1000_Ind50_ckmrmultinom10[1]/IQR_RE_R0_N1000_Ind50_10yrs_noCKMR[1], pch=0, col=2,cex=1.25)
points(2.11,IQR_RE_R0_N5000_Ind50_ckmrmultinom10[1]/IQR_RE_R0_N5000_Ind50_10yrs_noCKMR[1], pch=0, col=3,cex=1.25)
points(2.91,IQR_RE_R0_N100_Ind50_ckmrmultinom20[1]/IQR_RE_R0_N100_Ind50_20yrs_noCKMR[1], pch=2, col=1,cex=1.25)
points(3.01,IQR_RE_R0_N1000_Ind50_ckmrmultinom20[1]/IQR_RE_R0_N1000_Ind50_20yrs_noCKMR[1], pch=2, col=2,cex=1.25)
points(3.11,IQR_RE_R0_N5000_Ind50_ckmrmultinom20[1]/IQR_RE_R0_N5000_Ind50_20yrs_noCKMR[1], pch=2, col=3,cex=1.25)
#Flatfish
plot(0.9,IQR_RE_M_N100_Ind50_ckmrmultinom5[2]/IQR_RE_M_N100_Ind50_5yrs_noCKMR[2], ylim=c(0.1,1.2), las=1, ylab="", xaxt="n", pch=16, main="", xlab="",xlim=c(0.75,3.25),cex=1.25, yaxt="n", bty="n")
mtext(text="Flatfish", side=1, line=-1.05,cex=0.7, font=2)
axis(side=1,lwd.ticks = 0, labels=FALSE, at=c(0.5,3.5))
axis(side=3,lwd.ticks = 0, labels=FALSE, at=c(0.5,3.5))
abline(h=1, lty=2)
points(1,IQR_RE_M_N1000_Ind50_ckmrmultinom5[2]/IQR_RE_M_N1000_Ind50_5yrs_noCKMR[2], pch=16, col=2,cex=1.25)
points(1.1,IQR_RE_M_N5000_Ind50_ckmrmultinom5[2]/IQR_RE_M_N5000_Ind50_5yrs_noCKMR[2], pch=16, col=3,cex=1.25)
points(1.9,IQR_RE_M_N100_Ind50_ckmrmultinom10[2]/IQR_RE_M_N100_Ind50_10yrs_noCKMR[2], pch=15, cex=1.25, col=1)
points(2,IQR_RE_M_N1000_Ind50_ckmrmultinom10[2]/IQR_RE_M_N1000_Ind50_10yrs_noCKMR[2], pch=15, col=2,cex=1.25)
points(2.1,IQR_RE_M_N5000_Ind50_ckmrmultinom10[2]/IQR_RE_M_N5000_Ind50_10yrs_noCKMR[2], pch=15, col=3,cex=1.25)
points(2.9,IQR_RE_M_N100_Ind50_ckmrmultinom20[2]/IQR_RE_M_N100_Ind50_20yrs_noCKMR[2], pch=17, cex=1.25,col=1)
points(3,IQR_RE_M_N1000_Ind50_ckmrmultinom20[2]/IQR_RE_M_N1000_Ind50_20yrs_noCKMR[2], pch=17, col=2,cex=1.25)
points(3.1,IQR_RE_M_N5000_Ind50_ckmrmultinom20[2]/IQR_RE_M_N5000_Ind50_20yrs_noCKMR[2], pch=17, col=3,cex=1.25)
#R0
points(0.91,IQR_RE_R0_N100_Ind50_ckmrmultinom5[2]/IQR_RE_R0_N100_Ind50_5yrs_noCKMR[2], pch=1, cex=1.25)
points(1.01,IQR_RE_R0_N1000_Ind50_ckmrmultinom5[2]/IQR_RE_R0_N1000_Ind50_5yrs_noCKMR[2], pch=1, col=2,cex=1.25)
points(1.11,IQR_RE_R0_N5000_Ind50_ckmrmultinom5[2]/IQR_RE_R0_N5000_Ind50_5yrs_noCKMR[2], pch=1, col=3,cex=1.25)
points(1.91,IQR_RE_R0_N100_Ind50_ckmrmultinom10[2]/IQR_RE_R0_N100_Ind50_10yrs_noCKMR[2], pch=0, cex=1.25,col=1)
points(2.01,IQR_RE_R0_N1000_Ind50_ckmrmultinom10[2]/IQR_RE_R0_N1000_Ind50_10yrs_noCKMR[2], pch=0, col=2,cex=1.25)
points(2.11,IQR_RE_R0_N5000_Ind50_ckmrmultinom10[2]/IQR_RE_R0_N5000_Ind50_10yrs_noCKMR[2], pch=0, col=3,cex=1.25)
points(2.91,IQR_RE_R0_N100_Ind50_ckmrmultinom20[2]/IQR_RE_R0_N100_Ind50_20yrs_noCKMR[2], pch=2, col=1,cex=1.25)
points(3.01,IQR_RE_R0_N1000_Ind50_ckmrmultinom20[2]/IQR_RE_R0_N1000_Ind50_20yrs_noCKMR[2], pch=2, col=2,cex=1.25)
points(3.11,IQR_RE_R0_N5000_Ind50_ckmrmultinom20[2]/IQR_RE_R0_N5000_Ind50_20yrs_noCKMR[2], pch=2, col=3,cex=1.25)
#Sardine
plot(0.9,IQR_RE_M_N100_Ind50_ckmrmultinom5[3]/IQR_RE_M_N100_Ind50_5yrs_noCKMR[3], ylim=c(0.1,1.2), las=1, ylab="", xaxt="n", pch=16, main="", xlab="",xlim=c(0.75,3.25),cex=1.25,yaxt="n",bty="n")
axis(side=1,lwd.ticks = 0, labels=FALSE, at=c(0.5,3.5))
axis(side=3,lwd.ticks = 0, labels=FALSE, at=c(0.5,3.5))
mtext(text="Sardine", side=1, line=-1.05,cex=0.7, font=2)
abline(h=1, lty=2)
points(1,IQR_RE_M_N1000_Ind50_ckmrmultinom5[3]/IQR_RE_M_N1000_Ind50_5yrs_noCKMR[3], pch=16, col=2,cex=1.25)
points(1.1,IQR_RE_M_N5000_Ind50_ckmrmultinom5[3]/IQR_RE_M_N5000_Ind50_5yrs_noCKMR[3], pch=16, col=3,cex=1.25)
points(1.9,IQR_RE_M_N100_Ind50_ckmrmultinom10[3]/IQR_RE_M_N100_Ind50_10yrs_noCKMR[3], pch=15, cex=1.25, col=1)
points(2,IQR_RE_M_N1000_Ind50_ckmrmultinom10[3]/IQR_RE_M_N1000_Ind50_10yrs_noCKMR[3], pch=15, col=2,cex=1.25)
points(2.1,IQR_RE_M_N5000_Ind50_ckmrmultinom10[3]/IQR_RE_M_N5000_Ind50_10yrs_noCKMR[3], pch=15, col=3,cex=1.25)
points(2.9,IQR_RE_M_N100_Ind50_ckmrmultinom20[3]/IQR_RE_M_N100_Ind50_20yrs_noCKMR[3], pch=17, cex=1.25,col=1)
points(3,IQR_RE_M_N1000_Ind50_ckmrmultinom20[3]/IQR_RE_M_N1000_Ind50_20yrs_noCKMR[3], pch=17, col=2,cex=1.25)
points(3.1,IQR_RE_M_N5000_Ind50_ckmrmultinom20[3]/IQR_RE_M_N5000_Ind50_20yrs_noCKMR[3], pch=17, col=3,cex=1.25)
#R0
points(0.91,IQR_RE_R0_N100_Ind50_ckmrmultinom5[3]/IQR_RE_R0_N100_Ind50_5yrs_noCKMR[3], pch=1, cex=1.25)
points(1.01,IQR_RE_R0_N1000_Ind50_ckmrmultinom5[3]/IQR_RE_R0_N1000_Ind50_5yrs_noCKMR[3], pch=1, col=2,cex=1.25)
points(1.11,IQR_RE_R0_N5000_Ind50_ckmrmultinom5[3]/IQR_RE_R0_N5000_Ind50_5yrs_noCKMR[3], pch=1, col=3,cex=1.25)
points(1.91,IQR_RE_R0_N100_Ind50_ckmrmultinom10[3]/IQR_RE_R0_N100_Ind50_10yrs_noCKMR[3], pch=0, cex=1.25,col=1)
points(2.01,IQR_RE_R0_N1000_Ind50_ckmrmultinom10[3]/IQR_RE_R0_N1000_Ind50_10yrs_noCKMR[3], pch=0, col=2,cex=1.25)
points(2.11,IQR_RE_R0_N5000_Ind50_ckmrmultinom10[3]/IQR_RE_R0_N5000_Ind50_10yrs_noCKMR[3], pch=0, col=3,cex=1.25)
points(2.91,IQR_RE_R0_N100_Ind50_ckmrmultinom20[3]/IQR_RE_R0_N100_Ind50_20yrs_noCKMR[3], pch=2, col=1,cex=1.25)
points(3.01,IQR_RE_R0_N1000_Ind50_ckmrmultinom20[3]/IQR_RE_R0_N1000_Ind50_20yrs_noCKMR[3], pch=2, col=2,cex=1.25)
points(3.11,IQR_RE_R0_N5000_Ind50_ckmrmultinom20[3]/IQR_RE_R0_N5000_Ind50_20yrs_noCKMR[3], pch=2, col=3,cex=1.25)
axis(side=1, at=1:3, labels=c("CKMR 5yrs", "CKMR 10yrs", "CKMR 20yrs"))
#Index 0.25##################
#Cod
plot(0.9,apply(abs(RE_M_N100_Ind25_ckmrmultinom5),2,median, na.rm=TRUE)[1]/apply(abs(RE_M_N100_Ind25_5yrs_noCKMR),2,median, na.rm=TRUE)[1], ylim=c(0.1,1.2), las=1, ylab="", xaxt="n", pch=16, main="", xlab="",xlim=c(0.75,3.25),cex=1.25, bty="]",yaxt="n")
abline(h=1, lty=2)
mtext(side=3, text="Index 0.25", line=-1.15, font=2)
points(1,apply(abs(RE_M_N1000_Ind25_ckmrmultinom5),2,median, na.rm=TRUE)[1]/apply(abs(RE_M_N1000_Ind25_5yrs_noCKMR),2,median, na.rm=TRUE)[1], pch=16, col=2,cex=1.25)
points(1.1,apply(abs(RE_M_N5000_Ind25_ckmrmultinom5),2,median, na.rm=TRUE)[1]/apply(abs(RE_M_N5000_Ind25_5yrs_noCKMR),2,median, na.rm=TRUE)[1], pch=16, col=3,cex=1.25)
points(1.9,apply(abs(RE_M_N100_Ind25_ckmrmultinom10),2,median, na.rm=TRUE)[1]/apply(abs(RE_M_N100_Ind25_10yrs_noCKMR),2,median, na.rm=TRUE)[1], pch=15, cex=1.25, col=1)
points(2,apply(abs(RE_M_N1000_Ind25_ckmrmultinom10),2,median, na.rm=TRUE)[1]/apply(abs(RE_M_N1000_Ind25_10yrs_noCKMR),2,median, na.rm=TRUE)[1], pch=15, col=2,cex=1.25)
points(2.1,apply(abs(RE_M_N5000_Ind25_ckmrmultinom10),2,median, na.rm=TRUE)[1]/apply(abs(RE_M_N5000_Ind25_10yrs_noCKMR),2,median, na.rm=TRUE)[1], pch=15, col=3,cex=1.25)
points(2.9,apply(abs(RE_M_N100_Ind25_ckmrmultinom20),2,median, na.rm=TRUE)[1]/apply(abs(RE_M_N100_Ind25_20yrs_noCKMR),2,median, na.rm=TRUE)[1], pch=17, cex=1.25,col=1)
points(3,apply(abs(RE_M_N1000_Ind25_ckmrmultinom20),2,median, na.rm=TRUE)[1]/apply(abs(RE_M_N1000_Ind25_20yrs_noCKMR),2,median, na.rm=TRUE)[1], pch=17, col=2,cex=1.25)
points(3.1,apply(abs(RE_M_N5000_Ind25_ckmrmultinom20),2,median, na.rm=TRUE)[1]/apply(abs(RE_M_N5000_Ind25_20yrs_noCKMR),2,median, na.rm=TRUE)[1], pch=17, col=3,cex=1.25)
#R0
points(0.91,apply(abs(RE_R0_N100_Ind25_ckmrmultinom5),2,median, na.rm=TRUE)[1]/apply(abs(RE_R0_N100_Ind25_5yrs_noCKMR),2,median, na.rm=TRUE)[1], pch=1, cex=1.25)
points(1.01,apply(abs(RE_R0_N1000_Ind25_ckmrmultinom5),2,median, na.rm=TRUE)[1]/apply(abs(RE_R0_N1000_Ind25_5yrs_noCKMR),2,median, na.rm=TRUE)[1], pch=1, col=2,cex=1.25)
points(1.11,apply(abs(RE_R0_N5000_Ind25_ckmrmultinom5),2,median, na.rm=TRUE)[1]/apply(abs(RE_R0_N5000_Ind25_5yrs_noCKMR),2,median, na.rm=TRUE)[1], pch=1, col=3,cex=1.25)
points(1.91,apply(abs(RE_R0_N100_Ind25_ckmrmultinom10),2,median, na.rm=TRUE)[1]/apply(abs(RE_R0_N100_Ind25_10yrs_noCKMR),2,median, na.rm=TRUE)[1], pch=0, cex=1.25,col=1)
points(2.01,apply(abs(RE_R0_N1000_Ind25_ckmrmultinom10),2,median, na.rm=TRUE)[1]/apply(abs(RE_R0_N1000_Ind25_10yrs_noCKMR),2,median, na.rm=TRUE)[1], pch=0, col=2,cex=1.25)
points(2.11,apply(abs(RE_R0_N5000_Ind25_ckmrmultinom10),2,median, na.rm=TRUE)[1]/apply(abs(RE_R0_N5000_Ind25_10yrs_noCKMR),2,median, na.rm=TRUE)[1], pch=0, col=3,cex=1.25)
points(2.91,apply(abs(RE_R0_N100_Ind25_ckmrmultinom20),2,median, na.rm=TRUE)[1]/apply(abs(RE_R0_N100_Ind25_20yrs_noCKMR),2,median, na.rm=TRUE)[1], pch=2, col=1,cex=1.25)
points(3.01,apply(abs(RE_R0_N1000_Ind25_ckmrmultinom20),2,median, na.rm=TRUE)[1]/apply(abs(RE_R0_N1000_Ind25_20yrs_noCKMR),2,median, na.rm=TRUE)[1], pch=2, col=2,cex=1.25)
points(3.11,apply(abs(RE_R0_N5000_Ind25_ckmrmultinom20),2,median, na.rm=TRUE)[1]/apply(abs(RE_R0_N5000_Ind25_20yrs_noCKMR),2,median, na.rm=TRUE)[1], pch=2, col=3,cex=1.25)
#Flatfish
plot(0.9,apply(abs(RE_M_N100_Ind25_ckmrmultinom5),2,median, na.rm=TRUE)[2]/apply(abs(RE_M_N100_Ind25_5yrs_noCKMR),2,median, na.rm=TRUE)[2], ylim=c(0.1,1.2), las=1, ylab="", xaxt="n", pch=16, main="", xlab="",xlim=c(0.75,3.25),cex=1.25, yaxt="n", bty="]")
axis(side=1,lwd.ticks = 0, labels=FALSE, at=c(0.5,3.5))
axis(side=3,lwd.ticks = 0, labels=FALSE, at=c(0.5,3.5))
abline(h=1, lty=2)
points(1,apply(abs(RE_M_N1000_Ind25_ckmrmultinom5),2,median, na.rm=TRUE)[2]/apply(abs(RE_M_N1000_Ind25_5yrs_noCKMR),2,median, na.rm=TRUE)[2], pch=16, col=2,cex=1.25)
points(1.1,apply(abs(RE_M_N5000_Ind25_ckmrmultinom5),2,median, na.rm=TRUE)[2]/apply(abs(RE_M_N5000_Ind25_5yrs_noCKMR),2,median, na.rm=TRUE)[2], pch=16, col=3,cex=1.25)
points(1.9,apply(abs(RE_M_N100_Ind25_ckmrmultinom10),2,median, na.rm=TRUE)[2]/apply(abs(RE_M_N100_Ind25_10yrs_noCKMR),2,median, na.rm=TRUE)[2], pch=15, cex=1.25, col=1)
points(2,apply(abs(RE_M_N1000_Ind25_ckmrmultinom10),2,median, na.rm=TRUE)[2]/apply(abs(RE_M_N1000_Ind25_10yrs_noCKMR),2,median, na.rm=TRUE)[2], pch=15, col=2,cex=1.25)
points(2.1,apply(abs(RE_M_N5000_Ind25_ckmrmultinom10),2,median, na.rm=TRUE)[2]/apply(abs(RE_M_N5000_Ind25_10yrs_noCKMR),2,median, na.rm=TRUE)[2], pch=15, col=3,cex=1.25)
points(2.9,apply(abs(RE_M_N100_Ind25_ckmrmultinom20),2,median, na.rm=TRUE)[2]/apply(abs(RE_M_N100_Ind25_20yrs_noCKMR),2,median, na.rm=TRUE)[2], pch=17, cex=1.25,col=1)
points(3,apply(abs(RE_M_N1000_Ind25_ckmrmultinom20),2,median, na.rm=TRUE)[2]/apply(abs(RE_M_N1000_Ind25_20yrs_noCKMR),2,median, na.rm=TRUE)[2], pch=17, col=2,cex=1.25)
points(3.1,apply(abs(RE_M_N5000_Ind25_ckmrmultinom20),2,median, na.rm=TRUE)[2]/apply(abs(RE_M_N5000_Ind25_20yrs_noCKMR),2,median, na.rm=TRUE)[2], pch=17, col=3,cex=1.25)
#R0
points(0.91,apply(abs(RE_R0_N100_Ind25_ckmrmultinom5),2,median, na.rm=TRUE)[2]/apply(abs(RE_R0_N100_Ind25_5yrs_noCKMR),2,median, na.rm=TRUE)[2], pch=1, cex=1.25)
points(1.01,apply(abs(RE_R0_N1000_Ind25_ckmrmultinom5),2,median, na.rm=TRUE)[2]/apply(abs(RE_R0_N1000_Ind25_5yrs_noCKMR),2,median, na.rm=TRUE)[2], pch=1, col=2,cex=1.25)
points(1.11,apply(abs(RE_R0_N5000_Ind25_ckmrmultinom5),2,median, na.rm=TRUE)[2]/apply(abs(RE_R0_N5000_Ind25_5yrs_noCKMR),2,median, na.rm=TRUE)[2], pch=1, col=3,cex=1.25)
points(1.91,apply(abs(RE_R0_N100_Ind25_ckmrmultinom10),2,median, na.rm=TRUE)[2]/apply(abs(RE_R0_N100_Ind25_10yrs_noCKMR),2,median, na.rm=TRUE)[2], pch=0, cex=1.25,col=1)
points(2.01,apply(abs(RE_R0_N1000_Ind25_ckmrmultinom10),2,median, na.rm=TRUE)[2]/apply(abs(RE_R0_N1000_Ind25_10yrs_noCKMR),2,median, na.rm=TRUE)[2], pch=0, col=2,cex=1.25)
points(2.11,apply(abs(RE_R0_N5000_Ind25_ckmrmultinom10),2,median, na.rm=TRUE)[2]/apply(abs(RE_R0_N5000_Ind25_10yrs_noCKMR),2,median, na.rm=TRUE)[2], pch=0, col=3,cex=1.25)
points(2.91,apply(abs(RE_R0_N100_Ind25_ckmrmultinom20),2,median, na.rm=TRUE)[2]/apply(abs(RE_R0_N100_Ind25_20yrs_noCKMR),2,median, na.rm=TRUE)[2], pch=2, col=1,cex=1.25)
points(3.01,apply(abs(RE_R0_N1000_Ind25_ckmrmultinom20),2,median, na.rm=TRUE)[2]/apply(abs(RE_R0_N1000_Ind25_20yrs_noCKMR),2,median, na.rm=TRUE)[2], pch=2, col=2,cex=1.25)
points(3.11,apply(abs(RE_R0_N5000_Ind25_ckmrmultinom20),2,median, na.rm=TRUE)[2]/apply(abs(RE_R0_N5000_Ind25_20yrs_noCKMR),2,median, na.rm=TRUE)[2], pch=2, col=3,cex=1.25)
#Sardine
plot(0.9,apply(abs(RE_M_N100_Ind25_ckmrmultinom5),2,median, na.rm=TRUE)[3]/apply(abs(RE_M_N100_Ind25_5yrs_noCKMR),2,median, na.rm=TRUE)[3], ylim=c(0.1,1.2), las=1, ylab="", xaxt="n", pch=16, main="", xlab="",xlim=c(0.75,3.25),cex=1.25,yaxt="n",bty="]")
abline(h=1, lty=2)
points(1,apply(abs(RE_M_N1000_Ind25_ckmrmultinom5),2,median, na.rm=TRUE)[3]/apply(abs(RE_M_N1000_Ind25_5yrs_noCKMR),2,median, na.rm=TRUE)[3], pch=16, col=2,cex=1.25)
points(1.1,apply(abs(RE_M_N5000_Ind25_ckmrmultinom5),2,median, na.rm=TRUE)[3]/apply(abs(RE_M_N5000_Ind25_5yrs_noCKMR),2,median, na.rm=TRUE)[3], pch=16, col=3,cex=1.25)
points(1.9,apply(abs(RE_M_N100_Ind25_ckmrmultinom10),2,median, na.rm=TRUE)[3]/apply(abs(RE_M_N100_Ind25_10yrs_noCKMR),2,median, na.rm=TRUE)[3], pch=15, cex=1.25, col=1)
points(2,apply(abs(RE_M_N1000_Ind25_ckmrmultinom10),2,median, na.rm=TRUE)[3]/apply(abs(RE_M_N1000_Ind25_10yrs_noCKMR),2,median, na.rm=TRUE)[3], pch=15, col=2,cex=1.25)
points(2.1,apply(abs(RE_M_N5000_Ind25_ckmrmultinom10),2,median, na.rm=TRUE)[3]/apply(abs(RE_M_N5000_Ind25_10yrs_noCKMR),2,median, na.rm=TRUE)[3], pch=15, col=3,cex=1.25)
points(2.9,apply(abs(RE_M_N100_Ind25_ckmrmultinom20),2,median, na.rm=TRUE)[3]/apply(abs(RE_M_N100_Ind25_20yrs_noCKMR),2,median, na.rm=TRUE)[3], pch=17, cex=1.25,col=1)
points(3,apply(abs(RE_M_N1000_Ind25_ckmrmultinom20),2,median, na.rm=TRUE)[3]/apply(abs(RE_M_N1000_Ind25_20yrs_noCKMR),2,median, na.rm=TRUE)[3], pch=17, col=2,cex=1.25)
points(3.1,apply(abs(RE_M_N5000_Ind25_ckmrmultinom20),2,median, na.rm=TRUE)[3]/apply(abs(RE_M_N5000_Ind25_20yrs_noCKMR),2,median, na.rm=TRUE)[3], pch=17, col=3,cex=1.25)
#R0
points(0.91,apply(abs(RE_R0_N100_Ind25_ckmrmultinom5),2,median, na.rm=TRUE)[3]/apply(abs(RE_R0_N100_Ind25_5yrs_noCKMR),2,median, na.rm=TRUE)[3], pch=1, cex=1.25)
points(1.01,apply(abs(RE_R0_N1000_Ind25_ckmrmultinom5),2,median, na.rm=TRUE)[3]/apply(abs(RE_R0_N1000_Ind25_5yrs_noCKMR),2,median, na.rm=TRUE)[3], pch=1, col=2,cex=1.25)
points(1.11,apply(abs(RE_R0_N5000_Ind25_ckmrmultinom5),2,median, na.rm=TRUE)[3]/apply(abs(RE_R0_N5000_Ind25_5yrs_noCKMR),2,median, na.rm=TRUE)[3], pch=1, col=3,cex=1.25)
points(1.91,apply(abs(RE_R0_N100_Ind25_ckmrmultinom10),2,median, na.rm=TRUE)[3]/apply(abs(RE_R0_N100_Ind25_10yrs_noCKMR),2,median, na.rm=TRUE)[3], pch=0, cex=1.25,col=1)
points(2.01,apply(abs(RE_R0_N1000_Ind25_ckmrmultinom10),2,median, na.rm=TRUE)[3]/apply(abs(RE_R0_N1000_Ind25_10yrs_noCKMR),2,median, na.rm=TRUE)[3], pch=0, col=2,cex=1.25)
points(2.11,apply(abs(RE_R0_N5000_Ind25_ckmrmultinom10),2,median, na.rm=TRUE)[3]/apply(abs(RE_R0_N5000_Ind25_10yrs_noCKMR),2,median, na.rm=TRUE)[3], pch=0, col=3,cex=1.25)
points(2.91,apply(abs(RE_R0_N100_Ind25_ckmrmultinom20),2,median, na.rm=TRUE)[3]/apply(abs(RE_R0_N100_Ind25_20yrs_noCKMR),2,median, na.rm=TRUE)[3], pch=2, col=1,cex=1.25)
points(3.01,apply(abs(RE_R0_N1000_Ind25_ckmrmultinom20),2,median, na.rm=TRUE)[3]/apply(abs(RE_R0_N1000_Ind25_20yrs_noCKMR),2,median, na.rm=TRUE)[3], pch=2, col=2,cex=1.25)
points(3.11,apply(abs(RE_R0_N5000_Ind25_ckmrmultinom20),2,median, na.rm=TRUE)[3]/apply(abs(RE_R0_N5000_Ind25_20yrs_noCKMR),2,median, na.rm=TRUE)[3], pch=2, col=3,cex=1.25)
#Median SDs of M and R0
#Cod
plot(0.9,apply(SD_M_N100_Ind25_ckmrmultinom5,1,median, na.rm=TRUE)[1]/apply(SD_M_N100_Ind25_5yrs_noCKMR,1,median, na.rm=TRUE)[1], ylim=c(0.1,1.2), las=1, ylab="", xaxt="n", pch=16, main="", xlab="",xlim=c(0.75,3.25),cex=1.25, bty="]",yaxt="n")
abline(h=1, lty=2)
points(1,apply(SD_M_N1000_Ind25_ckmrmultinom5,1,median, na.rm=TRUE)[1]/apply(SD_M_N1000_Ind25_5yrs_noCKMR,1,median, na.rm=TRUE)[1], pch=16, col=2,cex=1.25)
points(1.1,apply(SD_M_N5000_Ind25_ckmrmultinom5,1,median, na.rm=TRUE)[1]/apply(SD_M_N5000_Ind25_5yrs_noCKMR,1,median, na.rm=TRUE)[1], pch=16, col=3,cex=1.25)
points(1.9,apply(SD_M_N100_Ind25_ckmrmultinom10,1,median, na.rm=TRUE)[1]/apply(SD_M_N100_Ind25_10yrs_noCKMR,1,median, na.rm=TRUE)[1], pch=15, cex=1.25, col=1)
points(2,apply(SD_M_N1000_Ind25_ckmrmultinom10,1,median, na.rm=TRUE)[1]/apply(SD_M_N1000_Ind25_10yrs_noCKMR,1,median, na.rm=TRUE)[1], pch=15, col=2,cex=1.25)
points(2.1,apply(SD_M_N5000_Ind25_ckmrmultinom10,1,median, na.rm=TRUE)[1]/apply(SD_M_N5000_Ind25_10yrs_noCKMR,1,median, na.rm=TRUE)[1], pch=15, col=3,cex=1.25)
points(2.9,apply(SD_M_N100_Ind25_ckmrmultinom20,1,median, na.rm=TRUE)[1]/apply(SD_M_N100_Ind25_20yrs_noCKMR,1,median, na.rm=TRUE)[1], pch=17, cex=1.25,col=1)
points(3,apply(SD_M_N1000_Ind25_ckmrmultinom20,1,median, na.rm=TRUE)[1]/apply(SD_M_N1000_Ind25_20yrs_noCKMR,1,median, na.rm=TRUE)[1], pch=17, col=2,cex=1.25)
points(3.1,apply(SD_M_N5000_Ind25_ckmrmultinom20,1,median, na.rm=TRUE)[1]/apply(SD_M_N5000_Ind25_20yrs_noCKMR,1,median, na.rm=TRUE)[1], pch=17, col=3,cex=1.25)
#R0
points(0.91,apply(SD_R0_N100_Ind25_ckmrmultinom5,1,median, na.rm=TRUE)[1]/apply(SD_R0_N100_Ind25_5yrs_noCKMR,1,median, na.rm=TRUE)[1], pch=1, cex=1.25)
points(1.01,apply(SD_R0_N1000_Ind25_ckmrmultinom5,1,median, na.rm=TRUE)[1]/apply(SD_R0_N1000_Ind25_5yrs_noCKMR,1,median, na.rm=TRUE)[1], pch=1, col=2,cex=1.25)
points(1.11,apply(SD_R0_N5000_Ind25_ckmrmultinom5,1,median, na.rm=TRUE)[1]/apply(SD_R0_N5000_Ind25_5yrs_noCKMR,1,median, na.rm=TRUE)[1], pch=1, col=3,cex=1.25)
points(1.91,apply(SD_R0_N100_Ind25_ckmrmultinom10,1,median, na.rm=TRUE)[1]/apply(SD_R0_N100_Ind25_10yrs_noCKMR,1,median, na.rm=TRUE)[1], pch=0, cex=1.25,col=1)
points(2.01,apply(SD_R0_N1000_Ind25_ckmrmultinom10,1,median, na.rm=TRUE)[1]/apply(SD_R0_N1000_Ind25_10yrs_noCKMR,1,median, na.rm=TRUE)[1], pch=0, col=2,cex=1.25)
points(2.11,apply(SD_R0_N5000_Ind25_ckmrmultinom10,1,median, na.rm=TRUE)[1]/apply(SD_R0_N5000_Ind25_10yrs_noCKMR,1,median, na.rm=TRUE)[1], pch=0, col=3,cex=1.25)
points(2.91,apply(SD_R0_N100_Ind25_ckmrmultinom20,1,median, na.rm=TRUE)[1]/apply(SD_R0_N100_Ind25_20yrs_noCKMR,1,median, na.rm=TRUE)[1], pch=2, col=1,cex=1.25)
points(3.01,apply(SD_R0_N1000_Ind25_ckmrmultinom20,1,median, na.rm=TRUE)[1]/apply(SD_R0_N1000_Ind25_20yrs_noCKMR,1,median, na.rm=TRUE)[1], pch=2, col=2,cex=1.25)
points(3.11,apply(SD_R0_N5000_Ind25_ckmrmultinom20,1,median, na.rm=TRUE)[1]/apply(SD_R0_N5000_Ind25_20yrs_noCKMR,1,median, na.rm=TRUE)[1], pch=2, col=3,cex=1.25)
#Flatfish
plot(0.9,apply(SD_M_N100_Ind25_ckmrmultinom5,1,median, na.rm=TRUE)[2]/apply(SD_M_N100_Ind25_5yrs_noCKMR,1,median, na.rm=TRUE)[2], ylim=c(0.1,1.2), las=1, ylab="", xaxt="n", pch=16, main="", xlab="",xlim=c(0.75,3.25),cex=1.25, yaxt="n", bty="]")
abline(h=1, lty=2)
points(1,apply(SD_M_N1000_Ind25_ckmrmultinom5,1,median, na.rm=TRUE)[2]/apply(SD_M_N1000_Ind25_5yrs_noCKMR,1,median, na.rm=TRUE)[2], pch=16, col=2,cex=1.25)
points(1.1,apply(SD_M_N5000_Ind25_ckmrmultinom5,1,median, na.rm=TRUE)[2]/apply(SD_M_N5000_Ind25_5yrs_noCKMR,1,median, na.rm=TRUE)[2], pch=16, col=3,cex=1.25)
points(1.9,apply(SD_M_N100_Ind25_ckmrmultinom10,1,median, na.rm=TRUE)[2]/apply(SD_M_N100_Ind25_10yrs_noCKMR,1,median, na.rm=TRUE)[2], pch=15, cex=1.25, col=1)
points(2,apply(SD_M_N1000_Ind25_ckmrmultinom10,1,median, na.rm=TRUE)[2]/apply(SD_M_N1000_Ind25_10yrs_noCKMR,1,median, na.rm=TRUE)[2], pch=15, col=2,cex=1.25)
points(2.1,apply(SD_M_N5000_Ind25_ckmrmultinom10,1,median, na.rm=TRUE)[2]/apply(SD_M_N5000_Ind25_10yrs_noCKMR,1,median, na.rm=TRUE)[2], pch=15, col=3,cex=1.25)
points(2.9,apply(SD_M_N100_Ind25_ckmrmultinom20,1,median, na.rm=TRUE)[2]/apply(SD_M_N100_Ind25_20yrs_noCKMR,1,median, na.rm=TRUE)[2], pch=17, cex=1.25,col=1)
points(3,apply(SD_M_N1000_Ind25_ckmrmultinom20,1,median, na.rm=TRUE)[2]/apply(SD_M_N1000_Ind25_20yrs_noCKMR,1,median, na.rm=TRUE)[2], pch=17, col=2,cex=1.25)
points(3.1,apply(SD_M_N5000_Ind25_ckmrmultinom20,1,median, na.rm=TRUE)[2]/apply(SD_M_N5000_Ind25_20yrs_noCKMR,1,median, na.rm=TRUE)[2], pch=17, col=3,cex=1.25)
#R0
points(0.91,apply(SD_R0_N100_Ind25_ckmrmultinom5,1,median, na.rm=TRUE)[2]/apply(SD_R0_N100_Ind25_5yrs_noCKMR,1,median, na.rm=TRUE)[2], pch=1, cex=1.25)
points(1.01,apply(SD_R0_N1000_Ind25_ckmrmultinom5,1,median, na.rm=TRUE)[2]/apply(SD_R0_N1000_Ind25_5yrs_noCKMR,1,median, na.rm=TRUE)[2], pch=1, col=2,cex=1.25)
points(1.11,apply(SD_R0_N5000_Ind25_ckmrmultinom5,1,median, na.rm=TRUE)[2]/apply(SD_R0_N5000_Ind25_5yrs_noCKMR,1,median, na.rm=TRUE)[2], pch=1, col=3,cex=1.25)
points(1.91,apply(SD_R0_N100_Ind25_ckmrmultinom10,1,median, na.rm=TRUE)[2]/apply(SD_R0_N100_Ind25_10yrs_noCKMR,1,median, na.rm=TRUE)[2], pch=0, cex=1.25,col=1)
points(2.01,apply(SD_R0_N1000_Ind25_ckmrmultinom10,1,median, na.rm=TRUE)[2]/apply(SD_R0_N1000_Ind25_10yrs_noCKMR,1,median, na.rm=TRUE)[2], pch=0, col=2,cex=1.25)
points(2.11,apply(SD_R0_N5000_Ind25_ckmrmultinom10,1,median, na.rm=TRUE)[2]/apply(SD_R0_N5000_Ind25_10yrs_noCKMR,1,median, na.rm=TRUE)[2], pch=0, col=3,cex=1.25)
points(2.91,apply(SD_R0_N100_Ind25_ckmrmultinom20,1,median, na.rm=TRUE)[2]/apply(SD_R0_N100_Ind25_20yrs_noCKMR,1,median, na.rm=TRUE)[2], pch=2, col=1,cex=1.25)
points(3.01,apply(SD_R0_N1000_Ind25_ckmrmultinom20,1,median, na.rm=TRUE)[2]/apply(SD_R0_N1000_Ind25_20yrs_noCKMR,1,median, na.rm=TRUE)[2], pch=2, col=2,cex=1.25)
points(3.11,apply(SD_R0_N5000_Ind25_ckmrmultinom20,1,median, na.rm=TRUE)[2]/apply(SD_R0_N5000_Ind25_20yrs_noCKMR,1,median, na.rm=TRUE)[2], pch=2, col=3,cex=1.25)
#Sardine
plot(0.9,apply(SD_M_N100_Ind25_ckmrmultinom5,1,median, na.rm=TRUE)[3]/apply(SD_M_N100_Ind25_5yrs_noCKMR,1,median, na.rm=TRUE)[3], ylim=c(0.1,1.2), las=1, ylab="", xaxt="n", pch=16, main="", xlab="",xlim=c(0.75,3.25),cex=1.25,yaxt="n",bty="]")
abline(h=1, lty=2)
points(1,apply(SD_M_N1000_Ind25_ckmrmultinom5,1,median, na.rm=TRUE)[3]/apply(SD_M_N1000_Ind25_5yrs_noCKMR,1,median, na.rm=TRUE)[3], pch=16, col=2,cex=1.25)
points(1.1,apply(SD_M_N5000_Ind25_ckmrmultinom5,1,median, na.rm=TRUE)[3]/apply(SD_M_N5000_Ind25_5yrs_noCKMR,1,median, na.rm=TRUE)[3], pch=16, col=3,cex=1.25)
points(1.9,apply(SD_M_N100_Ind25_ckmrmultinom10,1,median, na.rm=TRUE)[3]/apply(SD_M_N100_Ind25_10yrs_noCKMR,1,median, na.rm=TRUE)[3], pch=15, cex=1.25, col=1)
points(2,apply(SD_M_N1000_Ind25_ckmrmultinom10,1,median, na.rm=TRUE)[3]/apply(SD_M_N1000_Ind25_10yrs_noCKMR,1,median, na.rm=TRUE)[3], pch=15, col=2,cex=1.25)
points(2.1,apply(SD_M_N5000_Ind25_ckmrmultinom10,1,median, na.rm=TRUE)[3]/apply(SD_M_N5000_Ind25_10yrs_noCKMR,1,median, na.rm=TRUE)[3], pch=15, col=3,cex=1.25)
points(2.9,apply(SD_M_N100_Ind25_ckmrmultinom20,1,median, na.rm=TRUE)[3]/apply(SD_M_N100_Ind25_20yrs_noCKMR,1,median, na.rm=TRUE)[3], pch=17, cex=1.25,col=1)
points(3,apply(SD_M_N1000_Ind25_ckmrmultinom20,1,median, na.rm=TRUE)[3]/apply(SD_M_N1000_Ind25_20yrs_noCKMR,1,median, na.rm=TRUE)[3], pch=17, col=2,cex=1.25)
points(3.1,apply(SD_M_N5000_Ind25_ckmrmultinom20,1,median, na.rm=TRUE)[3]/apply(SD_M_N5000_Ind25_20yrs_noCKMR,1,median, na.rm=TRUE)[3], pch=17, col=3,cex=1.25)
#R0
points(0.91,apply(SD_R0_N100_Ind25_ckmrmultinom5,1,median, na.rm=TRUE)[3]/apply(SD_R0_N100_Ind25_5yrs_noCKMR,1,median, na.rm=TRUE)[3], pch=1, cex=1.25)
points(1.01,apply(SD_R0_N1000_Ind25_ckmrmultinom5,1,median, na.rm=TRUE)[3]/apply(SD_R0_N1000_Ind25_5yrs_noCKMR,1,median, na.rm=TRUE)[3], pch=1, col=2,cex=1.25)
points(1.11,apply(SD_R0_N5000_Ind25_ckmrmultinom5,1,median, na.rm=TRUE)[3]/apply(SD_R0_N5000_Ind25_5yrs_noCKMR,1,median, na.rm=TRUE)[3], pch=1, col=3,cex=1.25)
points(1.91,apply(SD_R0_N100_Ind25_ckmrmultinom10,1,median, na.rm=TRUE)[3]/apply(SD_R0_N100_Ind25_10yrs_noCKMR,1,median, na.rm=TRUE)[3], pch=0, cex=1.25,col=1)
points(2.01,apply(SD_R0_N1000_Ind25_ckmrmultinom10,1,median, na.rm=TRUE)[3]/apply(SD_R0_N1000_Ind25_10yrs_noCKMR,1,median, na.rm=TRUE)[3], pch=0, col=2,cex=1.25)
points(2.11,apply(SD_R0_N5000_Ind25_ckmrmultinom10,1,median, na.rm=TRUE)[3]/apply(SD_R0_N5000_Ind25_10yrs_noCKMR,1,median, na.rm=TRUE)[3], pch=0, col=3,cex=1.25)
points(2.91,apply(SD_R0_N100_Ind25_ckmrmultinom20,1,median, na.rm=TRUE)[3]/apply(SD_R0_N100_Ind25_20yrs_noCKMR,1,median, na.rm=TRUE)[3], pch=2, col=1,cex=1.25)
points(3.01,apply(SD_R0_N1000_Ind25_ckmrmultinom20,1,median, na.rm=TRUE)[3]/apply(SD_R0_N1000_Ind25_20yrs_noCKMR,1,median, na.rm=TRUE)[3], pch=2, col=2,cex=1.25)
points(3.11,apply(SD_R0_N5000_Ind25_ckmrmultinom20,1,median, na.rm=TRUE)[3]/apply(SD_R0_N5000_Ind25_20yrs_noCKMR,1,median, na.rm=TRUE)[3], pch=2, col=3,cex=1.25)
#IQR of RE between sims
#Cod
#No Index
plot(0.9,IQR_RE_M_N100_Ind25_ckmrmultinom5[1]/IQR_RE_M_N100_Ind25_5yrs_noCKMR[1], ylim=c(0.1,1.2), las=1, ylab="", xaxt="n", pch=16, main="", xlab="",xlim=c(0.75,3.25),cex=1.25, bty="]",yaxt="n")
abline(h=1, lty=2)
points(1,IQR_RE_M_N1000_Ind25_ckmrmultinom5[1]/IQR_RE_M_N1000_Ind25_5yrs_noCKMR[1], pch=16, col=2,cex=1.25)
points(1.1,IQR_RE_M_N5000_Ind25_ckmrmultinom5[1]/IQR_RE_M_N5000_Ind25_5yrs_noCKMR[1], pch=16, col=3,cex=1.25)
points(1.9,IQR_RE_M_N100_Ind25_ckmrmultinom10[1]/IQR_RE_M_N100_Ind25_10yrs_noCKMR[1], pch=15, cex=1.25, col=1)
points(2,IQR_RE_M_N1000_Ind25_ckmrmultinom10[1]/IQR_RE_M_N1000_Ind25_10yrs_noCKMR[1], pch=15, col=2,cex=1.25)
points(2.1,IQR_RE_M_N5000_Ind25_ckmrmultinom10[1]/IQR_RE_M_N5000_Ind25_10yrs_noCKMR[1], pch=15, col=3,cex=1.25)
points(2.9,IQR_RE_M_N100_Ind25_ckmrmultinom20[1]/IQR_RE_M_N100_Ind25_20yrs_noCKMR[1], pch=17, cex=1.25,col=1)
points(3,IQR_RE_M_N1000_Ind25_ckmrmultinom20[1]/IQR_RE_M_N1000_Ind25_20yrs_noCKMR[1], pch=17, col=2,cex=1.25)
points(3.1,IQR_RE_M_N5000_Ind25_ckmrmultinom20[1]/IQR_RE_M_N5000_Ind25_20yrs_noCKMR[1], pch=17, col=3,cex=1.25)
#R0
points(0.91,IQR_RE_R0_N100_Ind25_ckmrmultinom5[1]/IQR_RE_R0_N100_Ind25_5yrs_noCKMR[1], pch=1, cex=1.25)
points(1.01,IQR_RE_R0_N1000_Ind25_ckmrmultinom5[1]/IQR_RE_R0_N1000_Ind25_5yrs_noCKMR[1], pch=1, col=2,cex=1.25)
points(1.11,IQR_RE_R0_N5000_Ind25_ckmrmultinom5[1]/IQR_RE_R0_N5000_Ind25_5yrs_noCKMR[1], pch=1, col=3,cex=1.25)
points(1.91,IQR_RE_R0_N100_Ind25_ckmrmultinom10[1]/IQR_RE_R0_N100_Ind25_10yrs_noCKMR[1], pch=0, cex=1.25,col=1)
points(2.01,IQR_RE_R0_N1000_Ind25_ckmrmultinom10[1]/IQR_RE_R0_N1000_Ind25_10yrs_noCKMR[1], pch=0, col=2,cex=1.25)
points(2.11,IQR_RE_R0_N5000_Ind25_ckmrmultinom10[1]/IQR_RE_R0_N5000_Ind25_10yrs_noCKMR[1], pch=0, col=3,cex=1.25)
points(2.91,IQR_RE_R0_N100_Ind25_ckmrmultinom20[1]/IQR_RE_R0_N100_Ind25_20yrs_noCKMR[1], pch=2, col=1,cex=1.25)
points(3.01,IQR_RE_R0_N1000_Ind25_ckmrmultinom20[1]/IQR_RE_R0_N1000_Ind25_20yrs_noCKMR[1], pch=2, col=2,cex=1.25)
points(3.11,IQR_RE_R0_N5000_Ind25_ckmrmultinom20[1]/IQR_RE_R0_N5000_Ind25_20yrs_noCKMR[1], pch=2, col=3,cex=1.25)
#Flatfish
plot(0.9,IQR_RE_M_N100_Ind25_ckmrmultinom5[2]/IQR_RE_M_N100_Ind25_5yrs_noCKMR[2], ylim=c(0.1,1.2), las=1, ylab="", xaxt="n", pch=16, main="", xlab="",xlim=c(0.75,3.25),cex=1.25, yaxt="n", bty="]")
abline(h=1, lty=2)
points(1,IQR_RE_M_N1000_Ind25_ckmrmultinom5[2]/IQR_RE_M_N1000_Ind25_5yrs_noCKMR[2], pch=16, col=2,cex=1.25)
points(1.1,IQR_RE_M_N5000_Ind25_ckmrmultinom5[2]/IQR_RE_M_N5000_Ind25_5yrs_noCKMR[2], pch=16, col=3,cex=1.25)
points(1.9,IQR_RE_M_N100_Ind25_ckmrmultinom10[2]/IQR_RE_M_N100_Ind25_10yrs_noCKMR[2], pch=15, cex=1.25, col=1)
points(2,IQR_RE_M_N1000_Ind25_ckmrmultinom10[2]/IQR_RE_M_N1000_Ind25_10yrs_noCKMR[2], pch=15, col=2,cex=1.25)
points(2.1,IQR_RE_M_N5000_Ind25_ckmrmultinom10[2]/IQR_RE_M_N5000_Ind25_10yrs_noCKMR[2], pch=15, col=3,cex=1.25)
points(2.9,IQR_RE_M_N100_Ind25_ckmrmultinom20[2]/IQR_RE_M_N100_Ind25_20yrs_noCKMR[2], pch=17, cex=1.25,col=1)
points(3,IQR_RE_M_N1000_Ind25_ckmrmultinom20[2]/IQR_RE_M_N1000_Ind25_20yrs_noCKMR[2], pch=17, col=2,cex=1.25)
points(3.1,IQR_RE_M_N5000_Ind25_ckmrmultinom20[2]/IQR_RE_M_N5000_Ind25_20yrs_noCKMR[2], pch=17, col=3,cex=1.25)
#R0
points(0.91,IQR_RE_R0_N100_Ind25_ckmrmultinom5[2]/IQR_RE_R0_N100_Ind25_5yrs_noCKMR[2], pch=1, cex=1.25)
points(1.01,IQR_RE_R0_N1000_Ind25_ckmrmultinom5[2]/IQR_RE_R0_N1000_Ind25_5yrs_noCKMR[2], pch=1, col=2,cex=1.25)
points(1.11,IQR_RE_R0_N5000_Ind25_ckmrmultinom5[2]/IQR_RE_R0_N5000_Ind25_5yrs_noCKMR[2], pch=1, col=3,cex=1.25)
points(1.91,IQR_RE_R0_N100_Ind25_ckmrmultinom10[2]/IQR_RE_R0_N100_Ind25_10yrs_noCKMR[2], pch=0, cex=1.25,col=1)
points(2.01,IQR_RE_R0_N1000_Ind25_ckmrmultinom10[2]/IQR_RE_R0_N1000_Ind25_10yrs_noCKMR[2], pch=0, col=2,cex=1.25)
points(2.11,IQR_RE_R0_N5000_Ind25_ckmrmultinom10[2]/IQR_RE_R0_N5000_Ind25_10yrs_noCKMR[2], pch=0, col=3,cex=1.25)
points(2.91,IQR_RE_R0_N100_Ind25_ckmrmultinom20[2]/IQR_RE_R0_N100_Ind25_20yrs_noCKMR[2], pch=2, col=1,cex=1.25)
points(3.01,IQR_RE_R0_N1000_Ind25_ckmrmultinom20[2]/IQR_RE_R0_N1000_Ind25_20yrs_noCKMR[2], pch=2, col=2,cex=1.25)
points(3.11,IQR_RE_R0_N5000_Ind25_ckmrmultinom20[2]/IQR_RE_R0_N5000_Ind25_20yrs_noCKMR[2], pch=2, col=3,cex=1.25)
#Sardine
plot(0.9,IQR_RE_M_N100_Ind25_ckmrmultinom5[3]/IQR_RE_M_N100_Ind25_5yrs_noCKMR[3], ylim=c(0.1,1.2), las=1, ylab="", xaxt="n", pch=16, main="", xlab="",xlim=c(0.75,3.25),cex=1.25,yaxt="n",bty="]")
abline(h=1, lty=2)
points(1,IQR_RE_M_N1000_Ind25_ckmrmultinom5[3]/IQR_RE_M_N1000_Ind25_5yrs_noCKMR[3], pch=16, col=2,cex=1.25)
points(1.1,IQR_RE_M_N5000_Ind25_ckmrmultinom5[3]/IQR_RE_M_N5000_Ind25_5yrs_noCKMR[3], pch=16, col=3,cex=1.25)
points(1.9,IQR_RE_M_N100_Ind25_ckmrmultinom10[3]/IQR_RE_M_N100_Ind25_10yrs_noCKMR[3], pch=15, cex=1.25, col=1)
points(2,IQR_RE_M_N1000_Ind25_ckmrmultinom10[3]/IQR_RE_M_N1000_Ind25_10yrs_noCKMR[3], pch=15, col=2,cex=1.25)
points(2.1,IQR_RE_M_N5000_Ind25_ckmrmultinom10[3]/IQR_RE_M_N5000_Ind25_10yrs_noCKMR[3], pch=15, col=3,cex=1.25)
points(2.9,IQR_RE_M_N100_Ind25_ckmrmultinom20[3]/IQR_RE_M_N100_Ind25_20yrs_noCKMR[3], pch=17, cex=1.25,col=1)
points(3,IQR_RE_M_N1000_Ind25_ckmrmultinom20[3]/IQR_RE_M_N1000_Ind25_20yrs_noCKMR[3], pch=17, col=2,cex=1.25)
points(3.1,IQR_RE_M_N5000_Ind25_ckmrmultinom20[3]/IQR_RE_M_N5000_Ind25_20yrs_noCKMR[3], pch=17, col=3,cex=1.25)
#R0
points(0.91,IQR_RE_R0_N100_Ind25_ckmrmultinom5[3]/IQR_RE_R0_N100_Ind25_5yrs_noCKMR[3], pch=1, cex=1.25)
points(1.01,IQR_RE_R0_N1000_Ind25_ckmrmultinom5[3]/IQR_RE_R0_N1000_Ind25_5yrs_noCKMR[3], pch=1, col=2,cex=1.25)
points(1.11,IQR_RE_R0_N5000_Ind25_ckmrmultinom5[3]/IQR_RE_R0_N5000_Ind25_5yrs_noCKMR[3], pch=1, col=3,cex=1.25)
points(1.91,IQR_RE_R0_N100_Ind25_ckmrmultinom10[3]/IQR_RE_R0_N100_Ind25_10yrs_noCKMR[3], pch=0, cex=1.25,col=1)
points(2.01,IQR_RE_R0_N1000_Ind25_ckmrmultinom10[3]/IQR_RE_R0_N1000_Ind25_10yrs_noCKMR[3], pch=0, col=2,cex=1.25)
points(2.11,IQR_RE_R0_N5000_Ind25_ckmrmultinom10[3]/IQR_RE_R0_N5000_Ind25_10yrs_noCKMR[3], pch=0, col=3,cex=1.25)
points(2.91,IQR_RE_R0_N100_Ind25_ckmrmultinom20[3]/IQR_RE_R0_N100_Ind25_20yrs_noCKMR[3], pch=2, col=1,cex=1.25)
points(3.01,IQR_RE_R0_N1000_Ind25_ckmrmultinom20[3]/IQR_RE_R0_N1000_Ind25_20yrs_noCKMR[3], pch=2, col=2,cex=1.25)
points(3.11,IQR_RE_R0_N5000_Ind25_ckmrmultinom20[3]/IQR_RE_R0_N5000_Ind25_20yrs_noCKMR[3], pch=2, col=3,cex=1.25)
axis(side=1, at=1:3, labels=c("CKMR 5yrs", "CKMR 10yrs", "CKMR 20yrs"))
#dev.off()



