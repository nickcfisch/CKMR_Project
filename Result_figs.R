
####################################################
#Looking at Kinship results
####################################################

#wd<-"C:/Users/nfisch/Documents/GitHub/CKMR_Project/"

#Ncomp 100, sdindex 0.25, ckmr 5 years
load(paste0(wd,"/Cod_wdat_N100_Ind25_ckmrmultinom5_1.RData"))
load(paste0(wd,"/Flatfish_wdat_N100_Ind25_ckmrmultinom5_1.RData"))
load(paste0(wd,"/Sardine_wdat_N100_Ind25_ckmrmultinom5_1.RData"))

Cod_100_25_5<-Cod_wdat
Flatfish_100_25_5<-Flatfish_wdat
Sardine_100_25_5<-Sardine_wdat

#Ncomp 1000, sdindex 0.25, ckmr 5 years
load(paste0(wd,"/Cod_wdat_N1000_Ind25_ckmrmultinom5_1.RData"))
load(paste0(wd,"/Flatfish_wdat_N1000_Ind25_ckmrmultinom5_1.RData"))
load(paste0(wd,"/Sardine_wdat_N1000_Ind25_ckmrmultinom5_1.RData"))

Cod_1000_25_5<-Cod_wdat
Flatfish_1000_25_5<-Flatfish_wdat
Sardine_1000_25_5<-Sardine_wdat

#Ncomp 5000, sdindex 0.25, ckmr 5 years
load(paste0(wd,"/Cod_wdat_N5000_Ind25_ckmrmultinom5_1.RData"))
load(paste0(wd,"/Flatfish_wdat_N5000_Ind25_ckmrmultinom5_1.RData"))
load(paste0(wd,"/Sardine_wdat_N5000_Ind25_ckmrmultinom5_1.RData"))

Cod_5000_25_5<-Cod_wdat
Flatfish_5000_25_5<-Flatfish_wdat
Sardine_5000_25_5<-Sardine_wdat

#Ncomp 100, sdindex 0.25, ckmr 10 years
load(paste0(wd,"/Cod_wdat_N100_Ind25_ckmrmultinom10_1.RData"))
load(paste0(wd,"/Flatfish_wdat_N100_Ind25_ckmrmultinom10_1.RData"))
load(paste0(wd,"/Sardine_wdat_N100_Ind25_ckmrmultinom10_1.RData"))

Cod_100_25_10<-Cod_wdat
Flatfish_100_25_10<-Flatfish_wdat
Sardine_100_25_10<-Sardine_wdat

#Ncomp 1000, sdindex 0.25, ckmr 10 years
load(paste0(wd,"/Cod_wdat_N1000_Ind25_ckmrmultinom10_1.RData"))
load(paste0(wd,"/Flatfish_wdat_N1000_Ind25_ckmrmultinom10_1.RData"))
load(paste0(wd,"/Sardine_wdat_N1000_Ind25_ckmrmultinom10_1.RData"))

Cod_1000_25_10<-Cod_wdat
Flatfish_1000_25_10<-Flatfish_wdat
Sardine_1000_25_10<-Sardine_wdat

#Ncomp 5000, sdindex 0.25, ckmr 10 years
load(paste0(wd,"/Cod_wdat_N5000_Ind25_ckmrmultinom10_1.RData"))
load(paste0(wd,"/Flatfish_wdat_N5000_Ind25_ckmrmultinom10_1.RData"))
load(paste0(wd,"/Sardine_wdat_N5000_Ind25_ckmrmultinom10_1.RData"))

Cod_5000_25_10<-Cod_wdat
Flatfish_5000_25_10<-Flatfish_wdat
Sardine_5000_25_10<-Sardine_wdat

#Ncomp 100, sdindex 0.25, ckmr 20 years
load(paste0(wd,"/Cod_wdat_N100_Ind25_ckmrmultinom20_1.RData"))
load(paste0(wd,"/Flatfish_wdat_N100_Ind25_ckmrmultinom20_1.RData"))
load(paste0(wd,"/Sardine_wdat_N100_Ind25_ckmrmultinom20_1.RData"))

Cod_100_25_20<-Cod_wdat
Flatfish_100_25_20<-Flatfish_wdat
Sardine_100_25_20<-Sardine_wdat

#Ncomp 1000, sdindex 0.25, ckmr 20 years
load(paste0(wd,"/Cod_wdat_N1000_Ind25_ckmrmultinom20_1.RData"))
load(paste0(wd,"/Flatfish_wdat_N1000_Ind25_ckmrmultinom20_1.RData"))
load(paste0(wd,"/Sardine_wdat_N1000_Ind25_ckmrmultinom20_1.RData"))

Cod_1000_25_20<-Cod_wdat
Flatfish_1000_25_20<-Flatfish_wdat
Sardine_1000_25_20<-Sardine_wdat

#Ncomp 5000, sdindex 0.25, ckmr 20 years
load(paste0(wd,"/Cod_wdat_N5000_Ind25_ckmrmultinom20_1.RData"))
load(paste0(wd,"/Flatfish_wdat_N5000_Ind25_ckmrmultinom20_1.RData"))
load(paste0(wd,"/Sardine_wdat_N5000_Ind25_ckmrmultinom20_1.RData"))

Cod_5000_25_20<-Cod_wdat
Flatfish_5000_25_20<-Flatfish_wdat
Sardine_5000_25_20<-Sardine_wdat

#Ncomp 100, sdindex 0.50, ckmr 5 years
load(paste0(wd,"/Cod_wdat_N100_Ind50_ckmrmultinom5_1.RData"))
load(paste0(wd,"/Flatfish_wdat_N100_Ind50_ckmrmultinom5_1.RData"))
load(paste0(wd,"/Sardine_wdat_N100_Ind50_ckmrmultinom5_1.RData"))

Cod_100_50_5<-Cod_wdat
Flatfish_100_50_5<-Flatfish_wdat
Sardine_100_50_5<-Sardine_wdat

#Ncomp 1000, sdindex 0.50, ckmr 5 years
load(paste0(wd,"/Cod_wdat_N1000_Ind50_ckmrmultinom5_1.RData"))
load(paste0(wd,"/Flatfish_wdat_N1000_Ind50_ckmrmultinom5_1.RData"))
load(paste0(wd,"/Sardine_wdat_N1000_Ind50_ckmrmultinom5_1.RData"))

Cod_1000_50_5<-Cod_wdat
Flatfish_1000_50_5<-Flatfish_wdat
Sardine_1000_50_5<-Sardine_wdat

#Ncomp 5000, sdindex 0.50, ckmr 5 years
load(paste0(wd,"/Cod_wdat_N5000_Ind50_ckmrmultinom5_1.RData"))
load(paste0(wd,"/Flatfish_wdat_N5000_Ind50_ckmrmultinom5_1.RData"))
load(paste0(wd,"/Sardine_wdat_N5000_Ind50_ckmrmultinom5_1.RData"))

Cod_5000_50_5<-Cod_wdat
Flatfish_5000_50_5<-Flatfish_wdat
Sardine_5000_50_5<-Sardine_wdat

#Ncomp 100, sdindex 0.50, ckmr 10 years
load(paste0(wd,"/Cod_wdat_N100_Ind50_ckmrmultinom10_1.RData"))
load(paste0(wd,"/Flatfish_wdat_N100_Ind50_ckmrmultinom10_1.RData"))
load(paste0(wd,"/Sardine_wdat_N100_Ind50_ckmrmultinom10_1.RData"))

Cod_100_50_10<-Cod_wdat
Flatfish_100_50_10<-Flatfish_wdat
Sardine_100_50_10<-Sardine_wdat

#Ncomp 1000, sdindex 0.50, ckmr 10 years
load(paste0(wd,"/Cod_wdat_N1000_Ind50_ckmrmultinom10_1.RData"))
load(paste0(wd,"/Flatfish_wdat_N1000_Ind50_ckmrmultinom10_1.RData"))
load(paste0(wd,"/Sardine_wdat_N1000_Ind50_ckmrmultinom10_1.RData"))

Cod_1000_50_10<-Cod_wdat
Flatfish_1000_50_10<-Flatfish_wdat
Sardine_1000_50_10<-Sardine_wdat

#Ncomp 5000, sdindex 0.50, ckmr 10 years
load(paste0(wd,"/Cod_wdat_N5000_Ind50_ckmrmultinom10_1.RData"))
load(paste0(wd,"/Flatfish_wdat_N5000_Ind50_ckmrmultinom10_1.RData"))
load(paste0(wd,"/Sardine_wdat_N5000_Ind50_ckmrmultinom10_1.RData"))

Cod_5000_50_10<-Cod_wdat
Flatfish_5000_50_10<-Flatfish_wdat
Sardine_5000_50_10<-Sardine_wdat

#Ncomp 100, sdindex 0.50, ckmr 20 years
load(paste0(wd,"/Cod_wdat_N100_Ind50_ckmrmultinom20_1.RData"))
load(paste0(wd,"/Flatfish_wdat_N100_Ind50_ckmrmultinom20_1.RData"))
load(paste0(wd,"/Sardine_wdat_N100_Ind50_ckmrmultinom20_1.RData"))

Cod_100_50_20<-Cod_wdat
Flatfish_100_50_20<-Flatfish_wdat
Sardine_100_50_20<-Sardine_wdat

#Ncomp 1000, sdindex 0.50, ckmr 20 years
load(paste0(wd,"/Cod_wdat_N1000_Ind50_ckmrmultinom20_1.RData"))
load(paste0(wd,"/Flatfish_wdat_N1000_Ind50_ckmrmultinom20_1.RData"))
load(paste0(wd,"/Sardine_wdat_N1000_Ind50_ckmrmultinom20_1.RData"))

Cod_1000_50_20<-Cod_wdat
Flatfish_1000_50_20<-Flatfish_wdat
Sardine_1000_50_20<-Sardine_wdat

#Ncomp 5000, sdindex 0.50, ckmr 20 years
load(paste0(wd,"/Cod_wdat_N5000_Ind50_ckmrmultinom20_1.RData"))
load(paste0(wd,"/Flatfish_wdat_N5000_Ind50_ckmrmultinom20_1.RData"))
load(paste0(wd,"/Sardine_wdat_N5000_Ind50_ckmrmultinom20_1.RData"))

Cod_5000_50_20<-Cod_wdat
Flatfish_5000_50_20<-Flatfish_wdat
Sardine_5000_50_20<-Sardine_wdat

#############################################
#Looking at the number of pairs by treatment 
#############################################
#Getting it into more usable data 
Pairs_Cod_100_25_5<-Pairs_Cod_1000_25_5<-Pairs_Cod_5000_25_5<-matrix(NA, nrow=100,ncol=2)
Pairs_Cod_100_25_10<-Pairs_Cod_1000_25_10<-Pairs_Cod_5000_25_10<-matrix(NA, nrow=100,ncol=2)
Pairs_Cod_100_25_20<-Pairs_Cod_1000_25_20<-Pairs_Cod_5000_25_20<-matrix(NA, nrow=100,ncol=2)
Pairs_Flatfish_100_25_5<-Pairs_Flatfish_1000_25_5<-Pairs_Flatfish_5000_25_5<-matrix(NA, nrow=100,ncol=2)
Pairs_Flatfish_100_25_10<-Pairs_Flatfish_1000_25_10<-Pairs_Flatfish_5000_25_10<-matrix(NA, nrow=100,ncol=2)
Pairs_Flatfish_100_25_20<-Pairs_Flatfish_1000_25_20<-Pairs_Flatfish_5000_25_20<-matrix(NA, nrow=100,ncol=2)
Pairs_Sardine_100_25_5<-Pairs_Sardine_1000_25_5<-Pairs_Sardine_5000_25_5<-matrix(NA, nrow=100,ncol=2)
Pairs_Sardine_100_25_10<-Pairs_Sardine_1000_25_10<-Pairs_Sardine_5000_25_10<-matrix(NA, nrow=100,ncol=2)
Pairs_Sardine_100_25_20<-Pairs_Sardine_1000_25_20<-Pairs_Sardine_5000_25_20<-matrix(NA, nrow=100,ncol=2)
Pairs_Cod_100_25_5_HSPnoGGP<-Pairs_Cod_1000_25_5_HSPnoGGP<-Pairs_Cod_5000_25_5_HSPnoGGP<-Pairs_Cod_100_25_10_HSPnoGGP<-Pairs_Cod_1000_25_10_HSPnoGGP<-NA
Pairs_Cod_5000_25_10_HSPnoGGP<-Pairs_Cod_100_25_20_HSPnoGGP<-Pairs_Cod_1000_25_20_HSPnoGGP<-Pairs_Cod_5000_25_20_HSPnoGGP<-NA
Pairs_Flatfish_100_25_5_HSPnoGGP<-Pairs_Flatfish_1000_25_5_HSPnoGGP<-Pairs_Flatfish_5000_25_5_HSPnoGGP<-NA
Pairs_Flatfish_100_25_10_HSPnoGGP<-Pairs_Flatfish_1000_25_10_HSPnoGGP<-Pairs_Flatfish_5000_25_10_HSPnoGGP<-NA
Pairs_Flatfish_100_25_20_HSPnoGGP<-Pairs_Flatfish_1000_25_20_HSPnoGGP<-Pairs_Flatfish_5000_25_20_HSPnoGGP<-NA
Pairs_Sardine_100_25_5_HSPnoGGP<-Pairs_Sardine_1000_25_5_HSPnoGGP<-Pairs_Sardine_5000_25_5_HSPnoGGP<-NA
Pairs_Sardine_100_25_10_HSPnoGGP<-Pairs_Sardine_1000_25_10_HSPnoGGP<-Pairs_Sardine_5000_25_10_HSPnoGGP<-NA
Pairs_Sardine_100_25_20_HSPnoGGP<-Pairs_Sardine_1000_25_20_HSPnoGGP<-Pairs_Sardine_5000_25_20_HSPnoGGP<-NA
for (i in 1:100){
 Pairs_Cod_100_25_5[i,1]<-(sum(Cod_100_25_5[[i]]$k_ckmr_pop))
 Pairs_Cod_100_25_5[i,2]<-(sum(Cod_100_25_5[[i]]$k_ckmr_hsp))
 Pairs_Cod_100_25_5_HSPnoGGP[i]<-(sum(Cod_100_25_5[[i]]$k_ckmr_hsp[which(Cod_100_25_5[[i]]$age_diff<(1.51*2))]))
 Pairs_Cod_1000_25_5[i,1]<-(sum(Cod_1000_25_5[[i]]$k_ckmr_pop))
 Pairs_Cod_1000_25_5[i,2]<-(sum(Cod_1000_25_5[[i]]$k_ckmr_hsp))
 Pairs_Cod_1000_25_5_HSPnoGGP[i]<-(sum(Cod_1000_25_5[[i]]$k_ckmr_hsp[which(Cod_1000_25_5[[i]]$age_diff<(1.51*2))]))
 Pairs_Cod_5000_25_5[i,1]<-(sum(Cod_5000_25_5[[i]]$k_ckmr_pop))
 Pairs_Cod_5000_25_5[i,2]<-(sum(Cod_5000_25_5[[i]]$k_ckmr_hsp))
 Pairs_Cod_5000_25_5_HSPnoGGP[i]<-(sum(Cod_5000_25_5[[i]]$k_ckmr_hsp[which(Cod_5000_25_5[[i]]$age_diff<(1.51*2))]))
 
 Pairs_Cod_100_25_10[i,1]<-(sum(Cod_100_25_10[[i]]$k_ckmr_pop))
 Pairs_Cod_100_25_10[i,2]<-(sum(Cod_100_25_10[[i]]$k_ckmr_hsp))
 Pairs_Cod_100_25_10_HSPnoGGP[i]<-(sum(Cod_100_25_10[[i]]$k_ckmr_hsp[which(Cod_100_25_10[[i]]$age_diff<(1.51*2))]))
 Pairs_Cod_1000_25_10[i,1]<-(sum(Cod_1000_25_10[[i]]$k_ckmr_pop))
 Pairs_Cod_1000_25_10[i,2]<-(sum(Cod_1000_25_10[[i]]$k_ckmr_hsp))
 Pairs_Cod_1000_25_10_HSPnoGGP[i]<-(sum(Cod_1000_25_10[[i]]$k_ckmr_hsp[which(Cod_1000_25_10[[i]]$age_diff<(1.51*2))]))
 Pairs_Cod_5000_25_10[i,1]<-(sum(Cod_5000_25_10[[i]]$k_ckmr_pop))
 Pairs_Cod_5000_25_10[i,2]<-(sum(Cod_5000_25_10[[i]]$k_ckmr_hsp))
 Pairs_Cod_5000_25_10_HSPnoGGP[i]<-(sum(Cod_5000_25_10[[i]]$k_ckmr_hsp[which(Cod_5000_25_10[[i]]$age_diff<(1.51*2))]))
 
 Pairs_Cod_100_25_20[i,1]<-(sum(Cod_100_25_20[[i]]$k_ckmr_pop))
 Pairs_Cod_100_25_20[i,2]<-(sum(Cod_100_25_20[[i]]$k_ckmr_hsp))
 Pairs_Cod_100_25_20_HSPnoGGP[i]<-(sum(Cod_100_25_20[[i]]$k_ckmr_hsp[which(Cod_100_25_20[[i]]$age_diff<(1.51*2))]))
 Pairs_Cod_1000_25_20[i,1]<-(sum(Cod_1000_25_20[[i]]$k_ckmr_pop))
 Pairs_Cod_1000_25_20[i,2]<-(sum(Cod_1000_25_20[[i]]$k_ckmr_hsp))
 Pairs_Cod_1000_25_20_HSPnoGGP[i]<-(sum(Cod_1000_25_20[[i]]$k_ckmr_hsp[which(Cod_1000_25_20[[i]]$age_diff<(1.51*2))]))
 Pairs_Cod_5000_25_20[i,1]<-(sum(Cod_5000_25_20[[i]]$k_ckmr_pop))
 Pairs_Cod_5000_25_20[i,2]<-(sum(Cod_5000_25_20[[i]]$k_ckmr_hsp))
 Pairs_Cod_5000_25_20_HSPnoGGP[i]<-(sum(Cod_5000_25_20[[i]]$k_ckmr_hsp[which(Cod_5000_25_20[[i]]$age_diff<(1.51*2))]))
 
 Pairs_Flatfish_100_25_5[i,1]<-(sum(Flatfish_100_25_5[[i]]$k_ckmr_pop))
 Pairs_Flatfish_100_25_5[i,2]<-(sum(Flatfish_100_25_5[[i]]$k_ckmr_hsp))
 Pairs_Flatfish_100_25_5_HSPnoGGP[i]<-(sum(Flatfish_100_25_5[[i]]$k_ckmr_hsp[which(Flatfish_100_25_5[[i]]$age_diff<(2.4*2))]))
 Pairs_Flatfish_1000_25_5[i,1]<-(sum(Flatfish_1000_25_5[[i]]$k_ckmr_pop))
 Pairs_Flatfish_1000_25_5[i,2]<-(sum(Flatfish_1000_25_5[[i]]$k_ckmr_hsp))
 Pairs_Flatfish_1000_25_5_HSPnoGGP[i]<-(sum(Flatfish_1000_25_5[[i]]$k_ckmr_hsp[which(Flatfish_1000_25_5[[i]]$age_diff<(2.4*2))]))
 Pairs_Flatfish_5000_25_5[i,1]<-(sum(Flatfish_5000_25_5[[i]]$k_ckmr_pop))
 Pairs_Flatfish_5000_25_5[i,2]<-(sum(Flatfish_5000_25_5[[i]]$k_ckmr_hsp))
 Pairs_Flatfish_5000_25_5_HSPnoGGP[i]<-(sum(Flatfish_5000_25_5[[i]]$k_ckmr_hsp[which(Flatfish_5000_25_5[[i]]$age_diff<(2.4*2))]))
 
 Pairs_Flatfish_100_25_10[i,1]<-(sum(Flatfish_100_25_10[[i]]$k_ckmr_pop))
 Pairs_Flatfish_100_25_10[i,2]<-(sum(Flatfish_100_25_10[[i]]$k_ckmr_hsp))
 Pairs_Flatfish_100_25_10_HSPnoGGP[i]<-(sum(Flatfish_100_25_10[[i]]$k_ckmr_hsp[which(Flatfish_100_25_10[[i]]$age_diff<(2.4*2))]))
 Pairs_Flatfish_1000_25_10[i,1]<-(sum(Flatfish_1000_25_10[[i]]$k_ckmr_pop))
 Pairs_Flatfish_1000_25_10[i,2]<-(sum(Flatfish_1000_25_10[[i]]$k_ckmr_hsp))
 Pairs_Flatfish_1000_25_10_HSPnoGGP[i]<-(sum(Flatfish_1000_25_10[[i]]$k_ckmr_hsp[which(Flatfish_1000_25_10[[i]]$age_diff<(2.4*2))]))
 Pairs_Flatfish_5000_25_10[i,1]<-(sum(Flatfish_5000_25_10[[i]]$k_ckmr_pop))
 Pairs_Flatfish_5000_25_10[i,2]<-(sum(Flatfish_5000_25_10[[i]]$k_ckmr_hsp))
 Pairs_Flatfish_5000_25_10_HSPnoGGP[i]<-(sum(Flatfish_5000_25_10[[i]]$k_ckmr_hsp[which(Flatfish_5000_25_10[[i]]$age_diff<(2.4*2))]))
 
 Pairs_Flatfish_100_25_20[i,1]<-(sum(Flatfish_100_25_20[[i]]$k_ckmr_pop))
 Pairs_Flatfish_100_25_20[i,2]<-(sum(Flatfish_100_25_20[[i]]$k_ckmr_hsp))
 Pairs_Flatfish_100_25_20_HSPnoGGP[i]<-(sum(Flatfish_100_25_20[[i]]$k_ckmr_hsp[which(Flatfish_100_25_20[[i]]$age_diff<(2.4*2))]))
 Pairs_Flatfish_1000_25_20[i,1]<-(sum(Flatfish_1000_25_20[[i]]$k_ckmr_pop))
 Pairs_Flatfish_1000_25_20[i,2]<-(sum(Flatfish_1000_25_20[[i]]$k_ckmr_hsp))
 Pairs_Flatfish_1000_25_20_HSPnoGGP[i]<-(sum(Flatfish_1000_25_20[[i]]$k_ckmr_hsp[which(Flatfish_1000_25_20[[i]]$age_diff<(2.4*2))]))
 Pairs_Flatfish_5000_25_20[i,1]<-(sum(Flatfish_5000_25_20[[i]]$k_ckmr_pop))
 Pairs_Flatfish_5000_25_20[i,2]<-(sum(Flatfish_5000_25_20[[i]]$k_ckmr_hsp))
 Pairs_Flatfish_5000_25_20_HSPnoGGP[i]<-(sum(Flatfish_5000_25_20[[i]]$k_ckmr_hsp[which(Flatfish_5000_25_20[[i]]$age_diff<(2.4*2))]))
 
 Pairs_Sardine_100_25_5[i,1]<-(sum(Sardine_100_25_5[[i]]$k_ckmr_pop))
 Pairs_Sardine_100_25_5[i,2]<-(sum(Sardine_100_25_5[[i]]$k_ckmr_hsp))
 Pairs_Sardine_100_25_5_HSPnoGGP[i]<-(sum(Sardine_100_25_5[[i]]$k_ckmr_hsp[which(Sardine_100_25_5[[i]]$age_diff<(1.7*2))]))
 Pairs_Sardine_1000_25_5[i,1]<-(sum(Sardine_1000_25_5[[i]]$k_ckmr_pop))
 Pairs_Sardine_1000_25_5[i,2]<-(sum(Sardine_1000_25_5[[i]]$k_ckmr_hsp))
 Pairs_Sardine_1000_25_5_HSPnoGGP[i]<-(sum(Sardine_1000_25_5[[i]]$k_ckmr_hsp[which(Sardine_1000_25_5[[i]]$age_diff<(1.7*2))]))
 Pairs_Sardine_5000_25_5[i,1]<-(sum(Sardine_5000_25_5[[i]]$k_ckmr_pop))
 Pairs_Sardine_5000_25_5[i,2]<-(sum(Sardine_5000_25_5[[i]]$k_ckmr_hsp))
 Pairs_Sardine_5000_25_5_HSPnoGGP[i]<-(sum(Sardine_5000_25_5[[i]]$k_ckmr_hsp[which(Sardine_5000_25_5[[i]]$age_diff<(1.7*2))]))
 
 Pairs_Sardine_100_25_10[i,1]<-(sum(Sardine_100_25_10[[i]]$k_ckmr_pop))
 Pairs_Sardine_100_25_10[i,2]<-(sum(Sardine_100_25_10[[i]]$k_ckmr_hsp))
 Pairs_Sardine_100_25_10_HSPnoGGP[i]<-(sum(Sardine_100_25_10[[i]]$k_ckmr_hsp[which(Sardine_100_25_10[[i]]$age_diff<(1.7*2))]))
 Pairs_Sardine_1000_25_10[i,1]<-(sum(Sardine_1000_25_10[[i]]$k_ckmr_pop))
 Pairs_Sardine_1000_25_10[i,2]<-(sum(Sardine_1000_25_10[[i]]$k_ckmr_hsp))
 Pairs_Sardine_1000_25_10_HSPnoGGP[i]<-(sum(Sardine_1000_25_10[[i]]$k_ckmr_hsp[which(Sardine_1000_25_10[[i]]$age_diff<(1.7*2))]))
 Pairs_Sardine_5000_25_10[i,1]<-(sum(Sardine_5000_25_10[[i]]$k_ckmr_pop))
 Pairs_Sardine_5000_25_10[i,2]<-(sum(Sardine_5000_25_10[[i]]$k_ckmr_hsp))
 Pairs_Sardine_5000_25_10_HSPnoGGP[i]<-(sum(Sardine_5000_25_10[[i]]$k_ckmr_hsp[which(Sardine_5000_25_10[[i]]$age_diff<(1.7*2))]))
 
 Pairs_Sardine_100_25_20[i,1]<-(sum(Sardine_100_25_20[[i]]$k_ckmr_pop))
 Pairs_Sardine_100_25_20[i,2]<-(sum(Sardine_100_25_20[[i]]$k_ckmr_hsp))
 Pairs_Sardine_100_25_20_HSPnoGGP[i]<-(sum(Sardine_100_25_20[[i]]$k_ckmr_hsp[which(Sardine_100_25_20[[i]]$age_diff<(1.7*2))]))
 Pairs_Sardine_1000_25_20[i,1]<-(sum(Sardine_1000_25_20[[i]]$k_ckmr_pop))
 Pairs_Sardine_1000_25_20[i,2]<-(sum(Sardine_1000_25_20[[i]]$k_ckmr_hsp))
 Pairs_Sardine_1000_25_20_HSPnoGGP[i]<-(sum(Sardine_1000_25_20[[i]]$k_ckmr_hsp[which(Sardine_1000_25_20[[i]]$age_diff<(1.7*2))]))
 Pairs_Sardine_5000_25_20[i,1]<-(sum(Sardine_5000_25_20[[i]]$k_ckmr_pop))
 Pairs_Sardine_5000_25_20[i,2]<-(sum(Sardine_5000_25_20[[i]]$k_ckmr_hsp))
 Pairs_Sardine_5000_25_20_HSPnoGGP[i]<-(sum(Sardine_5000_25_20[[i]]$k_ckmr_hsp[which(Sardine_5000_25_20[[i]]$age_diff<(1.7*2))]))
}

#N100
#tiff(paste0(wd,"/CKMRPairs_N100_noGPP.tiff"), height=20, width=30, units='cm', compression="lzw", res=500)
par(mfrow=c(3,6), oma=c(2,2,1,1), mar=c(4,4,2.5,1))
hist(Pairs_Cod_100_25_5[,1], breaks=seq(-0.5,1e6,1), xlim=c(-0.5,5), las=1, xlab="", main="")
mtext(text="5yr", side=2, line=4.5, font=2)
mtext(text="POP", side=3, line=-2,font=2)
#hist(Pairs_Cod_100_25_5[,2], breaks=seq(-0.5,1e6,1), xlim=c(-0.5,5), las=1, xlab="", main="", ylab="")
hist(Pairs_Cod_100_25_5_HSPnoGGP, breaks=seq(-0.5,1e6,1), xlim=c(-0.5,5), las=1, xlab="", main="", ylab="")
mtext(text="Cod", side=3, line=2, at=-4, font=2)
mtext(text="HSP", side=3, line=-2,font=2)

hist(Pairs_Flatfish_100_25_5[,1], breaks=seq(-0.5,1e6,10), xlim=c(-0.5,200), las=1, xlab="", main="", ylab="")
mtext(text="POP", side=3, line=-2,font=2)
#hist(Pairs_Flatfish_100_25_5[,2], breaks=seq(-0.5,1e6,10), xlim=c(-0.5,200), las=1, xlab="", main="", ylab="")
hist(Pairs_Flatfish_100_25_5_HSPnoGGP, breaks=seq(-0.5,1e6,10), xlim=c(-0.5,200), las=1, xlab="", main="", ylab="")
mtext(text="Flatfish", side=3, line=2, at=-75, font=2)
mtext(text="HSP", side=3, line=-2,font=2)

hist(Pairs_Sardine_100_25_5[,1], breaks=seq(-0.5,1e6,1), xlim=c(-0.5,5), las=1, xlab="", main="", ylab="")
mtext(text="POP", side=3, line=-2,font=2)
#hist(Pairs_Sardine_100_25_5[,2], breaks=seq(-0.5,1e6,1), xlim=c(-0.5,5), las=1, xlab="", main="", ylab="")
hist(Pairs_Sardine_100_25_5_HSPnoGGP, breaks=seq(-0.5,1e6,1), xlim=c(-0.5,5), las=1, xlab="", main="", ylab="")
mtext(text="Sardine", side=3, line=2, at=-4, font=2)
mtext(text="HSP", side=3, line=-2,font=2)

hist(Pairs_Cod_100_25_10[,1], breaks=seq(-0.5,1e6,1), xlim=c(-0.5,5), las=1, xlab="", main="")
mtext(text="10yr", side=2, line=4.5, font=2)
#hist(Pairs_Cod_100_25_10[,2], breaks=seq(-0.5,1e6,1), xlim=c(-0.5,5), las=1, xlab="", main="", ylab="")
hist(Pairs_Cod_100_25_10_HSPnoGGP, breaks=seq(-0.5,1e6,1), xlim=c(-0.5,5), las=1, xlab="", main="", ylab="")

hist(Pairs_Flatfish_100_25_10[,1], breaks=seq(-0.5,1e6,10), xlim=c(-0.5,200), las=1, xlab="", main="", ylab="")
#hist(Pairs_Flatfish_100_25_10[,2], breaks=seq(-0.5,1e6,10), xlim=c(-0.5,200), las=1, xlab="", main="", ylab="")
hist(Pairs_Flatfish_100_25_10_HSPnoGGP, breaks=seq(-0.5,1e6,10), xlim=c(-0.5,200), las=1, xlab="", main="", ylab="")

hist(Pairs_Sardine_100_25_10[,1], breaks=seq(-0.5,1e6,1), xlim=c(-0.5,5), las=1, xlab="", main="", ylab="")
#hist(Pairs_Sardine_100_25_10[,2], breaks=seq(-0.5,1e6,1), xlim=c(-0.5,5), las=1, xlab="", main="", ylab="")
hist(Pairs_Sardine_100_25_10_HSPnoGGP, breaks=seq(-0.5,1e6,1), xlim=c(-0.5,5), las=1, xlab="", main="", ylab="")

hist(Pairs_Cod_100_25_20[,1], breaks=seq(-0.5,1e6,1), xlim=c(-0.5,5), las=1, xlab="Parent-Offspring Pairs", main="")
mtext(text="20yr", side=2, line=4.5, font=2)
#hist(Pairs_Cod_100_25_20[,2], breaks=seq(-0.5,1e6,1), xlim=c(-0.5,5), las=1, xlab="Half-Sibling Pairs", main="", ylab="")
hist(Pairs_Cod_100_25_20_HSPnoGGP, breaks=seq(-0.5,1e6,1), xlim=c(-0.5,5), las=1, xlab="Half-Sibling Pairs", main="", ylab="")

hist(Pairs_Flatfish_100_25_20[,1], breaks=seq(-0.5,1e6,10), xlim=c(-0.5,200), las=1, xlab="Parent-Offspring Pairs", main="", ylab="")
#hist(Pairs_Flatfish_100_25_20[,2], breaks=seq(-0.5,1e6,10), xlim=c(-0.5,200), las=1, xlab="Half-Sibling Pairs", main="", ylab="")
hist(Pairs_Flatfish_100_25_20_HSPnoGGP, breaks=seq(-0.5,1e6,10), xlim=c(-0.5,200), las=1, xlab="Half-Sibling Pairs", main="", ylab="")

hist(Pairs_Sardine_100_25_20[,1], breaks=seq(-0.5,1e6,1), xlim=c(-0.5,5), las=1, xlab="Parent-Offspring Pairs", main="", ylab="")
#hist(Pairs_Sardine_100_25_20[,2], breaks=seq(-0.5,1e6,1), xlim=c(-0.5,5), las=1, xlab="Half-Sibling Pairs", main="", ylab="")
hist(Pairs_Sardine_100_25_20_HSPnoGGP, breaks=seq(-0.5,1e6,1), xlim=c(-0.5,5), las=1, xlab="Half-Sibling Pairs", main="", ylab="")
#dev.off()

#N1000
#tiff(paste0(wd,"/CKMRPairs_N1000_noGPP.tiff"), height=20, width=30, units='cm', compression="lzw", res=500)
par(mfrow=c(3,6), oma=c(2,2,1,1), mar=c(4,4,2.5,1))
hist(Pairs_Cod_1000_25_5[,1], breaks=seq(-0.5,1e6,1), xlim=c(-0.5,10), las=1, xlab="", main="")
mtext(text="5yr", side=2, line=4.5, font=2)
mtext(text="POP", side=3, line=-2,font=2)
#hist(Pairs_Cod_1000_25_5[,2], breaks=seq(-0.5,1e6,1), xlim=c(-0.5,10), las=1, xlab="", main="", ylab="")
hist(Pairs_Cod_1000_25_5_HSPnoGGP, breaks=seq(-0.5,1e6,1), xlim=c(-0.5,10), las=1, xlab="", main="", ylab="")
mtext(text="Cod", side=3, line=2, at=-4, font=2)
mtext(text="HSP", side=3, line=-2,font=2)

hist(Pairs_Flatfish_1000_25_5[,1], breaks=seq(-0.5,1e6,100), xlim=c(-0.5,15000), las=1, xlab="", main="", ylab="")
mtext(text="POP", side=3, line=-2,font=2)
#hist(Pairs_Flatfish_1000_25_5[,2], breaks=seq(-0.5,1e6,100), xlim=c(-0.5,15000), las=1, xlab="", main="", ylab="")
hist(Pairs_Flatfish_1000_25_5_HSPnoGGP, breaks=seq(-0.5,1e6,100), xlim=c(-0.5,15000), las=1, xlab="", main="", ylab="")
mtext(text="Flatfish", side=3, line=2, at=-2500, font=2)
mtext(text="HSP", side=3, line=-2,font=2)

hist(Pairs_Sardine_1000_25_5[,1], breaks=seq(-0.5,1e6,1), xlim=c(-0.5,100), las=1, xlab="", main="", ylab="")
mtext(text="POP", side=3, line=-2,font=2)
#hist(Pairs_Sardine_1000_25_5[,2], breaks=seq(-0.5,1e6,1), xlim=c(-0.5,100), las=1, xlab="", main="", ylab="")
hist(Pairs_Sardine_1000_25_5_HSPnoGGP, breaks=seq(-0.5,1e6,1), xlim=c(-0.5,100), las=1, xlab="", main="", ylab="")
mtext(text="Sardine", side=3, line=2, at=-25, font=2)
mtext(text="HSP", side=3, line=-2,font=2)

hist(Pairs_Cod_1000_25_10[,1], breaks=seq(-0.5,1e6,1), xlim=c(-0.5,10), las=1, xlab="", main="")
mtext(text="10yr", side=2, line=4.5, font=2)
#hist(Pairs_Cod_1000_25_10[,2], breaks=seq(-0.5,1e6,1), xlim=c(-0.5,10), las=1, xlab="", main="", ylab="")
hist(Pairs_Cod_1000_25_10_HSPnoGGP, breaks=seq(-0.5,1e6,1), xlim=c(-0.5,10), las=1, xlab="", main="", ylab="")

hist(Pairs_Flatfish_1000_25_10[,1], breaks=seq(-0.5,1e6,100), xlim=c(-0.5,15000), las=1, xlab="", main="", ylab="")
#hist(Pairs_Flatfish_1000_25_10[,2], breaks=seq(-0.5,1e6,100), xlim=c(-0.5,15000), las=1, xlab="", main="", ylab="")
hist(Pairs_Flatfish_1000_25_10_HSPnoGGP, breaks=seq(-0.5,1e6,100), xlim=c(-0.5,15000), las=1, xlab="", main="", ylab="")

hist(Pairs_Sardine_1000_25_10[,1], breaks=seq(-0.5,1e6,1), xlim=c(-0.5,100), las=1, xlab="", main="", ylab="")
#hist(Pairs_Sardine_1000_25_10[,2], breaks=seq(-0.5,1e6,1), xlim=c(-0.5,100), las=1, xlab="", main="", ylab="")
hist(Pairs_Sardine_1000_25_10_HSPnoGGP, breaks=seq(-0.5,1e6,1), xlim=c(-0.5,100), las=1, xlab="", main="", ylab="")

hist(Pairs_Cod_1000_25_20[,1], breaks=seq(-0.5,1e6,1), xlim=c(-0.5,10), las=1, xlab="Parent-Offspring Pairs", main="")
mtext(text="20yr", side=2, line=4.5, font=2)
#hist(Pairs_Cod_1000_25_20[,2], breaks=seq(-0.5,1e6,1), xlim=c(-0.5,10), las=1, xlab="Half-Sibling Pairs", main="", ylab="")
hist(Pairs_Cod_1000_25_20_HSPnoGGP, breaks=seq(-0.5,1e6,1), xlim=c(-0.5,10), las=1, xlab="Half-Sibling Pairs", main="", ylab="")

hist(Pairs_Flatfish_1000_25_20[,1], breaks=seq(-0.5,1e6,100), xlim=c(-0.5,15000), las=1, xlab="Parent-Offspring Pairs", main="", ylab="")
#hist(Pairs_Flatfish_1000_25_20[,2], breaks=seq(-0.5,1e6,100), xlim=c(-0.5,15000), las=1, xlab="Half-Sibling Pairs", main="", ylab="")
hist(Pairs_Flatfish_1000_25_20_HSPnoGGP, breaks=seq(-0.5,1e6,100), xlim=c(-0.5,15000), las=1, xlab="Half-Sibling Pairs", main="", ylab="")

hist(Pairs_Sardine_1000_25_20[,1], breaks=seq(-0.5,1e6,1), xlim=c(-0.5,100), las=1, xlab="Parent-Offspring Pairs", main="", ylab="")
#hist(Pairs_Sardine_1000_25_20[,2], breaks=seq(-0.5,1e6,1), xlim=c(-0.5,100), las=1, xlab="Half-Sibling Pairs", main="", ylab="")
hist(Pairs_Sardine_1000_25_20_HSPnoGGP, breaks=seq(-0.5,1e6,1), xlim=c(-0.5,100), las=1, xlab="Half-Sibling Pairs", main="", ylab="")
#dev.off()

#N5000
#tiff(paste0(wd,"/CKMRPairs_N5000_noGPP.tiff"), height=20, width=30, units='cm', compression="lzw", res=500)
par(mfrow=c(3,6), oma=c(2,2,1,1), mar=c(4,4,2.5,1))
hist(Pairs_Cod_5000_25_5[,1], breaks=seq(-0.5,1e6,1), xlim=c(-0.5,120), las=1, xlab="", main="")
mtext(text="5yr", side=2, line=4.5, font=2)
mtext(text="POP", side=3, line=-2,font=2)
#hist(Pairs_Cod_5000_25_5[,2], breaks=seq(-0.5,1e6,1), xlim=c(-0.5,120), las=1, xlab="", main="", ylab="")
hist(Pairs_Cod_5000_25_5_HSPnoGGP, breaks=seq(-0.5,1e6,1), xlim=c(-0.5,120), las=1, xlab="", main="", ylab="")
mtext(text="Cod", side=3, line=2, at=-30, font=2)
mtext(text="HSP", side=3, line=-2,font=2)

hist(Pairs_Flatfish_5000_25_5[,1], breaks=seq(-0.5,1e6,2e3), xlim=c(-0.5,3e5), las=1, xlab="", main="", ylab="")
mtext(text="POP", side=3, line=-2,font=2)
#hist(Pairs_Flatfish_5000_25_5[,2], breaks=seq(-0.5,1e6,2e3), xlim=c(-0.5,3e5), las=1, xlab="", main="", ylab="")
hist(Pairs_Flatfish_5000_25_5_HSPnoGGP, breaks=seq(-0.5,1e6,2e3), xlim=c(-0.5,3e5), las=1, xlab="", main="", ylab="")
mtext(text="Flatfish", side=3, line=2, at=-50000, font=2)
mtext(text="HSP", side=3, line=-2,font=2)

hist(Pairs_Sardine_5000_25_5[,1], breaks=seq(-0.5,1e6,50), xlim=c(-0.5,2500), las=1, xlab="", main="", ylab="")
mtext(text="POP", side=3, line=-2,font=2)
#hist(Pairs_Sardine_5000_25_5[,2], breaks=seq(-0.5,1e6,50), xlim=c(-0.5,2500), las=1, xlab="", main="", ylab="")
hist(Pairs_Sardine_5000_25_5_HSPnoGGP, breaks=seq(-0.5,1e6,50), xlim=c(-0.5,2500), las=1, xlab="", main="", ylab="")
mtext(text="Sardine", side=3, line=2, at=-600, font=2)
mtext(text="HSP", side=3, line=-2,font=2)

hist(Pairs_Cod_5000_25_10[,1], breaks=seq(-0.5,1e6,1), xlim=c(-0.5,120), las=1, xlab="", main="")
mtext(text="10yr", side=2, line=4.5, font=2)
#hist(Pairs_Cod_5000_25_10[,2], breaks=seq(-0.5,1e6,1), xlim=c(-0.5,120), las=1, xlab="", main="", ylab="")
hist(Pairs_Cod_5000_25_10_HSPnoGGP, breaks=seq(-0.5,1e6,1), xlim=c(-0.5,120), las=1, xlab="", main="", ylab="")

hist(Pairs_Flatfish_5000_25_10[,1], breaks=seq(-0.5,1e6,2e3), xlim=c(-0.5,3e5), las=1, xlab="", main="", ylab="")
#hist(Pairs_Flatfish_5000_25_10[,2], breaks=seq(-0.5,1e6,2e3), xlim=c(-0.5,3e5), las=1, xlab="", main="", ylab="")
hist(Pairs_Flatfish_5000_25_10_HSPnoGGP, breaks=seq(-0.5,1e6,2e3), xlim=c(-0.5,3e5), las=1, xlab="", main="", ylab="")

hist(Pairs_Sardine_5000_25_10[,1], breaks=seq(-0.5,1e6,50), xlim=c(-0.5,2500), las=1, xlab="", main="", ylab="")
#hist(Pairs_Sardine_5000_25_10[,2], breaks=seq(-0.5,1e6,50), xlim=c(-0.5,2500), las=1, xlab="", main="", ylab="")
hist(Pairs_Sardine_5000_25_10_HSPnoGGP, breaks=seq(-0.5,1e6,50), xlim=c(-0.5,2500), las=1, xlab="", main="", ylab="")

hist(Pairs_Cod_5000_25_20[,1], breaks=seq(-0.5,1e6,1), xlim=c(-0.5,120), las=1, xlab="Parent-Offspring Pairs", main="")
mtext(text="20yr", side=2, line=4.5, font=2)
#hist(Pairs_Cod_5000_25_20[,2], breaks=seq(-0.5,1e6,1), xlim=c(-0.5,120), las=1, xlab="Half-Sibling Pairs", main="", ylab="")
hist(Pairs_Cod_5000_25_20_HSPnoGGP, breaks=seq(-0.5,1e6,1), xlim=c(-0.5,120), las=1, xlab="Half-Sibling Pairs", main="", ylab="")

hist(Pairs_Flatfish_5000_25_20[,1], breaks=seq(-0.5,1e6,2e3), xlim=c(-0.5,3e5), las=1, xlab="Parent-Offspring Pairs", main="", ylab="")
#hist(Pairs_Flatfish_5000_25_20[,2], breaks=seq(-0.5,1e6,2e3), xlim=c(-0.5,3e5), las=1, xlab="Half-Sibling Pairs", main="", ylab="")
hist(Pairs_Flatfish_5000_25_20_HSPnoGGP, breaks=seq(-0.5,1e6,2e3), xlim=c(-0.5,3e5), las=1, xlab="Half-Sibling Pairs", main="", ylab="")

hist(Pairs_Sardine_5000_25_20[,1], breaks=seq(-0.5,1e6,50), xlim=c(-0.5,2500), las=1, xlab="Parent-Offspring Pairs", main="", ylab="")
#hist(Pairs_Sardine_5000_25_20[,2], breaks=seq(-0.5,1e6,50), xlim=c(-0.5,2500), las=1, xlab="Half-Sibling Pairs", main="", ylab="")
hist(Pairs_Sardine_5000_25_20_HSPnoGGP, breaks=seq(-0.5,1e6,50), xlim=c(-0.5,2500), las=1, xlab="Half-Sibling Pairs", main="", ylab="")
#dev.off()

#Overlap histograms
#N5000
#tiff(paste0(wd,"/CKMRPairs_Overlap.tiff"), height=20, width=30, units='cm', compression="lzw", res=500)
par(mfrow=c(3,6), oma=c(2,2,1,1), mar=c(4,4,2.5,1))
hist(Pairs_Cod_5000_25_5[,1], breaks=seq(-0.5,1e6,1), xlim=c(-1,100), las=1, xlab="", main="",col=rgb(0.8,0,0,0.2))
hist(Pairs_Cod_1000_25_5[,1], breaks=seq(-0.5,1e6,1), add=TRUE, col=rgb(0,0.8,0,0.2))
hist(Pairs_Cod_100_25_5[,1], breaks=seq(-0.5,1e6,1), add=TRUE, col=rgb(0,0,0.8,0.2))
mtext(text="5yr", side=2, line=4.5, font=2)
mtext(text="POP", side=3, line=-2,font=2)
hist(Pairs_Cod_5000_25_5[,2], breaks=seq(-0.5,1e6,1), xlim=c(-1,100), las=1, xlab="", main="", ylab="",col=rgb(0.8,0,0,0.2))
hist(Pairs_Cod_1000_25_5[,2], breaks=seq(-0.5,1e6,1), add=TRUE, col=rgb(0,0.8,0,0.2))
hist(Pairs_Cod_100_25_5[,2], breaks=seq(-0.5,1e6,1), add=TRUE, col=rgb(0,0,0.8,0.2))
mtext(text="Cod", side=3, line=2, at=-30, font=2)
mtext(text="HSP", side=3, line=-2,font=2)

hist(Pairs_Flatfish_5000_25_5[,1], breaks=seq(-0.5,1e6,5e3), xlim=c(-1,2.5e5), las=1, xlab="", main="", ylab="",col=rgb(0.8,0,0,0.2))
hist(Pairs_Flatfish_1000_25_5[,1], breaks=seq(-0.5,1e6,5e3), add=TRUE, col=rgb(0,0.8,0,0.2))
hist(Pairs_Flatfish_100_25_5[,1], breaks=seq(-0.5,1e6,5e3), add=TRUE, col=rgb(0,0,0.8,0.2))
mtext(text="POP", side=3, line=-2,font=2)
hist(Pairs_Flatfish_5000_25_5[,2], breaks=seq(-0.5,1e6,5e3), xlim=c(-1,2.5e5), las=1, xlab="", main="", ylab="",col=rgb(0.8,0,0,0.2))
hist(Pairs_Flatfish_1000_25_5[,2], breaks=seq(-0.5,1e6,5e3), add=TRUE, col=rgb(0,0.8,0,0.2))
hist(Pairs_Flatfish_100_25_5[,2], breaks=seq(-0.5,1e6,5e3), add=TRUE, col=rgb(0,0,0.8,0.2))
mtext(text="Flatfish", side=3, line=2, at=-50000, font=2)
mtext(text="HSP", side=3, line=-2,font=2)

hist(Pairs_Sardine_5000_25_5[,1], breaks=seq(-0.5,1e6,50), xlim=c(-1,2200), las=1, xlab="", main="", ylab="",col=rgb(0.8,0,0,0.2))
hist(Pairs_Sardine_1000_25_5[,1], breaks=seq(-0.5,1e6,50), add=TRUE, col=rgb(0,0.8,0,0.2))
hist(Pairs_Sardine_100_25_5[,1], breaks=seq(-0.5,1e6,50), add=TRUE, col=rgb(0,0,0.8,0.2))
mtext(text="POP", side=3, line=-2,font=2)
hist(Pairs_Sardine_5000_25_5[,2], breaks=seq(-0.5,1e6,50), xlim=c(-1,2200), las=1, xlab="", main="", ylab="",col=rgb(0.8,0,0,0.2))
hist(Pairs_Sardine_1000_25_5[,2], breaks=seq(-0.5,1e6,50), add=TRUE, col=rgb(0,0.8,0,0.2))
hist(Pairs_Sardine_100_25_5[,2], breaks=seq(-0.5,1e6,50), add=TRUE, col=rgb(0,0,0.8,0.2))
mtext(text="Sardine", side=3, line=2, at=-600, font=2)
mtext(text="HSP", side=3, line=-2,font=2)

hist(Pairs_Cod_5000_25_10[,1], breaks=seq(-0.5,1e6,1), xlim=c(-1,100), las=1, xlab="", main="",col=rgb(0.8,0,0,0.2))
hist(Pairs_Cod_1000_25_10[,1], breaks=seq(-0.5,1e6,1), add=TRUE, col=rgb(0,0.8,0,0.2))
hist(Pairs_Cod_100_25_10[,1], breaks=seq(-0.5,1e6,1), add=TRUE, col=rgb(0,0,0.8,0.2))
mtext(text="10yr", side=2, line=4.5, font=2)
hist(Pairs_Cod_5000_25_10[,2], breaks=seq(-0.5,1e6,1), xlim=c(-1,100), las=1, xlab="", main="", ylab="",col=rgb(0.8,0,0,0.2))
hist(Pairs_Cod_1000_25_10[,2], breaks=seq(-0.5,1e6,1), add=TRUE, col=rgb(0,0.8,0,0.2))
hist(Pairs_Cod_100_25_10[,2], breaks=seq(-0.5,1e6,1), add=TRUE, col=rgb(0,0,0.8,0.2))

hist(Pairs_Flatfish_5000_25_10[,1], breaks=seq(-0.5,1e6,5e3), xlim=c(-1,2.5e5), las=1, xlab="", main="", ylab="",col=rgb(0.8,0,0,0.2))
hist(Pairs_Flatfish_1000_25_10[,1], breaks=seq(-0.5,1e6,5e3), add=TRUE, col=rgb(0,0.8,0,0.2))
hist(Pairs_Flatfish_100_25_10[,1], breaks=seq(-0.5,1e6,5e3), add=TRUE, col=rgb(0,0,0.8,0.2))
hist(Pairs_Flatfish_5000_25_10[,2], breaks=seq(-0.5,1e6,5e3), xlim=c(-1,2.5e5), las=1, xlab="", main="", ylab="",col=rgb(0.8,0,0,0.2))
hist(Pairs_Flatfish_1000_25_10[,2], breaks=seq(-0.5,1e6,5e3), add=TRUE, col=rgb(0,0.8,0,0.2))
hist(Pairs_Flatfish_100_25_10[,2], breaks=seq(-0.5,1e6,5e3), add=TRUE, col=rgb(0,0,0.8,0.2))

hist(Pairs_Sardine_5000_25_10[,1], breaks=seq(-0.5,1e6,50), xlim=c(-1,2200), las=1, xlab="", main="", ylab="",col=rgb(0.8,0,0,0.2))
hist(Pairs_Sardine_1000_25_10[,1], breaks=seq(-0.5,1e6,50), add=TRUE, col=rgb(0,0.8,0,0.2))
hist(Pairs_Sardine_100_25_10[,1], breaks=seq(-0.5,1e6,50), add=TRUE, col=rgb(0,0,0.8,0.2))
hist(Pairs_Sardine_5000_25_10[,2], breaks=seq(-0.5,1e6,50), xlim=c(-1,2200), las=1, xlab="", main="", ylab="",col=rgb(0.8,0,0,0.2))
hist(Pairs_Sardine_1000_25_10[,2], breaks=seq(-0.5,1e6,50), add=TRUE, col=rgb(0,0.8,0,0.2))
hist(Pairs_Sardine_100_25_10[,2], breaks=seq(-0.5,1e6,50), add=TRUE, col=rgb(0,0,0.8,0.2))

hist(Pairs_Cod_5000_25_20[,1], breaks=seq(-0.5,1e6,1), xlim=c(-1,100), las=1, xlab="Parent-Offspring Pairs", main="",col=rgb(0.8,0,0,0.2))
hist(Pairs_Cod_1000_25_20[,1], breaks=seq(-0.5,1e6,1), add=TRUE, col=rgb(0,0.8,0,0.2))
hist(Pairs_Cod_100_25_20[,1], breaks=seq(-0.5,1e6,1), add=TRUE, col=rgb(0,0,0.8,0.2))
mtext(text="20yr", side=2, line=4.5, font=2)
hist(Pairs_Cod_5000_25_20[,2], breaks=seq(-0.5,1e6,1), xlim=c(-1,100), las=1, xlab="Half-Sibling Pairs", main="", ylab="",col=rgb(0.8,0,0,0.2))
hist(Pairs_Cod_1000_25_20[,2], breaks=seq(-0.5,1e6,1), add=TRUE, col=rgb(0,0.8,0,0.2))
hist(Pairs_Cod_100_25_20[,2], breaks=seq(-0.5,1e6,1), add=TRUE, col=rgb(0,0,0.8,0.2))

hist(Pairs_Flatfish_5000_25_20[,1], breaks=seq(-0.5,1e6,5e3), xlim=c(-1,2.5e5), las=1, xlab="Parent-Offspring Pairs", main="", ylab="",col=rgb(0.8,0,0,0.2))
hist(Pairs_Flatfish_1000_25_20[,1], breaks=seq(-0.5,1e6,5e3), add=TRUE, col=rgb(0,0.8,0,0.2))
hist(Pairs_Flatfish_100_25_20[,1], breaks=seq(-0.5,1e6,5e3), add=TRUE, col=rgb(0,0,0.8,0.2))
hist(Pairs_Flatfish_5000_25_20[,2], breaks=seq(-0.5,1e6,5e3), xlim=c(-1,2.5e5), las=1, xlab="Half-Sibling Pairs", main="", ylab="",col=rgb(0.8,0,0,0.2))
hist(Pairs_Flatfish_1000_25_20[,2], breaks=seq(-0.5,1e6,5e3), add=TRUE, col=rgb(0,0.8,0,0.2))
hist(Pairs_Flatfish_100_25_20[,2], breaks=seq(-0.5,1e6,5e3), add=TRUE, col=rgb(0,0,0.8,0.2))

hist(Pairs_Sardine_5000_25_20[,1], breaks=seq(-0.5,1e6,50), xlim=c(-1,2200), las=1, xlab="Parent-Offspring Pairs", main="", ylab="",col=rgb(0.8,0,0,0.2))
hist(Pairs_Sardine_1000_25_20[,1], breaks=seq(-0.5,1e6,50), add=TRUE, col=rgb(0,0.8,0,0.2))
hist(Pairs_Sardine_100_25_20[,1], breaks=seq(-0.5,1e6,50), add=TRUE, col=rgb(0,0,0.8,0.2))
hist(Pairs_Sardine_5000_25_20[,2], breaks=seq(-0.5,1e6,50), xlim=c(-1,2200), las=1, xlab="Half-Sibling Pairs", main="", ylab="",col=rgb(0.8,0,0,0.2))
hist(Pairs_Sardine_1000_25_20[,2], breaks=seq(-0.5,1e6,50), add=TRUE, col=rgb(0,0.8,0,0.2))
hist(Pairs_Sardine_100_25_20[,2], breaks=seq(-0.5,1e6,50), add=TRUE, col=rgb(0,0,0.8,0.2))
#dev.off()

#Getting pairs Table, 
c(mean(Pairs_Cod_100_25_5[,1]),sd(Pairs_Cod_100_25_5[,1]),mean(Pairs_Cod_100_25_5_HSPnoGGP),sd(Pairs_Cod_100_25_5_HSPnoGGP))
c(mean(Pairs_Cod_100_25_10[,1]),sd(Pairs_Cod_100_25_10[,1]),mean(Pairs_Cod_100_25_10_HSPnoGGP),sd(Pairs_Cod_100_25_10_HSPnoGGP))
c(mean(Pairs_Cod_100_25_20[,1]),sd(Pairs_Cod_100_25_20[,1]),mean(Pairs_Cod_100_25_20_HSPnoGGP),sd(Pairs_Cod_100_25_20_HSPnoGGP))

c(mean(Pairs_Cod_1000_25_5[,1]),sd(Pairs_Cod_1000_25_5[,1]),mean(Pairs_Cod_1000_25_5_HSPnoGGP),sd(Pairs_Cod_1000_25_5_HSPnoGGP))
c(mean(Pairs_Cod_1000_25_10[,1]),sd(Pairs_Cod_1000_25_10[,1]),mean(Pairs_Cod_1000_25_10_HSPnoGGP),sd(Pairs_Cod_1000_25_10_HSPnoGGP))
c(mean(Pairs_Cod_1000_25_20[,1]),sd(Pairs_Cod_1000_25_20[,1]),mean(Pairs_Cod_1000_25_20_HSPnoGGP),sd(Pairs_Cod_1000_25_20_HSPnoGGP))

c(mean(Pairs_Cod_5000_25_5[,1]),sd(Pairs_Cod_5000_25_5[,1]),mean(Pairs_Cod_5000_25_5_HSPnoGGP),sd(Pairs_Cod_5000_25_5_HSPnoGGP))
c(mean(Pairs_Cod_5000_25_10[,1]),sd(Pairs_Cod_5000_25_10[,1]),mean(Pairs_Cod_5000_25_10_HSPnoGGP),sd(Pairs_Cod_5000_25_10_HSPnoGGP))
c(mean(Pairs_Cod_5000_25_20[,1]),sd(Pairs_Cod_5000_25_20[,1]),mean(Pairs_Cod_5000_25_20_HSPnoGGP),sd(Pairs_Cod_5000_25_20_HSPnoGGP))

c(mean(Pairs_Flatfish_100_25_5[,1]),sd(Pairs_Flatfish_100_25_5[,1]),mean(Pairs_Flatfish_100_25_5_HSPnoGGP),sd(Pairs_Flatfish_100_25_5_HSPnoGGP))
c(mean(Pairs_Flatfish_100_25_10[,1]),sd(Pairs_Flatfish_100_25_10[,1]),mean(Pairs_Flatfish_100_25_10_HSPnoGGP),sd(Pairs_Flatfish_100_25_10_HSPnoGGP))
c(mean(Pairs_Flatfish_100_25_20[,1]),sd(Pairs_Flatfish_100_25_20[,1]),mean(Pairs_Flatfish_100_25_20_HSPnoGGP),sd(Pairs_Flatfish_100_25_20_HSPnoGGP))

c(mean(Pairs_Flatfish_1000_25_5[,1]),sd(Pairs_Flatfish_1000_25_5[,1]),mean(Pairs_Flatfish_1000_25_5_HSPnoGGP),sd(Pairs_Flatfish_1000_25_5_HSPnoGGP))
c(mean(Pairs_Flatfish_1000_25_10[,1]),sd(Pairs_Flatfish_1000_25_10[,1]),mean(Pairs_Flatfish_1000_25_10_HSPnoGGP),sd(Pairs_Flatfish_1000_25_10_HSPnoGGP))
c(mean(Pairs_Flatfish_1000_25_20[,1]),sd(Pairs_Flatfish_1000_25_20[,1]),mean(Pairs_Flatfish_1000_25_20_HSPnoGGP),sd(Pairs_Flatfish_1000_25_20_HSPnoGGP))

c(mean(Pairs_Flatfish_5000_25_5[,1]),sd(Pairs_Flatfish_5000_25_5[,1]),mean(Pairs_Flatfish_5000_25_5_HSPnoGGP),sd(Pairs_Flatfish_5000_25_5_HSPnoGGP))
c(mean(Pairs_Flatfish_5000_25_10[,1]),sd(Pairs_Flatfish_5000_25_10[,1]),mean(Pairs_Flatfish_5000_25_10_HSPnoGGP),sd(Pairs_Flatfish_5000_25_10_HSPnoGGP))
c(mean(Pairs_Flatfish_5000_25_20[,1]),sd(Pairs_Flatfish_5000_25_20[,1]),mean(Pairs_Flatfish_5000_25_20_HSPnoGGP),sd(Pairs_Flatfish_5000_25_20_HSPnoGGP))

c(mean(Pairs_Sardine_100_25_5[,1]),sd(Pairs_Sardine_100_25_5[,1]),mean(Pairs_Sardine_100_25_5_HSPnoGGP),sd(Pairs_Sardine_100_25_5_HSPnoGGP))
c(mean(Pairs_Sardine_100_25_10[,1]),sd(Pairs_Sardine_100_25_10[,1]),mean(Pairs_Sardine_100_25_10_HSPnoGGP),sd(Pairs_Sardine_100_25_10_HSPnoGGP))
c(mean(Pairs_Sardine_100_25_20[,1]),sd(Pairs_Sardine_100_25_20[,1]),mean(Pairs_Sardine_100_25_20_HSPnoGGP),sd(Pairs_Sardine_100_25_20_HSPnoGGP))

c(mean(Pairs_Sardine_1000_25_5[,1]),sd(Pairs_Sardine_1000_25_5[,1]),mean(Pairs_Sardine_1000_25_5_HSPnoGGP),sd(Pairs_Sardine_1000_25_5_HSPnoGGP))
c(mean(Pairs_Sardine_1000_25_10[,1]),sd(Pairs_Sardine_1000_25_10[,1]),mean(Pairs_Sardine_1000_25_10_HSPnoGGP),sd(Pairs_Sardine_1000_25_10_HSPnoGGP))
c(mean(Pairs_Sardine_1000_25_20[,1]),sd(Pairs_Sardine_1000_25_20[,1]),mean(Pairs_Sardine_1000_25_20_HSPnoGGP),sd(Pairs_Sardine_1000_25_20_HSPnoGGP))

c(mean(Pairs_Sardine_5000_25_5[,1]),sd(Pairs_Sardine_5000_25_5[,1]),mean(Pairs_Sardine_5000_25_5_HSPnoGGP),sd(Pairs_Sardine_5000_25_5_HSPnoGGP))
c(mean(Pairs_Sardine_5000_25_10[,1]),sd(Pairs_Sardine_5000_25_10[,1]),mean(Pairs_Sardine_5000_25_10_HSPnoGGP),sd(Pairs_Sardine_5000_25_10_HSPnoGGP))
c(mean(Pairs_Sardine_5000_25_20[,1]),sd(Pairs_Sardine_5000_25_20[,1]),mean(Pairs_Sardine_5000_25_20_HSPnoGGP),sd(Pairs_Sardine_5000_25_20_HSPnoGGP))

#Plots of Selectivity
par(mfrow=c(3,1), mar=c(4,4,1,1), oma=c(2,2,1,1))
plot(0:25, Cod_runs[[1]]$Sel, xlab="", ylab="", las=1, type="b", pch=16, lwd=2, main="Cod")
plot(0:25,Flatfish_runs[[1]]$Sel, ylab="Selectivity", xlab="", type="b", pch=16, lwd=2, las=1, main="Flatfish")
plot(0:15,Sardine_runs[[1]]$Sel, xlab="Age", ylab="", las=1, type="b", pch=16, lwd=2, main="Sardine")

#########################################
#Example CKMR data given to assessment
#########################################
#Doing Flatfish for 10 years N1000
load(paste0(wd,"/Flatfish_wdat_N1000_Ind50_ckmrmultinom10_1.RData"))
 
Flatfish_OM<-Flatfish_wdat
OM<-Flatfish_OM[[1]]
dat<-list(fyear=OM$OM$fyear, lyear=75, fage=OM$OM$fage, lage=OM$OM$lage, 
         years=OM$OM$fyear:75, ages=OM$OM$fage:OM$OM$lage,
         obs_harv=OM$Obs_Catch,
         obs_index=OM$Obs_Index,
         obs_fishery_comp=OM$Obs_Catch_Comp/rowSums(OM$Obs_Catch_Comp),
         SS_fishery=rowSums(OM$Obs_Catch_Comp),
         Mat=OM$OM$Mat,
         Laa=OM$OM$Laa,
         Waa=OM$OM$Waa,
         #CKMR 
         born_year_old=OM$born_year_old-(OM$fyear_dat-1),
         age_diff=OM$age_diff,
         n_ckmr=OM$n_ckmr,
         k_ckmr_hsp=OM$k_ckmr_hsp,
         born_year_young=OM$born_year_young-(OM$fyear_dat-1), 
         k_ckmr_pop=OM$k_ckmr_pop,
         samp_year_old=OM$samp_year_old-(OM$fyear_dat-1),
         #Switch for whether to use a data source or not, 0=no, 1=yes
         Lamda_Harvest=1,
         Lamda_Comp=1,
         Lamda_Index=1,
         Lamda_CKMR=1)

ex_dat<-data.frame(born_year_old=dat$born_year_old,born_year_young=dat$born_year_young,age_diff=dat$age_diff,samp_year_old=dat$samp_year_old,n_ckmr=dat$n_ckmr,k_ckmr_pop=dat$k_ckmr_pop,k_ckmr_hsp=dat$k_ckmr_hsp)
set.seed(10)
samp<-sample(1:(dim(ex_dat)[1]),size=10,replace=FALSE)
ex_dat[samp,]

head(ex_dat)
tail(ex_dat)

##################################
#SCAAs without CKMR data
##################################

#N100 for 5yrs, and index sd 0.25
res_list<-list()
res_list[[1]]<-readRDS(paste0(wd,"/SCAAfit_Cod_N100_Ind25_5yrs_noCKMR.RData"))
res_list[[2]]<-readRDS(paste0(wd,"/SCAAfit_Flatfish_N100_Ind25_5yrs_noCKMR.RData"))
res_list[[3]]<-readRDS(paste0(wd,"/SCAAfit_Sardine_N100_Ind25_5yrs_noCKMR.RData"))

Cod_wdat<-Cod_100_25_5
Flatfish_wdat<-Flatfish_100_25_5
Sardine_wdat<-Sardine_100_25_5
  
re_Dep<-re_SSB<-array(NA, dim=c(3,100,76))
re_R0<-re_M<-matrix(NA, nrow=100, ncol=3)
for(f in 1:3){
  for (i in 1:100){
    if(f==1){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Cod_wdat[[i]]$OM$SSB[26:101])/Cod_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Cod_wdat[[i]]$OM$SSB[26:101]/Cod_wdat[[i]]$OM$SSB0)/(Cod_wdat[[i]]$OM$SSB[26:101]/Cod_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[3])-Cod_wdat[[i]]$OM$R0)/Cod_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Cod_wdat[[i]]$OM$Mref)/Cod_wdat[[i]]$OM$Mref
      
    }else if (f==2){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Flatfish_wdat[[i]]$OM$SSB[26:101])/Flatfish_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Flatfish_wdat[[i]]$OM$SSB[26:101]/Flatfish_wdat[[i]]$OM$SSB0)/(Flatfish_wdat[[i]]$OM$SSB[26:101]/Flatfish_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[3])-Flatfish_wdat[[i]]$OM$R0)/Flatfish_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Flatfish_wdat[[i]]$OM$Mref)/Flatfish_wdat[[i]]$OM$Mref
      
    } else if (f==3){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Sardine_wdat[[i]]$OM$SSB[26:101])/Sardine_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Sardine_wdat[[i]]$OM$SSB[26:101]/Sardine_wdat[[i]]$OM$SSB0)/(Sardine_wdat[[i]]$OM$SSB[26:101]/Sardine_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[3])-Sardine_wdat[[i]]$OM$R0)/Sardine_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Sardine_wdat[[i]]$OM$Mref)/Sardine_wdat[[i]]$OM$Mref
      
    }
  }
}

#SSB
par(mfrow=c(3,3))
boxplot(re_SSB[1,,], ylim=c(-0.25,0.25), las=1, main="Cod - N100, Index SD - 0.25", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[2,,], ylim=c(-0.25,0.25), las=1, main="Flatfish - N100, Index SD - 0.25", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[3,,], ylim=c(-0.25,0.25), las=1, main="Sardine - N100, Index SD - 0.25", ylab="RE - SSB")
abline(h=0)

#R0
boxplot(re_R0[,1], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,2], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,3], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)

#M
boxplot(re_M[,1], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,2], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,3], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)

#SD of relative error for point estimates
sd_RE_ssb_N100_Ind25_5yrs_noCKMR<-apply(re_SSB,c(1,3),sd, na.rm=TRUE)
sd_RE_R0_N100_Ind25_5yrs_noCKMR<-apply(re_R0,2,sd, na.rm=TRUE)
sd_RE_M_N100_Ind25_5yrs_noCKMR<-apply(re_M,2,sd, na.rm=TRUE)

#SD of absolute relative error
sd_ARE_ssb_N100_Ind25_5yrs_noCKMR<-apply(abs(re_SSB),c(1,3),sd, na.rm=TRUE)
sd_ARE_R0_N100_Ind25_5yrs_noCKMR<-apply(abs(re_R0),2,sd, na.rm=TRUE)
sd_ARE_M_N100_Ind25_5yrs_noCKMR<-apply(abs(re_M),2,sd, na.rm=TRUE)

#Precision within sims
SD_ssb_N100_Ind25_5yrs_noCKMR<-CV_ssb_N100_Ind25_5yrs_noCKMR<-array(NA, dim=c(3,100,76)) 
SD_R0_N100_Ind25_5yrs_noCKMR<-matrix(NA, nrow=3, ncol=100)
SD_M_N100_Ind25_5yrs_noCKMR<-matrix(NA, nrow=3, ncol=100)
for(f in 1:3){
  for (i in 1:100){
    CV_ssb_N100_Ind25_5yrs_noCKMR[f,i,]<-res_list[[f]][[i]]$SD$sd/res_list[[f]][[i]]$SD$unbiased$value
    SD_ssb_N100_Ind25_5yrs_noCKMR[f,i,]<-res_list[[f]][[i]]$SD$sd
    SD_R0_N100_Ind25_5yrs_noCKMR[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_R0","log_R0"])
    SD_M_N100_Ind25_5yrs_noCKMR[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_M","log_M"])
  }
}

#N1000 for 5 yrs, sd index 0.25
res_list[[1]]<-readRDS(paste0(wd,"/SCAAfit_Cod_N1000_Ind25_5yrs_noCKMR.RData"))
res_list[[2]]<-readRDS(paste0(wd,"/SCAAfit_Flatfish_N1000_Ind25_5yrs_noCKMR.RData"))
res_list[[3]]<-readRDS(paste0(wd,"/SCAAfit_Sardine_N1000_Ind25_5yrs_noCKMR.RData"))

Cod_wdat<-Cod_1000_25_5
Flatfish_wdat<-Flatfish_1000_25_5
Sardine_wdat<-Sardine_1000_25_5

re_Dep<-re_SSB<-array(NA, dim=c(3,100,76))
re_R0<-re_M<-matrix(NA, nrow=100, ncol=3)
for(f in 1:3){
  for (i in 1:100){
    if(f==1){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Cod_wdat[[i]]$OM$SSB[26:101])/Cod_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Cod_wdat[[i]]$OM$SSB[26:101]/Cod_wdat[[i]]$OM$SSB0)/(Cod_wdat[[i]]$OM$SSB[26:101]/Cod_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[3])-Cod_wdat[[i]]$OM$R0)/Cod_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Cod_wdat[[i]]$OM$Mref)/Cod_wdat[[i]]$OM$Mref
      
    }else if (f==2){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Flatfish_wdat[[i]]$OM$SSB[26:101])/Flatfish_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Flatfish_wdat[[i]]$OM$SSB[26:101]/Flatfish_wdat[[i]]$OM$SSB0)/(Flatfish_wdat[[i]]$OM$SSB[26:101]/Flatfish_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[3])-Flatfish_wdat[[i]]$OM$R0)/Flatfish_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Flatfish_wdat[[i]]$OM$Mref)/Flatfish_wdat[[i]]$OM$Mref
      
    } else if (f==3){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Sardine_wdat[[i]]$OM$SSB[26:101])/Sardine_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Sardine_wdat[[i]]$OM$SSB[26:101]/Sardine_wdat[[i]]$OM$SSB0)/(Sardine_wdat[[i]]$OM$SSB[26:101]/Sardine_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[3])-Sardine_wdat[[i]]$OM$R0)/Sardine_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Sardine_wdat[[i]]$OM$Mref)/Sardine_wdat[[i]]$OM$Mref
      
    }
  }
}

#SD of relative error for point estimates
sd_RE_ssb_N1000_Ind25_5yrs_noCKMR<-apply(re_SSB,c(1,3),sd, na.rm=TRUE)
sd_RE_R0_N1000_Ind25_5yrs_noCKMR<-apply(re_R0,2,sd, na.rm=TRUE)
sd_RE_M_N1000_Ind25_5yrs_noCKMR<-apply(re_M,2,sd, na.rm=TRUE)

#SD of absolute relative error
sd_ARE_ssb_N1000_Ind25_5yrs_noCKMR<-apply(abs(re_SSB),c(1,3),sd, na.rm=TRUE)
sd_ARE_R0_N1000_Ind25_5yrs_noCKMR<-apply(abs(re_R0),2,sd, na.rm=TRUE)
sd_ARE_M_N1000_Ind25_5yrs_noCKMR<-apply(abs(re_M),2,sd, na.rm=TRUE)

#Precision within sims
SD_ssb_N1000_Ind25_5yrs_noCKMR<-CV_ssb_N1000_Ind25_5yrs_noCKMR<-array(NA, dim=c(3,100,76)) 
SD_R0_N1000_Ind25_5yrs_noCKMR<-matrix(NA, nrow=3, ncol=100)
SD_M_N1000_Ind25_5yrs_noCKMR<-matrix(NA, nrow=3, ncol=100)
for(f in 1:3){
  for (i in 1:100){
    CV_ssb_N1000_Ind25_5yrs_noCKMR[f,i,]<-res_list[[f]][[i]]$SD$sd/res_list[[f]][[i]]$SD$unbiased$value
    SD_ssb_N1000_Ind25_5yrs_noCKMR[f,i,]<-res_list[[f]][[i]]$SD$sd
    SD_R0_N1000_Ind25_5yrs_noCKMR[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_R0","log_R0"])
    SD_M_N1000_Ind25_5yrs_noCKMR[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_M","log_M"])
  }
}

#N5000 for 5 yrs, sd index 0.25
res_list[[1]]<-readRDS(paste0(wd,"/SCAAfit_Cod_N5000_Ind25_5yrs_noCKMR.RData"))
res_list[[2]]<-readRDS(paste0(wd,"/SCAAfit_Flatfish_N5000_Ind25_5yrs_noCKMR.RData"))
res_list[[3]]<-readRDS(paste0(wd,"/SCAAfit_Sardine_N5000_Ind25_5yrs_noCKMR.RData"))

Cod_wdat<-Cod_5000_25_5
Flatfish_wdat<-Flatfish_5000_25_5
Sardine_wdat<-Sardine_5000_25_5

re_Dep<-re_SSB<-array(NA, dim=c(3,100,76))
re_R0<-re_M<-matrix(NA, nrow=100, ncol=3)
for(f in 1:3){
  for (i in 1:100){
    if(f==1){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Cod_wdat[[i]]$OM$SSB[26:101])/Cod_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Cod_wdat[[i]]$OM$SSB[26:101]/Cod_wdat[[i]]$OM$SSB0)/(Cod_wdat[[i]]$OM$SSB[26:101]/Cod_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[3])-Cod_wdat[[i]]$OM$R0)/Cod_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Cod_wdat[[i]]$OM$Mref)/Cod_wdat[[i]]$OM$Mref
      
    }else if (f==2){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Flatfish_wdat[[i]]$OM$SSB[26:101])/Flatfish_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Flatfish_wdat[[i]]$OM$SSB[26:101]/Flatfish_wdat[[i]]$OM$SSB0)/(Flatfish_wdat[[i]]$OM$SSB[26:101]/Flatfish_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[3])-Flatfish_wdat[[i]]$OM$R0)/Flatfish_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Flatfish_wdat[[i]]$OM$Mref)/Flatfish_wdat[[i]]$OM$Mref
      
    } else if (f==3){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Sardine_wdat[[i]]$OM$SSB[26:101])/Sardine_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Sardine_wdat[[i]]$OM$SSB[26:101]/Sardine_wdat[[i]]$OM$SSB0)/(Sardine_wdat[[i]]$OM$SSB[26:101]/Sardine_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[3])-Sardine_wdat[[i]]$OM$R0)/Sardine_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Sardine_wdat[[i]]$OM$Mref)/Sardine_wdat[[i]]$OM$Mref
      
    }
  }
}

#SD of relative error for point estimates
sd_RE_ssb_N5000_Ind25_5yrs_noCKMR<-apply(re_SSB,c(1,3),sd, na.rm=TRUE)
sd_RE_R0_N5000_Ind25_5yrs_noCKMR<-apply(re_R0,2,sd, na.rm=TRUE)
sd_RE_M_N5000_Ind25_5yrs_noCKMR<-apply(re_M,2,sd, na.rm=TRUE)

#SD of absolute relative error
sd_ARE_ssb_N5000_Ind25_5yrs_noCKMR<-apply(abs(re_SSB),c(1,3),sd, na.rm=TRUE)
sd_ARE_R0_N5000_Ind25_5yrs_noCKMR<-apply(abs(re_R0),2,sd, na.rm=TRUE)
sd_ARE_M_N5000_Ind25_5yrs_noCKMR<-apply(abs(re_M),2,sd, na.rm=TRUE)

#Precision within sims
SD_ssb_N5000_Ind25_5yrs_noCKMR<-CV_ssb_N5000_Ind25_5yrs_noCKMR<-array(NA, dim=c(3,100,76)) 
SD_R0_N5000_Ind25_5yrs_noCKMR<-matrix(NA, nrow=3, ncol=100)
SD_M_N5000_Ind25_5yrs_noCKMR<-matrix(NA, nrow=3, ncol=100)
for(f in 1:3){
  for (i in 1:100){
    CV_ssb_N5000_Ind25_5yrs_noCKMR[f,i,]<-res_list[[f]][[i]]$SD$sd/res_list[[f]][[i]]$SD$unbiased$value
    SD_ssb_N5000_Ind25_5yrs_noCKMR[f,i,]<-res_list[[f]][[i]]$SD$sd
    SD_R0_N5000_Ind25_5yrs_noCKMR[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_R0","log_R0"])
    SD_M_N5000_Ind25_5yrs_noCKMR[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_M","log_M"])
  }
}

#N100 for 5 yrs and index sd 0.50
res_list<-list()
res_list[[1]]<-readRDS(paste0(wd,"/SCAAfit_Cod_N100_Ind50_5yrs_noCKMR.RData"))
res_list[[2]]<-readRDS(paste0(wd,"/SCAAfit_Flatfish_N100_Ind50_5yrs_noCKMR.RData"))
res_list[[3]]<-readRDS(paste0(wd,"/SCAAfit_Sardine_N100_Ind50_5yrs_noCKMR.RData"))

Cod_wdat<-Cod_100_50_5
Flatfish_wdat<-Flatfish_100_50_5
Sardine_wdat<-Sardine_100_50_5

re_Dep<-re_SSB<-array(NA, dim=c(3,100,76))
re_R0<-re_M<-matrix(NA, nrow=100, ncol=3)
for(f in 1:3){
  for (i in 1:100){
    if(f==1){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Cod_wdat[[i]]$OM$SSB[26:101])/Cod_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Cod_wdat[[i]]$OM$SSB[26:101]/Cod_wdat[[i]]$OM$SSB0)/(Cod_wdat[[i]]$OM$SSB[26:101]/Cod_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[3])-Cod_wdat[[i]]$OM$R0)/Cod_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Cod_wdat[[i]]$OM$Mref)/Cod_wdat[[i]]$OM$Mref
      
    }else if (f==2){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Flatfish_wdat[[i]]$OM$SSB[26:101])/Flatfish_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Flatfish_wdat[[i]]$OM$SSB[26:101]/Flatfish_wdat[[i]]$OM$SSB0)/(Flatfish_wdat[[i]]$OM$SSB[26:101]/Flatfish_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[3])-Flatfish_wdat[[i]]$OM$R0)/Flatfish_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Flatfish_wdat[[i]]$OM$Mref)/Flatfish_wdat[[i]]$OM$Mref
      
    } else if (f==3){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Sardine_wdat[[i]]$OM$SSB[26:101])/Sardine_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Sardine_wdat[[i]]$OM$SSB[26:101]/Sardine_wdat[[i]]$OM$SSB0)/(Sardine_wdat[[i]]$OM$SSB[26:101]/Sardine_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[3])-Sardine_wdat[[i]]$OM$R0)/Sardine_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Sardine_wdat[[i]]$OM$Mref)/Sardine_wdat[[i]]$OM$Mref
      
    }
  }
}

#SSB
par(mfrow=c(3,3))
boxplot(re_SSB[1,,], ylim=c(-0.50,0.50), las=1, main="Cod - N200, Index SD - 0.50, CKMR 5yrs", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[2,,], ylim=c(-0.50,0.50), las=1, main="Flatfish - N200, Index SD - 0.50, CKMR 5yrs", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[3,,], ylim=c(-0.50,0.50), las=1, main="Sardine - N200, Index SD - 0.50, CKMR 5yrs", ylab="RE - SSB")
abline(h=0)

#R0
boxplot(re_R0[,1], ylim=c(-0.50,0.50), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,2], ylim=c(-0.50,0.50), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,3], ylim=c(-0.50,0.50), las=1, main="", ylab="RE - R0")
abline(h=0)

#M
boxplot(re_M[,1], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,2], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,3], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)

#SD of relative error for point estimates
sd_RE_ssb_N100_Ind50_5yrs_noCKMR<-apply(re_SSB,c(1,3),sd, na.rm=TRUE)
sd_RE_R0_N100_Ind50_5yrs_noCKMR<-apply(re_R0,2,sd, na.rm=TRUE)
sd_RE_M_N100_Ind50_5yrs_noCKMR<-apply(re_M,2,sd, na.rm=TRUE)

#SD of absolute relative error
sd_ARE_ssb_N100_Ind50_5yrs_noCKMR<-apply(abs(re_SSB),c(1,3),sd, na.rm=TRUE)
sd_ARE_R0_N100_Ind50_5yrs_noCKMR<-apply(abs(re_R0),2,sd, na.rm=TRUE)
sd_ARE_M_N100_Ind50_5yrs_noCKMR<-apply(abs(re_M),2,sd, na.rm=TRUE)

#Precision within sims
SD_ssb_N100_Ind50_5yrs_noCKMR<-CV_ssb_N100_Ind50_5yrs_noCKMR<-array(NA, dim=c(3,100,76)) 
SD_R0_N100_Ind50_5yrs_noCKMR<-matrix(NA, nrow=3, ncol=100)
SD_M_N100_Ind50_5yrs_noCKMR<-matrix(NA, nrow=3, ncol=100)
for(f in 1:3){
  for (i in 1:100){
    CV_ssb_N100_Ind50_5yrs_noCKMR[f,i,]<-res_list[[f]][[i]]$SD$sd/res_list[[f]][[i]]$SD$unbiased$value
    SD_ssb_N100_Ind50_5yrs_noCKMR[f,i,]<-res_list[[f]][[i]]$SD$sd
    SD_R0_N100_Ind50_5yrs_noCKMR[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_R0","log_R0"])
    SD_M_N100_Ind50_5yrs_noCKMR[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_M","log_M"])
  }
}

#N1000 for 5 yrs, sd index 0.50
res_list[[1]]<-readRDS(paste0(wd,"/SCAAfit_Cod_N1000_Ind50_5yrs_noCKMR.RData"))
res_list[[2]]<-readRDS(paste0(wd,"/SCAAfit_Flatfish_N1000_Ind50_5yrs_noCKMR.RData"))
res_list[[3]]<-readRDS(paste0(wd,"/SCAAfit_Sardine_N1000_Ind50_5yrs_noCKMR.RData"))

Cod_wdat<-Cod_1000_50_5
Flatfish_wdat<-Flatfish_1000_50_5
Sardine_wdat<-Sardine_1000_50_5

re_Dep<-re_SSB<-array(NA, dim=c(3,100,76))
re_R0<-re_M<-matrix(NA, nrow=100, ncol=3)
for(f in 1:3){
  for (i in 1:100){
    if(f==1){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Cod_wdat[[i]]$OM$SSB[26:101])/Cod_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Cod_wdat[[i]]$OM$SSB[26:101]/Cod_wdat[[i]]$OM$SSB0)/(Cod_wdat[[i]]$OM$SSB[26:101]/Cod_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[3])-Cod_wdat[[i]]$OM$R0)/Cod_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Cod_wdat[[i]]$OM$Mref)/Cod_wdat[[i]]$OM$Mref
      
    }else if (f==2){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Flatfish_wdat[[i]]$OM$SSB[26:101])/Flatfish_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Flatfish_wdat[[i]]$OM$SSB[26:101]/Flatfish_wdat[[i]]$OM$SSB0)/(Flatfish_wdat[[i]]$OM$SSB[26:101]/Flatfish_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[3])-Flatfish_wdat[[i]]$OM$R0)/Flatfish_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Flatfish_wdat[[i]]$OM$Mref)/Flatfish_wdat[[i]]$OM$Mref
      
    } else if (f==3){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Sardine_wdat[[i]]$OM$SSB[26:101])/Sardine_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Sardine_wdat[[i]]$OM$SSB[26:101]/Sardine_wdat[[i]]$OM$SSB0)/(Sardine_wdat[[i]]$OM$SSB[26:101]/Sardine_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[3])-Sardine_wdat[[i]]$OM$R0)/Sardine_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Sardine_wdat[[i]]$OM$Mref)/Sardine_wdat[[i]]$OM$Mref
      
    }
  }
}

#SD of relative error for point estimates
sd_RE_ssb_N1000_Ind50_5yrs_noCKMR<-apply(re_SSB,c(1,3),sd, na.rm=TRUE)
sd_RE_R0_N1000_Ind50_5yrs_noCKMR<-apply(re_R0,2,sd, na.rm=TRUE)
sd_RE_M_N1000_Ind50_5yrs_noCKMR<-apply(re_M,2,sd, na.rm=TRUE)

#SD of absolute relative error
sd_ARE_ssb_N1000_Ind50_5yrs_noCKMR<-apply(abs(re_SSB),c(1,3),sd, na.rm=TRUE)
sd_ARE_R0_N1000_Ind50_5yrs_noCKMR<-apply(abs(re_R0),2,sd, na.rm=TRUE)
sd_ARE_M_N1000_Ind50_5yrs_noCKMR<-apply(abs(re_M),2,sd, na.rm=TRUE)

#Precision within sims
SD_ssb_N1000_Ind50_5yrs_noCKMR<-CV_ssb_N1000_Ind50_5yrs_noCKMR<-array(NA, dim=c(3,100,76)) 
SD_R0_N1000_Ind50_5yrs_noCKMR<-matrix(NA, nrow=3, ncol=100)
SD_M_N1000_Ind50_5yrs_noCKMR<-matrix(NA, nrow=3, ncol=100)
for(f in 1:3){
  for (i in 1:100){
    CV_ssb_N1000_Ind50_5yrs_noCKMR[f,i,]<-res_list[[f]][[i]]$SD$sd/res_list[[f]][[i]]$SD$unbiased$value
    SD_ssb_N1000_Ind50_5yrs_noCKMR[f,i,]<-res_list[[f]][[i]]$SD$sd
    SD_R0_N1000_Ind50_5yrs_noCKMR[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_R0","log_R0"])
    SD_M_N1000_Ind50_5yrs_noCKMR[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_M","log_M"])
  }
}

#N5000 for 5 years, sd index 0.50
res_list[[1]]<-readRDS(paste0(wd,"/SCAAfit_Cod_N5000_Ind50_5yrs_noCKMR.RData"))
res_list[[2]]<-readRDS(paste0(wd,"/SCAAfit_Flatfish_N5000_Ind50_5yrs_noCKMR.RData"))
res_list[[3]]<-readRDS(paste0(wd,"/SCAAfit_Sardine_N5000_Ind50_5yrs_noCKMR.RData"))

Cod_wdat<-Cod_5000_50_5
Flatfish_wdat<-Flatfish_5000_50_5
Sardine_wdat<-Sardine_5000_50_5

re_Dep<-re_SSB<-array(NA, dim=c(3,100,76))
re_R0<-re_M<-matrix(NA, nrow=100, ncol=3)
for(f in 1:3){
  for (i in 1:100){
    if(f==1){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Cod_wdat[[i]]$OM$SSB[26:101])/Cod_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Cod_wdat[[i]]$OM$SSB[26:101]/Cod_wdat[[i]]$OM$SSB0)/(Cod_wdat[[i]]$OM$SSB[26:101]/Cod_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[3])-Cod_wdat[[i]]$OM$R0)/Cod_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Cod_wdat[[i]]$OM$Mref)/Cod_wdat[[i]]$OM$Mref
      
    }else if (f==2){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Flatfish_wdat[[i]]$OM$SSB[26:101])/Flatfish_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Flatfish_wdat[[i]]$OM$SSB[26:101]/Flatfish_wdat[[i]]$OM$SSB0)/(Flatfish_wdat[[i]]$OM$SSB[26:101]/Flatfish_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[3])-Flatfish_wdat[[i]]$OM$R0)/Flatfish_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Flatfish_wdat[[i]]$OM$Mref)/Flatfish_wdat[[i]]$OM$Mref
      
    } else if (f==3){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Sardine_wdat[[i]]$OM$SSB[26:101])/Sardine_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Sardine_wdat[[i]]$OM$SSB[26:101]/Sardine_wdat[[i]]$OM$SSB0)/(Sardine_wdat[[i]]$OM$SSB[26:101]/Sardine_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[3])-Sardine_wdat[[i]]$OM$R0)/Sardine_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Sardine_wdat[[i]]$OM$Mref)/Sardine_wdat[[i]]$OM$Mref
      
    }
  }
}

#SD of relative error for point estimates
sd_RE_ssb_N5000_Ind50_5yrs_noCKMR<-apply(re_SSB,c(1,3),sd, na.rm=TRUE)
sd_RE_R0_N5000_Ind50_5yrs_noCKMR<-apply(re_R0,2,sd, na.rm=TRUE)
sd_RE_M_N5000_Ind50_5yrs_noCKMR<-apply(re_M,2,sd, na.rm=TRUE)

#SD of absolute relative error
sd_ARE_ssb_N5000_Ind50_5yrs_noCKMR<-apply(abs(re_SSB),c(1,3),sd, na.rm=TRUE)
sd_ARE_R0_N5000_Ind50_5yrs_noCKMR<-apply(abs(re_R0),2,sd, na.rm=TRUE)
sd_ARE_M_N5000_Ind50_5yrs_noCKMR<-apply(abs(re_M),2,sd, na.rm=TRUE)

#Precision within sims
SD_ssb_N5000_Ind50_5yrs_noCKMR<-CV_ssb_N5000_Ind50_5yrs_noCKMR<-array(NA, dim=c(3,100,76)) 
SD_R0_N5000_Ind50_5yrs_noCKMR<-matrix(NA, nrow=3, ncol=100)
SD_M_N5000_Ind50_5yrs_noCKMR<-matrix(NA, nrow=3, ncol=100)
for(f in 1:3){
  for (i in 1:100){
    CV_ssb_N5000_Ind50_5yrs_noCKMR[f,i,]<-res_list[[f]][[i]]$SD$sd/res_list[[f]][[i]]$SD$unbiased$value
    SD_ssb_N5000_Ind50_5yrs_noCKMR[f,i,]<-res_list[[f]][[i]]$SD$sd
    SD_R0_N5000_Ind50_5yrs_noCKMR[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_R0","log_R0"])
    SD_M_N5000_Ind50_5yrs_noCKMR[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_M","log_M"])
  }
}

#########
#10 years
#########

#N100 for 10yrs, and index sd 0.25
res_list<-list()
res_list[[1]]<-readRDS(paste0(wd,"/SCAAfit_Cod_N100_Ind25_10yrs_noCKMR.RData"))
res_list[[2]]<-readRDS(paste0(wd,"/SCAAfit_Flatfish_N100_Ind25_10yrs_noCKMR.RData"))
res_list[[3]]<-readRDS(paste0(wd,"/SCAAfit_Sardine_N100_Ind25_10yrs_noCKMR.RData"))

Cod_wdat<-Cod_100_25_10
Flatfish_wdat<-Flatfish_100_25_10
Sardine_wdat<-Sardine_100_25_10

re_Dep<-re_SSB<-array(NA, dim=c(3,100,76))
re_R0<-re_M<-matrix(NA, nrow=100, ncol=3)
for(f in 1:3){
  for (i in 1:100){
    if(f==1){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Cod_wdat[[i]]$OM$SSB[26:101])/Cod_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Cod_wdat[[i]]$OM$SSB[26:101]/Cod_wdat[[i]]$OM$SSB0)/(Cod_wdat[[i]]$OM$SSB[26:101]/Cod_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[3])-Cod_wdat[[i]]$OM$R0)/Cod_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Cod_wdat[[i]]$OM$Mref)/Cod_wdat[[i]]$OM$Mref
      
    }else if (f==2){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Flatfish_wdat[[i]]$OM$SSB[26:101])/Flatfish_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Flatfish_wdat[[i]]$OM$SSB[26:101]/Flatfish_wdat[[i]]$OM$SSB0)/(Flatfish_wdat[[i]]$OM$SSB[26:101]/Flatfish_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[3])-Flatfish_wdat[[i]]$OM$R0)/Flatfish_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Flatfish_wdat[[i]]$OM$Mref)/Flatfish_wdat[[i]]$OM$Mref
      
    } else if (f==3){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Sardine_wdat[[i]]$OM$SSB[26:101])/Sardine_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Sardine_wdat[[i]]$OM$SSB[26:101]/Sardine_wdat[[i]]$OM$SSB0)/(Sardine_wdat[[i]]$OM$SSB[26:101]/Sardine_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[3])-Sardine_wdat[[i]]$OM$R0)/Sardine_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Sardine_wdat[[i]]$OM$Mref)/Sardine_wdat[[i]]$OM$Mref
      
    }
  }
}

#SSB
par(mfrow=c(3,3))
boxplot(re_SSB[1,,], ylim=c(-0.25,0.25), las=1, main="Cod - N100, Index SD - 0.25", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[2,,], ylim=c(-0.25,0.25), las=1, main="Flatfish - N100, Index SD - 0.25", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[3,,], ylim=c(-0.25,0.25), las=1, main="Sardine - N100, Index SD - 0.25", ylab="RE - SSB")
abline(h=0)

#R0
boxplot(re_R0[,1], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,2], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,3], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)

#M
boxplot(re_M[,1], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,2], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,3], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)

#SD of relative error for point estimates
sd_RE_ssb_N100_Ind25_10yrs_noCKMR<-apply(re_SSB,c(1,3),sd, na.rm=TRUE)
sd_RE_R0_N100_Ind25_10yrs_noCKMR<-apply(re_R0,2,sd, na.rm=TRUE)
sd_RE_M_N100_Ind25_10yrs_noCKMR<-apply(re_M,2,sd, na.rm=TRUE)

#SD of absolute relative error
sd_ARE_ssb_N100_Ind25_10yrs_noCKMR<-apply(abs(re_SSB),c(1,3),sd, na.rm=TRUE)
sd_ARE_R0_N100_Ind25_10yrs_noCKMR<-apply(abs(re_R0),2,sd, na.rm=TRUE)
sd_ARE_M_N100_Ind25_10yrs_noCKMR<-apply(abs(re_M),2,sd, na.rm=TRUE)

#Precision within sims
SD_ssb_N100_Ind25_10yrs_noCKMR<-CV_ssb_N100_Ind25_10yrs_noCKMR<-array(NA, dim=c(3,100,76)) 
SD_R0_N100_Ind25_10yrs_noCKMR<-matrix(NA, nrow=3, ncol=100)
SD_M_N100_Ind25_10yrs_noCKMR<-matrix(NA, nrow=3, ncol=100)
for(f in 1:3){
  for (i in 1:100){
    CV_ssb_N100_Ind25_10yrs_noCKMR[f,i,]<-res_list[[f]][[i]]$SD$sd/res_list[[f]][[i]]$SD$unbiased$value
    SD_ssb_N100_Ind25_10yrs_noCKMR[f,i,]<-res_list[[f]][[i]]$SD$sd
    SD_R0_N100_Ind25_10yrs_noCKMR[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_R0","log_R0"])
    SD_M_N100_Ind25_10yrs_noCKMR[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_M","log_M"])
  }
}

#N1000 for 10yrs, sd index 0.25
res_list[[1]]<-readRDS(paste0(wd,"/SCAAfit_Cod_N1000_Ind25_10yrs_noCKMR.RData"))
res_list[[2]]<-readRDS(paste0(wd,"/SCAAfit_Flatfish_N1000_Ind25_10yrs_noCKMR.RData"))
res_list[[3]]<-readRDS(paste0(wd,"/SCAAfit_Sardine_N1000_Ind25_10yrs_noCKMR.RData"))

Cod_wdat<-Cod_1000_25_10
Flatfish_wdat<-Flatfish_1000_25_10
Sardine_wdat<-Sardine_1000_25_10

re_Dep<-re_SSB<-array(NA, dim=c(3,100,76))
re_R0<-re_M<-matrix(NA, nrow=100, ncol=3)
for(f in 1:3){
  for (i in 1:100){
    if(f==1){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Cod_wdat[[i]]$OM$SSB[26:101])/Cod_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Cod_wdat[[i]]$OM$SSB[26:101]/Cod_wdat[[i]]$OM$SSB0)/(Cod_wdat[[i]]$OM$SSB[26:101]/Cod_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[3])-Cod_wdat[[i]]$OM$R0)/Cod_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Cod_wdat[[i]]$OM$Mref)/Cod_wdat[[i]]$OM$Mref
      
    }else if (f==2){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Flatfish_wdat[[i]]$OM$SSB[26:101])/Flatfish_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Flatfish_wdat[[i]]$OM$SSB[26:101]/Flatfish_wdat[[i]]$OM$SSB0)/(Flatfish_wdat[[i]]$OM$SSB[26:101]/Flatfish_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[3])-Flatfish_wdat[[i]]$OM$R0)/Flatfish_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Flatfish_wdat[[i]]$OM$Mref)/Flatfish_wdat[[i]]$OM$Mref
      
    } else if (f==3){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Sardine_wdat[[i]]$OM$SSB[26:101])/Sardine_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Sardine_wdat[[i]]$OM$SSB[26:101]/Sardine_wdat[[i]]$OM$SSB0)/(Sardine_wdat[[i]]$OM$SSB[26:101]/Sardine_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[3])-Sardine_wdat[[i]]$OM$R0)/Sardine_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Sardine_wdat[[i]]$OM$Mref)/Sardine_wdat[[i]]$OM$Mref
      
    }
  }
}

#SD of relative error for point estimates
sd_RE_ssb_N1000_Ind25_10yrs_noCKMR<-apply(re_SSB,c(1,3),sd, na.rm=TRUE)
sd_RE_R0_N1000_Ind25_10yrs_noCKMR<-apply(re_R0,2,sd, na.rm=TRUE)
sd_RE_M_N1000_Ind25_10yrs_noCKMR<-apply(re_M,2,sd, na.rm=TRUE)

#SD of absolute relative error
sd_ARE_ssb_N1000_Ind25_10yrs_noCKMR<-apply(abs(re_SSB),c(1,3),sd, na.rm=TRUE)
sd_ARE_R0_N1000_Ind25_10yrs_noCKMR<-apply(abs(re_R0),2,sd, na.rm=TRUE)
sd_ARE_M_N1000_Ind25_10yrs_noCKMR<-apply(abs(re_M),2,sd, na.rm=TRUE)

#Precision within sims
SD_ssb_N1000_Ind25_10yrs_noCKMR<-CV_ssb_N1000_Ind25_10yrs_noCKMR<-array(NA, dim=c(3,100,76)) 
SD_R0_N1000_Ind25_10yrs_noCKMR<-matrix(NA, nrow=3, ncol=100)
SD_M_N1000_Ind25_10yrs_noCKMR<-matrix(NA, nrow=3, ncol=100)
for(f in 1:3){
  for (i in 1:100){
    CV_ssb_N1000_Ind25_10yrs_noCKMR[f,i,]<-res_list[[f]][[i]]$SD$sd/res_list[[f]][[i]]$SD$unbiased$value
    SD_ssb_N1000_Ind25_10yrs_noCKMR[f,i,]<-res_list[[f]][[i]]$SD$sd
    SD_R0_N1000_Ind25_10yrs_noCKMR[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_R0","log_R0"])
    SD_M_N1000_Ind25_10yrs_noCKMR[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_M","log_M"])
  }
}

#N5000 for 10yrs, sd index 0.25
res_list[[1]]<-readRDS(paste0(wd,"/SCAAfit_Cod_N5000_Ind25_10yrs_noCKMR.RData"))
res_list[[2]]<-readRDS(paste0(wd,"/SCAAfit_Flatfish_N5000_Ind25_10yrs_noCKMR.RData"))
res_list[[3]]<-readRDS(paste0(wd,"/SCAAfit_Sardine_N5000_Ind25_10yrs_noCKMR.RData"))

Cod_wdat<-Cod_5000_25_10
Flatfish_wdat<-Flatfish_5000_25_10
Sardine_wdat<-Sardine_5000_25_10

re_Dep<-re_SSB<-array(NA, dim=c(3,100,76))
re_R0<-re_M<-matrix(NA, nrow=100, ncol=3)
for(f in 1:3){
  for (i in 1:100){
    if(f==1){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Cod_wdat[[i]]$OM$SSB[26:101])/Cod_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Cod_wdat[[i]]$OM$SSB[26:101]/Cod_wdat[[i]]$OM$SSB0)/(Cod_wdat[[i]]$OM$SSB[26:101]/Cod_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[3])-Cod_wdat[[i]]$OM$R0)/Cod_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Cod_wdat[[i]]$OM$Mref)/Cod_wdat[[i]]$OM$Mref
      
    }else if (f==2){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Flatfish_wdat[[i]]$OM$SSB[26:101])/Flatfish_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Flatfish_wdat[[i]]$OM$SSB[26:101]/Flatfish_wdat[[i]]$OM$SSB0)/(Flatfish_wdat[[i]]$OM$SSB[26:101]/Flatfish_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[3])-Flatfish_wdat[[i]]$OM$R0)/Flatfish_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Flatfish_wdat[[i]]$OM$Mref)/Flatfish_wdat[[i]]$OM$Mref
      
    } else if (f==3){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Sardine_wdat[[i]]$OM$SSB[26:101])/Sardine_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Sardine_wdat[[i]]$OM$SSB[26:101]/Sardine_wdat[[i]]$OM$SSB0)/(Sardine_wdat[[i]]$OM$SSB[26:101]/Sardine_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[3])-Sardine_wdat[[i]]$OM$R0)/Sardine_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Sardine_wdat[[i]]$OM$Mref)/Sardine_wdat[[i]]$OM$Mref
      
    }
  }
}

#SD of relative error for point estimates
sd_RE_ssb_N5000_Ind25_10yrs_noCKMR<-apply(re_SSB,c(1,3),sd, na.rm=TRUE)
sd_RE_R0_N5000_Ind25_10yrs_noCKMR<-apply(re_R0,2,sd, na.rm=TRUE)
sd_RE_M_N5000_Ind25_10yrs_noCKMR<-apply(re_M,2,sd, na.rm=TRUE)

#SD of absolute relative error
sd_ARE_ssb_N5000_Ind25_10yrs_noCKMR<-apply(abs(re_SSB),c(1,3),sd, na.rm=TRUE)
sd_ARE_R0_N5000_Ind25_10yrs_noCKMR<-apply(abs(re_R0),2,sd, na.rm=TRUE)
sd_ARE_M_N5000_Ind25_10yrs_noCKMR<-apply(abs(re_M),2,sd, na.rm=TRUE)

#Precision within sims
SD_ssb_N5000_Ind25_10yrs_noCKMR<-CV_ssb_N5000_Ind25_10yrs_noCKMR<-array(NA, dim=c(3,100,76)) 
SD_R0_N5000_Ind25_10yrs_noCKMR<-matrix(NA, nrow=3, ncol=100)
SD_M_N5000_Ind25_10yrs_noCKMR<-matrix(NA, nrow=3, ncol=100)
for(f in 1:3){
  for (i in 1:100){
    CV_ssb_N5000_Ind25_10yrs_noCKMR[f,i,]<-res_list[[f]][[i]]$SD$sd/res_list[[f]][[i]]$SD$unbiased$value
    SD_ssb_N5000_Ind25_10yrs_noCKMR[f,i,]<-res_list[[f]][[i]]$SD$sd
    SD_R0_N5000_Ind25_10yrs_noCKMR[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_R0","log_R0"])
    SD_M_N5000_Ind25_10yrs_noCKMR[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_M","log_M"])
  }
}

#N100 for 10yrs and index sd 0.50
res_list<-list()
res_list[[1]]<-readRDS(paste0(wd,"/SCAAfit_Cod_N100_Ind50_10yrs_noCKMR.RData"))
res_list[[2]]<-readRDS(paste0(wd,"/SCAAfit_Flatfish_N100_Ind50_10yrs_noCKMR.RData"))
res_list[[3]]<-readRDS(paste0(wd,"/SCAAfit_Sardine_N100_Ind50_10yrs_noCKMR.RData"))

Cod_wdat<-Cod_100_50_10
Flatfish_wdat<-Flatfish_100_50_10
Sardine_wdat<-Sardine_100_50_10

re_Dep<-re_SSB<-array(NA, dim=c(3,100,76))
re_R0<-re_M<-matrix(NA, nrow=100, ncol=3)
for(f in 1:3){
  for (i in 1:100){
    if(f==1){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Cod_wdat[[i]]$OM$SSB[26:101])/Cod_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Cod_wdat[[i]]$OM$SSB[26:101]/Cod_wdat[[i]]$OM$SSB0)/(Cod_wdat[[i]]$OM$SSB[26:101]/Cod_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[3])-Cod_wdat[[i]]$OM$R0)/Cod_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Cod_wdat[[i]]$OM$Mref)/Cod_wdat[[i]]$OM$Mref
      
    }else if (f==2){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Flatfish_wdat[[i]]$OM$SSB[26:101])/Flatfish_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Flatfish_wdat[[i]]$OM$SSB[26:101]/Flatfish_wdat[[i]]$OM$SSB0)/(Flatfish_wdat[[i]]$OM$SSB[26:101]/Flatfish_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[3])-Flatfish_wdat[[i]]$OM$R0)/Flatfish_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Flatfish_wdat[[i]]$OM$Mref)/Flatfish_wdat[[i]]$OM$Mref
      
    } else if (f==3){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Sardine_wdat[[i]]$OM$SSB[26:101])/Sardine_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Sardine_wdat[[i]]$OM$SSB[26:101]/Sardine_wdat[[i]]$OM$SSB0)/(Sardine_wdat[[i]]$OM$SSB[26:101]/Sardine_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[3])-Sardine_wdat[[i]]$OM$R0)/Sardine_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Sardine_wdat[[i]]$OM$Mref)/Sardine_wdat[[i]]$OM$Mref
      
    }
  }
}

#SSB
par(mfrow=c(3,3))
boxplot(re_SSB[1,,], ylim=c(-0.50,0.50), las=1, main="Cod - N200, Index SD - 0.50, CKMR 10yrs", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[2,,], ylim=c(-0.50,0.50), las=1, main="Flatfish - N200, Index SD - 0.50, CKMR 10yrs", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[3,,], ylim=c(-0.50,0.50), las=1, main="Sardine - N200, Index SD - 0.50, CKMR 10yrs", ylab="RE - SSB")
abline(h=0)

#R0
boxplot(re_R0[,1], ylim=c(-0.50,0.50), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,2], ylim=c(-0.50,0.50), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,3], ylim=c(-0.50,0.50), las=1, main="", ylab="RE - R0")
abline(h=0)

#M
boxplot(re_M[,1], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,2], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,3], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)

#SD of relative error for point estimates
sd_RE_ssb_N100_Ind50_10yrs_noCKMR<-apply(re_SSB,c(1,3),sd, na.rm=TRUE)
sd_RE_R0_N100_Ind50_10yrs_noCKMR<-apply(re_R0,2,sd, na.rm=TRUE)
sd_RE_M_N100_Ind50_10yrs_noCKMR<-apply(re_M,2,sd, na.rm=TRUE)

#SD of absolute relative error
sd_ARE_ssb_N100_Ind50_10yrs_noCKMR<-apply(abs(re_SSB),c(1,3),sd, na.rm=TRUE)
sd_ARE_R0_N100_Ind50_10yrs_noCKMR<-apply(abs(re_R0),2,sd, na.rm=TRUE)
sd_ARE_M_N100_Ind50_10yrs_noCKMR<-apply(abs(re_M),2,sd, na.rm=TRUE)

#Precision within sims
SD_ssb_N100_Ind50_10yrs_noCKMR<-CV_ssb_N100_Ind50_10yrs_noCKMR<-array(NA, dim=c(3,100,76)) 
SD_R0_N100_Ind50_10yrs_noCKMR<-matrix(NA, nrow=3, ncol=100)
SD_M_N100_Ind50_10yrs_noCKMR<-matrix(NA, nrow=3, ncol=100)
for(f in 1:3){
  for (i in 1:100){
    CV_ssb_N100_Ind50_10yrs_noCKMR[f,i,]<-res_list[[f]][[i]]$SD$sd/res_list[[f]][[i]]$SD$unbiased$value
    SD_ssb_N100_Ind50_10yrs_noCKMR[f,i,]<-res_list[[f]][[i]]$SD$sd
    SD_R0_N100_Ind50_10yrs_noCKMR[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_R0","log_R0"])
    SD_M_N100_Ind50_10yrs_noCKMR[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_M","log_M"])
  }
}

#N1000 for 10yrs, sd index 0.50
res_list[[1]]<-readRDS(paste0(wd,"/SCAAfit_Cod_N1000_Ind50_10yrs_noCKMR.RData"))
res_list[[2]]<-readRDS(paste0(wd,"/SCAAfit_Flatfish_N1000_Ind50_10yrs_noCKMR.RData"))
res_list[[3]]<-readRDS(paste0(wd,"/SCAAfit_Sardine_N1000_Ind50_10yrs_noCKMR.RData"))

Cod_wdat<-Cod_1000_50_10
Flatfish_wdat<-Flatfish_1000_50_10
Sardine_wdat<-Sardine_1000_50_10

re_Dep<-re_SSB<-array(NA, dim=c(3,100,76))
re_R0<-re_M<-matrix(NA, nrow=100, ncol=3)
for(f in 1:3){
  for (i in 1:100){
    if(f==1){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Cod_wdat[[i]]$OM$SSB[26:101])/Cod_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Cod_wdat[[i]]$OM$SSB[26:101]/Cod_wdat[[i]]$OM$SSB0)/(Cod_wdat[[i]]$OM$SSB[26:101]/Cod_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[3])-Cod_wdat[[i]]$OM$R0)/Cod_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Cod_wdat[[i]]$OM$Mref)/Cod_wdat[[i]]$OM$Mref
      
    }else if (f==2){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Flatfish_wdat[[i]]$OM$SSB[26:101])/Flatfish_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Flatfish_wdat[[i]]$OM$SSB[26:101]/Flatfish_wdat[[i]]$OM$SSB0)/(Flatfish_wdat[[i]]$OM$SSB[26:101]/Flatfish_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[3])-Flatfish_wdat[[i]]$OM$R0)/Flatfish_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Flatfish_wdat[[i]]$OM$Mref)/Flatfish_wdat[[i]]$OM$Mref
      
    } else if (f==3){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Sardine_wdat[[i]]$OM$SSB[26:101])/Sardine_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Sardine_wdat[[i]]$OM$SSB[26:101]/Sardine_wdat[[i]]$OM$SSB0)/(Sardine_wdat[[i]]$OM$SSB[26:101]/Sardine_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[3])-Sardine_wdat[[i]]$OM$R0)/Sardine_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Sardine_wdat[[i]]$OM$Mref)/Sardine_wdat[[i]]$OM$Mref
      
    }
  }
}

#SD of relative error for point estimates
sd_RE_ssb_N1000_Ind50_10yrs_noCKMR<-apply(re_SSB,c(1,3),sd, na.rm=TRUE)
sd_RE_R0_N1000_Ind50_10yrs_noCKMR<-apply(re_R0,2,sd, na.rm=TRUE)
sd_RE_M_N1000_Ind50_10yrs_noCKMR<-apply(re_M,2,sd, na.rm=TRUE)

#SD of absolute relative error
sd_ARE_ssb_N1000_Ind50_10yrs_noCKMR<-apply(abs(re_SSB),c(1,3),sd, na.rm=TRUE)
sd_ARE_R0_N1000_Ind50_10yrs_noCKMR<-apply(abs(re_R0),2,sd, na.rm=TRUE)
sd_ARE_M_N1000_Ind50_10yrs_noCKMR<-apply(abs(re_M),2,sd, na.rm=TRUE)

#Precision within sims
SD_ssb_N1000_Ind50_10yrs_noCKMR<-CV_ssb_N1000_Ind50_10yrs_noCKMR<-array(NA, dim=c(3,100,76)) 
SD_R0_N1000_Ind50_10yrs_noCKMR<-matrix(NA, nrow=3, ncol=100)
SD_M_N1000_Ind50_10yrs_noCKMR<-matrix(NA, nrow=3, ncol=100)
for(f in 1:3){
  for (i in 1:100){
    CV_ssb_N1000_Ind50_10yrs_noCKMR[f,i,]<-res_list[[f]][[i]]$SD$sd/res_list[[f]][[i]]$SD$unbiased$value
    SD_ssb_N1000_Ind50_10yrs_noCKMR[f,i,]<-res_list[[f]][[i]]$SD$sd
    SD_R0_N1000_Ind50_10yrs_noCKMR[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_R0","log_R0"])
    SD_M_N1000_Ind50_10yrs_noCKMR[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_M","log_M"])
  }
}

#N5000 for 10yrs, sd index 0.50
res_list[[1]]<-readRDS(paste0(wd,"/SCAAfit_Cod_N5000_Ind50_10yrs_noCKMR.RData"))
res_list[[2]]<-readRDS(paste0(wd,"/SCAAfit_Flatfish_N5000_Ind50_10yrs_noCKMR.RData"))
res_list[[3]]<-readRDS(paste0(wd,"/SCAAfit_Sardine_N5000_Ind50_10yrs_noCKMR.RData"))

Cod_wdat<-Cod_5000_50_10
Flatfish_wdat<-Flatfish_5000_50_10
Sardine_wdat<-Sardine_5000_50_10

re_Dep<-re_SSB<-array(NA, dim=c(3,100,76))
re_R0<-re_M<-matrix(NA, nrow=100, ncol=3)
for(f in 1:3){
  for (i in 1:100){
    if(f==1){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Cod_wdat[[i]]$OM$SSB[26:101])/Cod_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Cod_wdat[[i]]$OM$SSB[26:101]/Cod_wdat[[i]]$OM$SSB0)/(Cod_wdat[[i]]$OM$SSB[26:101]/Cod_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[3])-Cod_wdat[[i]]$OM$R0)/Cod_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Cod_wdat[[i]]$OM$Mref)/Cod_wdat[[i]]$OM$Mref
      
    }else if (f==2){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Flatfish_wdat[[i]]$OM$SSB[26:101])/Flatfish_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Flatfish_wdat[[i]]$OM$SSB[26:101]/Flatfish_wdat[[i]]$OM$SSB0)/(Flatfish_wdat[[i]]$OM$SSB[26:101]/Flatfish_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[3])-Flatfish_wdat[[i]]$OM$R0)/Flatfish_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Flatfish_wdat[[i]]$OM$Mref)/Flatfish_wdat[[i]]$OM$Mref
      
    } else if (f==3){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Sardine_wdat[[i]]$OM$SSB[26:101])/Sardine_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Sardine_wdat[[i]]$OM$SSB[26:101]/Sardine_wdat[[i]]$OM$SSB0)/(Sardine_wdat[[i]]$OM$SSB[26:101]/Sardine_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[3])-Sardine_wdat[[i]]$OM$R0)/Sardine_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Sardine_wdat[[i]]$OM$Mref)/Sardine_wdat[[i]]$OM$Mref
      
    }
  }
}

#SD of relative error for point estimates
sd_RE_ssb_N5000_Ind50_10yrs_noCKMR<-apply(re_SSB,c(1,3),sd, na.rm=TRUE)
sd_RE_R0_N5000_Ind50_10yrs_noCKMR<-apply(re_R0,2,sd, na.rm=TRUE)
sd_RE_M_N5000_Ind50_10yrs_noCKMR<-apply(re_M,2,sd, na.rm=TRUE)

#SD of absolute relative error
sd_ARE_ssb_N5000_Ind50_10yrs_noCKMR<-apply(abs(re_SSB),c(1,3),sd, na.rm=TRUE)
sd_ARE_R0_N5000_Ind50_10yrs_noCKMR<-apply(abs(re_R0),2,sd, na.rm=TRUE)
sd_ARE_M_N5000_Ind50_10yrs_noCKMR<-apply(abs(re_M),2,sd, na.rm=TRUE)

#Precision within sims
SD_ssb_N5000_Ind50_10yrs_noCKMR<-CV_ssb_N5000_Ind50_10yrs_noCKMR<-array(NA, dim=c(3,100,76)) 
SD_R0_N5000_Ind50_10yrs_noCKMR<-matrix(NA, nrow=3, ncol=100)
SD_M_N5000_Ind50_10yrs_noCKMR<-matrix(NA, nrow=3, ncol=100)
for(f in 1:3){
  for (i in 1:100){
    CV_ssb_N5000_Ind50_10yrs_noCKMR[f,i,]<-res_list[[f]][[i]]$SD$sd/res_list[[f]][[i]]$SD$unbiased$value
    SD_ssb_N5000_Ind50_10yrs_noCKMR[f,i,]<-res_list[[f]][[i]]$SD$sd
    SD_R0_N5000_Ind50_10yrs_noCKMR[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_R0","log_R0"])
    SD_M_N5000_Ind50_10yrs_noCKMR[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_M","log_M"])
  }
}

#########
#20 years
#########

#N100 for 20yrs, and index sd 0.25
res_list<-list()
res_list[[1]]<-readRDS(paste0(wd,"/SCAAfit_Cod_N100_Ind25_20yrs_noCKMR.RData"))
res_list[[2]]<-readRDS(paste0(wd,"/SCAAfit_Flatfish_N100_Ind25_20yrs_noCKMR.RData"))
res_list[[3]]<-readRDS(paste0(wd,"/SCAAfit_Sardine_N100_Ind25_20yrs_noCKMR.RData"))

Cod_wdat<-Cod_100_25_20
Flatfish_wdat<-Flatfish_100_25_20
Sardine_wdat<-Sardine_100_25_20

re_Dep<-re_SSB<-array(NA, dim=c(3,100,76))
re_R0<-re_M<-matrix(NA, nrow=100, ncol=3)
for(f in 1:3){
  for (i in 1:100){
    if(f==1){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Cod_wdat[[i]]$OM$SSB[26:101])/Cod_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Cod_wdat[[i]]$OM$SSB[26:101]/Cod_wdat[[i]]$OM$SSB0)/(Cod_wdat[[i]]$OM$SSB[26:101]/Cod_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[3])-Cod_wdat[[i]]$OM$R0)/Cod_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Cod_wdat[[i]]$OM$Mref)/Cod_wdat[[i]]$OM$Mref
      
    }else if (f==2){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Flatfish_wdat[[i]]$OM$SSB[26:101])/Flatfish_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Flatfish_wdat[[i]]$OM$SSB[26:101]/Flatfish_wdat[[i]]$OM$SSB0)/(Flatfish_wdat[[i]]$OM$SSB[26:101]/Flatfish_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[3])-Flatfish_wdat[[i]]$OM$R0)/Flatfish_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Flatfish_wdat[[i]]$OM$Mref)/Flatfish_wdat[[i]]$OM$Mref
      
    } else if (f==3){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Sardine_wdat[[i]]$OM$SSB[26:101])/Sardine_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Sardine_wdat[[i]]$OM$SSB[26:101]/Sardine_wdat[[i]]$OM$SSB0)/(Sardine_wdat[[i]]$OM$SSB[26:101]/Sardine_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[3])-Sardine_wdat[[i]]$OM$R0)/Sardine_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Sardine_wdat[[i]]$OM$Mref)/Sardine_wdat[[i]]$OM$Mref
      
    }
  }
}

#SSB
par(mfrow=c(3,3))
boxplot(re_SSB[1,,], ylim=c(-0.25,0.25), las=1, main="Cod - N100, Index SD - 0.25", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[2,,], ylim=c(-0.25,0.25), las=1, main="Flatfish - N100, Index SD - 0.25", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[3,,], ylim=c(-0.25,0.25), las=1, main="Sardine - N100, Index SD - 0.25", ylab="RE - SSB")
abline(h=0)

#R0
boxplot(re_R0[,1], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,2], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,3], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)

#M
boxplot(re_M[,1], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,2], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,3], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)

#SD of relative error for point estimates
sd_RE_ssb_N100_Ind25_20yrs_noCKMR<-apply(re_SSB,c(1,3),sd, na.rm=TRUE)
sd_RE_R0_N100_Ind25_20yrs_noCKMR<-apply(re_R0,2,sd, na.rm=TRUE)
sd_RE_M_N100_Ind25_20yrs_noCKMR<-apply(re_M,2,sd, na.rm=TRUE)

#SD of absolute relative error
sd_ARE_ssb_N100_Ind25_20yrs_noCKMR<-apply(abs(re_SSB),c(1,3),sd, na.rm=TRUE)
sd_ARE_R0_N100_Ind25_20yrs_noCKMR<-apply(abs(re_R0),2,sd, na.rm=TRUE)
sd_ARE_M_N100_Ind25_20yrs_noCKMR<-apply(abs(re_M),2,sd, na.rm=TRUE)

#Precision within sims
SD_ssb_N100_Ind25_20yrs_noCKMR<-CV_ssb_N100_Ind25_20yrs_noCKMR<-array(NA, dim=c(3,100,76)) 
SD_R0_N100_Ind25_20yrs_noCKMR<-matrix(NA, nrow=3, ncol=100)
SD_M_N100_Ind25_20yrs_noCKMR<-matrix(NA, nrow=3, ncol=100)
for(f in 1:3){
  for (i in 1:100){
    CV_ssb_N100_Ind25_20yrs_noCKMR[f,i,]<-res_list[[f]][[i]]$SD$sd/res_list[[f]][[i]]$SD$unbiased$value
    SD_ssb_N100_Ind25_20yrs_noCKMR[f,i,]<-res_list[[f]][[i]]$SD$sd
    SD_R0_N100_Ind25_20yrs_noCKMR[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_R0","log_R0"])
    SD_M_N100_Ind25_20yrs_noCKMR[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_M","log_M"])
  }
}

#N1000 for 20yrs, sd index 0.25
res_list[[1]]<-readRDS(paste0(wd,"/SCAAfit_Cod_N1000_Ind25_20yrs_noCKMR.RData"))
res_list[[2]]<-readRDS(paste0(wd,"/SCAAfit_Flatfish_N1000_Ind25_20yrs_noCKMR.RData"))
res_list[[3]]<-readRDS(paste0(wd,"/SCAAfit_Sardine_N1000_Ind25_20yrs_noCKMR.RData"))

Cod_wdat<-Cod_1000_25_20
Flatfish_wdat<-Flatfish_1000_25_20
Sardine_wdat<-Sardine_1000_25_20

re_Dep<-re_SSB<-array(NA, dim=c(3,100,76))
re_R0<-re_M<-matrix(NA, nrow=100, ncol=3)
for(f in 1:3){
  for (i in 1:100){
    if(f==1){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Cod_wdat[[i]]$OM$SSB[26:101])/Cod_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Cod_wdat[[i]]$OM$SSB[26:101]/Cod_wdat[[i]]$OM$SSB0)/(Cod_wdat[[i]]$OM$SSB[26:101]/Cod_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[3])-Cod_wdat[[i]]$OM$R0)/Cod_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Cod_wdat[[i]]$OM$Mref)/Cod_wdat[[i]]$OM$Mref
      
    }else if (f==2){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Flatfish_wdat[[i]]$OM$SSB[26:101])/Flatfish_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Flatfish_wdat[[i]]$OM$SSB[26:101]/Flatfish_wdat[[i]]$OM$SSB0)/(Flatfish_wdat[[i]]$OM$SSB[26:101]/Flatfish_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[3])-Flatfish_wdat[[i]]$OM$R0)/Flatfish_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Flatfish_wdat[[i]]$OM$Mref)/Flatfish_wdat[[i]]$OM$Mref
      
    } else if (f==3){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Sardine_wdat[[i]]$OM$SSB[26:101])/Sardine_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Sardine_wdat[[i]]$OM$SSB[26:101]/Sardine_wdat[[i]]$OM$SSB0)/(Sardine_wdat[[i]]$OM$SSB[26:101]/Sardine_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[3])-Sardine_wdat[[i]]$OM$R0)/Sardine_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Sardine_wdat[[i]]$OM$Mref)/Sardine_wdat[[i]]$OM$Mref
      
    }
  }
}

#SD of relative error for point estimates
sd_RE_ssb_N1000_Ind25_20yrs_noCKMR<-apply(re_SSB,c(1,3),sd, na.rm=TRUE)
sd_RE_R0_N1000_Ind25_20yrs_noCKMR<-apply(re_R0,2,sd, na.rm=TRUE)
sd_RE_M_N1000_Ind25_20yrs_noCKMR<-apply(re_M,2,sd, na.rm=TRUE)

#SD of absolute relative error
sd_ARE_ssb_N1000_Ind25_20yrs_noCKMR<-apply(abs(re_SSB),c(1,3),sd, na.rm=TRUE)
sd_ARE_R0_N1000_Ind25_20yrs_noCKMR<-apply(abs(re_R0),2,sd, na.rm=TRUE)
sd_ARE_M_N1000_Ind25_20yrs_noCKMR<-apply(abs(re_M),2,sd, na.rm=TRUE)

#Precision within sims
SD_ssb_N1000_Ind25_20yrs_noCKMR<-CV_ssb_N1000_Ind25_20yrs_noCKMR<-array(NA, dim=c(3,100,76)) 
SD_R0_N1000_Ind25_20yrs_noCKMR<-matrix(NA, nrow=3, ncol=100)
SD_M_N1000_Ind25_20yrs_noCKMR<-matrix(NA, nrow=3, ncol=100)
for(f in 1:3){
  for (i in 1:100){
    CV_ssb_N1000_Ind25_20yrs_noCKMR[f,i,]<-res_list[[f]][[i]]$SD$sd/res_list[[f]][[i]]$SD$unbiased$value
    SD_ssb_N1000_Ind25_20yrs_noCKMR[f,i,]<-res_list[[f]][[i]]$SD$sd
    SD_R0_N1000_Ind25_20yrs_noCKMR[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_R0","log_R0"])
    SD_M_N1000_Ind25_20yrs_noCKMR[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_M","log_M"])
  }
}

#N5000 for 20yrs, sd index 0.25
res_list[[1]]<-readRDS(paste0(wd,"/SCAAfit_Cod_N5000_Ind25_20yrs_noCKMR.RData"))
res_list[[2]]<-readRDS(paste0(wd,"/SCAAfit_Flatfish_N5000_Ind25_20yrs_noCKMR.RData"))
res_list[[3]]<-readRDS(paste0(wd,"/SCAAfit_Sardine_N5000_Ind25_20yrs_noCKMR.RData"))

Cod_wdat<-Cod_5000_25_20
Flatfish_wdat<-Flatfish_5000_25_20
Sardine_wdat<-Sardine_5000_25_20

re_Dep<-re_SSB<-array(NA, dim=c(3,100,76))
re_R0<-re_M<-matrix(NA, nrow=100, ncol=3)
for(f in 1:3){
  for (i in 1:100){
    if(f==1){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Cod_wdat[[i]]$OM$SSB[26:101])/Cod_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Cod_wdat[[i]]$OM$SSB[26:101]/Cod_wdat[[i]]$OM$SSB0)/(Cod_wdat[[i]]$OM$SSB[26:101]/Cod_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[3])-Cod_wdat[[i]]$OM$R0)/Cod_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Cod_wdat[[i]]$OM$Mref)/Cod_wdat[[i]]$OM$Mref
      
    }else if (f==2){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Flatfish_wdat[[i]]$OM$SSB[26:101])/Flatfish_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Flatfish_wdat[[i]]$OM$SSB[26:101]/Flatfish_wdat[[i]]$OM$SSB0)/(Flatfish_wdat[[i]]$OM$SSB[26:101]/Flatfish_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[3])-Flatfish_wdat[[i]]$OM$R0)/Flatfish_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Flatfish_wdat[[i]]$OM$Mref)/Flatfish_wdat[[i]]$OM$Mref
      
    } else if (f==3){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Sardine_wdat[[i]]$OM$SSB[26:101])/Sardine_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Sardine_wdat[[i]]$OM$SSB[26:101]/Sardine_wdat[[i]]$OM$SSB0)/(Sardine_wdat[[i]]$OM$SSB[26:101]/Sardine_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[3])-Sardine_wdat[[i]]$OM$R0)/Sardine_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Sardine_wdat[[i]]$OM$Mref)/Sardine_wdat[[i]]$OM$Mref
      
    }
  }
}

#SD of relative error for point estimates
sd_RE_ssb_N5000_Ind25_20yrs_noCKMR<-apply(re_SSB,c(1,3),sd, na.rm=TRUE)
sd_RE_R0_N5000_Ind25_20yrs_noCKMR<-apply(re_R0,2,sd, na.rm=TRUE)
sd_RE_M_N5000_Ind25_20yrs_noCKMR<-apply(re_M,2,sd, na.rm=TRUE)

#SD of absolute relative error
sd_ARE_ssb_N5000_Ind25_20yrs_noCKMR<-apply(abs(re_SSB),c(1,3),sd, na.rm=TRUE)
sd_ARE_R0_N5000_Ind25_20yrs_noCKMR<-apply(abs(re_R0),2,sd, na.rm=TRUE)
sd_ARE_M_N5000_Ind25_20yrs_noCKMR<-apply(abs(re_M),2,sd, na.rm=TRUE)

#Precision within sims
SD_ssb_N5000_Ind25_20yrs_noCKMR<-CV_ssb_N5000_Ind25_20yrs_noCKMR<-array(NA, dim=c(3,100,76)) 
SD_R0_N5000_Ind25_20yrs_noCKMR<-matrix(NA, nrow=3, ncol=100)
SD_M_N5000_Ind25_20yrs_noCKMR<-matrix(NA, nrow=3, ncol=100)
for(f in 1:3){
  for (i in 1:100){
    CV_ssb_N5000_Ind25_20yrs_noCKMR[f,i,]<-res_list[[f]][[i]]$SD$sd/res_list[[f]][[i]]$SD$unbiased$value
    SD_ssb_N5000_Ind25_20yrs_noCKMR[f,i,]<-res_list[[f]][[i]]$SD$sd
    SD_R0_N5000_Ind25_20yrs_noCKMR[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_R0","log_R0"])
    SD_M_N5000_Ind25_20yrs_noCKMR[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_M","log_M"])
  }
}

#N100 for 20yrs and index sd 0.50
res_list<-list()
res_list[[1]]<-readRDS(paste0(wd,"/SCAAfit_Cod_N100_Ind50_20yrs_noCKMR.RData"))
res_list[[2]]<-readRDS(paste0(wd,"/SCAAfit_Flatfish_N100_Ind50_20yrs_noCKMR.RData"))
res_list[[3]]<-readRDS(paste0(wd,"/SCAAfit_Sardine_N100_Ind50_20yrs_noCKMR.RData"))

Cod_wdat<-Cod_100_50_20
Flatfish_wdat<-Flatfish_100_50_20
Sardine_wdat<-Sardine_100_50_20

re_Dep<-re_SSB<-array(NA, dim=c(3,100,76))
re_R0<-re_M<-matrix(NA, nrow=100, ncol=3)
for(f in 1:3){
  for (i in 1:100){
    if(f==1){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Cod_wdat[[i]]$OM$SSB[26:101])/Cod_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Cod_wdat[[i]]$OM$SSB[26:101]/Cod_wdat[[i]]$OM$SSB0)/(Cod_wdat[[i]]$OM$SSB[26:101]/Cod_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[3])-Cod_wdat[[i]]$OM$R0)/Cod_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Cod_wdat[[i]]$OM$Mref)/Cod_wdat[[i]]$OM$Mref
      
    }else if (f==2){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Flatfish_wdat[[i]]$OM$SSB[26:101])/Flatfish_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Flatfish_wdat[[i]]$OM$SSB[26:101]/Flatfish_wdat[[i]]$OM$SSB0)/(Flatfish_wdat[[i]]$OM$SSB[26:101]/Flatfish_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[3])-Flatfish_wdat[[i]]$OM$R0)/Flatfish_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Flatfish_wdat[[i]]$OM$Mref)/Flatfish_wdat[[i]]$OM$Mref
      
    } else if (f==3){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Sardine_wdat[[i]]$OM$SSB[26:101])/Sardine_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Sardine_wdat[[i]]$OM$SSB[26:101]/Sardine_wdat[[i]]$OM$SSB0)/(Sardine_wdat[[i]]$OM$SSB[26:101]/Sardine_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[3])-Sardine_wdat[[i]]$OM$R0)/Sardine_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Sardine_wdat[[i]]$OM$Mref)/Sardine_wdat[[i]]$OM$Mref
      
    }
  }
}

#SSB
par(mfrow=c(3,3))
boxplot(re_SSB[1,,], ylim=c(-0.50,0.50), las=1, main="Cod - N200, Index SD - 0.50, CKMR 20yrs", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[2,,], ylim=c(-0.50,0.50), las=1, main="Flatfish - N200, Index SD - 0.50, CKMR 20yrs", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[3,,], ylim=c(-0.50,0.50), las=1, main="Sardine - N200, Index SD - 0.50, CKMR 20yrs", ylab="RE - SSB")
abline(h=0)

#R0
boxplot(re_R0[,1], ylim=c(-0.50,0.50), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,2], ylim=c(-0.50,0.50), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,3], ylim=c(-0.50,0.50), las=1, main="", ylab="RE - R0")
abline(h=0)

#M
boxplot(re_M[,1], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,2], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,3], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)

#SD of relative error for point estimates
sd_RE_ssb_N100_Ind50_20yrs_noCKMR<-apply(re_SSB,c(1,3),sd, na.rm=TRUE)
sd_RE_R0_N100_Ind50_20yrs_noCKMR<-apply(re_R0,2,sd, na.rm=TRUE)
sd_RE_M_N100_Ind50_20yrs_noCKMR<-apply(re_M,2,sd, na.rm=TRUE)

#SD of absolute relative error
sd_ARE_ssb_N100_Ind50_20yrs_noCKMR<-apply(abs(re_SSB),c(1,3),sd, na.rm=TRUE)
sd_ARE_R0_N100_Ind50_20yrs_noCKMR<-apply(abs(re_R0),2,sd, na.rm=TRUE)
sd_ARE_M_N100_Ind50_20yrs_noCKMR<-apply(abs(re_M),2,sd, na.rm=TRUE)

#Precision within sims
SD_ssb_N100_Ind50_20yrs_noCKMR<-CV_ssb_N100_Ind50_20yrs_noCKMR<-array(NA, dim=c(3,100,76)) 
SD_R0_N100_Ind50_20yrs_noCKMR<-matrix(NA, nrow=3, ncol=100)
SD_M_N100_Ind50_20yrs_noCKMR<-matrix(NA, nrow=3, ncol=100)
for(f in 1:3){
  for (i in 1:100){
    CV_ssb_N100_Ind50_20yrs_noCKMR[f,i,]<-res_list[[f]][[i]]$SD$sd/res_list[[f]][[i]]$SD$unbiased$value
    SD_ssb_N100_Ind50_20yrs_noCKMR[f,i,]<-res_list[[f]][[i]]$SD$sd
    SD_R0_N100_Ind50_20yrs_noCKMR[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_R0","log_R0"])
    SD_M_N100_Ind50_20yrs_noCKMR[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_M","log_M"])
  }
}

#N1000 for 20yrs, sd index 0.50
res_list[[1]]<-readRDS(paste0(wd,"/SCAAfit_Cod_N1000_Ind50_20yrs_noCKMR.RData"))
res_list[[2]]<-readRDS(paste0(wd,"/SCAAfit_Flatfish_N1000_Ind50_20yrs_noCKMR.RData"))
res_list[[3]]<-readRDS(paste0(wd,"/SCAAfit_Sardine_N1000_Ind50_20yrs_noCKMR.RData"))

Cod_wdat<-Cod_1000_50_20
Flatfish_wdat<-Flatfish_1000_50_20
Sardine_wdat<-Sardine_1000_50_20

re_Dep<-re_SSB<-array(NA, dim=c(3,100,76))
re_R0<-re_M<-matrix(NA, nrow=100, ncol=3)
for(f in 1:3){
  for (i in 1:100){
    if(f==1){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Cod_wdat[[i]]$OM$SSB[26:101])/Cod_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Cod_wdat[[i]]$OM$SSB[26:101]/Cod_wdat[[i]]$OM$SSB0)/(Cod_wdat[[i]]$OM$SSB[26:101]/Cod_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[3])-Cod_wdat[[i]]$OM$R0)/Cod_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Cod_wdat[[i]]$OM$Mref)/Cod_wdat[[i]]$OM$Mref
      
    }else if (f==2){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Flatfish_wdat[[i]]$OM$SSB[26:101])/Flatfish_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Flatfish_wdat[[i]]$OM$SSB[26:101]/Flatfish_wdat[[i]]$OM$SSB0)/(Flatfish_wdat[[i]]$OM$SSB[26:101]/Flatfish_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[3])-Flatfish_wdat[[i]]$OM$R0)/Flatfish_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Flatfish_wdat[[i]]$OM$Mref)/Flatfish_wdat[[i]]$OM$Mref
      
    } else if (f==3){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Sardine_wdat[[i]]$OM$SSB[26:101])/Sardine_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Sardine_wdat[[i]]$OM$SSB[26:101]/Sardine_wdat[[i]]$OM$SSB0)/(Sardine_wdat[[i]]$OM$SSB[26:101]/Sardine_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[3])-Sardine_wdat[[i]]$OM$R0)/Sardine_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Sardine_wdat[[i]]$OM$Mref)/Sardine_wdat[[i]]$OM$Mref
      
    }
  }
}

#SD of relative error for point estimates
sd_RE_ssb_N1000_Ind50_20yrs_noCKMR<-apply(re_SSB,c(1,3),sd, na.rm=TRUE)
sd_RE_R0_N1000_Ind50_20yrs_noCKMR<-apply(re_R0,2,sd, na.rm=TRUE)
sd_RE_M_N1000_Ind50_20yrs_noCKMR<-apply(re_M,2,sd, na.rm=TRUE)

#SD of absolute relative error
sd_ARE_ssb_N1000_Ind50_20yrs_noCKMR<-apply(abs(re_SSB),c(1,3),sd, na.rm=TRUE)
sd_ARE_R0_N1000_Ind50_20yrs_noCKMR<-apply(abs(re_R0),2,sd, na.rm=TRUE)
sd_ARE_M_N1000_Ind50_20yrs_noCKMR<-apply(abs(re_M),2,sd, na.rm=TRUE)

#Precision within sims
SD_ssb_N1000_Ind50_20yrs_noCKMR<-CV_ssb_N1000_Ind50_20yrs_noCKMR<-array(NA, dim=c(3,100,76)) 
SD_R0_N1000_Ind50_20yrs_noCKMR<-matrix(NA, nrow=3, ncol=100)
SD_M_N1000_Ind50_20yrs_noCKMR<-matrix(NA, nrow=3, ncol=100)
for(f in 1:3){
  for (i in 1:100){
    CV_ssb_N1000_Ind50_20yrs_noCKMR[f,i,]<-res_list[[f]][[i]]$SD$sd/res_list[[f]][[i]]$SD$unbiased$value
    SD_ssb_N1000_Ind50_20yrs_noCKMR[f,i,]<-res_list[[f]][[i]]$SD$sd
    SD_R0_N1000_Ind50_20yrs_noCKMR[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_R0","log_R0"])
    SD_M_N1000_Ind50_20yrs_noCKMR[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_M","log_M"])
  }
}

#N5000 for 20yrs, sd index 0.50
res_list[[1]]<-readRDS(paste0(wd,"/SCAAfit_Cod_N5000_Ind50_20yrs_noCKMR.RData"))
res_list[[2]]<-readRDS(paste0(wd,"/SCAAfit_Flatfish_N5000_Ind50_20yrs_noCKMR.RData"))
res_list[[3]]<-readRDS(paste0(wd,"/SCAAfit_Sardine_N5000_Ind50_20yrs_noCKMR.RData"))

Cod_wdat<-Cod_5000_50_20
Flatfish_wdat<-Flatfish_5000_50_20
Sardine_wdat<-Sardine_5000_50_20

re_Dep<-re_SSB<-array(NA, dim=c(3,100,76))
re_R0<-re_M<-matrix(NA, nrow=100, ncol=3)
for(f in 1:3){
  for (i in 1:100){
    if(f==1){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Cod_wdat[[i]]$OM$SSB[26:101])/Cod_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Cod_wdat[[i]]$OM$SSB[26:101]/Cod_wdat[[i]]$OM$SSB0)/(Cod_wdat[[i]]$OM$SSB[26:101]/Cod_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[3])-Cod_wdat[[i]]$OM$R0)/Cod_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Cod_wdat[[i]]$OM$Mref)/Cod_wdat[[i]]$OM$Mref
      
    }else if (f==2){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Flatfish_wdat[[i]]$OM$SSB[26:101])/Flatfish_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Flatfish_wdat[[i]]$OM$SSB[26:101]/Flatfish_wdat[[i]]$OM$SSB0)/(Flatfish_wdat[[i]]$OM$SSB[26:101]/Flatfish_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[3])-Flatfish_wdat[[i]]$OM$R0)/Flatfish_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Flatfish_wdat[[i]]$OM$Mref)/Flatfish_wdat[[i]]$OM$Mref
      
    } else if (f==3){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Sardine_wdat[[i]]$OM$SSB[26:101])/Sardine_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Sardine_wdat[[i]]$OM$SSB[26:101]/Sardine_wdat[[i]]$OM$SSB0)/(Sardine_wdat[[i]]$OM$SSB[26:101]/Sardine_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[3])-Sardine_wdat[[i]]$OM$R0)/Sardine_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Sardine_wdat[[i]]$OM$Mref)/Sardine_wdat[[i]]$OM$Mref
      
    }
  }
}

#SD of relative error for point estimates
sd_RE_ssb_N5000_Ind50_20yrs_noCKMR<-apply(re_SSB,c(1,3),sd, na.rm=TRUE)
sd_RE_R0_N5000_Ind50_20yrs_noCKMR<-apply(re_R0,2,sd, na.rm=TRUE)
sd_RE_M_N5000_Ind50_20yrs_noCKMR<-apply(re_M,2,sd, na.rm=TRUE)

#SD of absolute relative error
sd_ARE_ssb_N5000_Ind50_20yrs_noCKMR<-apply(abs(re_SSB),c(1,3),sd, na.rm=TRUE)
sd_ARE_R0_N5000_Ind50_20yrs_noCKMR<-apply(abs(re_R0),2,sd, na.rm=TRUE)
sd_ARE_M_N5000_Ind50_20yrs_noCKMR<-apply(abs(re_M),2,sd, na.rm=TRUE)

#Precision within sims
SD_ssb_N5000_Ind50_20yrs_noCKMR<-CV_ssb_N5000_Ind50_20yrs_noCKMR<-array(NA, dim=c(3,100,76)) 
SD_R0_N5000_Ind50_20yrs_noCKMR<-matrix(NA, nrow=3, ncol=100)
SD_M_N5000_Ind50_20yrs_noCKMR<-matrix(NA, nrow=3, ncol=100)
for(f in 1:3){
  for (i in 1:100){
    CV_ssb_N5000_Ind50_20yrs_noCKMR[f,i,]<-res_list[[f]][[i]]$SD$sd/res_list[[f]][[i]]$SD$unbiased$value
    SD_ssb_N5000_Ind50_20yrs_noCKMR[f,i,]<-res_list[[f]][[i]]$SD$sd
    SD_R0_N5000_Ind50_20yrs_noCKMR[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_R0","log_R0"])
    SD_M_N5000_Ind50_20yrs_noCKMR[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_M","log_M"])
  }
}

###########################################
#SCAAs with No Index data and No CKMR
###########################################

#N100 for 5yrs, No Index
res_list<-list()
res_list[[1]]<-readRDS(paste0(wd,"/SCAAfit_Cod_N100_NoIndex_5yrs_noCKMR.RData"))
res_list[[2]]<-readRDS(paste0(wd,"/SCAAfit_Flatfish_N100_NoIndex_5yrs_noCKMR.RData"))
res_list[[3]]<-readRDS(paste0(wd,"/SCAAfit_Sardine_N100_NoIndex_5yrs_noCKMR.RData"))

Cod_wdat<-Cod_100_25_5
Flatfish_wdat<-Flatfish_100_25_5
Sardine_wdat<-Sardine_100_25_5

re_Dep<-re_SSB<-array(NA, dim=c(3,100,76))
re_R0<-re_M<-matrix(NA, nrow=100, ncol=3)
for(f in 1:3){
  for (i in 1:100){
    if(f==1){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Cod_wdat[[i]]$OM$SSB[26:101])/Cod_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Cod_wdat[[i]]$OM$SSB[26:101]/Cod_wdat[[i]]$OM$SSB0)/(Cod_wdat[[i]]$OM$SSB[26:101]/Cod_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[2])-Cod_wdat[[i]]$OM$R0)/Cod_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Cod_wdat[[i]]$OM$Mref)/Cod_wdat[[i]]$OM$Mref
      
    }else if (f==2){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Flatfish_wdat[[i]]$OM$SSB[26:101])/Flatfish_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Flatfish_wdat[[i]]$OM$SSB[26:101]/Flatfish_wdat[[i]]$OM$SSB0)/(Flatfish_wdat[[i]]$OM$SSB[26:101]/Flatfish_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[2])-Flatfish_wdat[[i]]$OM$R0)/Flatfish_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Flatfish_wdat[[i]]$OM$Mref)/Flatfish_wdat[[i]]$OM$Mref
      
    } else if (f==3){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Sardine_wdat[[i]]$OM$SSB[26:101])/Sardine_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Sardine_wdat[[i]]$OM$SSB[26:101]/Sardine_wdat[[i]]$OM$SSB0)/(Sardine_wdat[[i]]$OM$SSB[26:101]/Sardine_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[2])-Sardine_wdat[[i]]$OM$R0)/Sardine_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Sardine_wdat[[i]]$OM$Mref)/Sardine_wdat[[i]]$OM$Mref
      
    }
  }
}

#SSB
par(mfrow=c(3,3))
boxplot(re_SSB[1,,], ylim=c(-0.25,0.25), las=1, main="Cod - N100, No Index", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[2,,], ylim=c(-0.25,0.25), las=1, main="Flatfish - N100, No Index", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[3,,], ylim=c(-0.25,0.25), las=1, main="Sardine - N100, No Index", ylab="RE - SSB")
abline(h=0)

#R0
boxplot(re_R0[,1], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,2], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,3], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)

#M
boxplot(re_M[,1], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,2], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,3], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)

#SD of relative error for point estimates
sd_RE_ssb_N100_NoIndex_5yrs_noCKMR<-apply(re_SSB,c(1,3),sd, na.rm=TRUE)
sd_RE_R0_N100_NoIndex_5yrs_noCKMR<-apply(re_R0,2,sd, na.rm=TRUE)
sd_RE_M_N100_NoIndex_5yrs_noCKMR<-apply(re_M,2,sd, na.rm=TRUE)

#SD of absolute relative error
sd_ARE_ssb_N100_NoIndex_5yrs_noCKMR<-apply(abs(re_SSB),c(1,3),sd, na.rm=TRUE)
sd_ARE_R0_N100_NoIndex_5yrs_noCKMR<-apply(abs(re_R0),2,sd, na.rm=TRUE)
sd_ARE_M_N100_NoIndex_5yrs_noCKMR<-apply(abs(re_M),2,sd, na.rm=TRUE)

#Precision within sims
SD_ssb_N100_NoIndex_5yrs_noCKMR<-CV_ssb_N100_NoIndex_5yrs_noCKMR<-array(NA, dim=c(3,100,76)) 
SD_R0_N100_NoIndex_5yrs_noCKMR<-matrix(NA, nrow=3, ncol=100)
SD_M_N100_NoIndex_5yrs_noCKMR<-matrix(NA, nrow=3, ncol=100)
for(f in 1:3){
  for (i in 1:100){
    CV_ssb_N100_NoIndex_5yrs_noCKMR[f,i,]<-res_list[[f]][[i]]$SD$sd/res_list[[f]][[i]]$SD$unbiased$value
    SD_ssb_N100_NoIndex_5yrs_noCKMR[f,i,]<-res_list[[f]][[i]]$SD$sd
    SD_R0_N100_NoIndex_5yrs_noCKMR[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_R0","log_R0"])
    SD_M_N100_NoIndex_5yrs_noCKMR[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_M","log_M"])
  }
}

#N1000 for 5 yrs, No Index
res_list[[1]]<-readRDS(paste0(wd,"/SCAAfit_Cod_N1000_NoIndex_5yrs_noCKMR.RData"))
res_list[[2]]<-readRDS(paste0(wd,"/SCAAfit_Flatfish_N1000_NoIndex_5yrs_noCKMR.RData"))
res_list[[3]]<-readRDS(paste0(wd,"/SCAAfit_Sardine_N1000_NoIndex_5yrs_noCKMR.RData"))

Cod_wdat<-Cod_1000_25_5
Flatfish_wdat<-Flatfish_1000_25_5
Sardine_wdat<-Sardine_1000_25_5

re_Dep<-re_SSB<-array(NA, dim=c(3,100,76))
re_R0<-re_M<-matrix(NA, nrow=100, ncol=3)
for(f in 1:3){
  for (i in 1:100){
    if(f==1){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Cod_wdat[[i]]$OM$SSB[26:101])/Cod_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Cod_wdat[[i]]$OM$SSB[26:101]/Cod_wdat[[i]]$OM$SSB0)/(Cod_wdat[[i]]$OM$SSB[26:101]/Cod_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[2])-Cod_wdat[[i]]$OM$R0)/Cod_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Cod_wdat[[i]]$OM$Mref)/Cod_wdat[[i]]$OM$Mref
      
    }else if (f==2){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Flatfish_wdat[[i]]$OM$SSB[26:101])/Flatfish_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Flatfish_wdat[[i]]$OM$SSB[26:101]/Flatfish_wdat[[i]]$OM$SSB0)/(Flatfish_wdat[[i]]$OM$SSB[26:101]/Flatfish_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[2])-Flatfish_wdat[[i]]$OM$R0)/Flatfish_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Flatfish_wdat[[i]]$OM$Mref)/Flatfish_wdat[[i]]$OM$Mref
      
    } else if (f==3){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Sardine_wdat[[i]]$OM$SSB[26:101])/Sardine_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Sardine_wdat[[i]]$OM$SSB[26:101]/Sardine_wdat[[i]]$OM$SSB0)/(Sardine_wdat[[i]]$OM$SSB[26:101]/Sardine_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[2])-Sardine_wdat[[i]]$OM$R0)/Sardine_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Sardine_wdat[[i]]$OM$Mref)/Sardine_wdat[[i]]$OM$Mref
      
    }
  }
}

#SD of relative error for point estimates
sd_RE_ssb_N1000_NoIndex_5yrs_noCKMR<-apply(re_SSB,c(1,3),sd, na.rm=TRUE)
sd_RE_R0_N1000_NoIndex_5yrs_noCKMR<-apply(re_R0,2,sd, na.rm=TRUE)
sd_RE_M_N1000_NoIndex_5yrs_noCKMR<-apply(re_M,2,sd, na.rm=TRUE)

#SD of absolute relative error
sd_ARE_ssb_N1000_NoIndex_5yrs_noCKMR<-apply(abs(re_SSB),c(1,3),sd, na.rm=TRUE)
sd_ARE_R0_N1000_NoIndex_5yrs_noCKMR<-apply(abs(re_R0),2,sd, na.rm=TRUE)
sd_ARE_M_N1000_NoIndex_5yrs_noCKMR<-apply(abs(re_M),2,sd, na.rm=TRUE)

#Precision within sims
SD_ssb_N1000_NoIndex_5yrs_noCKMR<-CV_ssb_N1000_NoIndex_5yrs_noCKMR<-array(NA, dim=c(3,100,76)) 
SD_R0_N1000_NoIndex_5yrs_noCKMR<-matrix(NA, nrow=3, ncol=100)
SD_M_N1000_NoIndex_5yrs_noCKMR<-matrix(NA, nrow=3, ncol=100)
for(f in 1:3){
  for (i in 1:100){
    CV_ssb_N1000_NoIndex_5yrs_noCKMR[f,i,]<-res_list[[f]][[i]]$SD$sd/res_list[[f]][[i]]$SD$unbiased$value
    SD_ssb_N1000_NoIndex_5yrs_noCKMR[f,i,]<-res_list[[f]][[i]]$SD$sd
    SD_R0_N1000_NoIndex_5yrs_noCKMR[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_R0","log_R0"])
    SD_M_N1000_NoIndex_5yrs_noCKMR[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_M","log_M"])
  }
}

#N5000 for 5 yrs, No Index
res_list[[1]]<-readRDS(paste0(wd,"/SCAAfit_Cod_N5000_NoIndex_5yrs_noCKMR.RData"))
res_list[[2]]<-readRDS(paste0(wd,"/SCAAfit_Flatfish_N5000_NoIndex_5yrs_noCKMR.RData"))
res_list[[3]]<-readRDS(paste0(wd,"/SCAAfit_Sardine_N5000_NoIndex_5yrs_noCKMR.RData"))

Cod_wdat<-Cod_5000_25_5
Flatfish_wdat<-Flatfish_5000_25_5
Sardine_wdat<-Sardine_5000_25_5

re_Dep<-re_SSB<-array(NA, dim=c(3,100,76))
re_R0<-re_M<-matrix(NA, nrow=100, ncol=3)
for(f in 1:3){
  for (i in 1:100){
    if(f==1){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Cod_wdat[[i]]$OM$SSB[26:101])/Cod_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Cod_wdat[[i]]$OM$SSB[26:101]/Cod_wdat[[i]]$OM$SSB0)/(Cod_wdat[[i]]$OM$SSB[26:101]/Cod_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[2])-Cod_wdat[[i]]$OM$R0)/Cod_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Cod_wdat[[i]]$OM$Mref)/Cod_wdat[[i]]$OM$Mref
      
    }else if (f==2){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Flatfish_wdat[[i]]$OM$SSB[26:101])/Flatfish_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Flatfish_wdat[[i]]$OM$SSB[26:101]/Flatfish_wdat[[i]]$OM$SSB0)/(Flatfish_wdat[[i]]$OM$SSB[26:101]/Flatfish_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[2])-Flatfish_wdat[[i]]$OM$R0)/Flatfish_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Flatfish_wdat[[i]]$OM$Mref)/Flatfish_wdat[[i]]$OM$Mref
      
    } else if (f==3){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Sardine_wdat[[i]]$OM$SSB[26:101])/Sardine_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Sardine_wdat[[i]]$OM$SSB[26:101]/Sardine_wdat[[i]]$OM$SSB0)/(Sardine_wdat[[i]]$OM$SSB[26:101]/Sardine_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[2])-Sardine_wdat[[i]]$OM$R0)/Sardine_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Sardine_wdat[[i]]$OM$Mref)/Sardine_wdat[[i]]$OM$Mref
      
    }
  }
}

#SD of relative error for point estimates
sd_RE_ssb_N5000_NoIndex_5yrs_noCKMR<-apply(re_SSB,c(1,3),sd, na.rm=TRUE)
sd_RE_R0_N5000_NoIndex_5yrs_noCKMR<-apply(re_R0,2,sd, na.rm=TRUE)
sd_RE_M_N5000_NoIndex_5yrs_noCKMR<-apply(re_M,2,sd, na.rm=TRUE)

#SD of absolute relative error
sd_ARE_ssb_N5000_NoIndex_5yrs_noCKMR<-apply(abs(re_SSB),c(1,3),sd, na.rm=TRUE)
sd_ARE_R0_N5000_NoIndex_5yrs_noCKMR<-apply(abs(re_R0),2,sd, na.rm=TRUE)
sd_ARE_M_N5000_NoIndex_5yrs_noCKMR<-apply(abs(re_M),2,sd, na.rm=TRUE)

#Precision within sims
SD_ssb_N5000_NoIndex_5yrs_noCKMR<-CV_ssb_N5000_NoIndex_5yrs_noCKMR<-array(NA, dim=c(3,100,76)) 
SD_R0_N5000_NoIndex_5yrs_noCKMR<-matrix(NA, nrow=3, ncol=100)
SD_M_N5000_NoIndex_5yrs_noCKMR<-matrix(NA, nrow=3, ncol=100)
for(f in 1:3){
  for (i in 1:100){
    CV_ssb_N5000_NoIndex_5yrs_noCKMR[f,i,]<-res_list[[f]][[i]]$SD$sd/res_list[[f]][[i]]$SD$unbiased$value
    SD_ssb_N5000_NoIndex_5yrs_noCKMR[f,i,]<-res_list[[f]][[i]]$SD$sd
    SD_R0_N5000_NoIndex_5yrs_noCKMR[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_R0","log_R0"])
    SD_M_N5000_NoIndex_5yrs_noCKMR[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_M","log_M"])
  }
}

#########
#10 years
#########

#N100 for 10yrs, and No Index
res_list<-list()
res_list[[1]]<-readRDS(paste0(wd,"/SCAAfit_Cod_N100_NoIndex_10yrs_noCKMR.RData"))
res_list[[2]]<-readRDS(paste0(wd,"/SCAAfit_Flatfish_N100_NoIndex_10yrs_noCKMR.RData"))
res_list[[3]]<-readRDS(paste0(wd,"/SCAAfit_Sardine_N100_NoIndex_10yrs_noCKMR.RData"))

Cod_wdat<-Cod_100_25_10
Flatfish_wdat<-Flatfish_100_25_10
Sardine_wdat<-Sardine_100_25_10

re_Dep<-re_SSB<-array(NA, dim=c(3,100,76))
re_R0<-re_M<-matrix(NA, nrow=100, ncol=3)
for(f in 1:3){
  for (i in 1:100){
    if(f==1){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Cod_wdat[[i]]$OM$SSB[26:101])/Cod_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Cod_wdat[[i]]$OM$SSB[26:101]/Cod_wdat[[i]]$OM$SSB0)/(Cod_wdat[[i]]$OM$SSB[26:101]/Cod_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[2])-Cod_wdat[[i]]$OM$R0)/Cod_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Cod_wdat[[i]]$OM$Mref)/Cod_wdat[[i]]$OM$Mref
      
    }else if (f==2){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Flatfish_wdat[[i]]$OM$SSB[26:101])/Flatfish_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Flatfish_wdat[[i]]$OM$SSB[26:101]/Flatfish_wdat[[i]]$OM$SSB0)/(Flatfish_wdat[[i]]$OM$SSB[26:101]/Flatfish_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[2])-Flatfish_wdat[[i]]$OM$R0)/Flatfish_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Flatfish_wdat[[i]]$OM$Mref)/Flatfish_wdat[[i]]$OM$Mref
      
    } else if (f==3){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Sardine_wdat[[i]]$OM$SSB[26:101])/Sardine_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Sardine_wdat[[i]]$OM$SSB[26:101]/Sardine_wdat[[i]]$OM$SSB0)/(Sardine_wdat[[i]]$OM$SSB[26:101]/Sardine_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[2])-Sardine_wdat[[i]]$OM$R0)/Sardine_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Sardine_wdat[[i]]$OM$Mref)/Sardine_wdat[[i]]$OM$Mref
      
    }
  }
}

#SSB
par(mfrow=c(3,3))
boxplot(re_SSB[1,,], ylim=c(-0.25,0.25), las=1, main="Cod - N100, No Index", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[2,,], ylim=c(-0.25,0.25), las=1, main="Flatfish - N100, No Index", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[3,,], ylim=c(-0.25,0.25), las=1, main="Sardine - N100, No Index", ylab="RE - SSB")
abline(h=0)

#R0
boxplot(re_R0[,1], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,2], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,3], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)

#M
boxplot(re_M[,1], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,2], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,3], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)

#SD of relative error for point estimates
sd_RE_ssb_N100_NoIndex_10yrs_noCKMR<-apply(re_SSB,c(1,3),sd, na.rm=TRUE)
sd_RE_R0_N100_NoIndex_10yrs_noCKMR<-apply(re_R0,2,sd, na.rm=TRUE)
sd_RE_M_N100_NoIndex_10yrs_noCKMR<-apply(re_M,2,sd, na.rm=TRUE)

#SD of absolute relative error
sd_ARE_ssb_N100_NoIndex_10yrs_noCKMR<-apply(abs(re_SSB),c(1,3),sd, na.rm=TRUE)
sd_ARE_R0_N100_NoIndex_10yrs_noCKMR<-apply(abs(re_R0),2,sd, na.rm=TRUE)
sd_ARE_M_N100_NoIndex_10yrs_noCKMR<-apply(abs(re_M),2,sd, na.rm=TRUE)

#Precision within sims
SD_ssb_N100_NoIndex_10yrs_noCKMR<-CV_ssb_N100_NoIndex_10yrs_noCKMR<-array(NA, dim=c(3,100,76)) 
SD_R0_N100_NoIndex_10yrs_noCKMR<-matrix(NA, nrow=3, ncol=100)
SD_M_N100_NoIndex_10yrs_noCKMR<-matrix(NA, nrow=3, ncol=100)
for(f in 1:3){
  for (i in 1:100){
    CV_ssb_N100_NoIndex_10yrs_noCKMR[f,i,]<-res_list[[f]][[i]]$SD$sd/res_list[[f]][[i]]$SD$unbiased$value
    SD_ssb_N100_NoIndex_10yrs_noCKMR[f,i,]<-res_list[[f]][[i]]$SD$sd
    SD_R0_N100_NoIndex_10yrs_noCKMR[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_R0","log_R0"])
    SD_M_N100_NoIndex_10yrs_noCKMR[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_M","log_M"])
  }
}

#N1000 for 10yrs, No Index
res_list[[1]]<-readRDS(paste0(wd,"/SCAAfit_Cod_N1000_NoIndex_10yrs_noCKMR.RData"))
res_list[[2]]<-readRDS(paste0(wd,"/SCAAfit_Flatfish_N1000_NoIndex_10yrs_noCKMR.RData"))
res_list[[3]]<-readRDS(paste0(wd,"/SCAAfit_Sardine_N1000_NoIndex_10yrs_noCKMR.RData"))

Cod_wdat<-Cod_1000_25_10
Flatfish_wdat<-Flatfish_1000_25_10
Sardine_wdat<-Sardine_1000_25_10

re_Dep<-re_SSB<-array(NA, dim=c(3,100,76))
re_R0<-re_M<-matrix(NA, nrow=100, ncol=3)
for(f in 1:3){
  for (i in 1:100){
    if(f==1){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Cod_wdat[[i]]$OM$SSB[26:101])/Cod_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Cod_wdat[[i]]$OM$SSB[26:101]/Cod_wdat[[i]]$OM$SSB0)/(Cod_wdat[[i]]$OM$SSB[26:101]/Cod_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[2])-Cod_wdat[[i]]$OM$R0)/Cod_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Cod_wdat[[i]]$OM$Mref)/Cod_wdat[[i]]$OM$Mref
      
    }else if (f==2){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Flatfish_wdat[[i]]$OM$SSB[26:101])/Flatfish_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Flatfish_wdat[[i]]$OM$SSB[26:101]/Flatfish_wdat[[i]]$OM$SSB0)/(Flatfish_wdat[[i]]$OM$SSB[26:101]/Flatfish_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[2])-Flatfish_wdat[[i]]$OM$R0)/Flatfish_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Flatfish_wdat[[i]]$OM$Mref)/Flatfish_wdat[[i]]$OM$Mref
      
    } else if (f==3){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Sardine_wdat[[i]]$OM$SSB[26:101])/Sardine_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Sardine_wdat[[i]]$OM$SSB[26:101]/Sardine_wdat[[i]]$OM$SSB0)/(Sardine_wdat[[i]]$OM$SSB[26:101]/Sardine_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[2])-Sardine_wdat[[i]]$OM$R0)/Sardine_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Sardine_wdat[[i]]$OM$Mref)/Sardine_wdat[[i]]$OM$Mref
      
    }
  }
}

#SD of relative error for point estimates
sd_RE_ssb_N1000_NoIndex_10yrs_noCKMR<-apply(re_SSB,c(1,3),sd, na.rm=TRUE)
sd_RE_R0_N1000_NoIndex_10yrs_noCKMR<-apply(re_R0,2,sd, na.rm=TRUE)
sd_RE_M_N1000_NoIndex_10yrs_noCKMR<-apply(re_M,2,sd, na.rm=TRUE)

#SD of absolute relative error
sd_ARE_ssb_N1000_NoIndex_10yrs_noCKMR<-apply(abs(re_SSB),c(1,3),sd, na.rm=TRUE)
sd_ARE_R0_N1000_NoIndex_10yrs_noCKMR<-apply(abs(re_R0),2,sd, na.rm=TRUE)
sd_ARE_M_N1000_NoIndex_10yrs_noCKMR<-apply(abs(re_M),2,sd, na.rm=TRUE)

#Precision within sims
SD_ssb_N1000_NoIndex_10yrs_noCKMR<-CV_ssb_N1000_NoIndex_10yrs_noCKMR<-array(NA, dim=c(3,100,76)) 
SD_R0_N1000_NoIndex_10yrs_noCKMR<-matrix(NA, nrow=3, ncol=100)
SD_M_N1000_NoIndex_10yrs_noCKMR<-matrix(NA, nrow=3, ncol=100)
for(f in 1:3){
  for (i in 1:100){
    CV_ssb_N1000_NoIndex_10yrs_noCKMR[f,i,]<-res_list[[f]][[i]]$SD$sd/res_list[[f]][[i]]$SD$unbiased$value
    SD_ssb_N1000_NoIndex_10yrs_noCKMR[f,i,]<-res_list[[f]][[i]]$SD$sd
    SD_R0_N1000_NoIndex_10yrs_noCKMR[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_R0","log_R0"])
    SD_M_N1000_NoIndex_10yrs_noCKMR[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_M","log_M"])
  }
}

#N5000 for 10yrs, No Index
res_list[[1]]<-readRDS(paste0(wd,"/SCAAfit_Cod_N5000_NoIndex_10yrs_noCKMR.RData"))
res_list[[2]]<-readRDS(paste0(wd,"/SCAAfit_Flatfish_N5000_NoIndex_10yrs_noCKMR.RData"))
res_list[[3]]<-readRDS(paste0(wd,"/SCAAfit_Sardine_N5000_NoIndex_10yrs_noCKMR.RData"))

Cod_wdat<-Cod_5000_25_10
Flatfish_wdat<-Flatfish_5000_25_10
Sardine_wdat<-Sardine_5000_25_10

re_Dep<-re_SSB<-array(NA, dim=c(3,100,76))
re_R0<-re_M<-matrix(NA, nrow=100, ncol=3)
for(f in 1:3){
  for (i in 1:100){
    if(f==1){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Cod_wdat[[i]]$OM$SSB[26:101])/Cod_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Cod_wdat[[i]]$OM$SSB[26:101]/Cod_wdat[[i]]$OM$SSB0)/(Cod_wdat[[i]]$OM$SSB[26:101]/Cod_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[2])-Cod_wdat[[i]]$OM$R0)/Cod_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Cod_wdat[[i]]$OM$Mref)/Cod_wdat[[i]]$OM$Mref
      
    }else if (f==2){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Flatfish_wdat[[i]]$OM$SSB[26:101])/Flatfish_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Flatfish_wdat[[i]]$OM$SSB[26:101]/Flatfish_wdat[[i]]$OM$SSB0)/(Flatfish_wdat[[i]]$OM$SSB[26:101]/Flatfish_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[2])-Flatfish_wdat[[i]]$OM$R0)/Flatfish_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Flatfish_wdat[[i]]$OM$Mref)/Flatfish_wdat[[i]]$OM$Mref
      
    } else if (f==3){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Sardine_wdat[[i]]$OM$SSB[26:101])/Sardine_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Sardine_wdat[[i]]$OM$SSB[26:101]/Sardine_wdat[[i]]$OM$SSB0)/(Sardine_wdat[[i]]$OM$SSB[26:101]/Sardine_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[2])-Sardine_wdat[[i]]$OM$R0)/Sardine_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Sardine_wdat[[i]]$OM$Mref)/Sardine_wdat[[i]]$OM$Mref
      
    }
  }
}

#SD of relative error for point estimates
sd_RE_ssb_N5000_NoIndex_10yrs_noCKMR<-apply(re_SSB,c(1,3),sd, na.rm=TRUE)
sd_RE_R0_N5000_NoIndex_10yrs_noCKMR<-apply(re_R0,2,sd, na.rm=TRUE)
sd_RE_M_N5000_NoIndex_10yrs_noCKMR<-apply(re_M,2,sd, na.rm=TRUE)

#SD of absolute relative error
sd_ARE_ssb_N5000_NoIndex_10yrs_noCKMR<-apply(abs(re_SSB),c(1,3),sd, na.rm=TRUE)
sd_ARE_R0_N5000_NoIndex_10yrs_noCKMR<-apply(abs(re_R0),2,sd, na.rm=TRUE)
sd_ARE_M_N5000_NoIndex_10yrs_noCKMR<-apply(abs(re_M),2,sd, na.rm=TRUE)

#Precision within sims
SD_ssb_N5000_NoIndex_10yrs_noCKMR<-CV_ssb_N5000_NoIndex_10yrs_noCKMR<-array(NA, dim=c(3,100,76)) 
SD_R0_N5000_NoIndex_10yrs_noCKMR<-matrix(NA, nrow=3, ncol=100)
SD_M_N5000_NoIndex_10yrs_noCKMR<-matrix(NA, nrow=3, ncol=100)
for(f in 1:3){
  for (i in 1:100){
    CV_ssb_N5000_NoIndex_10yrs_noCKMR[f,i,]<-res_list[[f]][[i]]$SD$sd/res_list[[f]][[i]]$SD$unbiased$value
    SD_ssb_N5000_NoIndex_10yrs_noCKMR[f,i,]<-res_list[[f]][[i]]$SD$sd
    SD_R0_N5000_NoIndex_10yrs_noCKMR[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_R0","log_R0"])
    SD_M_N5000_NoIndex_10yrs_noCKMR[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_M","log_M"])
  }
}

#N100 for 20yrs, No index
res_list<-list()
res_list[[1]]<-readRDS(paste0(wd,"/SCAAfit_Cod_N100_NoIndex_20yrs_noCKMR.RData"))
res_list[[2]]<-readRDS(paste0(wd,"/SCAAfit_Flatfish_N100_NoIndex_20yrs_noCKMR.RData"))
res_list[[3]]<-readRDS(paste0(wd,"/SCAAfit_Sardine_N100_NoIndex_20yrs_noCKMR.RData"))

Cod_wdat<-Cod_100_25_20
Flatfish_wdat<-Flatfish_100_25_20
Sardine_wdat<-Sardine_100_25_20

re_Dep<-re_SSB<-array(NA, dim=c(3,100,76))
re_R0<-re_M<-matrix(NA, nrow=100, ncol=3)
for(f in 1:3){
  for (i in 1:100){
    if(f==1){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Cod_wdat[[i]]$OM$SSB[26:101])/Cod_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Cod_wdat[[i]]$OM$SSB[26:101]/Cod_wdat[[i]]$OM$SSB0)/(Cod_wdat[[i]]$OM$SSB[26:101]/Cod_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[2])-Cod_wdat[[i]]$OM$R0)/Cod_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Cod_wdat[[i]]$OM$Mref)/Cod_wdat[[i]]$OM$Mref
    }else if (f==2){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Flatfish_wdat[[i]]$OM$SSB[26:101])/Flatfish_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Flatfish_wdat[[i]]$OM$SSB[26:101]/Flatfish_wdat[[i]]$OM$SSB0)/(Flatfish_wdat[[i]]$OM$SSB[26:101]/Flatfish_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[2])-Flatfish_wdat[[i]]$OM$R0)/Flatfish_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Flatfish_wdat[[i]]$OM$Mref)/Flatfish_wdat[[i]]$OM$Mref
    } else if (f==3){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Sardine_wdat[[i]]$OM$SSB[26:101])/Sardine_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Sardine_wdat[[i]]$OM$SSB[26:101]/Sardine_wdat[[i]]$OM$SSB0)/(Sardine_wdat[[i]]$OM$SSB[26:101]/Sardine_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[2])-Sardine_wdat[[i]]$OM$R0)/Sardine_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Sardine_wdat[[i]]$OM$Mref)/Sardine_wdat[[i]]$OM$Mref
    }
  }
}

#SSB
par(mfrow=c(3,3))
boxplot(re_SSB[1,,], ylim=c(-0.25,0.25), las=1, main="Cod - N100, No Index", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[2,,], ylim=c(-0.25,0.25), las=1, main="Flatfish - N100, No Index", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[3,,], ylim=c(-0.25,0.25), las=1, main="Sardine - N100, No Index", ylab="RE - SSB")
abline(h=0)

#R0
boxplot(re_R0[,1], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,2], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,3], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)

#M
boxplot(re_M[,1], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,2], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,3], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)

#SD of relative error for point estimates
sd_RE_ssb_N100_NoIndex_20yrs_noCKMR<-apply(re_SSB,c(1,3),sd, na.rm=TRUE)
sd_RE_R0_N100_NoIndex_20yrs_noCKMR<-apply(re_R0,2,sd, na.rm=TRUE)
sd_RE_M_N100_NoIndex_20yrs_noCKMR<-apply(re_M,2,sd, na.rm=TRUE)

#SD of absolute relative error
sd_ARE_ssb_N100_NoIndex_20yrs_noCKMR<-apply(abs(re_SSB),c(1,3),sd, na.rm=TRUE)
sd_ARE_R0_N100_NoIndex_20yrs_noCKMR<-apply(abs(re_R0),2,sd, na.rm=TRUE)
sd_ARE_M_N100_NoIndex_20yrs_noCKMR<-apply(abs(re_M),2,sd, na.rm=TRUE)

#Precision within sims
SD_ssb_N100_NoIndex_20yrs_noCKMR<-CV_ssb_N100_NoIndex_20yrs_noCKMR<-array(NA, dim=c(3,100,76)) 
SD_R0_N100_NoIndex_20yrs_noCKMR<-matrix(NA, nrow=3, ncol=100)
SD_M_N100_NoIndex_20yrs_noCKMR<-matrix(NA, nrow=3, ncol=100)
for(f in 1:3){
  for (i in 1:100){
    CV_ssb_N100_NoIndex_20yrs_noCKMR[f,i,]<-res_list[[f]][[i]]$SD$sd/res_list[[f]][[i]]$SD$unbiased$value
    SD_ssb_N100_NoIndex_20yrs_noCKMR[f,i,]<-res_list[[f]][[i]]$SD$sd
    SD_R0_N100_NoIndex_20yrs_noCKMR[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_R0","log_R0"])
    SD_M_N100_NoIndex_20yrs_noCKMR[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_M","log_M"])
  }
}

#N1000 for 20yrs, No Index
res_list[[1]]<-readRDS(paste0(wd,"/SCAAfit_Cod_N1000_NoIndex_20yrs_noCKMR.RData"))
res_list[[2]]<-readRDS(paste0(wd,"/SCAAfit_Flatfish_N1000_NoIndex_20yrs_noCKMR.RData"))
res_list[[3]]<-readRDS(paste0(wd,"/SCAAfit_Sardine_N1000_NoIndex_20yrs_noCKMR.RData"))

Cod_wdat<-Cod_1000_25_20
Flatfish_wdat<-Flatfish_1000_25_20
Sardine_wdat<-Sardine_1000_25_20

re_Dep<-re_SSB<-array(NA, dim=c(3,100,76))
re_R0<-re_M<-matrix(NA, nrow=100, ncol=3)
for(f in 1:3){
  for (i in 1:100){
    if(f==1){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Cod_wdat[[i]]$OM$SSB[26:101])/Cod_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Cod_wdat[[i]]$OM$SSB[26:101]/Cod_wdat[[i]]$OM$SSB0)/(Cod_wdat[[i]]$OM$SSB[26:101]/Cod_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[2])-Cod_wdat[[i]]$OM$R0)/Cod_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Cod_wdat[[i]]$OM$Mref)/Cod_wdat[[i]]$OM$Mref
      
    }else if (f==2){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Flatfish_wdat[[i]]$OM$SSB[26:101])/Flatfish_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Flatfish_wdat[[i]]$OM$SSB[26:101]/Flatfish_wdat[[i]]$OM$SSB0)/(Flatfish_wdat[[i]]$OM$SSB[26:101]/Flatfish_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[2])-Flatfish_wdat[[i]]$OM$R0)/Flatfish_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Flatfish_wdat[[i]]$OM$Mref)/Flatfish_wdat[[i]]$OM$Mref
      
    } else if (f==3){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Sardine_wdat[[i]]$OM$SSB[26:101])/Sardine_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Sardine_wdat[[i]]$OM$SSB[26:101]/Sardine_wdat[[i]]$OM$SSB0)/(Sardine_wdat[[i]]$OM$SSB[26:101]/Sardine_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[2])-Sardine_wdat[[i]]$OM$R0)/Sardine_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Sardine_wdat[[i]]$OM$Mref)/Sardine_wdat[[i]]$OM$Mref
      
    }
  }
}

#SD of relative error for point estimates
sd_RE_ssb_N1000_NoIndex_20yrs_noCKMR<-apply(re_SSB,c(1,3),sd, na.rm=TRUE)
sd_RE_R0_N1000_NoIndex_20yrs_noCKMR<-apply(re_R0,2,sd, na.rm=TRUE)
sd_RE_M_N1000_NoIndex_20yrs_noCKMR<-apply(re_M,2,sd, na.rm=TRUE)

#SD of absolute relative error
sd_ARE_ssb_N1000_NoIndex_20yrs_noCKMR<-apply(abs(re_SSB),c(1,3),sd, na.rm=TRUE)
sd_ARE_R0_N1000_NoIndex_20yrs_noCKMR<-apply(abs(re_R0),2,sd, na.rm=TRUE)
sd_ARE_M_N1000_NoIndex_20yrs_noCKMR<-apply(abs(re_M),2,sd, na.rm=TRUE)

#Precision within sims
SD_ssb_N1000_NoIndex_20yrs_noCKMR<-CV_ssb_N1000_NoIndex_20yrs_noCKMR<-array(NA, dim=c(3,100,76)) 
SD_R0_N1000_NoIndex_20yrs_noCKMR<-matrix(NA, nrow=3, ncol=100)
SD_M_N1000_NoIndex_20yrs_noCKMR<-matrix(NA, nrow=3, ncol=100)
for(f in 1:3){
  for (i in 1:100){
    CV_ssb_N1000_NoIndex_20yrs_noCKMR[f,i,]<-res_list[[f]][[i]]$SD$sd/res_list[[f]][[i]]$SD$unbiased$value
    SD_ssb_N1000_NoIndex_20yrs_noCKMR[f,i,]<-res_list[[f]][[i]]$SD$sd
    SD_R0_N1000_NoIndex_20yrs_noCKMR[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_R0","log_R0"])
    SD_M_N1000_NoIndex_20yrs_noCKMR[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_M","log_M"])
  }
}

#N5000 for 20yrs, No Index
res_list[[1]]<-readRDS(paste0(wd,"/SCAAfit_Cod_N5000_NoIndex_20yrs_noCKMR.RData"))
res_list[[2]]<-readRDS(paste0(wd,"/SCAAfit_Flatfish_N5000_NoIndex_20yrs_noCKMR.RData"))
res_list[[3]]<-readRDS(paste0(wd,"/SCAAfit_Sardine_N5000_NoIndex_20yrs_noCKMR.RData"))

Cod_wdat<-Cod_5000_25_20
Flatfish_wdat<-Flatfish_5000_25_20
Sardine_wdat<-Sardine_5000_25_20

re_Dep<-re_SSB<-array(NA, dim=c(3,100,76))
re_R0<-re_M<-matrix(NA, nrow=100, ncol=3)
for(f in 1:3){
  for (i in 1:100){
    if(f==1){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Cod_wdat[[i]]$OM$SSB[26:101])/Cod_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Cod_wdat[[i]]$OM$SSB[26:101]/Cod_wdat[[i]]$OM$SSB0)/(Cod_wdat[[i]]$OM$SSB[26:101]/Cod_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[2])-Cod_wdat[[i]]$OM$R0)/Cod_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Cod_wdat[[i]]$OM$Mref)/Cod_wdat[[i]]$OM$Mref
      
    }else if (f==2){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Flatfish_wdat[[i]]$OM$SSB[26:101])/Flatfish_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Flatfish_wdat[[i]]$OM$SSB[26:101]/Flatfish_wdat[[i]]$OM$SSB0)/(Flatfish_wdat[[i]]$OM$SSB[26:101]/Flatfish_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[2])-Flatfish_wdat[[i]]$OM$R0)/Flatfish_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Flatfish_wdat[[i]]$OM$Mref)/Flatfish_wdat[[i]]$OM$Mref
      
    } else if (f==3){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Sardine_wdat[[i]]$OM$SSB[26:101])/Sardine_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Sardine_wdat[[i]]$OM$SSB[26:101]/Sardine_wdat[[i]]$OM$SSB0)/(Sardine_wdat[[i]]$OM$SSB[26:101]/Sardine_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[2])-Sardine_wdat[[i]]$OM$R0)/Sardine_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Sardine_wdat[[i]]$OM$Mref)/Sardine_wdat[[i]]$OM$Mref
      
    }
  }
}

#SD of relative error for point estimates
sd_RE_ssb_N5000_NoIndex_20yrs_noCKMR<-apply(re_SSB,c(1,3),sd, na.rm=TRUE)
sd_RE_R0_N5000_NoIndex_20yrs_noCKMR<-apply(re_R0,2,sd, na.rm=TRUE)
sd_RE_M_N5000_NoIndex_20yrs_noCKMR<-apply(re_M,2,sd, na.rm=TRUE)

#SD of absolute relative error
sd_ARE_ssb_N5000_NoIndex_20yrs_noCKMR<-apply(abs(re_SSB),c(1,3),sd, na.rm=TRUE)
sd_ARE_R0_N5000_NoIndex_20yrs_noCKMR<-apply(abs(re_R0),2,sd, na.rm=TRUE)
sd_ARE_M_N5000_NoIndex_20yrs_noCKMR<-apply(abs(re_M),2,sd, na.rm=TRUE)

#Precision within sims
SD_ssb_N5000_NoIndex_20yrs_noCKMR<-CV_ssb_N5000_NoIndex_20yrs_noCKMR<-array(NA, dim=c(3,100,76)) 
SD_R0_N5000_NoIndex_20yrs_noCKMR<-matrix(NA, nrow=3, ncol=100)
SD_M_N5000_NoIndex_20yrs_noCKMR<-matrix(NA, nrow=3, ncol=100)
for(f in 1:3){
  for (i in 1:100){
    CV_ssb_N5000_NoIndex_20yrs_noCKMR[f,i,]<-res_list[[f]][[i]]$SD$sd/res_list[[f]][[i]]$SD$unbiased$value
    SD_ssb_N5000_NoIndex_20yrs_noCKMR[f,i,]<-res_list[[f]][[i]]$SD$sd
    SD_R0_N5000_NoIndex_20yrs_noCKMR[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_R0","log_R0"])
    SD_M_N5000_NoIndex_20yrs_noCKMR[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_M","log_M"])
  }
}

##################################
#SCAAs with CKMR data
##################################

#N100, 5yrs CKMR data, sd index 0.25
res_list<-list()
res_list[[1]]<-readRDS(paste0(wd,"/SCAAfit_Cod_N100_Ind25_ckmrmultinom5.RData"))
res_list[[2]]<-readRDS(paste0(wd,"/SCAAfit_Flatfish_N100_Ind25_ckmrmultinom5.RData"))
res_list[[3]]<-readRDS(paste0(wd,"/SCAAfit_Sardine_N100_Ind25_ckmrmultinom5.RData"))

load(paste0(wd,"/Cod_wdat_N100_Ind25_ckmrmultinom5_1.RData"))
load(paste0(wd,"/Flatfish_wdat_N100_Ind25_ckmrmultinom5_1.RData"))
load(paste0(wd,"/Sardine_wdat_N100_Ind25_ckmrmultinom5_1.RData"))

re_Dep<-re_SSB<-array(NA, dim=c(3,100,76))
re_R0<-re_M<-matrix(NA, nrow=100, ncol=3)
for(f in 1:3){
  for (i in 1:100){
    if(f==1){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Cod_wdat[[i]]$OM$SSB[26:101])/Cod_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Cod_wdat[[i]]$OM$SSB[26:101]/Cod_wdat[[i]]$OM$SSB0)/(Cod_wdat[[i]]$OM$SSB[26:101]/Cod_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[3])-Cod_wdat[[i]]$OM$R0)/Cod_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Cod_wdat[[i]]$OM$Mref)/Cod_wdat[[i]]$OM$Mref
      
    }else if (f==2){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Flatfish_wdat[[i]]$OM$SSB[26:101])/Flatfish_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Flatfish_wdat[[i]]$OM$SSB[26:101]/Flatfish_wdat[[i]]$OM$SSB0)/(Flatfish_wdat[[i]]$OM$SSB[26:101]/Flatfish_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[3])-Flatfish_wdat[[i]]$OM$R0)/Flatfish_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Flatfish_wdat[[i]]$OM$Mref)/Flatfish_wdat[[i]]$OM$Mref
      
    } else if (f==3){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Sardine_wdat[[i]]$OM$SSB[26:101])/Sardine_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Sardine_wdat[[i]]$OM$SSB[26:101]/Sardine_wdat[[i]]$OM$SSB0)/(Sardine_wdat[[i]]$OM$SSB[26:101]/Sardine_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[3])-Sardine_wdat[[i]]$OM$R0)/Sardine_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Sardine_wdat[[i]]$OM$Mref)/Sardine_wdat[[i]]$OM$Mref
      
    }
  }
}

#SSB
par(mfrow=c(3,3))
boxplot(re_SSB[1,,], ylim=c(-0.25,0.25), las=1, main="Cod - N100, Index SD - 0.25, CKMR 5yrs", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[2,,], ylim=c(-0.25,0.25), las=1, main="Flatfish - N100, Index SD - 0.25, CKMR 5yrs", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[3,,], ylim=c(-0.25,0.25), las=1, main="Sardine - N100, Index SD - 0.25, CKMR 5yrs", ylab="RE - SSB")
abline(h=0)

#R0
boxplot(re_R0[,1], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,2], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,3], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)

#M
boxplot(re_M[,1], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,2], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,3], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)

#SD of relative error for point estimates
sd_RE_ssb_N100_Ind25_ckmrmultinom5<-apply(re_SSB,c(1,3),sd, na.rm=TRUE)
sd_RE_R0_N100_Ind25_ckmrmultinom5<-apply(re_R0,2,sd, na.rm=TRUE)
sd_RE_M_N100_Ind25_ckmrmultinom5<-apply(re_M,2,sd, na.rm=TRUE)

#SD of absolute relative error
sd_ARE_ssb_N100_Ind25_ckmrmultinom5<-apply(abs(re_SSB),c(1,3),sd, na.rm=TRUE)
sd_ARE_R0_N100_Ind25_ckmrmultinom5<-apply(abs(re_R0),2,sd, na.rm=TRUE)
sd_ARE_M_N100_Ind25_ckmrmultinom5<-apply(abs(re_M),2,sd, na.rm=TRUE)

#Precision within sims
SD_ssb_N100_Ind25_ckmrmultinom5<-CV_ssb_N100_Ind25_ckmrmultinom5<-array(NA, dim=c(3,100,76)) 
SD_R0_N100_Ind25_ckmrmultinom5<-matrix(NA, nrow=3, ncol=100)
SD_M_N100_Ind25_ckmrmultinom5<-matrix(NA, nrow=3, ncol=100)
 for(f in 1:3){
  for (i in 1:100){
   CV_ssb_N100_Ind25_ckmrmultinom5[f,i,]<-res_list[[f]][[i]]$SD$sd/res_list[[f]][[i]]$SD$unbiased$value
   SD_ssb_N100_Ind25_ckmrmultinom5[f,i,]<-res_list[[f]][[i]]$SD$sd
   SD_R0_N100_Ind25_ckmrmultinom5[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_R0","log_R0"])
   SD_M_N100_Ind25_ckmrmultinom5[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_M","log_M"])
  }
 }

#N1000, 5yrs CKMR data, sd index 0.25
res_list<-list()
res_list[[1]]<-readRDS(paste0(wd,"/SCAAfit_Cod_N1000_Ind25_ckmrmultinom5.RData"))
res_list[[2]]<-readRDS(paste0(wd,"/SCAAfit_Flatfish_N1000_Ind25_ckmrmultinom5.RData"))
res_list[[3]]<-readRDS(paste0(wd,"/SCAAfit_Sardine_N1000_Ind25_ckmrmultinom5.RData"))

load(paste0(wd,"/Cod_wdat_N1000_Ind25_ckmrmultinom5_1.RData"))
load(paste0(wd,"/Flatfish_wdat_N1000_Ind25_ckmrmultinom5_1.RData"))
load(paste0(wd,"/Sardine_wdat_N1000_Ind25_ckmrmultinom5_1.RData"))

re_Dep<-re_SSB<-array(NA, dim=c(3,100,76))
re_R0<-re_M<-matrix(NA, nrow=100, ncol=3)
for(f in 1:3){
  for (i in 1:100){
    if(f==1){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Cod_wdat[[i]]$OM$SSB[26:101])/Cod_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Cod_wdat[[i]]$OM$SSB[26:101]/Cod_wdat[[i]]$OM$SSB0)/(Cod_wdat[[i]]$OM$SSB[26:101]/Cod_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[3])-Cod_wdat[[i]]$OM$R0)/Cod_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Cod_wdat[[i]]$OM$Mref)/Cod_wdat[[i]]$OM$Mref
      
    }else if (f==2){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Flatfish_wdat[[i]]$OM$SSB[26:101])/Flatfish_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Flatfish_wdat[[i]]$OM$SSB[26:101]/Flatfish_wdat[[i]]$OM$SSB0)/(Flatfish_wdat[[i]]$OM$SSB[26:101]/Flatfish_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[3])-Flatfish_wdat[[i]]$OM$R0)/Flatfish_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Flatfish_wdat[[i]]$OM$Mref)/Flatfish_wdat[[i]]$OM$Mref
      
    } else if (f==3){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Sardine_wdat[[i]]$OM$SSB[26:101])/Sardine_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Sardine_wdat[[i]]$OM$SSB[26:101]/Sardine_wdat[[i]]$OM$SSB0)/(Sardine_wdat[[i]]$OM$SSB[26:101]/Sardine_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[3])-Sardine_wdat[[i]]$OM$R0)/Sardine_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Sardine_wdat[[i]]$OM$Mref)/Sardine_wdat[[i]]$OM$Mref
      
    }
  }
}

#SSB
par(mfrow=c(3,3))
boxplot(re_SSB[1,,], ylim=c(-0.25,0.25), las=1, main="Cod - N1000, Index SD - 0.25, CKMR 5yrs", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[2,,], ylim=c(-0.25,0.25), las=1, main="Flatfish - N1000, Index SD - 0.25, CKMR 5yrs", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[3,,], ylim=c(-0.25,0.25), las=1, main="Sardine - N1000, Index SD - 0.25, CKMR 5yrs", ylab="RE - SSB")
abline(h=0)

#R0
boxplot(re_R0[,1], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,2], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,3], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)

#M
boxplot(re_M[,1], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,2], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,3], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)

#SD of relative error for point estimates
sd_RE_ssb_N1000_Ind25_ckmrmultinom5<-apply(re_SSB,c(1,3),sd, na.rm=TRUE)
sd_RE_R0_N1000_Ind25_ckmrmultinom5<-apply(re_R0,2,sd, na.rm=TRUE)
sd_RE_M_N1000_Ind25_ckmrmultinom5<-apply(re_M,2,sd, na.rm=TRUE)

#SD of absolute relative error
sd_ARE_ssb_N1000_Ind25_ckmrmultinom5<-apply(abs(re_SSB),c(1,3),sd, na.rm=TRUE)
sd_ARE_R0_N1000_Ind25_ckmrmultinom5<-apply(abs(re_R0),2,sd, na.rm=TRUE)
sd_ARE_M_N1000_Ind25_ckmrmultinom5<-apply(abs(re_M),2,sd, na.rm=TRUE)

#Precision within sims
SD_ssb_N1000_Ind25_ckmrmultinom5<-CV_ssb_N1000_Ind25_ckmrmultinom5<-array(NA, dim=c(3,100,76)) 
SD_R0_N1000_Ind25_ckmrmultinom5<-matrix(NA, nrow=3, ncol=100)
SD_M_N1000_Ind25_ckmrmultinom5<-matrix(NA, nrow=3, ncol=100)
for(f in 1:3){
  for (i in 1:100){
    CV_ssb_N1000_Ind25_ckmrmultinom5[f,i,]<-res_list[[f]][[i]]$SD$sd/res_list[[f]][[i]]$SD$unbiased$value
    SD_ssb_N1000_Ind25_ckmrmultinom5[f,i,]<-res_list[[f]][[i]]$SD$sd
    SD_R0_N1000_Ind25_ckmrmultinom5[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_R0","log_R0"])
    SD_M_N1000_Ind25_ckmrmultinom5[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_M","log_M"])
  }
}

#N5000, 5yrs CKMR data, sd index 0.25
res_list<-list()
res_list[[1]]<-readRDS(paste0(wd,"/SCAAfit_Cod_N5000_Ind25_ckmrmultinom5.RData"))
res_list[[2]]<-readRDS(paste0(wd,"/SCAAfit_Flatfish_N5000_Ind25_ckmrmultinom5.RData"))
res_list[[3]]<-readRDS(paste0(wd,"/SCAAfit_Sardine_N5000_Ind25_ckmrmultinom5.RData"))

load(paste0(wd,"/Cod_wdat_N5000_Ind25_ckmrmultinom5_1.RData"))
load(paste0(wd,"/Flatfish_wdat_N5000_Ind25_ckmrmultinom5_1.RData"))
load(paste0(wd,"/Sardine_wdat_N5000_Ind25_ckmrmultinom5_1.RData"))

re_Dep<-re_SSB<-array(NA, dim=c(3,100,76))
re_R0<-re_M<-matrix(NA, nrow=100, ncol=3)
for(f in 1:3){
  for (i in 1:100){
    if(f==1){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Cod_wdat[[i]]$OM$SSB[26:101])/Cod_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Cod_wdat[[i]]$OM$SSB[26:101]/Cod_wdat[[i]]$OM$SSB0)/(Cod_wdat[[i]]$OM$SSB[26:101]/Cod_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[3])-Cod_wdat[[i]]$OM$R0)/Cod_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Cod_wdat[[i]]$OM$Mref)/Cod_wdat[[i]]$OM$Mref
      
    }else if (f==2){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Flatfish_wdat[[i]]$OM$SSB[26:101])/Flatfish_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Flatfish_wdat[[i]]$OM$SSB[26:101]/Flatfish_wdat[[i]]$OM$SSB0)/(Flatfish_wdat[[i]]$OM$SSB[26:101]/Flatfish_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[3])-Flatfish_wdat[[i]]$OM$R0)/Flatfish_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Flatfish_wdat[[i]]$OM$Mref)/Flatfish_wdat[[i]]$OM$Mref
      
    } else if (f==3){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Sardine_wdat[[i]]$OM$SSB[26:101])/Sardine_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Sardine_wdat[[i]]$OM$SSB[26:101]/Sardine_wdat[[i]]$OM$SSB0)/(Sardine_wdat[[i]]$OM$SSB[26:101]/Sardine_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[3])-Sardine_wdat[[i]]$OM$R0)/Sardine_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Sardine_wdat[[i]]$OM$Mref)/Sardine_wdat[[i]]$OM$Mref
      
    }
  }
}

#SSB
par(mfrow=c(3,3))
boxplot(re_SSB[1,,], ylim=c(-0.25,0.25), las=1, main="Cod - N5000, Index SD - 0.25, CKMR 5yrs", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[2,,], ylim=c(-0.25,0.25), las=1, main="Flatfish - N5000, Index SD - 0.25, CKMR 5yrs", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[3,,], ylim=c(-0.25,0.25), las=1, main="Sardine - N5000, Index SD - 0.25, CKMR 5yrs", ylab="RE - SSB")
abline(h=0)

#R0
boxplot(re_R0[,1], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,2], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,3], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)

#M
boxplot(re_M[,1], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,2], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,3], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)

#SD of relative error for point estimates
sd_RE_ssb_N5000_Ind25_ckmrmultinom5<-apply(re_SSB,c(1,3),sd, na.rm=TRUE)
sd_RE_R0_N5000_Ind25_ckmrmultinom5<-apply(re_R0,2,sd, na.rm=TRUE)
sd_RE_M_N5000_Ind25_ckmrmultinom5<-apply(re_M,2,sd, na.rm=TRUE)

#SD of absolute relative error
sd_ARE_ssb_N5000_Ind25_ckmrmultinom5<-apply(abs(re_SSB),c(1,3),sd, na.rm=TRUE)
sd_ARE_R0_N5000_Ind25_ckmrmultinom5<-apply(abs(re_R0),2,sd, na.rm=TRUE)
sd_ARE_M_N5000_Ind25_ckmrmultinom5<-apply(abs(re_M),2,sd, na.rm=TRUE)

#Precision within sims
SD_ssb_N5000_Ind25_ckmrmultinom5<-CV_ssb_N5000_Ind25_ckmrmultinom5<-array(NA, dim=c(3,100,76)) 
SD_R0_N5000_Ind25_ckmrmultinom5<-matrix(NA, nrow=3, ncol=100)
SD_M_N5000_Ind25_ckmrmultinom5<-matrix(NA, nrow=3, ncol=100)
for(f in 1:3){
  for (i in 1:100){
    CV_ssb_N5000_Ind25_ckmrmultinom5[f,i,]<-res_list[[f]][[i]]$SD$sd/res_list[[f]][[i]]$SD$unbiased$value
    SD_ssb_N5000_Ind25_ckmrmultinom5[f,i,]<-res_list[[f]][[i]]$SD$sd
    SD_R0_N5000_Ind25_ckmrmultinom5[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_R0","log_R0"])
    SD_M_N5000_Ind25_ckmrmultinom5[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_M","log_M"])
  }
}

#N100, 5yrs CKMR data, sd index 0.50
res_list<-list()
res_list[[1]]<-readRDS(paste0(wd,"/SCAAfit_Cod_N100_Ind50_ckmrmultinom5.RData"))
res_list[[2]]<-readRDS(paste0(wd,"/SCAAfit_Flatfish_N100_Ind50_ckmrmultinom5.RData"))
res_list[[3]]<-readRDS(paste0(wd,"/SCAAfit_Sardine_N100_Ind50_ckmrmultinom5.RData"))

load(paste0(wd,"/Cod_wdat_N100_Ind50_ckmrmultinom5_1.RData"))
load(paste0(wd,"/Flatfish_wdat_N100_Ind50_ckmrmultinom5_1.RData"))
load(paste0(wd,"/Sardine_wdat_N100_Ind50_ckmrmultinom5_1.RData"))

re_Dep<-re_SSB<-array(NA, dim=c(3,100,76))
re_R0<-re_M<-matrix(NA, nrow=100, ncol=3)
for(f in 1:3){
  for (i in 1:100){
    if(f==1){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Cod_wdat[[i]]$OM$SSB[26:101])/Cod_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Cod_wdat[[i]]$OM$SSB[26:101]/Cod_wdat[[i]]$OM$SSB0)/(Cod_wdat[[i]]$OM$SSB[26:101]/Cod_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[3])-Cod_wdat[[i]]$OM$R0)/Cod_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Cod_wdat[[i]]$OM$Mref)/Cod_wdat[[i]]$OM$Mref
      
    }else if (f==2){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Flatfish_wdat[[i]]$OM$SSB[26:101])/Flatfish_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Flatfish_wdat[[i]]$OM$SSB[26:101]/Flatfish_wdat[[i]]$OM$SSB0)/(Flatfish_wdat[[i]]$OM$SSB[26:101]/Flatfish_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[3])-Flatfish_wdat[[i]]$OM$R0)/Flatfish_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Flatfish_wdat[[i]]$OM$Mref)/Flatfish_wdat[[i]]$OM$Mref
      
    } else if (f==3){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Sardine_wdat[[i]]$OM$SSB[26:101])/Sardine_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Sardine_wdat[[i]]$OM$SSB[26:101]/Sardine_wdat[[i]]$OM$SSB0)/(Sardine_wdat[[i]]$OM$SSB[26:101]/Sardine_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[3])-Sardine_wdat[[i]]$OM$R0)/Sardine_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Sardine_wdat[[i]]$OM$Mref)/Sardine_wdat[[i]]$OM$Mref
      
    }
  }
}

#SSB
par(mfrow=c(3,3))
boxplot(re_SSB[1,,], ylim=c(-0.25,0.25), las=1, main="Cod - N100, Index SD - 0.50, CKMR 5yrs", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[2,,], ylim=c(-0.25,0.25), las=1, main="Flatfish - N100, Index SD - 0.50, CKMR 5yrs", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[3,,], ylim=c(-0.25,0.25), las=1, main="Sardine - N100, Index SD - 0.50, CKMR 5yrs", ylab="RE - SSB")
abline(h=0)

#R0
boxplot(re_R0[,1], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,2], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,3], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)

#M
boxplot(re_M[,1], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,2], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,3], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)

#SD of relative error for point estimates
sd_RE_ssb_N100_Ind50_ckmrmultinom5<-apply(re_SSB,c(1,3),sd, na.rm=TRUE)
sd_RE_R0_N100_Ind50_ckmrmultinom5<-apply(re_R0,2,sd, na.rm=TRUE)
sd_RE_M_N100_Ind50_ckmrmultinom5<-apply(re_M,2,sd, na.rm=TRUE)

#SD of absolute relative error
sd_ARE_ssb_N100_Ind50_ckmrmultinom5<-apply(abs(re_SSB),c(1,3),sd, na.rm=TRUE)
sd_ARE_R0_N100_Ind50_ckmrmultinom5<-apply(abs(re_R0),2,sd, na.rm=TRUE)
sd_ARE_M_N100_Ind50_ckmrmultinom5<-apply(abs(re_M),2,sd, na.rm=TRUE)

#Precision within sims
SD_ssb_N100_Ind50_ckmrmultinom5<-CV_ssb_N100_Ind50_ckmrmultinom5<-array(NA, dim=c(3,100,76)) 
SD_R0_N100_Ind50_ckmrmultinom5<-matrix(NA, nrow=3, ncol=100)
SD_M_N100_Ind50_ckmrmultinom5<-matrix(NA, nrow=3, ncol=100)
for(f in 1:3){
  for (i in 1:100){
    CV_ssb_N100_Ind50_ckmrmultinom5[f,i,]<-res_list[[f]][[i]]$SD$sd/res_list[[f]][[i]]$SD$unbiased$value
    SD_ssb_N100_Ind50_ckmrmultinom5[f,i,]<-res_list[[f]][[i]]$SD$sd
    SD_R0_N100_Ind50_ckmrmultinom5[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_R0","log_R0"])
    SD_M_N100_Ind50_ckmrmultinom5[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_M","log_M"])
  }
}

#N1000, 5yrs CKMR data, sd index 0.50
res_list<-list()
res_list[[1]]<-readRDS(paste0(wd,"/SCAAfit_Cod_N1000_Ind50_ckmrmultinom5.RData"))
res_list[[2]]<-readRDS(paste0(wd,"/SCAAfit_Flatfish_N1000_Ind50_ckmrmultinom5.RData"))
res_list[[3]]<-readRDS(paste0(wd,"/SCAAfit_Sardine_N1000_Ind50_ckmrmultinom5.RData"))

load(paste0(wd,"/Cod_wdat_N1000_Ind50_ckmrmultinom5_1.RData"))
load(paste0(wd,"/Flatfish_wdat_N1000_Ind50_ckmrmultinom5_1.RData"))
load(paste0(wd,"/Sardine_wdat_N1000_Ind50_ckmrmultinom5_1.RData"))

re_Dep<-re_SSB<-array(NA, dim=c(3,100,76))
re_R0<-re_M<-matrix(NA, nrow=100, ncol=3)
for(f in 1:3){
  for (i in 1:100){
    if(f==1){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Cod_wdat[[i]]$OM$SSB[26:101])/Cod_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Cod_wdat[[i]]$OM$SSB[26:101]/Cod_wdat[[i]]$OM$SSB0)/(Cod_wdat[[i]]$OM$SSB[26:101]/Cod_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[3])-Cod_wdat[[i]]$OM$R0)/Cod_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Cod_wdat[[i]]$OM$Mref)/Cod_wdat[[i]]$OM$Mref
      
    }else if (f==2){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Flatfish_wdat[[i]]$OM$SSB[26:101])/Flatfish_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Flatfish_wdat[[i]]$OM$SSB[26:101]/Flatfish_wdat[[i]]$OM$SSB0)/(Flatfish_wdat[[i]]$OM$SSB[26:101]/Flatfish_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[3])-Flatfish_wdat[[i]]$OM$R0)/Flatfish_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Flatfish_wdat[[i]]$OM$Mref)/Flatfish_wdat[[i]]$OM$Mref
      
    } else if (f==3){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Sardine_wdat[[i]]$OM$SSB[26:101])/Sardine_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Sardine_wdat[[i]]$OM$SSB[26:101]/Sardine_wdat[[i]]$OM$SSB0)/(Sardine_wdat[[i]]$OM$SSB[26:101]/Sardine_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[3])-Sardine_wdat[[i]]$OM$R0)/Sardine_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Sardine_wdat[[i]]$OM$Mref)/Sardine_wdat[[i]]$OM$Mref
      
    }
  }
}

#SSB
par(mfrow=c(3,3))
boxplot(re_SSB[1,,], ylim=c(-0.25,0.25), las=1, main="Cod - N1000, Index SD - 0.50, CKMR 5yrs", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[2,,], ylim=c(-0.25,0.25), las=1, main="Flatfish - N1000, Index SD - 0.50, CKMR 5yrs", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[3,,], ylim=c(-0.25,0.25), las=1, main="Sardine - N1000, Index SD - 0.50, CKMR 5yrs", ylab="RE - SSB")
abline(h=0)

#R0
boxplot(re_R0[,1], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,2], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,3], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)

#M
boxplot(re_M[,1], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,2], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,3], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)

#SD of relative error for point estimates
sd_RE_ssb_N1000_Ind50_ckmrmultinom5<-apply(re_SSB,c(1,3),sd, na.rm=TRUE)
sd_RE_R0_N1000_Ind50_ckmrmultinom5<-apply(re_R0,2,sd, na.rm=TRUE)
sd_RE_M_N1000_Ind50_ckmrmultinom5<-apply(re_M,2,sd, na.rm=TRUE)

#SD of absolute relative error
sd_ARE_ssb_N1000_Ind50_ckmrmultinom5<-apply(abs(re_SSB),c(1,3),sd, na.rm=TRUE)
sd_ARE_R0_N1000_Ind50_ckmrmultinom5<-apply(abs(re_R0),2,sd, na.rm=TRUE)
sd_ARE_M_N1000_Ind50_ckmrmultinom5<-apply(abs(re_M),2,sd, na.rm=TRUE)

#Precision within sims
SD_ssb_N1000_Ind50_ckmrmultinom5<-CV_ssb_N1000_Ind50_ckmrmultinom5<-array(NA, dim=c(3,100,76)) 
SD_R0_N1000_Ind50_ckmrmultinom5<-matrix(NA, nrow=3, ncol=100)
SD_M_N1000_Ind50_ckmrmultinom5<-matrix(NA, nrow=3, ncol=100)
for(f in 1:3){
  for (i in 1:100){
    CV_ssb_N1000_Ind50_ckmrmultinom5[f,i,]<-res_list[[f]][[i]]$SD$sd/res_list[[f]][[i]]$SD$unbiased$value
    SD_ssb_N1000_Ind50_ckmrmultinom5[f,i,]<-res_list[[f]][[i]]$SD$sd
    SD_R0_N1000_Ind50_ckmrmultinom5[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_R0","log_R0"])
    SD_M_N1000_Ind50_ckmrmultinom5[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_M","log_M"])
  }
}

#N5000, 5yrs CKMR data, sd index 0.50
res_list<-list()
res_list[[1]]<-readRDS(paste0(wd,"/SCAAfit_Cod_N5000_Ind50_ckmrmultinom5.RData"))
res_list[[2]]<-readRDS(paste0(wd,"/SCAAfit_Flatfish_N5000_Ind50_ckmrmultinom5.RData"))
res_list[[3]]<-readRDS(paste0(wd,"/SCAAfit_Sardine_N5000_Ind50_ckmrmultinom5.RData"))

load(paste0(wd,"/Cod_wdat_N5000_Ind50_ckmrmultinom5_1.RData"))
load(paste0(wd,"/Flatfish_wdat_N5000_Ind50_ckmrmultinom5_1.RData"))
load(paste0(wd,"/Sardine_wdat_N5000_Ind50_ckmrmultinom5_1.RData"))

re_Dep<-re_SSB<-array(NA, dim=c(3,100,76))
re_R0<-re_M<-matrix(NA, nrow=100, ncol=3)
for(f in 1:3){
  for (i in 1:100){
    if(f==1){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Cod_wdat[[i]]$OM$SSB[26:101])/Cod_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Cod_wdat[[i]]$OM$SSB[26:101]/Cod_wdat[[i]]$OM$SSB0)/(Cod_wdat[[i]]$OM$SSB[26:101]/Cod_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[3])-Cod_wdat[[i]]$OM$R0)/Cod_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Cod_wdat[[i]]$OM$Mref)/Cod_wdat[[i]]$OM$Mref
      
    }else if (f==2){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Flatfish_wdat[[i]]$OM$SSB[26:101])/Flatfish_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Flatfish_wdat[[i]]$OM$SSB[26:101]/Flatfish_wdat[[i]]$OM$SSB0)/(Flatfish_wdat[[i]]$OM$SSB[26:101]/Flatfish_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[3])-Flatfish_wdat[[i]]$OM$R0)/Flatfish_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Flatfish_wdat[[i]]$OM$Mref)/Flatfish_wdat[[i]]$OM$Mref
      
    } else if (f==3){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Sardine_wdat[[i]]$OM$SSB[26:101])/Sardine_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Sardine_wdat[[i]]$OM$SSB[26:101]/Sardine_wdat[[i]]$OM$SSB0)/(Sardine_wdat[[i]]$OM$SSB[26:101]/Sardine_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[3])-Sardine_wdat[[i]]$OM$R0)/Sardine_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Sardine_wdat[[i]]$OM$Mref)/Sardine_wdat[[i]]$OM$Mref
      
    }
  }
}

#SSB
par(mfrow=c(3,3))
boxplot(re_SSB[1,,], ylim=c(-0.25,0.25), las=1, main="Cod - N5000, Index SD - 0.50, CKMR 5yrs", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[2,,], ylim=c(-0.25,0.25), las=1, main="Flatfish - N5000, Index SD - 0.50, CKMR 5yrs", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[3,,], ylim=c(-0.25,0.25), las=1, main="Sardine - N5000, Index SD - 0.50, CKMR 5yrs", ylab="RE - SSB")
abline(h=0)

#R0
boxplot(re_R0[,1], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,2], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,3], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)

#M
boxplot(re_M[,1], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,2], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,3], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)

#SD of relative error for point estimates
sd_RE_ssb_N5000_Ind50_ckmrmultinom5<-apply(re_SSB,c(1,3),sd, na.rm=TRUE)
sd_RE_R0_N5000_Ind50_ckmrmultinom5<-apply(re_R0,2,sd, na.rm=TRUE)
sd_RE_M_N5000_Ind50_ckmrmultinom5<-apply(re_M,2,sd, na.rm=TRUE)

#SD of absolute relative error
sd_ARE_ssb_N5000_Ind50_ckmrmultinom5<-apply(abs(re_SSB),c(1,3),sd, na.rm=TRUE)
sd_ARE_R0_N5000_Ind50_ckmrmultinom5<-apply(abs(re_R0),2,sd, na.rm=TRUE)
sd_ARE_M_N5000_Ind50_ckmrmultinom5<-apply(abs(re_M),2,sd, na.rm=TRUE)

#Precision within sims
SD_ssb_N5000_Ind50_ckmrmultinom5<-CV_ssb_N5000_Ind50_ckmrmultinom5<-array(NA, dim=c(3,100,76)) 
SD_R0_N5000_Ind50_ckmrmultinom5<-matrix(NA, nrow=3, ncol=100)
SD_M_N5000_Ind50_ckmrmultinom5<-matrix(NA, nrow=3, ncol=100)
for(f in 1:3){
  for (i in 1:100){
    CV_ssb_N5000_Ind50_ckmrmultinom5[f,i,]<-res_list[[f]][[i]]$SD$sd/res_list[[f]][[i]]$SD$unbiased$value
    SD_ssb_N5000_Ind50_ckmrmultinom5[f,i,]<-res_list[[f]][[i]]$SD$sd
    SD_R0_N5000_Ind50_ckmrmultinom5[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_R0","log_R0"])
    SD_M_N5000_Ind50_ckmrmultinom5[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_M","log_M"])
  }
}

#N100, 10yrs CKMR data, sd index 0.25
res_list<-list()
res_list[[1]]<-readRDS(paste0(wd,"/SCAAfit_Cod_N100_Ind25_ckmrmultinom10.RData"))
res_list[[2]]<-readRDS(paste0(wd,"/SCAAfit_Flatfish_N100_Ind25_ckmrmultinom10.RData"))
res_list[[3]]<-readRDS(paste0(wd,"/SCAAfit_Sardine_N100_Ind25_ckmrmultinom10.RData"))

load(paste0(wd,"/Cod_wdat_N100_Ind25_ckmrmultinom10_1.RData"))
load(paste0(wd,"/Flatfish_wdat_N100_Ind25_ckmrmultinom10_1.RData"))
load(paste0(wd,"/Sardine_wdat_N100_Ind25_ckmrmultinom10_1.RData"))

re_Dep<-re_SSB<-array(NA, dim=c(3,100,76))
re_R0<-re_M<-matrix(NA, nrow=100, ncol=3)
for(f in 1:3){
  for (i in 1:100){
    if(f==1){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Cod_wdat[[i]]$OM$SSB[26:101])/Cod_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Cod_wdat[[i]]$OM$SSB[26:101]/Cod_wdat[[i]]$OM$SSB0)/(Cod_wdat[[i]]$OM$SSB[26:101]/Cod_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[3])-Cod_wdat[[i]]$OM$R0)/Cod_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Cod_wdat[[i]]$OM$Mref)/Cod_wdat[[i]]$OM$Mref
      
    }else if (f==2){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Flatfish_wdat[[i]]$OM$SSB[26:101])/Flatfish_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Flatfish_wdat[[i]]$OM$SSB[26:101]/Flatfish_wdat[[i]]$OM$SSB0)/(Flatfish_wdat[[i]]$OM$SSB[26:101]/Flatfish_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[3])-Flatfish_wdat[[i]]$OM$R0)/Flatfish_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Flatfish_wdat[[i]]$OM$Mref)/Flatfish_wdat[[i]]$OM$Mref
      
    } else if (f==3){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Sardine_wdat[[i]]$OM$SSB[26:101])/Sardine_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Sardine_wdat[[i]]$OM$SSB[26:101]/Sardine_wdat[[i]]$OM$SSB0)/(Sardine_wdat[[i]]$OM$SSB[26:101]/Sardine_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[3])-Sardine_wdat[[i]]$OM$R0)/Sardine_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Sardine_wdat[[i]]$OM$Mref)/Sardine_wdat[[i]]$OM$Mref
      
    }
  }
}

#SSB
par(mfrow=c(3,3))
boxplot(re_SSB[1,,], ylim=c(-0.25,0.25), las=1, main="Cod - N100, Index SD - 0.25, CKMR 10yrs", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[2,,], ylim=c(-0.25,0.25), las=1, main="Flatfish - N100, Index SD - 0.25, CKMR 10yrs", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[3,,], ylim=c(-0.25,0.25), las=1, main="Sardine - N100, Index SD - 0.25, CKMR 10yrs", ylab="RE - SSB")
abline(h=0)

#R0
boxplot(re_R0[,1], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,2], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,3], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)

#M
boxplot(re_M[,1], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,2], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,3], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)

#SD of relative error for point estimates
sd_RE_ssb_N100_Ind25_ckmrmultinom10<-apply(re_SSB,c(1,3),sd, na.rm=TRUE)
sd_RE_R0_N100_Ind25_ckmrmultinom10<-apply(re_R0,2,sd, na.rm=TRUE)
sd_RE_M_N100_Ind25_ckmrmultinom10<-apply(re_M,2,sd, na.rm=TRUE)

#SD of absolute relative error
sd_ARE_ssb_N100_Ind25_ckmrmultinom10<-apply(abs(re_SSB),c(1,3),sd, na.rm=TRUE)
sd_ARE_R0_N100_Ind25_ckmrmultinom10<-apply(abs(re_R0),2,sd, na.rm=TRUE)
sd_ARE_M_N100_Ind25_ckmrmultinom10<-apply(abs(re_M),2,sd, na.rm=TRUE)

#Precision within sims
SD_ssb_N100_Ind25_ckmrmultinom10<-CV_ssb_N100_Ind25_ckmrmultinom10<-array(NA, dim=c(3,100,76)) 
SD_R0_N100_Ind25_ckmrmultinom10<-matrix(NA, nrow=3, ncol=100)
SD_M_N100_Ind25_ckmrmultinom10<-matrix(NA, nrow=3, ncol=100)
for(f in 1:3){
  for (i in 1:100){
    CV_ssb_N100_Ind25_ckmrmultinom10[f,i,]<-res_list[[f]][[i]]$SD$sd/res_list[[f]][[i]]$SD$unbiased$value
    SD_ssb_N100_Ind25_ckmrmultinom10[f,i,]<-res_list[[f]][[i]]$SD$sd
    SD_R0_N100_Ind25_ckmrmultinom10[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_R0","log_R0"])
    SD_M_N100_Ind25_ckmrmultinom10[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_M","log_M"])
  }
}

#N1000, 10yrs CKMR data, sd index 0.25
res_list<-list()
res_list[[1]]<-readRDS(paste0(wd,"/SCAAfit_Cod_N1000_Ind25_ckmrmultinom10.RData"))
res_list[[2]]<-readRDS(paste0(wd,"/SCAAfit_Flatfish_N1000_Ind25_ckmrmultinom10.RData"))
res_list[[3]]<-readRDS(paste0(wd,"/SCAAfit_Sardine_N1000_Ind25_ckmrmultinom10.RData"))

load(paste0(wd,"/Cod_wdat_N1000_Ind25_ckmrmultinom10_1.RData"))
load(paste0(wd,"/Flatfish_wdat_N1000_Ind25_ckmrmultinom10_1.RData"))
load(paste0(wd,"/Sardine_wdat_N1000_Ind25_ckmrmultinom10_1.RData"))

re_Dep<-re_SSB<-array(NA, dim=c(3,100,76))
re_R0<-re_M<-matrix(NA, nrow=100, ncol=3)
for(f in 1:3){
  for (i in 1:100){
    if(f==1){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Cod_wdat[[i]]$OM$SSB[26:101])/Cod_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Cod_wdat[[i]]$OM$SSB[26:101]/Cod_wdat[[i]]$OM$SSB0)/(Cod_wdat[[i]]$OM$SSB[26:101]/Cod_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[3])-Cod_wdat[[i]]$OM$R0)/Cod_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Cod_wdat[[i]]$OM$Mref)/Cod_wdat[[i]]$OM$Mref
      
    }else if (f==2){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Flatfish_wdat[[i]]$OM$SSB[26:101])/Flatfish_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Flatfish_wdat[[i]]$OM$SSB[26:101]/Flatfish_wdat[[i]]$OM$SSB0)/(Flatfish_wdat[[i]]$OM$SSB[26:101]/Flatfish_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[3])-Flatfish_wdat[[i]]$OM$R0)/Flatfish_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Flatfish_wdat[[i]]$OM$Mref)/Flatfish_wdat[[i]]$OM$Mref
      
    } else if (f==3){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Sardine_wdat[[i]]$OM$SSB[26:101])/Sardine_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Sardine_wdat[[i]]$OM$SSB[26:101]/Sardine_wdat[[i]]$OM$SSB0)/(Sardine_wdat[[i]]$OM$SSB[26:101]/Sardine_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[3])-Sardine_wdat[[i]]$OM$R0)/Sardine_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Sardine_wdat[[i]]$OM$Mref)/Sardine_wdat[[i]]$OM$Mref
      
    }
  }
}

#SSB
par(mfrow=c(3,3))
boxplot(re_SSB[1,,], ylim=c(-0.25,0.25), las=1, main="Cod - N1000, Index SD - 0.25, CKMR 10yrs", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[2,,], ylim=c(-0.25,0.25), las=1, main="Flatfish - N1000, Index SD - 0.25, CKMR 10yrs", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[3,,], ylim=c(-0.25,0.25), las=1, main="Sardine - N1000, Index SD - 0.25, CKMR 10yrs", ylab="RE - SSB")
abline(h=0)

#R0
boxplot(re_R0[,1], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,2], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,3], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)

#M
boxplot(re_M[,1], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,2], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,3], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)

#SD of relative error for point estimates
sd_RE_ssb_N1000_Ind25_ckmrmultinom10<-apply(re_SSB,c(1,3),sd, na.rm=TRUE)
sd_RE_R0_N1000_Ind25_ckmrmultinom10<-apply(re_R0,2,sd, na.rm=TRUE)
sd_RE_M_N1000_Ind25_ckmrmultinom10<-apply(re_M,2,sd, na.rm=TRUE)

#SD of absolute relative error
sd_ARE_ssb_N1000_Ind25_ckmrmultinom10<-apply(abs(re_SSB),c(1,3),sd, na.rm=TRUE)
sd_ARE_R0_N1000_Ind25_ckmrmultinom10<-apply(abs(re_R0),2,sd, na.rm=TRUE)
sd_ARE_M_N1000_Ind25_ckmrmultinom10<-apply(abs(re_M),2,sd, na.rm=TRUE)

#Precision within sims
SD_ssb_N1000_Ind25_ckmrmultinom10<-CV_ssb_N1000_Ind25_ckmrmultinom10<-array(NA, dim=c(3,100,76)) 
SD_R0_N1000_Ind25_ckmrmultinom10<-matrix(NA, nrow=3, ncol=100)
SD_M_N1000_Ind25_ckmrmultinom10<-matrix(NA, nrow=3, ncol=100)
for(f in 1:3){
  for (i in 1:100){
    CV_ssb_N1000_Ind25_ckmrmultinom10[f,i,]<-res_list[[f]][[i]]$SD$sd/res_list[[f]][[i]]$SD$unbiased$value
    SD_ssb_N1000_Ind25_ckmrmultinom10[f,i,]<-res_list[[f]][[i]]$SD$sd
    SD_R0_N1000_Ind25_ckmrmultinom10[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_R0","log_R0"])
    SD_M_N1000_Ind25_ckmrmultinom10[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_M","log_M"])
  }
}

#N5000, 10yrs CKMR data, sd index 0.25
res_list<-list()
res_list[[1]]<-readRDS(paste0(wd,"/SCAAfit_Cod_N5000_Ind25_ckmrmultinom10.RData"))
res_list[[2]]<-readRDS(paste0(wd,"/SCAAfit_Flatfish_N5000_Ind25_ckmrmultinom10.RData"))
res_list[[3]]<-readRDS(paste0(wd,"/SCAAfit_Sardine_N5000_Ind25_ckmrmultinom10.RData"))

load(paste0(wd,"/Cod_wdat_N5000_Ind25_ckmrmultinom10_1.RData"))
load(paste0(wd,"/Flatfish_wdat_N5000_Ind25_ckmrmultinom10_1.RData"))
load(paste0(wd,"/Sardine_wdat_N5000_Ind25_ckmrmultinom10_1.RData"))

re_Dep<-re_SSB<-array(NA, dim=c(3,100,76))
re_R0<-re_M<-matrix(NA, nrow=100, ncol=3)
for(f in 1:3){
  for (i in 1:100){
    if(f==1){
       if (!is.null(res_list[[f]][[i]])){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Cod_wdat[[i]]$OM$SSB[26:101])/Cod_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Cod_wdat[[i]]$OM$SSB[26:101]/Cod_wdat[[i]]$OM$SSB0)/(Cod_wdat[[i]]$OM$SSB[26:101]/Cod_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[3])-Cod_wdat[[i]]$OM$R0)/Cod_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Cod_wdat[[i]]$OM$Mref)/Cod_wdat[[i]]$OM$Mref
       }
    }else if (f==2){
       if (!is.null(res_list[[f]][[i]])){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Flatfish_wdat[[i]]$OM$SSB[26:101])/Flatfish_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Flatfish_wdat[[i]]$OM$SSB[26:101]/Flatfish_wdat[[i]]$OM$SSB0)/(Flatfish_wdat[[i]]$OM$SSB[26:101]/Flatfish_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[3])-Flatfish_wdat[[i]]$OM$R0)/Flatfish_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Flatfish_wdat[[i]]$OM$Mref)/Flatfish_wdat[[i]]$OM$Mref
       }
    } else if (f==3){
       if (!is.null(res_list[[f]][[i]])){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Sardine_wdat[[i]]$OM$SSB[26:101])/Sardine_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Sardine_wdat[[i]]$OM$SSB[26:101]/Sardine_wdat[[i]]$OM$SSB0)/(Sardine_wdat[[i]]$OM$SSB[26:101]/Sardine_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[3])-Sardine_wdat[[i]]$OM$R0)/Sardine_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Sardine_wdat[[i]]$OM$Mref)/Sardine_wdat[[i]]$OM$Mref
       }
    }
  }
}

#SSB
par(mfrow=c(3,3))
boxplot(re_SSB[1,,], ylim=c(-0.25,0.25), las=1, main="Cod - N5000, Index SD - 0.25, CKMR 10yrs", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[2,,], ylim=c(-0.25,0.25), las=1, main="Flatfish - N5000, Index SD - 0.25, CKMR 10yrs", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[3,,], ylim=c(-0.25,0.25), las=1, main="Sardine - N5000, Index SD - 0.25, CKMR 10yrs", ylab="RE - SSB")
abline(h=0)

#R0
boxplot(re_R0[,1], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,2], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,3], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)

#M
boxplot(re_M[,1], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,2], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,3], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)

#SD of relative error for point estimates
sd_RE_ssb_N5000_Ind25_ckmrmultinom10<-apply(re_SSB,c(1,3),sd, na.rm=TRUE)
sd_RE_R0_N5000_Ind25_ckmrmultinom10<-apply(re_R0,2,sd, na.rm=TRUE)
sd_RE_M_N5000_Ind25_ckmrmultinom10<-apply(re_M,2,sd, na.rm=TRUE)

#SD of absolute relative error
sd_ARE_ssb_N5000_Ind25_ckmrmultinom10<-apply(abs(re_SSB),c(1,3),sd, na.rm=TRUE)
sd_ARE_R0_N5000_Ind25_ckmrmultinom10<-apply(abs(re_R0),2,sd, na.rm=TRUE)
sd_ARE_M_N5000_Ind25_ckmrmultinom10<-apply(abs(re_M),2,sd, na.rm=TRUE)

#Precision within sims
SD_ssb_N5000_Ind25_ckmrmultinom10<-CV_ssb_N5000_Ind25_ckmrmultinom10<-array(NA, dim=c(3,100,76)) 
SD_R0_N5000_Ind25_ckmrmultinom10<-matrix(NA, nrow=3, ncol=100)
SD_M_N5000_Ind25_ckmrmultinom10<-matrix(NA, nrow=3, ncol=100)
for(f in 1:3){
  for (i in 1:100){
    if (!is.null(res_list[[f]][[i]])){
    CV_ssb_N5000_Ind25_ckmrmultinom10[f,i,]<-res_list[[f]][[i]]$SD$sd/res_list[[f]][[i]]$SD$unbiased$value
    SD_ssb_N5000_Ind25_ckmrmultinom10[f,i,]<-res_list[[f]][[i]]$SD$sd
    SD_R0_N5000_Ind25_ckmrmultinom10[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_R0","log_R0"])
    SD_M_N5000_Ind25_ckmrmultinom10[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_M","log_M"])
    }
  }
}

#N100, 10yrs CKMR data, sd index 0.50
res_list<-list()
res_list[[1]]<-readRDS(paste0(wd,"/SCAAfit_Cod_N100_Ind50_ckmrmultinom10.RData"))
res_list[[2]]<-readRDS(paste0(wd,"/SCAAfit_Flatfish_N100_Ind50_ckmrmultinom10.RData"))
res_list[[3]]<-readRDS(paste0(wd,"/SCAAfit_Sardine_N100_Ind50_ckmrmultinom10.RData"))

load(paste0(wd,"/Cod_wdat_N100_Ind50_ckmrmultinom10_1.RData"))
load(paste0(wd,"/Flatfish_wdat_N100_Ind50_ckmrmultinom10_1.RData"))
load(paste0(wd,"/Sardine_wdat_N100_Ind50_ckmrmultinom10_1.RData"))

re_Dep<-re_SSB<-array(NA, dim=c(3,100,76))
re_R0<-re_M<-matrix(NA, nrow=100, ncol=3)
for(f in 1:3){
  for (i in 1:100){
    if(f==1){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Cod_wdat[[i]]$OM$SSB[26:101])/Cod_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Cod_wdat[[i]]$OM$SSB[26:101]/Cod_wdat[[i]]$OM$SSB0)/(Cod_wdat[[i]]$OM$SSB[26:101]/Cod_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[3])-Cod_wdat[[i]]$OM$R0)/Cod_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Cod_wdat[[i]]$OM$Mref)/Cod_wdat[[i]]$OM$Mref
      
    }else if (f==2){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Flatfish_wdat[[i]]$OM$SSB[26:101])/Flatfish_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Flatfish_wdat[[i]]$OM$SSB[26:101]/Flatfish_wdat[[i]]$OM$SSB0)/(Flatfish_wdat[[i]]$OM$SSB[26:101]/Flatfish_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[3])-Flatfish_wdat[[i]]$OM$R0)/Flatfish_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Flatfish_wdat[[i]]$OM$Mref)/Flatfish_wdat[[i]]$OM$Mref
      
    } else if (f==3){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Sardine_wdat[[i]]$OM$SSB[26:101])/Sardine_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Sardine_wdat[[i]]$OM$SSB[26:101]/Sardine_wdat[[i]]$OM$SSB0)/(Sardine_wdat[[i]]$OM$SSB[26:101]/Sardine_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[3])-Sardine_wdat[[i]]$OM$R0)/Sardine_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Sardine_wdat[[i]]$OM$Mref)/Sardine_wdat[[i]]$OM$Mref
      
    }
  }
}

#SSB
par(mfrow=c(3,3))
boxplot(re_SSB[1,,], ylim=c(-0.25,0.25), las=1, main="Cod - N100, Index SD - 0.50, CKMR 10yrs", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[2,,], ylim=c(-0.25,0.25), las=1, main="Flatfish - N100, Index SD - 0.50, CKMR 10yrs", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[3,,], ylim=c(-0.25,0.25), las=1, main="Sardine - N100, Index SD - 0.50, CKMR 10yrs", ylab="RE - SSB")
abline(h=0)

#R0
boxplot(re_R0[,1], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,2], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,3], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)

#M
boxplot(re_M[,1], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,2], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,3], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)

#SD of relative error for point estimates
sd_RE_ssb_N100_Ind50_ckmrmultinom10<-apply(re_SSB,c(1,3),sd, na.rm=TRUE)
sd_RE_R0_N100_Ind50_ckmrmultinom10<-apply(re_R0,2,sd, na.rm=TRUE)
sd_RE_M_N100_Ind50_ckmrmultinom10<-apply(re_M,2,sd, na.rm=TRUE)

#SD of absolute relative error
sd_ARE_ssb_N100_Ind50_ckmrmultinom10<-apply(abs(re_SSB),c(1,3),sd, na.rm=TRUE)
sd_ARE_R0_N100_Ind50_ckmrmultinom10<-apply(abs(re_R0),2,sd, na.rm=TRUE)
sd_ARE_M_N100_Ind50_ckmrmultinom10<-apply(abs(re_M),2,sd, na.rm=TRUE)

#Precision within sims
SD_ssb_N100_Ind50_ckmrmultinom10<-CV_ssb_N100_Ind50_ckmrmultinom10<-array(NA, dim=c(3,100,76)) 
SD_R0_N100_Ind50_ckmrmultinom10<-matrix(NA, nrow=3, ncol=100)
SD_M_N100_Ind50_ckmrmultinom10<-matrix(NA, nrow=3, ncol=100)
for(f in 1:3){
  for (i in 1:100){
    CV_ssb_N100_Ind50_ckmrmultinom10[f,i,]<-res_list[[f]][[i]]$SD$sd/res_list[[f]][[i]]$SD$unbiased$value
    SD_ssb_N100_Ind50_ckmrmultinom10[f,i,]<-res_list[[f]][[i]]$SD$sd
    SD_R0_N100_Ind50_ckmrmultinom10[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_R0","log_R0"])
    SD_M_N100_Ind50_ckmrmultinom10[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_M","log_M"])
  }
}

#N1000, 10yrs CKMR data, sd index 0.50
res_list<-list()
res_list[[1]]<-readRDS(paste0(wd,"/SCAAfit_Cod_N1000_Ind50_ckmrmultinom10.RData"))
res_list[[2]]<-readRDS(paste0(wd,"/SCAAfit_Flatfish_N1000_Ind50_ckmrmultinom10.RData"))
res_list[[3]]<-readRDS(paste0(wd,"/SCAAfit_Sardine_N1000_Ind50_ckmrmultinom10.RData"))

load(paste0(wd,"/Cod_wdat_N1000_Ind50_ckmrmultinom10_1.RData"))
load(paste0(wd,"/Flatfish_wdat_N1000_Ind50_ckmrmultinom10_1.RData"))
load(paste0(wd,"/Sardine_wdat_N1000_Ind50_ckmrmultinom10_1.RData"))

re_Dep<-re_SSB<-array(NA, dim=c(3,100,76))
re_R0<-re_M<-matrix(NA, nrow=100, ncol=3)
for(f in 1:3){
  for (i in 1:100){
    if(f==1){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Cod_wdat[[i]]$OM$SSB[26:101])/Cod_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Cod_wdat[[i]]$OM$SSB[26:101]/Cod_wdat[[i]]$OM$SSB0)/(Cod_wdat[[i]]$OM$SSB[26:101]/Cod_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[3])-Cod_wdat[[i]]$OM$R0)/Cod_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Cod_wdat[[i]]$OM$Mref)/Cod_wdat[[i]]$OM$Mref
      
    }else if (f==2){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Flatfish_wdat[[i]]$OM$SSB[26:101])/Flatfish_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Flatfish_wdat[[i]]$OM$SSB[26:101]/Flatfish_wdat[[i]]$OM$SSB0)/(Flatfish_wdat[[i]]$OM$SSB[26:101]/Flatfish_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[3])-Flatfish_wdat[[i]]$OM$R0)/Flatfish_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Flatfish_wdat[[i]]$OM$Mref)/Flatfish_wdat[[i]]$OM$Mref
      
    } else if (f==3){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Sardine_wdat[[i]]$OM$SSB[26:101])/Sardine_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Sardine_wdat[[i]]$OM$SSB[26:101]/Sardine_wdat[[i]]$OM$SSB0)/(Sardine_wdat[[i]]$OM$SSB[26:101]/Sardine_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[3])-Sardine_wdat[[i]]$OM$R0)/Sardine_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Sardine_wdat[[i]]$OM$Mref)/Sardine_wdat[[i]]$OM$Mref
      
    }
  }
}

#SSB
par(mfrow=c(3,3))
boxplot(re_SSB[1,,], ylim=c(-0.25,0.25), las=1, main="Cod - N1000, Index SD - 0.50, CKMR 10yrs", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[2,,], ylim=c(-0.25,0.25), las=1, main="Flatfish - N1000, Index SD - 0.50, CKMR 10yrs", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[3,,], ylim=c(-0.25,0.25), las=1, main="Sardine - N1000, Index SD - 0.50, CKMR 10yrs", ylab="RE - SSB")
abline(h=0)

#R0
boxplot(re_R0[,1], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,2], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,3], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)

#M
boxplot(re_M[,1], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,2], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,3], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)

#SD of relative error for point estimates
sd_RE_ssb_N1000_Ind50_ckmrmultinom10<-apply(re_SSB,c(1,3),sd, na.rm=TRUE)
sd_RE_R0_N1000_Ind50_ckmrmultinom10<-apply(re_R0,2,sd, na.rm=TRUE)
sd_RE_M_N1000_Ind50_ckmrmultinom10<-apply(re_M,2,sd, na.rm=TRUE)

#SD of absolute relative error
sd_ARE_ssb_N1000_Ind50_ckmrmultinom10<-apply(abs(re_SSB),c(1,3),sd, na.rm=TRUE)
sd_ARE_R0_N1000_Ind50_ckmrmultinom10<-apply(abs(re_R0),2,sd, na.rm=TRUE)
sd_ARE_M_N1000_Ind50_ckmrmultinom10<-apply(abs(re_M),2,sd, na.rm=TRUE)

#Precision within sims
SD_ssb_N1000_Ind50_ckmrmultinom10<-CV_ssb_N1000_Ind50_ckmrmultinom10<-array(NA, dim=c(3,100,76)) 
SD_R0_N1000_Ind50_ckmrmultinom10<-matrix(NA, nrow=3, ncol=100)
SD_M_N1000_Ind50_ckmrmultinom10<-matrix(NA, nrow=3, ncol=100)
for(f in 1:3){
  for (i in 1:100){
    CV_ssb_N1000_Ind50_ckmrmultinom10[f,i,]<-res_list[[f]][[i]]$SD$sd/res_list[[f]][[i]]$SD$unbiased$value
    SD_ssb_N1000_Ind50_ckmrmultinom10[f,i,]<-res_list[[f]][[i]]$SD$sd
    SD_R0_N1000_Ind50_ckmrmultinom10[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_R0","log_R0"])
    SD_M_N1000_Ind50_ckmrmultinom10[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_M","log_M"])
  }
}

#N5000, 10yrs CKMR data, sd index 0.50
res_list<-list()
res_list[[1]]<-readRDS(paste0(wd,"/SCAAfit_Cod_N5000_Ind50_ckmrmultinom10.RData"))
res_list[[2]]<-readRDS(paste0(wd,"/SCAAfit_Flatfish_N5000_Ind50_ckmrmultinom10.RData"))
res_list[[3]]<-readRDS(paste0(wd,"/SCAAfit_Sardine_N5000_Ind50_ckmrmultinom10.RData"))

load(paste0(wd,"/Cod_wdat_N5000_Ind50_ckmrmultinom10_1.RData"))
load(paste0(wd,"/Flatfish_wdat_N5000_Ind50_ckmrmultinom10_1.RData"))
load(paste0(wd,"/Sardine_wdat_N5000_Ind50_ckmrmultinom10_1.RData"))

re_Dep<-re_SSB<-array(NA, dim=c(3,100,76))
re_R0<-re_M<-matrix(NA, nrow=100, ncol=3)
for(f in 1:3){
  for (i in 1:100){
    if(f==1){
       if (!is.null(res_list[[f]][[i]])){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Cod_wdat[[i]]$OM$SSB[26:101])/Cod_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Cod_wdat[[i]]$OM$SSB[26:101]/Cod_wdat[[i]]$OM$SSB0)/(Cod_wdat[[i]]$OM$SSB[26:101]/Cod_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[3])-Cod_wdat[[i]]$OM$R0)/Cod_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Cod_wdat[[i]]$OM$Mref)/Cod_wdat[[i]]$OM$Mref
       }
    }else if (f==2){
       if (!is.null(res_list[[f]][[i]])){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Flatfish_wdat[[i]]$OM$SSB[26:101])/Flatfish_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Flatfish_wdat[[i]]$OM$SSB[26:101]/Flatfish_wdat[[i]]$OM$SSB0)/(Flatfish_wdat[[i]]$OM$SSB[26:101]/Flatfish_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[3])-Flatfish_wdat[[i]]$OM$R0)/Flatfish_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Flatfish_wdat[[i]]$OM$Mref)/Flatfish_wdat[[i]]$OM$Mref
       }
    } else if (f==3){
       if (!is.null(res_list[[f]][[i]])){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Sardine_wdat[[i]]$OM$SSB[26:101])/Sardine_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Sardine_wdat[[i]]$OM$SSB[26:101]/Sardine_wdat[[i]]$OM$SSB0)/(Sardine_wdat[[i]]$OM$SSB[26:101]/Sardine_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[3])-Sardine_wdat[[i]]$OM$R0)/Sardine_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Sardine_wdat[[i]]$OM$Mref)/Sardine_wdat[[i]]$OM$Mref
       }
    }
  }
}

#SSB
par(mfrow=c(3,3))
boxplot(re_SSB[1,,], ylim=c(-0.25,0.25), las=1, main="Cod - N5000, Index SD - 0.50, CKMR 10yrs", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[2,,], ylim=c(-0.25,0.25), las=1, main="Flatfish - N5000, Index SD - 0.50, CKMR 10yrs", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[3,,], ylim=c(-0.25,0.25), las=1, main="Sardine - N5000, Index SD - 0.50, CKMR 10yrs", ylab="RE - SSB")
abline(h=0)

#R0
boxplot(re_R0[,1], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,2], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,3], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)

#M
boxplot(re_M[,1], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,2], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,3], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)

#SD of relative error for point estimates
sd_RE_ssb_N5000_Ind50_ckmrmultinom10<-apply(re_SSB,c(1,3),sd, na.rm=TRUE)
sd_RE_R0_N5000_Ind50_ckmrmultinom10<-apply(re_R0,2,sd, na.rm=TRUE)
sd_RE_M_N5000_Ind50_ckmrmultinom10<-apply(re_M,2,sd, na.rm=TRUE)

#SD of absolute relative error
sd_ARE_ssb_N5000_Ind50_ckmrmultinom10<-apply(abs(re_SSB),c(1,3),sd, na.rm=TRUE)
sd_ARE_R0_N5000_Ind50_ckmrmultinom10<-apply(abs(re_R0),2,sd, na.rm=TRUE)
sd_ARE_M_N5000_Ind50_ckmrmultinom10<-apply(abs(re_M),2,sd, na.rm=TRUE)

#Precision within sims
SD_ssb_N5000_Ind50_ckmrmultinom10<-CV_ssb_N5000_Ind50_ckmrmultinom10<-array(NA, dim=c(3,100,76)) 
SD_R0_N5000_Ind50_ckmrmultinom10<-matrix(NA, nrow=3, ncol=100)
SD_M_N5000_Ind50_ckmrmultinom10<-matrix(NA, nrow=3, ncol=100)
for(f in 1:3){
  for (i in 1:100){
    if (!is.null(res_list[[f]][[i]])){
    CV_ssb_N5000_Ind50_ckmrmultinom10[f,i,]<-res_list[[f]][[i]]$SD$sd/res_list[[f]][[i]]$SD$unbiased$value
    SD_ssb_N5000_Ind50_ckmrmultinom10[f,i,]<-res_list[[f]][[i]]$SD$sd
    SD_R0_N5000_Ind50_ckmrmultinom10[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_R0","log_R0"])
    SD_M_N5000_Ind50_ckmrmultinom10[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_M","log_M"])
    }
  }
}

#20yrs CKMR data
#N100, 20yrs CKMR data, sd index 0.25
res_list<-list()
res_list[[1]]<-readRDS(paste0(wd,"/SCAAfit_Cod_N100_Ind25_ckmrmultinom20.RData"))
res_list[[2]]<-readRDS(paste0(wd,"/SCAAfit_Flatfish_N100_Ind25_ckmrmultinom20.RData"))
res_list[[3]]<-readRDS(paste0(wd,"/SCAAfit_Sardine_N100_Ind25_ckmrmultinom20.RData"))

load(paste0(wd,"/Cod_wdat_N100_Ind25_ckmrmultinom20_1.RData"))
load(paste0(wd,"/Flatfish_wdat_N100_Ind25_ckmrmultinom20_1.RData"))
load(paste0(wd,"/Sardine_wdat_N100_Ind25_ckmrmultinom20_1.RData"))

re_Dep<-re_SSB<-array(NA, dim=c(3,100,76))
re_R0<-re_M<-matrix(NA, nrow=100, ncol=3)
for(f in 1:3){
  for (i in 1:100){
    if(f==1){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Cod_wdat[[i]]$OM$SSB[26:101])/Cod_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Cod_wdat[[i]]$OM$SSB[26:101]/Cod_wdat[[i]]$OM$SSB0)/(Cod_wdat[[i]]$OM$SSB[26:101]/Cod_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[3])-Cod_wdat[[i]]$OM$R0)/Cod_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Cod_wdat[[i]]$OM$Mref)/Cod_wdat[[i]]$OM$Mref

    }else if (f==2){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Flatfish_wdat[[i]]$OM$SSB[26:101])/Flatfish_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Flatfish_wdat[[i]]$OM$SSB[26:101]/Flatfish_wdat[[i]]$OM$SSB0)/(Flatfish_wdat[[i]]$OM$SSB[26:101]/Flatfish_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[3])-Flatfish_wdat[[i]]$OM$R0)/Flatfish_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Flatfish_wdat[[i]]$OM$Mref)/Flatfish_wdat[[i]]$OM$Mref

    } else if (f==3){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Sardine_wdat[[i]]$OM$SSB[26:101])/Sardine_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Sardine_wdat[[i]]$OM$SSB[26:101]/Sardine_wdat[[i]]$OM$SSB0)/(Sardine_wdat[[i]]$OM$SSB[26:101]/Sardine_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[3])-Sardine_wdat[[i]]$OM$R0)/Sardine_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Sardine_wdat[[i]]$OM$Mref)/Sardine_wdat[[i]]$OM$Mref

    }
  }
}

#SSB
par(mfrow=c(3,3))
boxplot(re_SSB[1,,], ylim=c(-0.25,0.25), las=1, main="Cod - N100, Index SD - 0.25, CKMR 20yrs", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[2,,], ylim=c(-0.25,0.25), las=1, main="Flatfish - N100, Index SD - 0.25, CKMR 20yrs", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[3,,], ylim=c(-0.25,0.25), las=1, main="Sardine - N100, Index SD - 0.25, CKMR 20yrs", ylab="RE - SSB")
abline(h=0)

#R0
boxplot(re_R0[,1], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,2], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,3], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)

#M
boxplot(re_M[,1], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,2], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,3], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)

#SD of relative error for point estimates
sd_RE_ssb_N100_Ind25_ckmrmultinom20<-apply(re_SSB,c(1,3),sd, na.rm=TRUE)
sd_RE_R0_N100_Ind25_ckmrmultinom20<-apply(re_R0,2,sd, na.rm=TRUE)
sd_RE_M_N100_Ind25_ckmrmultinom20<-apply(re_M,2,sd, na.rm=TRUE)

#SD of absolute relative error
sd_ARE_ssb_N100_Ind25_ckmrmultinom20<-apply(abs(re_SSB),c(1,3),sd, na.rm=TRUE)
sd_ARE_R0_N100_Ind25_ckmrmultinom20<-apply(abs(re_R0),2,sd, na.rm=TRUE)
sd_ARE_M_N100_Ind25_ckmrmultinom20<-apply(abs(re_M),2,sd, na.rm=TRUE)

#Precision within sims
SD_ssb_N100_Ind25_ckmrmultinom20<-CV_ssb_N100_Ind25_ckmrmultinom20<-array(NA, dim=c(3,100,76))
SD_R0_N100_Ind25_ckmrmultinom20<-matrix(NA, nrow=3, ncol=100)
SD_M_N100_Ind25_ckmrmultinom20<-matrix(NA, nrow=3, ncol=100)
for(f in 1:3){
  for (i in 1:100){
    CV_ssb_N100_Ind25_ckmrmultinom20[f,i,]<-res_list[[f]][[i]]$SD$sd/res_list[[f]][[i]]$SD$unbiased$value
    SD_ssb_N100_Ind25_ckmrmultinom20[f,i,]<-res_list[[f]][[i]]$SD$sd
    SD_R0_N100_Ind25_ckmrmultinom20[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_R0","log_R0"])
    SD_M_N100_Ind25_ckmrmultinom20[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_M","log_M"])
  }
}

#N1000, 20yrs CKMR data, sd index 0.25
res_list<-list()
res_list[[1]]<-readRDS(paste0(wd,"/SCAAfit_Cod_N1000_Ind25_ckmrmultinom20.RData"))
res_list[[2]]<-readRDS(paste0(wd,"/SCAAfit_Flatfish_N1000_Ind25_ckmrmultinom20.RData"))
res_list[[3]]<-readRDS(paste0(wd,"/SCAAfit_Sardine_N1000_Ind25_ckmrmultinom20.RData"))

load(paste0(wd,"/Cod_wdat_N1000_Ind25_ckmrmultinom20_1.RData"))
load(paste0(wd,"/Flatfish_wdat_N1000_Ind25_ckmrmultinom20_1.RData"))
load(paste0(wd,"/Sardine_wdat_N1000_Ind25_ckmrmultinom20_1.RData"))

re_Dep<-re_SSB<-array(NA, dim=c(3,100,76))
re_R0<-re_M<-matrix(NA, nrow=100, ncol=3)
for(f in 1:3){
  for (i in 1:100){
    if(f==1){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Cod_wdat[[i]]$OM$SSB[26:101])/Cod_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Cod_wdat[[i]]$OM$SSB[26:101]/Cod_wdat[[i]]$OM$SSB0)/(Cod_wdat[[i]]$OM$SSB[26:101]/Cod_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[3])-Cod_wdat[[i]]$OM$R0)/Cod_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Cod_wdat[[i]]$OM$Mref)/Cod_wdat[[i]]$OM$Mref

    }else if (f==2){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Flatfish_wdat[[i]]$OM$SSB[26:101])/Flatfish_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Flatfish_wdat[[i]]$OM$SSB[26:101]/Flatfish_wdat[[i]]$OM$SSB0)/(Flatfish_wdat[[i]]$OM$SSB[26:101]/Flatfish_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[3])-Flatfish_wdat[[i]]$OM$R0)/Flatfish_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Flatfish_wdat[[i]]$OM$Mref)/Flatfish_wdat[[i]]$OM$Mref

    } else if (f==3){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Sardine_wdat[[i]]$OM$SSB[26:101])/Sardine_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Sardine_wdat[[i]]$OM$SSB[26:101]/Sardine_wdat[[i]]$OM$SSB0)/(Sardine_wdat[[i]]$OM$SSB[26:101]/Sardine_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[3])-Sardine_wdat[[i]]$OM$R0)/Sardine_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Sardine_wdat[[i]]$OM$Mref)/Sardine_wdat[[i]]$OM$Mref

    }
  }
}

#SSB
par(mfrow=c(3,3))
boxplot(re_SSB[1,,], ylim=c(-0.25,0.25), las=1, main="Cod - N1000, Index SD - 0.25, CKMR 20yrs", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[2,,], ylim=c(-0.25,0.25), las=1, main="Flatfish - N1000, Index SD - 0.25, CKMR 20yrs", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[3,,], ylim=c(-0.25,0.25), las=1, main="Sardine - N1000, Index SD - 0.25, CKMR 20yrs", ylab="RE - SSB")
abline(h=0)

#R0
boxplot(re_R0[,1], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,2], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,3], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)

#M
boxplot(re_M[,1], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,2], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,3], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)

#SD of relative error for point estimates
sd_RE_ssb_N1000_Ind25_ckmrmultinom20<-apply(re_SSB,c(1,3),sd, na.rm=TRUE)
sd_RE_R0_N1000_Ind25_ckmrmultinom20<-apply(re_R0,2,sd, na.rm=TRUE)
sd_RE_M_N1000_Ind25_ckmrmultinom20<-apply(re_M,2,sd, na.rm=TRUE)

#SD of absolute relative error
sd_ARE_ssb_N1000_Ind25_ckmrmultinom20<-apply(abs(re_SSB),c(1,3),sd, na.rm=TRUE)
sd_ARE_R0_N1000_Ind25_ckmrmultinom20<-apply(abs(re_R0),2,sd, na.rm=TRUE)
sd_ARE_M_N1000_Ind25_ckmrmultinom20<-apply(abs(re_M),2,sd, na.rm=TRUE)

#Precision within sims
SD_ssb_N1000_Ind25_ckmrmultinom20<-CV_ssb_N1000_Ind25_ckmrmultinom20<-array(NA, dim=c(3,100,76))
SD_R0_N1000_Ind25_ckmrmultinom20<-matrix(NA, nrow=3, ncol=100)
SD_M_N1000_Ind25_ckmrmultinom20<-matrix(NA, nrow=3, ncol=100)
for(f in 1:3){
  for (i in 1:100){
    CV_ssb_N1000_Ind25_ckmrmultinom20[f,i,]<-res_list[[f]][[i]]$SD$sd/res_list[[f]][[i]]$SD$unbiased$value
    SD_ssb_N1000_Ind25_ckmrmultinom20[f,i,]<-res_list[[f]][[i]]$SD$sd
    SD_R0_N1000_Ind25_ckmrmultinom20[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_R0","log_R0"])
    SD_M_N1000_Ind25_ckmrmultinom20[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_M","log_M"])
  }
}

#N5000, 20yrs CKMR data, sd index 0.25
res_list<-list()
res_list[[1]]<-readRDS(paste0(wd,"/SCAAfit_Cod_N5000_Ind25_ckmrmultinom20.RData"))
res_list[[2]]<-readRDS(paste0(wd,"/SCAAfit_Flatfish_N5000_Ind25_ckmrmultinom20.RData"))
res_list[[3]]<-readRDS(paste0(wd,"/SCAAfit_Sardine_N5000_Ind25_ckmrmultinom20.RData"))

load(paste0(wd,"/Cod_wdat_N5000_Ind25_ckmrmultinom20_1.RData"))
load(paste0(wd,"/Flatfish_wdat_N5000_Ind25_ckmrmultinom20_1.RData"))
load(paste0(wd,"/Sardine_wdat_N5000_Ind25_ckmrmultinom20_1.RData"))

re_Dep<-re_SSB<-array(NA, dim=c(3,100,76))
re_R0<-re_M<-matrix(NA, nrow=100, ncol=3)
for(f in 1:3){
  for (i in 1:100){
    if(f==1){
       if (!is.null(res_list[[f]][[i]])){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Cod_wdat[[i]]$OM$SSB[26:101])/Cod_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Cod_wdat[[i]]$OM$SSB[26:101]/Cod_wdat[[i]]$OM$SSB0)/(Cod_wdat[[i]]$OM$SSB[26:101]/Cod_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[3])-Cod_wdat[[i]]$OM$R0)/Cod_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Cod_wdat[[i]]$OM$Mref)/Cod_wdat[[i]]$OM$Mref
       }
    }else if (f==2){
       if (!is.null(res_list[[f]][[i]])){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Flatfish_wdat[[i]]$OM$SSB[26:101])/Flatfish_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Flatfish_wdat[[i]]$OM$SSB[26:101]/Flatfish_wdat[[i]]$OM$SSB0)/(Flatfish_wdat[[i]]$OM$SSB[26:101]/Flatfish_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[3])-Flatfish_wdat[[i]]$OM$R0)/Flatfish_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Flatfish_wdat[[i]]$OM$Mref)/Flatfish_wdat[[i]]$OM$Mref
      }
    } else if (f==3){
       if (!is.null(res_list[[f]][[i]])){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Sardine_wdat[[i]]$OM$SSB[26:101])/Sardine_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Sardine_wdat[[i]]$OM$SSB[26:101]/Sardine_wdat[[i]]$OM$SSB0)/(Sardine_wdat[[i]]$OM$SSB[26:101]/Sardine_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[3])-Sardine_wdat[[i]]$OM$R0)/Sardine_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Sardine_wdat[[i]]$OM$Mref)/Sardine_wdat[[i]]$OM$Mref
       }
    }
  }
}

#SSB
par(mfrow=c(3,3))
boxplot(re_SSB[1,,], ylim=c(-0.25,0.25), las=1, main="Cod - N5000, Index SD - 0.25, CKMR 20yrs", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[2,,], ylim=c(-0.25,0.25), las=1, main="Flatfish - N5000, Index SD - 0.25, CKMR 20yrs", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[3,,], ylim=c(-0.25,0.25), las=1, main="Sardine - N5000, Index SD - 0.25, CKMR 20yrs", ylab="RE - SSB")
abline(h=0)

#R0
boxplot(re_R0[,1], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,2], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,3], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)

#M
boxplot(re_M[,1], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,2], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,3], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)

#SD of relative error for point estimates
sd_RE_ssb_N5000_Ind25_ckmrmultinom20<-apply(re_SSB,c(1,3),sd, na.rm=TRUE)
sd_RE_R0_N5000_Ind25_ckmrmultinom20<-apply(re_R0,2,sd, na.rm=TRUE)
sd_RE_M_N5000_Ind25_ckmrmultinom20<-apply(re_M,2,sd, na.rm=TRUE)

#SD of absolute relative error
sd_ARE_ssb_N5000_Ind25_ckmrmultinom20<-apply(abs(re_SSB),c(1,3),sd, na.rm=TRUE)
sd_ARE_R0_N5000_Ind25_ckmrmultinom20<-apply(abs(re_R0),2,sd, na.rm=TRUE)
sd_ARE_M_N5000_Ind25_ckmrmultinom20<-apply(abs(re_M),2,sd, na.rm=TRUE)

#Precision within sims
SD_ssb_N5000_Ind25_ckmrmultinom20<-CV_ssb_N5000_Ind25_ckmrmultinom20<-array(NA, dim=c(3,100,76))
SD_R0_N5000_Ind25_ckmrmultinom20<-matrix(NA, nrow=3, ncol=100)
SD_M_N5000_Ind25_ckmrmultinom20<-matrix(NA, nrow=3, ncol=100)
for(f in 1:3){
  for (i in 1:100){
    if (!is.null(res_list[[f]][[i]])){
    CV_ssb_N5000_Ind25_ckmrmultinom20[f,i,]<-res_list[[f]][[i]]$SD$sd/res_list[[f]][[i]]$SD$unbiased$value
    SD_ssb_N5000_Ind25_ckmrmultinom20[f,i,]<-res_list[[f]][[i]]$SD$sd
    SD_R0_N5000_Ind25_ckmrmultinom20[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_R0","log_R0"])
    SD_M_N5000_Ind25_ckmrmultinom20[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_M","log_M"])
    }
  }
}

#N100, 20yrs CKMR data, sd index 0.50
res_list<-list()
res_list[[1]]<-readRDS(paste0(wd,"/SCAAfit_Cod_N100_Ind50_ckmrmultinom20.RData"))
res_list[[2]]<-readRDS(paste0(wd,"/SCAAfit_Flatfish_N100_Ind50_ckmrmultinom20.RData"))
res_list[[3]]<-readRDS(paste0(wd,"/SCAAfit_Sardine_N100_Ind50_ckmrmultinom20.RData"))

load(paste0(wd,"/Cod_wdat_N100_Ind50_ckmrmultinom20_1.RData"))
load(paste0(wd,"/Flatfish_wdat_N100_Ind50_ckmrmultinom20_1.RData"))
load(paste0(wd,"/Sardine_wdat_N100_Ind50_ckmrmultinom20_1.RData"))

re_Dep<-re_SSB<-array(NA, dim=c(3,100,76))
re_R0<-re_M<-matrix(NA, nrow=100, ncol=3)
for(f in 1:3){
  for (i in 1:100){
    if(f==1){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Cod_wdat[[i]]$OM$SSB[26:101])/Cod_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Cod_wdat[[i]]$OM$SSB[26:101]/Cod_wdat[[i]]$OM$SSB0)/(Cod_wdat[[i]]$OM$SSB[26:101]/Cod_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[3])-Cod_wdat[[i]]$OM$R0)/Cod_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Cod_wdat[[i]]$OM$Mref)/Cod_wdat[[i]]$OM$Mref

    }else if (f==2){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Flatfish_wdat[[i]]$OM$SSB[26:101])/Flatfish_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Flatfish_wdat[[i]]$OM$SSB[26:101]/Flatfish_wdat[[i]]$OM$SSB0)/(Flatfish_wdat[[i]]$OM$SSB[26:101]/Flatfish_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[3])-Flatfish_wdat[[i]]$OM$R0)/Flatfish_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Flatfish_wdat[[i]]$OM$Mref)/Flatfish_wdat[[i]]$OM$Mref

    } else if (f==3){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Sardine_wdat[[i]]$OM$SSB[26:101])/Sardine_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Sardine_wdat[[i]]$OM$SSB[26:101]/Sardine_wdat[[i]]$OM$SSB0)/(Sardine_wdat[[i]]$OM$SSB[26:101]/Sardine_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[3])-Sardine_wdat[[i]]$OM$R0)/Sardine_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Sardine_wdat[[i]]$OM$Mref)/Sardine_wdat[[i]]$OM$Mref

    }
  }
}

#SSB
par(mfrow=c(3,3))
boxplot(re_SSB[1,,], ylim=c(-0.25,0.25), las=1, main="Cod - N100, Index SD - 0.50, CKMR 20yrs", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[2,,], ylim=c(-0.25,0.25), las=1, main="Flatfish - N100, Index SD - 0.50, CKMR 20yrs", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[3,,], ylim=c(-0.25,0.25), las=1, main="Sardine - N100, Index SD - 0.50, CKMR 20yrs", ylab="RE - SSB")
abline(h=0)

#R0
boxplot(re_R0[,1], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,2], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,3], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)

#M
boxplot(re_M[,1], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,2], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,3], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)

#SD of relative error for point estimates
sd_RE_ssb_N100_Ind50_ckmrmultinom20<-apply(re_SSB,c(1,3),sd, na.rm=TRUE)
sd_RE_R0_N100_Ind50_ckmrmultinom20<-apply(re_R0,2,sd, na.rm=TRUE)
sd_RE_M_N100_Ind50_ckmrmultinom20<-apply(re_M,2,sd, na.rm=TRUE)

#SD of absolute relative error
sd_ARE_ssb_N100_Ind50_ckmrmultinom20<-apply(abs(re_SSB),c(1,3),sd, na.rm=TRUE)
sd_ARE_R0_N100_Ind50_ckmrmultinom20<-apply(abs(re_R0),2,sd, na.rm=TRUE)
sd_ARE_M_N100_Ind50_ckmrmultinom20<-apply(abs(re_M),2,sd, na.rm=TRUE)

#Precision within sims
SD_ssb_N100_Ind50_ckmrmultinom20<-CV_ssb_N100_Ind50_ckmrmultinom20<-array(NA, dim=c(3,100,76))
SD_R0_N100_Ind50_ckmrmultinom20<-matrix(NA, nrow=3, ncol=100)
SD_M_N100_Ind50_ckmrmultinom20<-matrix(NA, nrow=3, ncol=100)
for(f in 1:3){
  for (i in 1:100){
    CV_ssb_N100_Ind50_ckmrmultinom20[f,i,]<-res_list[[f]][[i]]$SD$sd/res_list[[f]][[i]]$SD$unbiased$value
    SD_ssb_N100_Ind50_ckmrmultinom20[f,i,]<-res_list[[f]][[i]]$SD$sd
    SD_R0_N100_Ind50_ckmrmultinom20[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_R0","log_R0"])
    SD_M_N100_Ind50_ckmrmultinom20[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_M","log_M"])
  }
}

#N1000, 20yrs CKMR data, sd index 0.50
res_list<-list()
res_list[[1]]<-readRDS(paste0(wd,"/SCAAfit_Cod_N1000_Ind50_ckmrmultinom20.RData"))
res_list[[2]]<-readRDS(paste0(wd,"/SCAAfit_Flatfish_N1000_Ind50_ckmrmultinom20.RData"))
res_list[[3]]<-readRDS(paste0(wd,"/SCAAfit_Sardine_N1000_Ind50_ckmrmultinom20.RData"))

load(paste0(wd,"/Cod_wdat_N1000_Ind50_ckmrmultinom20_1.RData"))
load(paste0(wd,"/Flatfish_wdat_N1000_Ind50_ckmrmultinom20_1.RData"))
load(paste0(wd,"/Sardine_wdat_N1000_Ind50_ckmrmultinom20_1.RData"))

re_Dep<-re_SSB<-array(NA, dim=c(3,100,76))
re_R0<-re_M<-matrix(NA, nrow=100, ncol=3)
for(f in 1:3){
  for (i in 1:100){
    if(f==1){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Cod_wdat[[i]]$OM$SSB[26:101])/Cod_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Cod_wdat[[i]]$OM$SSB[26:101]/Cod_wdat[[i]]$OM$SSB0)/(Cod_wdat[[i]]$OM$SSB[26:101]/Cod_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[3])-Cod_wdat[[i]]$OM$R0)/Cod_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Cod_wdat[[i]]$OM$Mref)/Cod_wdat[[i]]$OM$Mref

    }else if (f==2){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Flatfish_wdat[[i]]$OM$SSB[26:101])/Flatfish_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Flatfish_wdat[[i]]$OM$SSB[26:101]/Flatfish_wdat[[i]]$OM$SSB0)/(Flatfish_wdat[[i]]$OM$SSB[26:101]/Flatfish_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[3])-Flatfish_wdat[[i]]$OM$R0)/Flatfish_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Flatfish_wdat[[i]]$OM$Mref)/Flatfish_wdat[[i]]$OM$Mref

    } else if (f==3){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Sardine_wdat[[i]]$OM$SSB[26:101])/Sardine_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Sardine_wdat[[i]]$OM$SSB[26:101]/Sardine_wdat[[i]]$OM$SSB0)/(Sardine_wdat[[i]]$OM$SSB[26:101]/Sardine_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[3])-Sardine_wdat[[i]]$OM$R0)/Sardine_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Sardine_wdat[[i]]$OM$Mref)/Sardine_wdat[[i]]$OM$Mref

    }
  }
}

#SSB
par(mfrow=c(3,3))
boxplot(re_SSB[1,,], ylim=c(-0.25,0.25), las=1, main="Cod - N1000, Index SD - 0.50, CKMR 20yrs", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[2,,], ylim=c(-0.25,0.25), las=1, main="Flatfish - N1000, Index SD - 0.50, CKMR 20yrs", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[3,,], ylim=c(-0.25,0.25), las=1, main="Sardine - N1000, Index SD - 0.50, CKMR 20yrs", ylab="RE - SSB")
abline(h=0)

#R0
boxplot(re_R0[,1], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,2], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,3], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)

#M
boxplot(re_M[,1], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,2], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,3], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)

#SD of relative error for point estimates
sd_RE_ssb_N1000_Ind50_ckmrmultinom20<-apply(re_SSB,c(1,3),sd, na.rm=TRUE)
sd_RE_R0_N1000_Ind50_ckmrmultinom20<-apply(re_R0,2,sd, na.rm=TRUE)
sd_RE_M_N1000_Ind50_ckmrmultinom20<-apply(re_M,2,sd, na.rm=TRUE)

#SD of absolute relative error
sd_ARE_ssb_N1000_Ind50_ckmrmultinom20<-apply(abs(re_SSB),c(1,3),sd, na.rm=TRUE)
sd_ARE_R0_N1000_Ind50_ckmrmultinom20<-apply(abs(re_R0),2,sd, na.rm=TRUE)
sd_ARE_M_N1000_Ind50_ckmrmultinom20<-apply(abs(re_M),2,sd, na.rm=TRUE)

#Precision within sims
SD_ssb_N1000_Ind50_ckmrmultinom20<-CV_ssb_N1000_Ind50_ckmrmultinom20<-array(NA, dim=c(3,100,76))
SD_R0_N1000_Ind50_ckmrmultinom20<-matrix(NA, nrow=3, ncol=100)
SD_M_N1000_Ind50_ckmrmultinom20<-matrix(NA, nrow=3, ncol=100)
for(f in 1:3){
  for (i in 1:100){
    CV_ssb_N1000_Ind50_ckmrmultinom20[f,i,]<-res_list[[f]][[i]]$SD$sd/res_list[[f]][[i]]$SD$unbiased$value
    SD_ssb_N1000_Ind50_ckmrmultinom20[f,i,]<-res_list[[f]][[i]]$SD$sd
    SD_R0_N1000_Ind50_ckmrmultinom20[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_R0","log_R0"])
    SD_M_N1000_Ind50_ckmrmultinom20[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_M","log_M"])
  }
}

#N5000, 20yrs CKMR data, sd index 0.50
res_list<-list()
res_list[[1]]<-readRDS(paste0(wd,"/SCAAfit_Cod_N5000_Ind50_ckmrmultinom20.RData"))
res_list[[2]]<-readRDS(paste0(wd,"/SCAAfit_Flatfish_N5000_Ind50_ckmrmultinom20.RData"))
res_list[[3]]<-readRDS(paste0(wd,"/SCAAfit_Sardine_N5000_Ind50_ckmrmultinom20.RData"))

load(paste0(wd,"/Cod_wdat_N5000_Ind50_ckmrmultinom20_1.RData"))
load(paste0(wd,"/Flatfish_wdat_N5000_Ind50_ckmrmultinom20_1.RData"))
load(paste0(wd,"/Sardine_wdat_N5000_Ind50_ckmrmultinom20_1.RData"))

re_Dep<-re_SSB<-array(NA, dim=c(3,100,76))
re_R0<-re_M<-matrix(NA, nrow=100, ncol=3)
for(f in 1:3){
  for (i in 1:100){
    if(f==1){
       if (!is.null(res_list[[f]][[i]])){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Cod_wdat[[i]]$OM$SSB[26:101])/Cod_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Cod_wdat[[i]]$OM$SSB[26:101]/Cod_wdat[[i]]$OM$SSB0)/(Cod_wdat[[i]]$OM$SSB[26:101]/Cod_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[3])-Cod_wdat[[i]]$OM$R0)/Cod_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Cod_wdat[[i]]$OM$Mref)/Cod_wdat[[i]]$OM$Mref
       }
    }else if (f==2){
       if (!is.null(res_list[[f]][[i]])){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Flatfish_wdat[[i]]$OM$SSB[26:101])/Flatfish_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Flatfish_wdat[[i]]$OM$SSB[26:101]/Flatfish_wdat[[i]]$OM$SSB0)/(Flatfish_wdat[[i]]$OM$SSB[26:101]/Flatfish_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[3])-Flatfish_wdat[[i]]$OM$R0)/Flatfish_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Flatfish_wdat[[i]]$OM$Mref)/Flatfish_wdat[[i]]$OM$Mref
       }
    } else if (f==3){
       if (!is.null(res_list[[f]][[i]])){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Sardine_wdat[[i]]$OM$SSB[26:101])/Sardine_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Sardine_wdat[[i]]$OM$SSB[26:101]/Sardine_wdat[[i]]$OM$SSB0)/(Sardine_wdat[[i]]$OM$SSB[26:101]/Sardine_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[3])-Sardine_wdat[[i]]$OM$R0)/Sardine_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Sardine_wdat[[i]]$OM$Mref)/Sardine_wdat[[i]]$OM$Mref
       }
    }
  }
}

#SSB
par(mfrow=c(3,3))
boxplot(re_SSB[1,,], ylim=c(-0.25,0.25), las=1, main="Cod - N5000, Index SD - 0.50, CKMR 20yrs", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[2,,], ylim=c(-0.25,0.25), las=1, main="Flatfish - N5000, Index SD - 0.50, CKMR 20yrs", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[3,,], ylim=c(-0.25,0.25), las=1, main="Sardine - N5000, Index SD - 0.50, CKMR 20yrs", ylab="RE - SSB")
abline(h=0)

#R0
boxplot(re_R0[,1], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,2], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,3], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)

#M
boxplot(re_M[,1], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,2], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,3], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)

#SD of relative error for point estimates
sd_RE_ssb_N5000_Ind50_ckmrmultinom20<-apply(re_SSB,c(1,3),sd, na.rm=TRUE)
sd_RE_R0_N5000_Ind50_ckmrmultinom20<-apply(re_R0,2,sd, na.rm=TRUE)
sd_RE_M_N5000_Ind50_ckmrmultinom20<-apply(re_M,2,sd, na.rm=TRUE)

#SD of absolute relative error
sd_ARE_ssb_N5000_Ind50_ckmrmultinom20<-apply(abs(re_SSB),c(1,3),sd, na.rm=TRUE)
sd_ARE_R0_N5000_Ind50_ckmrmultinom20<-apply(abs(re_R0),2,sd, na.rm=TRUE)
sd_ARE_M_N5000_Ind50_ckmrmultinom20<-apply(abs(re_M),2,sd, na.rm=TRUE)

#Precision within sims
SD_ssb_N5000_Ind50_ckmrmultinom20<-CV_ssb_N5000_Ind50_ckmrmultinom20<-array(NA, dim=c(3,100,76))
SD_R0_N5000_Ind50_ckmrmultinom20<-matrix(NA, nrow=3, ncol=100)
SD_M_N5000_Ind50_ckmrmultinom20<-matrix(NA, nrow=3, ncol=100)
for(f in 1:3){
  for (i in 1:100){
    if (!is.null(res_list[[f]][[i]])){
    CV_ssb_N5000_Ind50_ckmrmultinom20[f,i,]<-res_list[[f]][[i]]$SD$sd/res_list[[f]][[i]]$SD$unbiased$value
    SD_ssb_N5000_Ind50_ckmrmultinom20[f,i,]<-res_list[[f]][[i]]$SD$sd
    SD_R0_N5000_Ind50_ckmrmultinom20[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_R0","log_R0"])
    SD_M_N5000_Ind50_ckmrmultinom20[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_M","log_M"])
    }
  }
}

#######################################
#Models with NO INDEX but CKMR Data
#######################################

#N100, 5yrs CKMR data, no index
res_list<-list()
res_list[[1]]<-readRDS(paste0(wd,"/SCAAfit_Cod_N100_NoIndex_ckmrmultinom5.RData"))
res_list[[2]]<-readRDS(paste0(wd,"/SCAAfit_Flatfish_N100_NoIndex_ckmrmultinom5.RData"))
res_list[[3]]<-readRDS(paste0(wd,"/SCAAfit_Sardine_N100_NoIndex_ckmrmultinom5.RData"))

load(paste0(wd,"/Cod_wdat_N100_Ind25_ckmrmultinom5_1.RData"))
load(paste0(wd,"/Flatfish_wdat_N100_Ind25_ckmrmultinom5_1.RData"))
load(paste0(wd,"/Sardine_wdat_N100_Ind25_ckmrmultinom5_1.RData"))

re_Dep<-re_SSB<-array(NA, dim=c(3,100,76))
re_R0<-re_M<-matrix(NA, nrow=100, ncol=3)
for(f in 1:3){
  for (i in 1:100){
    if(f==1){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Cod_wdat[[i]]$OM$SSB[26:101])/Cod_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Cod_wdat[[i]]$OM$SSB[26:101]/Cod_wdat[[i]]$OM$SSB0)/(Cod_wdat[[i]]$OM$SSB[26:101]/Cod_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[2])-Cod_wdat[[i]]$OM$R0)/Cod_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Cod_wdat[[i]]$OM$Mref)/Cod_wdat[[i]]$OM$Mref
      
    }else if (f==2){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Flatfish_wdat[[i]]$OM$SSB[26:101])/Flatfish_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Flatfish_wdat[[i]]$OM$SSB[26:101]/Flatfish_wdat[[i]]$OM$SSB0)/(Flatfish_wdat[[i]]$OM$SSB[26:101]/Flatfish_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[2])-Flatfish_wdat[[i]]$OM$R0)/Flatfish_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Flatfish_wdat[[i]]$OM$Mref)/Flatfish_wdat[[i]]$OM$Mref
      
    } else if (f==3){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Sardine_wdat[[i]]$OM$SSB[26:101])/Sardine_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Sardine_wdat[[i]]$OM$SSB[26:101]/Sardine_wdat[[i]]$OM$SSB0)/(Sardine_wdat[[i]]$OM$SSB[26:101]/Sardine_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[2])-Sardine_wdat[[i]]$OM$R0)/Sardine_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Sardine_wdat[[i]]$OM$Mref)/Sardine_wdat[[i]]$OM$Mref
      
    }
  }
}

#SSB
par(mfrow=c(3,3))
boxplot(re_SSB[1,,], ylim=c(-0.25,0.25), las=1, main="Cod - N100, No Index, CKMR 5yrs", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[2,,], ylim=c(-0.25,0.25), las=1, main="Flatfish - N100, No Index, CKMR 5yrs", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[3,,], ylim=c(-0.25,0.25), las=1, main="Sardine - N100, No Index, CKMR 5yrs", ylab="RE - SSB")
abline(h=0)

#R0
boxplot(re_R0[,1], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,2], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,3], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)

#M
boxplot(re_M[,1], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,2], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,3], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)

#SD of relative error for point estimates
sd_RE_ssb_N100_NoIndex_ckmrmultinom5<-apply(re_SSB,c(1,3),sd, na.rm=TRUE)
sd_RE_R0_N100_NoIndex_ckmrmultinom5<-apply(re_R0,2,sd, na.rm=TRUE)
sd_RE_M_N100_NoIndex_ckmrmultinom5<-apply(re_M,2,sd, na.rm=TRUE)

#SD of absolute relative error
sd_ARE_ssb_N100_NoIndex_ckmrmultinom5<-apply(abs(re_SSB),c(1,3),sd, na.rm=TRUE)
sd_ARE_R0_N100_NoIndex_ckmrmultinom5<-apply(abs(re_R0),2,sd, na.rm=TRUE)
sd_ARE_M_N100_NoIndex_ckmrmultinom5<-apply(abs(re_M),2,sd, na.rm=TRUE)

#Precision within sims
SD_ssb_N100_NoIndex_ckmrmultinom5<-CV_ssb_N100_NoIndex_ckmrmultinom5<-array(NA, dim=c(3,100,76)) 
SD_R0_N100_NoIndex_ckmrmultinom5<-matrix(NA, nrow=3, ncol=100)
SD_M_N100_NoIndex_ckmrmultinom5<-matrix(NA, nrow=3, ncol=100)
for(f in 1:3){
  for (i in 1:100){
    CV_ssb_N100_NoIndex_ckmrmultinom5[f,i,]<-res_list[[f]][[i]]$SD$sd/res_list[[f]][[i]]$SD$unbiased$value
    SD_ssb_N100_NoIndex_ckmrmultinom5[f,i,]<-res_list[[f]][[i]]$SD$sd
    SD_R0_N100_NoIndex_ckmrmultinom5[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_R0","log_R0"])
    SD_M_N100_NoIndex_ckmrmultinom5[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_M","log_M"])
  }
}

#N1000, 5yrs CKMR data, No Index
res_list<-list()
res_list[[1]]<-readRDS(paste0(wd,"/SCAAfit_Cod_N1000_NoIndex_ckmrmultinom5.RData"))
res_list[[2]]<-readRDS(paste0(wd,"/SCAAfit_Flatfish_N1000_NoIndex_ckmrmultinom5.RData"))
res_list[[3]]<-readRDS(paste0(wd,"/SCAAfit_Sardine_N1000_NoIndex_ckmrmultinom5.RData"))

load(paste0(wd,"/Cod_wdat_N1000_Ind25_ckmrmultinom5_1.RData"))
load(paste0(wd,"/Flatfish_wdat_N1000_Ind25_ckmrmultinom5_1.RData"))
load(paste0(wd,"/Sardine_wdat_N1000_Ind25_ckmrmultinom5_1.RData"))

re_Dep<-re_SSB<-array(NA, dim=c(3,100,76))
re_R0<-re_M<-matrix(NA, nrow=100, ncol=3)
for(f in 1:3){
  for (i in 1:100){
    if(f==1){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Cod_wdat[[i]]$OM$SSB[26:101])/Cod_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Cod_wdat[[i]]$OM$SSB[26:101]/Cod_wdat[[i]]$OM$SSB0)/(Cod_wdat[[i]]$OM$SSB[26:101]/Cod_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[2])-Cod_wdat[[i]]$OM$R0)/Cod_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Cod_wdat[[i]]$OM$Mref)/Cod_wdat[[i]]$OM$Mref
      
    }else if (f==2){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Flatfish_wdat[[i]]$OM$SSB[26:101])/Flatfish_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Flatfish_wdat[[i]]$OM$SSB[26:101]/Flatfish_wdat[[i]]$OM$SSB0)/(Flatfish_wdat[[i]]$OM$SSB[26:101]/Flatfish_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[2])-Flatfish_wdat[[i]]$OM$R0)/Flatfish_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Flatfish_wdat[[i]]$OM$Mref)/Flatfish_wdat[[i]]$OM$Mref
      
    } else if (f==3){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Sardine_wdat[[i]]$OM$SSB[26:101])/Sardine_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Sardine_wdat[[i]]$OM$SSB[26:101]/Sardine_wdat[[i]]$OM$SSB0)/(Sardine_wdat[[i]]$OM$SSB[26:101]/Sardine_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[2])-Sardine_wdat[[i]]$OM$R0)/Sardine_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Sardine_wdat[[i]]$OM$Mref)/Sardine_wdat[[i]]$OM$Mref
      
    }
  }
}

#SSB
par(mfrow=c(3,3))
boxplot(re_SSB[1,,], ylim=c(-0.25,0.25), las=1, main="Cod - N1000, No Index, CKMR 5yrs", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[2,,], ylim=c(-0.25,0.25), las=1, main="Flatfish - N1000, No Index, CKMR 5yrs", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[3,,], ylim=c(-0.25,0.25), las=1, main="Sardine - N1000, No Index, CKMR 5yrs", ylab="RE - SSB")
abline(h=0)

#R0
boxplot(re_R0[,1], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,2], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,3], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)

#M
boxplot(re_M[,1], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,2], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,3], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)

#SD of relative error for point estimates
sd_RE_ssb_N1000_NoIndex_ckmrmultinom5<-apply(re_SSB,c(1,3),sd, na.rm=TRUE)
sd_RE_R0_N1000_NoIndex_ckmrmultinom5<-apply(re_R0,2,sd, na.rm=TRUE)
sd_RE_M_N1000_NoIndex_ckmrmultinom5<-apply(re_M,2,sd, na.rm=TRUE)

#SD of absolute relative error
sd_ARE_ssb_N1000_NoIndex_ckmrmultinom5<-apply(abs(re_SSB),c(1,3),sd, na.rm=TRUE)
sd_ARE_R0_N1000_NoIndex_ckmrmultinom5<-apply(abs(re_R0),2,sd, na.rm=TRUE)
sd_ARE_M_N1000_NoIndex_ckmrmultinom5<-apply(abs(re_M),2,sd, na.rm=TRUE)

#Precision within sims
SD_ssb_N1000_NoIndex_ckmrmultinom5<-CV_ssb_N1000_NoIndex_ckmrmultinom5<-array(NA, dim=c(3,100,76)) 
SD_R0_N1000_NoIndex_ckmrmultinom5<-matrix(NA, nrow=3, ncol=100)
SD_M_N1000_NoIndex_ckmrmultinom5<-matrix(NA, nrow=3, ncol=100)
for(f in 1:3){
  for (i in 1:100){
    CV_ssb_N1000_NoIndex_ckmrmultinom5[f,i,]<-res_list[[f]][[i]]$SD$sd/res_list[[f]][[i]]$SD$unbiased$value
    SD_ssb_N1000_NoIndex_ckmrmultinom5[f,i,]<-res_list[[f]][[i]]$SD$sd
    SD_R0_N1000_NoIndex_ckmrmultinom5[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_R0","log_R0"])
    SD_M_N1000_NoIndex_ckmrmultinom5[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_M","log_M"])
  }
}

#N5000, 5yrs CKMR data, No Index
res_list<-list()
res_list[[1]]<-readRDS(paste0(wd,"/SCAAfit_Cod_N5000_NoIndex_ckmrmultinom5.RData"))
res_list[[2]]<-readRDS(paste0(wd,"/SCAAfit_Flatfish_N5000_NoIndex_ckmrmultinom5.RData"))
res_list[[3]]<-readRDS(paste0(wd,"/SCAAfit_Sardine_N5000_NoIndex_ckmrmultinom5.RData"))

load(paste0(wd,"/Cod_wdat_N5000_Ind25_ckmrmultinom5_1.RData"))
load(paste0(wd,"/Flatfish_wdat_N5000_Ind25_ckmrmultinom5_1.RData"))
load(paste0(wd,"/Sardine_wdat_N5000_Ind25_ckmrmultinom5_1.RData"))

re_Dep<-re_SSB<-array(NA, dim=c(3,100,76))
re_R0<-re_M<-matrix(NA, nrow=100, ncol=3)
for(f in 1:3){
  for (i in 1:100){
    if(f==1){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Cod_wdat[[i]]$OM$SSB[26:101])/Cod_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Cod_wdat[[i]]$OM$SSB[26:101]/Cod_wdat[[i]]$OM$SSB0)/(Cod_wdat[[i]]$OM$SSB[26:101]/Cod_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[2])-Cod_wdat[[i]]$OM$R0)/Cod_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Cod_wdat[[i]]$OM$Mref)/Cod_wdat[[i]]$OM$Mref
      
    }else if (f==2){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Flatfish_wdat[[i]]$OM$SSB[26:101])/Flatfish_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Flatfish_wdat[[i]]$OM$SSB[26:101]/Flatfish_wdat[[i]]$OM$SSB0)/(Flatfish_wdat[[i]]$OM$SSB[26:101]/Flatfish_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[2])-Flatfish_wdat[[i]]$OM$R0)/Flatfish_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Flatfish_wdat[[i]]$OM$Mref)/Flatfish_wdat[[i]]$OM$Mref
      
    } else if (f==3){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Sardine_wdat[[i]]$OM$SSB[26:101])/Sardine_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Sardine_wdat[[i]]$OM$SSB[26:101]/Sardine_wdat[[i]]$OM$SSB0)/(Sardine_wdat[[i]]$OM$SSB[26:101]/Sardine_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[2])-Sardine_wdat[[i]]$OM$R0)/Sardine_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Sardine_wdat[[i]]$OM$Mref)/Sardine_wdat[[i]]$OM$Mref
      
    }
  }
}

#SSB
par(mfrow=c(3,3))
boxplot(re_SSB[1,,], ylim=c(-0.25,0.25), las=1, main="Cod - N5000, No Index, CKMR 5yrs", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[2,,], ylim=c(-0.25,0.25), las=1, main="Flatfish - N5000, No Index, CKMR 5yrs", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[3,,], ylim=c(-0.25,0.25), las=1, main="Sardine - N5000, No Index, CKMR 5yrs", ylab="RE - SSB")
abline(h=0)

#R0
boxplot(re_R0[,1], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,2], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,3], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)

#M
boxplot(re_M[,1], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,2], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,3], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)

#SD of relative error for point estimates
sd_RE_ssb_N5000_NoIndex_ckmrmultinom5<-apply(re_SSB,c(1,3),sd, na.rm=TRUE)
sd_RE_R0_N5000_NoIndex_ckmrmultinom5<-apply(re_R0,2,sd, na.rm=TRUE)
sd_RE_M_N5000_NoIndex_ckmrmultinom5<-apply(re_M,2,sd, na.rm=TRUE)

#SD of absolute relative error
sd_ARE_ssb_N5000_NoIndex_ckmrmultinom5<-apply(abs(re_SSB),c(1,3),sd, na.rm=TRUE)
sd_ARE_R0_N5000_NoIndex_ckmrmultinom5<-apply(abs(re_R0),2,sd, na.rm=TRUE)
sd_ARE_M_N5000_NoIndex_ckmrmultinom5<-apply(abs(re_M),2,sd, na.rm=TRUE)

#Precision within sims
SD_ssb_N5000_NoIndex_ckmrmultinom5<-CV_ssb_N5000_NoIndex_ckmrmultinom5<-array(NA, dim=c(3,100,76)) 
SD_R0_N5000_NoIndex_ckmrmultinom5<-matrix(NA, nrow=3, ncol=100)
SD_M_N5000_NoIndex_ckmrmultinom5<-matrix(NA, nrow=3, ncol=100)
for(f in 1:3){
  for (i in 1:100){
    CV_ssb_N5000_NoIndex_ckmrmultinom5[f,i,]<-res_list[[f]][[i]]$SD$sd/res_list[[f]][[i]]$SD$unbiased$value
    SD_ssb_N5000_NoIndex_ckmrmultinom5[f,i,]<-res_list[[f]][[i]]$SD$sd
    SD_R0_N5000_NoIndex_ckmrmultinom5[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_R0","log_R0"])
    SD_M_N5000_NoIndex_ckmrmultinom5[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_M","log_M"])
  }
}

#N100, 10yrs CKMR data, No Index
res_list<-list()
res_list[[1]]<-readRDS(paste0(wd,"/SCAAfit_Cod_N100_NoIndex_ckmrmultinom10.RData"))
res_list[[2]]<-readRDS(paste0(wd,"/SCAAfit_Flatfish_N100_NoIndex_ckmrmultinom10.RData"))
res_list[[3]]<-readRDS(paste0(wd,"/SCAAfit_Sardine_N100_NoIndex_ckmrmultinom10.RData"))

load(paste0(wd,"/Cod_wdat_N100_Ind25_ckmrmultinom10_1.RData"))
load(paste0(wd,"/Flatfish_wdat_N100_Ind25_ckmrmultinom10_1.RData"))
load(paste0(wd,"/Sardine_wdat_N100_Ind25_ckmrmultinom10_1.RData"))

re_Dep<-re_SSB<-array(NA, dim=c(3,100,76))
re_R0<-re_M<-matrix(NA, nrow=100, ncol=3)
for(f in 1:3){
  for (i in 1:100){
    if(f==1){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Cod_wdat[[i]]$OM$SSB[26:101])/Cod_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Cod_wdat[[i]]$OM$SSB[26:101]/Cod_wdat[[i]]$OM$SSB0)/(Cod_wdat[[i]]$OM$SSB[26:101]/Cod_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[2])-Cod_wdat[[i]]$OM$R0)/Cod_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Cod_wdat[[i]]$OM$Mref)/Cod_wdat[[i]]$OM$Mref
      
    }else if (f==2){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Flatfish_wdat[[i]]$OM$SSB[26:101])/Flatfish_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Flatfish_wdat[[i]]$OM$SSB[26:101]/Flatfish_wdat[[i]]$OM$SSB0)/(Flatfish_wdat[[i]]$OM$SSB[26:101]/Flatfish_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[2])-Flatfish_wdat[[i]]$OM$R0)/Flatfish_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Flatfish_wdat[[i]]$OM$Mref)/Flatfish_wdat[[i]]$OM$Mref
      
    } else if (f==3){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Sardine_wdat[[i]]$OM$SSB[26:101])/Sardine_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Sardine_wdat[[i]]$OM$SSB[26:101]/Sardine_wdat[[i]]$OM$SSB0)/(Sardine_wdat[[i]]$OM$SSB[26:101]/Sardine_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[2])-Sardine_wdat[[i]]$OM$R0)/Sardine_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Sardine_wdat[[i]]$OM$Mref)/Sardine_wdat[[i]]$OM$Mref
      
    }
  }
}

#SSB
par(mfrow=c(3,3))
boxplot(re_SSB[1,,], ylim=c(-0.25,0.25), las=1, main="Cod - N100, No Index, CKMR 10yrs", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[2,,], ylim=c(-0.25,0.25), las=1, main="Flatfish - N100, No Index, CKMR 10yrs", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[3,,], ylim=c(-0.25,0.25), las=1, main="Sardine - N100, No Index, CKMR 10yrs", ylab="RE - SSB")
abline(h=0)

#R0
boxplot(re_R0[,1], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,2], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,3], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)

#M
boxplot(re_M[,1], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,2], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,3], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)

#SD of relative error for point estimates
sd_RE_ssb_N100_NoIndex_ckmrmultinom10<-apply(re_SSB,c(1,3),sd, na.rm=TRUE)
sd_RE_R0_N100_NoIndex_ckmrmultinom10<-apply(re_R0,2,sd, na.rm=TRUE)
sd_RE_M_N100_NoIndex_ckmrmultinom10<-apply(re_M,2,sd, na.rm=TRUE)

#SD of absolute relative error
sd_ARE_ssb_N100_NoIndex_ckmrmultinom10<-apply(abs(re_SSB),c(1,3),sd, na.rm=TRUE)
sd_ARE_R0_N100_NoIndex_ckmrmultinom10<-apply(abs(re_R0),2,sd, na.rm=TRUE)
sd_ARE_M_N100_NoIndex_ckmrmultinom10<-apply(abs(re_M),2,sd, na.rm=TRUE)

#Precision within sims
SD_ssb_N100_NoIndex_ckmrmultinom10<-CV_ssb_N100_NoIndex_ckmrmultinom10<-array(NA, dim=c(3,100,76)) 
SD_R0_N100_NoIndex_ckmrmultinom10<-matrix(NA, nrow=3, ncol=100)
SD_M_N100_NoIndex_ckmrmultinom10<-matrix(NA, nrow=3, ncol=100)
for(f in 1:3){
  for (i in 1:100){
    CV_ssb_N100_NoIndex_ckmrmultinom10[f,i,]<-res_list[[f]][[i]]$SD$sd/res_list[[f]][[i]]$SD$unbiased$value
    SD_ssb_N100_NoIndex_ckmrmultinom10[f,i,]<-res_list[[f]][[i]]$SD$sd
    SD_R0_N100_NoIndex_ckmrmultinom10[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_R0","log_R0"])
    SD_M_N100_NoIndex_ckmrmultinom10[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_M","log_M"])
  }
}

#N1000, 10yrs CKMR data, No Index
res_list<-list()
res_list[[1]]<-readRDS(paste0(wd,"/SCAAfit_Cod_N1000_NoIndex_ckmrmultinom10.RData"))
res_list[[2]]<-readRDS(paste0(wd,"/SCAAfit_Flatfish_N1000_NoIndex_ckmrmultinom10.RData"))
res_list[[3]]<-readRDS(paste0(wd,"/SCAAfit_Sardine_N1000_NoIndex_ckmrmultinom10.RData"))

load(paste0(wd,"/Cod_wdat_N1000_Ind25_ckmrmultinom10_1.RData"))
load(paste0(wd,"/Flatfish_wdat_N1000_Ind25_ckmrmultinom10_1.RData"))
load(paste0(wd,"/Sardine_wdat_N1000_Ind25_ckmrmultinom10_1.RData"))

re_Dep<-re_SSB<-array(NA, dim=c(3,100,76))
re_R0<-re_M<-matrix(NA, nrow=100, ncol=3)
for(f in 1:3){
  for (i in 1:100){
    if(f==1){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Cod_wdat[[i]]$OM$SSB[26:101])/Cod_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Cod_wdat[[i]]$OM$SSB[26:101]/Cod_wdat[[i]]$OM$SSB0)/(Cod_wdat[[i]]$OM$SSB[26:101]/Cod_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[2])-Cod_wdat[[i]]$OM$R0)/Cod_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Cod_wdat[[i]]$OM$Mref)/Cod_wdat[[i]]$OM$Mref
      
    }else if (f==2){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Flatfish_wdat[[i]]$OM$SSB[26:101])/Flatfish_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Flatfish_wdat[[i]]$OM$SSB[26:101]/Flatfish_wdat[[i]]$OM$SSB0)/(Flatfish_wdat[[i]]$OM$SSB[26:101]/Flatfish_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[2])-Flatfish_wdat[[i]]$OM$R0)/Flatfish_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Flatfish_wdat[[i]]$OM$Mref)/Flatfish_wdat[[i]]$OM$Mref
      
    } else if (f==3){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Sardine_wdat[[i]]$OM$SSB[26:101])/Sardine_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Sardine_wdat[[i]]$OM$SSB[26:101]/Sardine_wdat[[i]]$OM$SSB0)/(Sardine_wdat[[i]]$OM$SSB[26:101]/Sardine_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[2])-Sardine_wdat[[i]]$OM$R0)/Sardine_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Sardine_wdat[[i]]$OM$Mref)/Sardine_wdat[[i]]$OM$Mref
      
    }
  }
}

#SSB
par(mfrow=c(3,3))
boxplot(re_SSB[1,,], ylim=c(-0.25,0.25), las=1, main="Cod - N1000, No Index, CKMR 10yrs", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[2,,], ylim=c(-0.25,0.25), las=1, main="Flatfish - N1000, No Index, CKMR 10yrs", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[3,,], ylim=c(-0.25,0.25), las=1, main="Sardine - N1000, No Index, CKMR 10yrs", ylab="RE - SSB")
abline(h=0)

#R0
boxplot(re_R0[,1], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,2], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,3], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)

#M
boxplot(re_M[,1], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,2], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,3], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)

#SD of relative error for point estimates
sd_RE_ssb_N1000_NoIndex_ckmrmultinom10<-apply(re_SSB,c(1,3),sd, na.rm=TRUE)
sd_RE_R0_N1000_NoIndex_ckmrmultinom10<-apply(re_R0,2,sd, na.rm=TRUE)
sd_RE_M_N1000_NoIndex_ckmrmultinom10<-apply(re_M,2,sd, na.rm=TRUE)

#SD of absolute relative error
sd_ARE_ssb_N1000_NoIndex_ckmrmultinom10<-apply(abs(re_SSB),c(1,3),sd, na.rm=TRUE)
sd_ARE_R0_N1000_NoIndex_ckmrmultinom10<-apply(abs(re_R0),2,sd, na.rm=TRUE)
sd_ARE_M_N1000_NoIndex_ckmrmultinom10<-apply(abs(re_M),2,sd, na.rm=TRUE)

#Precision within sims
SD_ssb_N1000_NoIndex_ckmrmultinom10<-CV_ssb_N1000_NoIndex_ckmrmultinom10<-array(NA, dim=c(3,100,76)) 
SD_R0_N1000_NoIndex_ckmrmultinom10<-matrix(NA, nrow=3, ncol=100)
SD_M_N1000_NoIndex_ckmrmultinom10<-matrix(NA, nrow=3, ncol=100)
for(f in 1:3){
  for (i in 1:100){
    CV_ssb_N1000_NoIndex_ckmrmultinom10[f,i,]<-res_list[[f]][[i]]$SD$sd/res_list[[f]][[i]]$SD$unbiased$value
    SD_ssb_N1000_NoIndex_ckmrmultinom10[f,i,]<-res_list[[f]][[i]]$SD$sd
    SD_R0_N1000_NoIndex_ckmrmultinom10[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_R0","log_R0"])
    SD_M_N1000_NoIndex_ckmrmultinom10[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_M","log_M"])
  }
}

#N5000, 10yrs CKMR data, No Index
res_list<-list()
res_list[[1]]<-readRDS(paste0(wd,"/SCAAfit_Cod_N5000_NoIndex_ckmrmultinom10.RData"))
res_list[[2]]<-readRDS(paste0(wd,"/SCAAfit_Flatfish_N5000_NoIndex_ckmrmultinom10.RData"))
res_list[[3]]<-readRDS(paste0(wd,"/SCAAfit_Sardine_N5000_NoIndex_ckmrmultinom10.RData"))

load(paste0(wd,"/Cod_wdat_N5000_Ind25_ckmrmultinom10_1.RData"))
load(paste0(wd,"/Flatfish_wdat_N5000_Ind25_ckmrmultinom10_1.RData"))
load(paste0(wd,"/Sardine_wdat_N5000_Ind25_ckmrmultinom10_1.RData"))

re_Dep<-re_SSB<-array(NA, dim=c(3,100,76))
re_R0<-re_M<-matrix(NA, nrow=100, ncol=3)
for(f in 1:3){
  for (i in 1:100){
    if(f==1){
       if (!is.null(res_list[[f]][[i]])){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Cod_wdat[[i]]$OM$SSB[26:101])/Cod_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Cod_wdat[[i]]$OM$SSB[26:101]/Cod_wdat[[i]]$OM$SSB0)/(Cod_wdat[[i]]$OM$SSB[26:101]/Cod_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[2])-Cod_wdat[[i]]$OM$R0)/Cod_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Cod_wdat[[i]]$OM$Mref)/Cod_wdat[[i]]$OM$Mref
       }
    }else if (f==2){
       if (!is.null(res_list[[f]][[i]])){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Flatfish_wdat[[i]]$OM$SSB[26:101])/Flatfish_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Flatfish_wdat[[i]]$OM$SSB[26:101]/Flatfish_wdat[[i]]$OM$SSB0)/(Flatfish_wdat[[i]]$OM$SSB[26:101]/Flatfish_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[2])-Flatfish_wdat[[i]]$OM$R0)/Flatfish_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Flatfish_wdat[[i]]$OM$Mref)/Flatfish_wdat[[i]]$OM$Mref
       }
    } else if (f==3){
       if (!is.null(res_list[[f]][[i]])){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Sardine_wdat[[i]]$OM$SSB[26:101])/Sardine_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Sardine_wdat[[i]]$OM$SSB[26:101]/Sardine_wdat[[i]]$OM$SSB0)/(Sardine_wdat[[i]]$OM$SSB[26:101]/Sardine_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[2])-Sardine_wdat[[i]]$OM$R0)/Sardine_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Sardine_wdat[[i]]$OM$Mref)/Sardine_wdat[[i]]$OM$Mref
       }
    }
  }
}

#SSB
par(mfrow=c(3,3))
boxplot(re_SSB[1,,], ylim=c(-0.25,0.25), las=1, main="Cod - N5000, No Index, CKMR 10yrs", ylab="RE - SSB")
abline(h=0) 
boxplot(re_SSB[2,,], ylim=c(-0.25,0.25), las=1, main="Flatfish - N5000, No Index, CKMR 10yrs", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[3,,], ylim=c(-0.25,0.25), las=1, main="Sardine - N5000, No Index, CKMR 10yrs", ylab="RE - SSB")
abline(h=0)

#R0
boxplot(re_R0[,1], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,2], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,3], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)

#M
boxplot(re_M[,1], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,2], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,3], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)

#SD of relative error for point estimates
sd_RE_ssb_N5000_NoIndex_ckmrmultinom10<-apply(re_SSB,c(1,3),sd, na.rm=TRUE)
sd_RE_R0_N5000_NoIndex_ckmrmultinom10<-apply(re_R0,2,sd, na.rm=TRUE)
sd_RE_M_N5000_NoIndex_ckmrmultinom10<-apply(re_M,2,sd, na.rm=TRUE)

#SD of absolute relative error
sd_ARE_ssb_N5000_NoIndex_ckmrmultinom10<-apply(abs(re_SSB),c(1,3),sd, na.rm=TRUE)
sd_ARE_R0_N5000_NoIndex_ckmrmultinom10<-apply(abs(re_R0),2,sd, na.rm=TRUE)
sd_ARE_M_N5000_NoIndex_ckmrmultinom10<-apply(abs(re_M),2,sd, na.rm=TRUE)

#Precision within sims
SD_ssb_N5000_NoIndex_ckmrmultinom10<-CV_ssb_N5000_NoIndex_ckmrmultinom10<-array(NA, dim=c(3,100,76)) 
SD_R0_N5000_NoIndex_ckmrmultinom10<-matrix(NA, nrow=3, ncol=100)
SD_M_N5000_NoIndex_ckmrmultinom10<-matrix(NA, nrow=3, ncol=100)
for(f in 1:3){
  for (i in 1:100){
    if (!is.null(res_list[[f]][[i]])){
    CV_ssb_N5000_NoIndex_ckmrmultinom10[f,i,]<-res_list[[f]][[i]]$SD$sd/res_list[[f]][[i]]$SD$unbiased$value
    SD_ssb_N5000_NoIndex_ckmrmultinom10[f,i,]<-res_list[[f]][[i]]$SD$sd
    SD_R0_N5000_NoIndex_ckmrmultinom10[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_R0","log_R0"])
    SD_M_N5000_NoIndex_ckmrmultinom10[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_M","log_M"])
    }
  }
}

#N100, 20yrs CKMR data, No Index
res_list<-list()
res_list[[1]]<-readRDS(paste0(wd,"/SCAAfit_Cod_N100_NoIndex_ckmrmultinom20.RData"))
res_list[[2]]<-readRDS(paste0(wd,"/SCAAfit_Flatfish_N100_NoIndex_ckmrmultinom20.RData"))
res_list[[3]]<-readRDS(paste0(wd,"/SCAAfit_Sardine_N100_NoIndex_ckmrmultinom20.RData"))

load(paste0(wd,"/Cod_wdat_N100_Ind25_ckmrmultinom20_1.RData"))
load(paste0(wd,"/Flatfish_wdat_N100_Ind25_ckmrmultinom20_1.RData"))
load(paste0(wd,"/Sardine_wdat_N100_Ind25_ckmrmultinom20_1.RData"))

re_Dep<-re_SSB<-array(NA, dim=c(3,100,76))
re_R0<-re_M<-matrix(NA, nrow=100, ncol=3)
for(f in 1:3){
  for (i in 1:100){
    if(f==1){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Cod_wdat[[i]]$OM$SSB[26:101])/Cod_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Cod_wdat[[i]]$OM$SSB[26:101]/Cod_wdat[[i]]$OM$SSB0)/(Cod_wdat[[i]]$OM$SSB[26:101]/Cod_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[2])-Cod_wdat[[i]]$OM$R0)/Cod_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Cod_wdat[[i]]$OM$Mref)/Cod_wdat[[i]]$OM$Mref

    }else if (f==2){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Flatfish_wdat[[i]]$OM$SSB[26:101])/Flatfish_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Flatfish_wdat[[i]]$OM$SSB[26:101]/Flatfish_wdat[[i]]$OM$SSB0)/(Flatfish_wdat[[i]]$OM$SSB[26:101]/Flatfish_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[2])-Flatfish_wdat[[i]]$OM$R0)/Flatfish_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Flatfish_wdat[[i]]$OM$Mref)/Flatfish_wdat[[i]]$OM$Mref

    } else if (f==3){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Sardine_wdat[[i]]$OM$SSB[26:101])/Sardine_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Sardine_wdat[[i]]$OM$SSB[26:101]/Sardine_wdat[[i]]$OM$SSB0)/(Sardine_wdat[[i]]$OM$SSB[26:101]/Sardine_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[2])-Sardine_wdat[[i]]$OM$R0)/Sardine_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Sardine_wdat[[i]]$OM$Mref)/Sardine_wdat[[i]]$OM$Mref

    }
  }
}

#SSB
par(mfrow=c(3,3))
boxplot(re_SSB[1,,], ylim=c(-0.25,0.25), las=1, main="Cod - N100, No Index, CKMR 20yrs", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[2,,], ylim=c(-0.25,0.25), las=1, main="Flatfish - N100, No Index, CKMR 20yrs", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[3,,], ylim=c(-0.25,0.25), las=1, main="Sardine - N100, No Index, CKMR 20yrs", ylab="RE - SSB")
abline(h=0)

#R0
boxplot(re_R0[,1], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,2], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,3], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)

#M
boxplot(re_M[,1], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,2], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,3], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)

#SD of relative error for point estimates
sd_RE_ssb_N100_NoIndex_ckmrmultinom20<-apply(re_SSB,c(1,3),sd, na.rm=TRUE)
sd_RE_R0_N100_NoIndex_ckmrmultinom20<-apply(re_R0,2,sd, na.rm=TRUE)
sd_RE_M_N100_NoIndex_ckmrmultinom20<-apply(re_M,2,sd, na.rm=TRUE)

#SD of absolute relative error
sd_ARE_ssb_N100_NoIndex_ckmrmultinom20<-apply(abs(re_SSB),c(1,3),sd, na.rm=TRUE)
sd_ARE_R0_N100_NoIndex_ckmrmultinom20<-apply(abs(re_R0),2,sd, na.rm=TRUE)
sd_ARE_M_N100_NoIndex_ckmrmultinom20<-apply(abs(re_M),2,sd, na.rm=TRUE)

#Precision within sims
SD_ssb_N100_NoIndex_ckmrmultinom20<-CV_ssb_N100_NoIndex_ckmrmultinom20<-array(NA, dim=c(3,100,76))
SD_R0_N100_NoIndex_ckmrmultinom20<-matrix(NA, nrow=3, ncol=100)
SD_M_N100_NoIndex_ckmrmultinom20<-matrix(NA, nrow=3, ncol=100)
for(f in 1:3){
  for (i in 1:100){
    CV_ssb_N100_NoIndex_ckmrmultinom20[f,i,]<-res_list[[f]][[i]]$SD$sd/res_list[[f]][[i]]$SD$unbiased$value
    SD_ssb_N100_NoIndex_ckmrmultinom20[f,i,]<-res_list[[f]][[i]]$SD$sd
    SD_R0_N100_NoIndex_ckmrmultinom20[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_R0","log_R0"])
    SD_M_N100_NoIndex_ckmrmultinom20[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_M","log_M"])
  }
}

#N1000, 20yrs CKMR data, No Index
res_list<-list()
res_list[[1]]<-readRDS(paste0(wd,"/SCAAfit_Cod_N1000_NoIndex_ckmrmultinom20.RData"))
res_list[[2]]<-readRDS(paste0(wd,"/SCAAfit_Flatfish_N1000_NoIndex_ckmrmultinom20.RData"))
res_list[[3]]<-readRDS(paste0(wd,"/SCAAfit_Sardine_N1000_NoIndex_ckmrmultinom20.RData"))

load(paste0(wd,"/Cod_wdat_N1000_Ind25_ckmrmultinom20_1.RData"))
load(paste0(wd,"/Flatfish_wdat_N1000_Ind25_ckmrmultinom20_1.RData"))
load(paste0(wd,"/Sardine_wdat_N1000_Ind25_ckmrmultinom20_1.RData"))

re_Dep<-re_SSB<-array(NA, dim=c(3,100,76))
re_R0<-re_M<-matrix(NA, nrow=100, ncol=3)
for(f in 1:3){
  for (i in 1:100){
    if(f==1){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Cod_wdat[[i]]$OM$SSB[26:101])/Cod_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Cod_wdat[[i]]$OM$SSB[26:101]/Cod_wdat[[i]]$OM$SSB0)/(Cod_wdat[[i]]$OM$SSB[26:101]/Cod_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[2])-Cod_wdat[[i]]$OM$R0)/Cod_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Cod_wdat[[i]]$OM$Mref)/Cod_wdat[[i]]$OM$Mref

    }else if (f==2){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Flatfish_wdat[[i]]$OM$SSB[26:101])/Flatfish_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Flatfish_wdat[[i]]$OM$SSB[26:101]/Flatfish_wdat[[i]]$OM$SSB0)/(Flatfish_wdat[[i]]$OM$SSB[26:101]/Flatfish_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[2])-Flatfish_wdat[[i]]$OM$R0)/Flatfish_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Flatfish_wdat[[i]]$OM$Mref)/Flatfish_wdat[[i]]$OM$Mref

    } else if (f==3){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Sardine_wdat[[i]]$OM$SSB[26:101])/Sardine_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Sardine_wdat[[i]]$OM$SSB[26:101]/Sardine_wdat[[i]]$OM$SSB0)/(Sardine_wdat[[i]]$OM$SSB[26:101]/Sardine_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[2])-Sardine_wdat[[i]]$OM$R0)/Sardine_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Sardine_wdat[[i]]$OM$Mref)/Sardine_wdat[[i]]$OM$Mref

    }
  }
}

#SSB
par(mfrow=c(3,3))
boxplot(re_SSB[1,,], ylim=c(-0.25,0.25), las=1, main="Cod - N1000, No Index, CKMR 20yrs", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[2,,], ylim=c(-0.25,0.25), las=1, main="Flatfish - N1000, No Index, CKMR 20yrs", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[3,,], ylim=c(-0.25,0.25), las=1, main="Sardine - N1000, No Index, CKMR 20yrs", ylab="RE - SSB")
abline(h=0)

#R0
boxplot(re_R0[,1], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,2], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,3], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)

#M
boxplot(re_M[,1], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,2], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,3], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)

#SD of relative error for point estimates
sd_RE_ssb_N1000_NoIndex_ckmrmultinom20<-apply(re_SSB,c(1,3),sd, na.rm=TRUE)
sd_RE_R0_N1000_NoIndex_ckmrmultinom20<-apply(re_R0,2,sd, na.rm=TRUE)
sd_RE_M_N1000_NoIndex_ckmrmultinom20<-apply(re_M,2,sd, na.rm=TRUE)

#SD of absolute relative error
sd_ARE_ssb_N1000_NoIndex_ckmrmultinom20<-apply(abs(re_SSB),c(1,3),sd, na.rm=TRUE)
sd_ARE_R0_N1000_NoIndex_ckmrmultinom20<-apply(abs(re_R0),2,sd, na.rm=TRUE)
sd_ARE_M_N1000_NoIndex_ckmrmultinom20<-apply(abs(re_M),2,sd, na.rm=TRUE)

#Precision within sims
SD_ssb_N1000_NoIndex_ckmrmultinom20<-CV_ssb_N1000_NoIndex_ckmrmultinom20<-array(NA, dim=c(3,100,76))
SD_R0_N1000_NoIndex_ckmrmultinom20<-matrix(NA, nrow=3, ncol=100)
SD_M_N1000_NoIndex_ckmrmultinom20<-matrix(NA, nrow=3, ncol=100)
for(f in 1:3){
  for (i in 1:100){
    CV_ssb_N1000_NoIndex_ckmrmultinom20[f,i,]<-res_list[[f]][[i]]$SD$sd/res_list[[f]][[i]]$SD$unbiased$value
    SD_ssb_N1000_NoIndex_ckmrmultinom20[f,i,]<-res_list[[f]][[i]]$SD$sd
    SD_R0_N1000_NoIndex_ckmrmultinom20[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_R0","log_R0"])
    SD_M_N1000_NoIndex_ckmrmultinom20[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_M","log_M"])
  }
}

#N5000, 20yrs CKMR data, No Index
res_list<-list()
res_list[[1]]<-readRDS(paste0(wd,"/SCAAfit_Cod_N5000_NoIndex_ckmrmultinom20.RData"))
res_list[[2]]<-readRDS(paste0(wd,"/SCAAfit_Flatfish_N5000_NoIndex_ckmrmultinom20.RData"))
res_list[[3]]<-readRDS(paste0(wd,"/SCAAfit_Sardine_N5000_NoIndex_ckmrmultinom20.RData"))

load(paste0(wd,"/Cod_wdat_N5000_Ind25_ckmrmultinom20_1.RData"))
load(paste0(wd,"/Flatfish_wdat_N5000_Ind25_ckmrmultinom20_1.RData"))
load(paste0(wd,"/Sardine_wdat_N5000_Ind25_ckmrmultinom20_1.RData"))

re_Dep<-re_SSB<-array(NA, dim=c(3,100,76))
re_R0<-re_M<-matrix(NA, nrow=100, ncol=3)
for(f in 1:3){
  for (i in 1:100){
    if(f==1){
       if (!is.null(res_list[[f]][[i]])){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Cod_wdat[[i]]$OM$SSB[26:101])/Cod_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Cod_wdat[[i]]$OM$SSB[26:101]/Cod_wdat[[i]]$OM$SSB0)/(Cod_wdat[[i]]$OM$SSB[26:101]/Cod_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[2])-Cod_wdat[[i]]$OM$R0)/Cod_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Cod_wdat[[i]]$OM$Mref)/Cod_wdat[[i]]$OM$Mref
       }
    }else if (f==2){
       if (!is.null(res_list[[f]][[i]])){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Flatfish_wdat[[i]]$OM$SSB[26:101])/Flatfish_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Flatfish_wdat[[i]]$OM$SSB[26:101]/Flatfish_wdat[[i]]$OM$SSB0)/(Flatfish_wdat[[i]]$OM$SSB[26:101]/Flatfish_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[2])-Flatfish_wdat[[i]]$OM$R0)/Flatfish_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Flatfish_wdat[[i]]$OM$Mref)/Flatfish_wdat[[i]]$OM$Mref
       }
    } else if (f==3){
       if (!is.null(res_list[[f]][[i]])){
      re_SSB[f,i,]<-(res_list[[f]][[i]]$SD$unbiased$value-Sardine_wdat[[i]]$OM$SSB[26:101])/Sardine_wdat[[i]]$OM$SSB[26:101]
      #re_Dep[f,i,]<-(summary(res_list[[f]][[i]]$SD)[which(rownames(summary(res_list[[f]][[i]]$SD)) %in% "Depletion"),3]-Sardine_wdat[[i]]$OM$SSB[26:101]/Sardine_wdat[[i]]$OM$SSB0)/(Sardine_wdat[[i]]$OM$SSB[26:101]/Sardine_wdat[[i]]$OM$SSB0)
      re_R0[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[2])-Sardine_wdat[[i]]$OM$R0)/Sardine_wdat[[i]]$OM$R0
      re_M[i,f]<-(exp(res_list[[f]][[i]]$SD$par.fixed[1])-Sardine_wdat[[i]]$OM$Mref)/Sardine_wdat[[i]]$OM$Mref
       }
    }
  }
}

#SSB
par(mfrow=c(3,3))
boxplot(re_SSB[1,,], ylim=c(-0.25,0.25), las=1, main="Cod - N5000, No Index, CKMR 20yrs", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[2,,], ylim=c(-0.25,0.25), las=1, main="Flatfish - N5000, No Index, CKMR 20yrs", ylab="RE - SSB")
abline(h=0)
boxplot(re_SSB[3,,], ylim=c(-0.25,0.25), las=1, main="Sardine - N5000, No Index, CKMR 20yrs", ylab="RE - SSB")
abline(h=0)

#R0
boxplot(re_R0[,1], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,2], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)
boxplot(re_R0[,3], ylim=c(-0.25,0.25), las=1, main="", ylab="RE - R0")
abline(h=0)

#M
boxplot(re_M[,1], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,2], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)
boxplot(re_M[,3], ylim=c(-0.1,0.1), las=1, main="", ylab="RE - M")
abline(h=0)

#SD of relative error for point estimates
sd_RE_ssb_N5000_NoIndex_ckmrmultinom20<-apply(re_SSB,c(1,3),sd, na.rm=TRUE)
sd_RE_R0_N5000_NoIndex_ckmrmultinom20<-apply(re_R0,2,sd, na.rm=TRUE)
sd_RE_M_N5000_NoIndex_ckmrmultinom20<-apply(re_M,2,sd, na.rm=TRUE)

#SD of absolute relative error
sd_ARE_ssb_N5000_NoIndex_ckmrmultinom20<-apply(abs(re_SSB),c(1,3),sd, na.rm=TRUE)
sd_ARE_R0_N5000_NoIndex_ckmrmultinom20<-apply(abs(re_R0),2,sd, na.rm=TRUE)
sd_ARE_M_N5000_NoIndex_ckmrmultinom20<-apply(abs(re_M),2,sd, na.rm=TRUE)

#Precision within sims
SD_ssb_N5000_NoIndex_ckmrmultinom20<-CV_ssb_N5000_NoIndex_ckmrmultinom20<-array(NA, dim=c(3,100,76))
SD_R0_N5000_NoIndex_ckmrmultinom20<-matrix(NA, nrow=3, ncol=100)
SD_M_N5000_NoIndex_ckmrmultinom20<-matrix(NA, nrow=3, ncol=100)
for(f in 1:3){
  for (i in 1:100){
    if (!is.null(res_list[[f]][[i]])){
    CV_ssb_N5000_NoIndex_ckmrmultinom20[f,i,]<-res_list[[f]][[i]]$SD$sd/res_list[[f]][[i]]$SD$unbiased$value
    SD_ssb_N5000_NoIndex_ckmrmultinom20[f,i,]<-res_list[[f]][[i]]$SD$sd
    SD_R0_N5000_NoIndex_ckmrmultinom20[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_R0","log_R0"])
    SD_M_N5000_NoIndex_ckmrmultinom20[f,i]<-sqrt(res_list[[f]][[i]]$SD$cov.fixed["log_M","log_M"])
    }
  }
}

#################################################
#########################################
#Comparative plots
#########################################
#################################################

######
#SSB
######

#No Index
par(mfrow=c(3,3), mar=c(3,4,1,1), oma=c(2,2,1,1))
boxplot(CV_ssb_N100_NoIndex_ckmrmultinom5[1,,], ylim=c(0,0.35), las=1, main="Cod - N100")
boxplot(CV_ssb_N100_NoIndex_5yrs_noCKMR[1,,], add=TRUE, las=1, main="", col=2)
boxplot(CV_ssb_N100_NoIndex_ckmrmultinom10[1,,], add=TRUE, las=1, main="",col=3)
boxplot(CV_ssb_N100_NoIndex_10yrs_noCKMR[1,,], add=TRUE, las=1, main="",col=4)
boxplot(CV_ssb_N100_NoIndex_ckmrmultinom20[1,,], add=TRUE, las=1, main="",col=5)
boxplot(CV_ssb_N100_NoIndex_20yrs_noCKMR[1,,], add=TRUE, las=1, main="",col=6)
boxplot(CV_ssb_N1000_NoIndex_ckmrmultinom5[1,,], ylim=c(0,0.35), las=1, main="No Index, Cod - N1000")
boxplot(CV_ssb_N1000_NoIndex_5yrs_noCKMR[1,,], add=TRUE, las=1, main="", col=2)
boxplot(CV_ssb_N1000_NoIndex_ckmrmultinom10[1,,], add=TRUE, las=1, main="", col=3)
boxplot(CV_ssb_N1000_NoIndex_10yrs_noCKMR[1,,], add=TRUE, las=1, main="", col=4)
boxplot(CV_ssb_N1000_NoIndex_ckmrmultinom20[1,,], add=TRUE, las=1, main="", col=5)
boxplot(CV_ssb_N1000_NoIndex_20yrs_noCKMR[1,,], add=TRUE, las=1, main="", col=6)
legend("top",c("5yrs no CKMR","10yrs no CKMR","20yrs no CKMR","5yrs CKMR", "10yrs CKMR", "20yrs CKMR"), pch=15, col=c(2,4,6,1,3,5))
boxplot(CV_ssb_N5000_NoIndex_ckmrmultinom5[1,,], ylim=c(0,0.35), las=1, main="Cod - N5000")
boxplot(CV_ssb_N5000_NoIndex_5yrs_noCKMR[1,,], add=TRUE, las=1, main="", col=2)
boxplot(CV_ssb_N5000_NoIndex_ckmrmultinom10[1,,], add=TRUE, las=1, main="", col=3)
boxplot(CV_ssb_N5000_NoIndex_10yrs_noCKMR[1,,], add=TRUE, las=1, main="", col=4)
boxplot(CV_ssb_N5000_NoIndex_ckmrmultinom20[1,,], add=TRUE, las=1, main="", col=5)
boxplot(CV_ssb_N5000_NoIndex_20yrs_noCKMR[1,,], add=TRUE, las=1, main="", col=6)

boxplot(CV_ssb_N100_NoIndex_ckmrmultinom5[2,,], ylim=c(0,0.35), las=1, main="Flatfish - N100")
boxplot(CV_ssb_N100_NoIndex_5yrs_noCKMR[2,,], add=TRUE, las=1, main="", col=2)
boxplot(CV_ssb_N100_NoIndex_ckmrmultinom10[2,,], add=TRUE, las=1, main="",col=3)
boxplot(CV_ssb_N100_NoIndex_10yrs_noCKMR[2,,], add=TRUE, las=1, main="",col=4)
boxplot(CV_ssb_N100_NoIndex_ckmrmultinom20[2,,], add=TRUE, las=1, main="",col=5)
boxplot(CV_ssb_N100_NoIndex_20yrs_noCKMR[2,,], add=TRUE, las=1, main="",col=6)
boxplot(CV_ssb_N1000_NoIndex_ckmrmultinom5[2,,], ylim=c(0,0.35), las=1, main="No Index, Flatfish - N1000")
boxplot(CV_ssb_N1000_NoIndex_5yrs_noCKMR[2,,], add=TRUE, las=1, main="", col=2)
boxplot(CV_ssb_N1000_NoIndex_ckmrmultinom10[2,,], add=TRUE, las=1, main="", col=3)
boxplot(CV_ssb_N1000_NoIndex_10yrs_noCKMR[2,,], add=TRUE, las=1, main="", col=4)
boxplot(CV_ssb_N1000_NoIndex_ckmrmultinom20[2,,], add=TRUE, las=1, main="", col=5)
boxplot(CV_ssb_N1000_NoIndex_20yrs_noCKMR[2,,], add=TRUE, las=1, main="", col=6)
boxplot(CV_ssb_N5000_NoIndex_ckmrmultinom5[2,,], ylim=c(0,0.35), las=1, main="Flatfish - N5000")
boxplot(CV_ssb_N5000_NoIndex_5yrs_noCKMR[2,,], add=TRUE, las=1, main="", col=2)
boxplot(CV_ssb_N5000_NoIndex_ckmrmultinom10[2,,], add=TRUE, las=1, main="", col=3)
boxplot(CV_ssb_N5000_NoIndex_10yrs_noCKMR[2,,], add=TRUE, las=1, main="", col=4)
boxplot(CV_ssb_N5000_NoIndex_ckmrmultinom20[2,,], add=TRUE, las=1, main="", col=5)
boxplot(CV_ssb_N5000_NoIndex_20yrs_noCKMR[2,,], add=TRUE, las=1, main="", col=6)

boxplot(CV_ssb_N100_NoIndex_ckmrmultinom5[3,,], ylim=c(0,0.35), las=1, main="Sardine - N100")
boxplot(CV_ssb_N100_NoIndex_5yrs_noCKMR[3,,], add=TRUE, las=1, main="", col=2)
boxplot(CV_ssb_N100_NoIndex_ckmrmultinom10[3,,], add=TRUE, las=1, main="",col=3)
boxplot(CV_ssb_N100_NoIndex_10yrs_noCKMR[3,,], add=TRUE, las=1, main="",col=4)
boxplot(CV_ssb_N100_NoIndex_ckmrmultinom20[3,,], add=TRUE, las=1, main="",col=5)
boxplot(CV_ssb_N100_NoIndex_20yrs_noCKMR[3,,], add=TRUE, las=1, main="",col=6)
boxplot(CV_ssb_N1000_NoIndex_ckmrmultinom5[3,,], ylim=c(0,0.35), las=1, main="No Index, Sardine - N1000")
boxplot(CV_ssb_N1000_NoIndex_5yrs_noCKMR[3,,], add=TRUE, las=1, main="", col=2)
boxplot(CV_ssb_N1000_NoIndex_ckmrmultinom10[3,,], add=TRUE, las=1, main="", col=3)
boxplot(CV_ssb_N1000_NoIndex_10yrs_noCKMR[3,,], add=TRUE, las=1, main="", col=4)
boxplot(CV_ssb_N1000_NoIndex_ckmrmultinom20[3,,], add=TRUE, las=1, main="", col=5)
boxplot(CV_ssb_N1000_NoIndex_20yrs_noCKMR[3,,], add=TRUE, las=1, main="", col=6)
boxplot(CV_ssb_N5000_NoIndex_ckmrmultinom5[3,,], ylim=c(0,0.35), las=1, main="Sardine - N5000")
boxplot(CV_ssb_N5000_NoIndex_5yrs_noCKMR[3,,], add=TRUE, las=1, main="", col=2)
boxplot(CV_ssb_N5000_NoIndex_ckmrmultinom10[3,,], add=TRUE, las=1, main="", col=3)
boxplot(CV_ssb_N5000_NoIndex_10yrs_noCKMR[3,,], add=TRUE, las=1, main="", col=4)
boxplot(CV_ssb_N5000_NoIndex_ckmrmultinom20[3,,], add=TRUE, las=1, main="", col=5)
boxplot(CV_ssb_N5000_NoIndex_20yrs_noCKMR[3,,], add=TRUE, las=1, main="", col=6)

#Index 0.50
par(mfrow=c(3,3), mar=c(3,4,1,1), oma=c(2,2,1,1))
boxplot(CV_ssb_N100_Ind50_ckmrmultinom5[1,,], ylim=c(0,0.35), las=1, main="Cod - N100")
boxplot(CV_ssb_N100_Ind50_5yrs_noCKMR[1,,], add=TRUE, las=1, main="", col=2)
boxplot(CV_ssb_N100_Ind50_ckmrmultinom10[1,,], add=TRUE, las=1, main="",col=3)
boxplot(CV_ssb_N100_Ind50_10yrs_noCKMR[1,,], add=TRUE, las=1, main="",col=4)
boxplot(CV_ssb_N100_Ind50_ckmrmultinom20[1,,], add=TRUE, las=1, main="",col=5)
boxplot(CV_ssb_N100_Ind50_20yrs_noCKMR[1,,], add=TRUE, las=1, main="",col=6)
boxplot(CV_ssb_N1000_Ind50_ckmrmultinom5[1,,], ylim=c(0,0.35), las=1, main="Index - 0.50, Cod - N1000")
boxplot(CV_ssb_N1000_Ind50_5yrs_noCKMR[1,,], add=TRUE, las=1, main="", col=2)
boxplot(CV_ssb_N1000_Ind50_ckmrmultinom10[1,,], add=TRUE, las=1, main="", col=3)
boxplot(CV_ssb_N1000_Ind50_10yrs_noCKMR[1,,], add=TRUE, las=1, main="", col=4)
boxplot(CV_ssb_N1000_Ind50_ckmrmultinom20[1,,], add=TRUE, las=1, main="", col=5)
boxplot(CV_ssb_N1000_Ind50_20yrs_noCKMR[1,,], add=TRUE, las=1, main="", col=6)
legend("top",c("5yrs no CKMR","10yrs no CKMR","20yrs no CKMR","5yrs CKMR", "10yrs CKMR", "20yrs CKMR"), pch=15, col=c(2,4,6,1,3,5))
boxplot(CV_ssb_N5000_Ind50_ckmrmultinom5[1,,], ylim=c(0,0.35), las=1, main="Cod - N5000")
boxplot(CV_ssb_N5000_Ind50_5yrs_noCKMR[1,,], add=TRUE, las=1, main="", col=2)
boxplot(CV_ssb_N5000_Ind50_ckmrmultinom10[1,,], add=TRUE, las=1, main="", col=3)
boxplot(CV_ssb_N5000_Ind50_10yrs_noCKMR[1,,], add=TRUE, las=1, main="", col=4)
boxplot(CV_ssb_N5000_Ind50_ckmrmultinom20[1,,], add=TRUE, las=1, main="", col=5)
boxplot(CV_ssb_N5000_Ind50_20yrs_noCKMR[1,,], add=TRUE, las=1, main="", col=6)

boxplot(CV_ssb_N100_Ind50_ckmrmultinom5[2,,], ylim=c(0,0.35), las=1, main="Flatfish - N100")
boxplot(CV_ssb_N100_Ind50_5yrs_noCKMR[2,,], add=TRUE, las=1, main="", col=2)
boxplot(CV_ssb_N100_Ind50_ckmrmultinom10[2,,], add=TRUE, las=1, main="",col=3)
boxplot(CV_ssb_N100_Ind50_10yrs_noCKMR[2,,], add=TRUE, las=1, main="",col=4)
boxplot(CV_ssb_N100_Ind50_ckmrmultinom20[2,,], add=TRUE, las=1, main="",col=5)
boxplot(CV_ssb_N100_Ind50_20yrs_noCKMR[2,,], add=TRUE, las=1, main="",col=6)
boxplot(CV_ssb_N1000_Ind50_ckmrmultinom5[2,,], ylim=c(0,0.35), las=1, main="Index - 0.50, Flatfish - N1000")
boxplot(CV_ssb_N1000_Ind50_5yrs_noCKMR[2,,], add=TRUE, las=1, main="", col=2)
boxplot(CV_ssb_N1000_Ind50_ckmrmultinom10[2,,], add=TRUE, las=1, main="", col=3)
boxplot(CV_ssb_N1000_Ind50_10yrs_noCKMR[2,,], add=TRUE, las=1, main="", col=4)
boxplot(CV_ssb_N1000_Ind50_ckmrmultinom20[2,,], add=TRUE, las=1, main="", col=5)
boxplot(CV_ssb_N1000_Ind50_20yrs_noCKMR[2,,], add=TRUE, las=1, main="", col=6)
boxplot(CV_ssb_N5000_Ind50_ckmrmultinom5[2,,], ylim=c(0,0.35), las=1, main="Flatfish - N5000")
boxplot(CV_ssb_N5000_Ind50_5yrs_noCKMR[2,,], add=TRUE, las=1, main="", col=2)
boxplot(CV_ssb_N5000_Ind50_ckmrmultinom10[2,,], add=TRUE, las=1, main="", col=3)
boxplot(CV_ssb_N5000_Ind50_10yrs_noCKMR[2,,], add=TRUE, las=1, main="", col=4)
boxplot(CV_ssb_N5000_Ind50_ckmrmultinom20[2,,], add=TRUE, las=1, main="", col=5)
boxplot(CV_ssb_N5000_Ind50_20yrs_noCKMR[2,,], add=TRUE, las=1, main="", col=6)

boxplot(CV_ssb_N100_Ind50_ckmrmultinom5[3,,], ylim=c(0,0.35), las=1, main="Sardine - N100")
boxplot(CV_ssb_N100_Ind50_5yrs_noCKMR[3,,], add=TRUE, las=1, main="", col=2)
boxplot(CV_ssb_N100_Ind50_ckmrmultinom10[3,,], add=TRUE, las=1, main="",col=3)
boxplot(CV_ssb_N100_Ind50_10yrs_noCKMR[3,,], add=TRUE, las=1, main="",col=4)
boxplot(CV_ssb_N100_Ind50_ckmrmultinom20[3,,], add=TRUE, las=1, main="",col=5)
boxplot(CV_ssb_N100_Ind50_20yrs_noCKMR[3,,], add=TRUE, las=1, main="",col=6)
boxplot(CV_ssb_N1000_Ind50_ckmrmultinom5[3,,], ylim=c(0,0.35), las=1, main="Index - 0.50, Sardine - N1000")
boxplot(CV_ssb_N1000_Ind50_5yrs_noCKMR[3,,], add=TRUE, las=1, main="", col=2)
boxplot(CV_ssb_N1000_Ind50_ckmrmultinom10[3,,], add=TRUE, las=1, main="", col=3)
boxplot(CV_ssb_N1000_Ind50_10yrs_noCKMR[3,,], add=TRUE, las=1, main="", col=4)
boxplot(CV_ssb_N1000_Ind50_ckmrmultinom20[3,,], add=TRUE, las=1, main="", col=5)
boxplot(CV_ssb_N1000_Ind50_20yrs_noCKMR[3,,], add=TRUE, las=1, main="", col=6)
boxplot(CV_ssb_N5000_Ind50_ckmrmultinom5[3,,], ylim=c(0,0.35), las=1, main="Sardine - N5000")
boxplot(CV_ssb_N5000_Ind50_5yrs_noCKMR[3,,], add=TRUE, las=1, main="", col=2)
boxplot(CV_ssb_N5000_Ind50_ckmrmultinom10[3,,], add=TRUE, las=1, main="", col=3)
boxplot(CV_ssb_N5000_Ind50_10yrs_noCKMR[3,,], add=TRUE, las=1, main="", col=4)
boxplot(CV_ssb_N5000_Ind50_ckmrmultinom20[3,,], add=TRUE, las=1, main="", col=5)
boxplot(CV_ssb_N5000_Ind50_20yrs_noCKMR[3,,], add=TRUE, las=1, main="", col=6)

#Index 0.25
par(mfrow=c(3,3), mar=c(3,4,1,1), oma=c(2,2,1,1))
boxplot(CV_ssb_N100_Ind25_ckmrmultinom5[1,,], ylim=c(0,0.35), las=1, main="Cod - N100")
boxplot(CV_ssb_N100_Ind25_5yrs_noCKMR[1,,], add=TRUE, las=1, main="", col=2)
boxplot(CV_ssb_N100_Ind25_ckmrmultinom10[1,,], add=TRUE, las=1, main="",col=3)
boxplot(CV_ssb_N100_Ind25_10yrs_noCKMR[1,,], add=TRUE, las=1, main="",col=4)
boxplot(CV_ssb_N100_Ind25_ckmrmultinom20[1,,], add=TRUE, las=1, main="",col=5)
boxplot(CV_ssb_N100_Ind25_20yrs_noCKMR[1,,], add=TRUE, las=1, main="",col=6)
boxplot(CV_ssb_N1000_Ind25_ckmrmultinom5[1,,], ylim=c(0,0.35), las=1, main="Index - 0.25, Cod - N1000")
boxplot(CV_ssb_N1000_Ind25_5yrs_noCKMR[1,,], add=TRUE, las=1, main="", col=2)
boxplot(CV_ssb_N1000_Ind25_ckmrmultinom10[1,,], add=TRUE, las=1, main="", col=3)
boxplot(CV_ssb_N1000_Ind25_10yrs_noCKMR[1,,], add=TRUE, las=1, main="", col=4)
boxplot(CV_ssb_N1000_Ind25_ckmrmultinom20[1,,], add=TRUE, las=1, main="", col=5)
boxplot(CV_ssb_N1000_Ind25_20yrs_noCKMR[1,,], add=TRUE, las=1, main="", col=6)
legend("top",c("5yrs no CKMR","10yrs no CKMR","20yrs no CKMR","5yrs CKMR", "10yrs CKMR", "20yrs CKMR"), pch=15, col=c(2,4,6,1,3,5))
boxplot(CV_ssb_N5000_Ind25_ckmrmultinom5[1,,], ylim=c(0,0.35), las=1, main="Cod - N5000")
boxplot(CV_ssb_N5000_Ind25_5yrs_noCKMR[1,,], add=TRUE, las=1, main="", col=2)
boxplot(CV_ssb_N5000_Ind25_ckmrmultinom10[1,,], add=TRUE, las=1, main="", col=3)
boxplot(CV_ssb_N5000_Ind25_10yrs_noCKMR[1,,], add=TRUE, las=1, main="", col=4)
boxplot(CV_ssb_N5000_Ind25_ckmrmultinom20[1,,], add=TRUE, las=1, main="", col=5)
boxplot(CV_ssb_N5000_Ind25_20yrs_noCKMR[1,,], add=TRUE, las=1, main="", col=6)

boxplot(CV_ssb_N100_Ind25_ckmrmultinom5[2,,], ylim=c(0,0.35), las=1, main="Flatfish - N100")
boxplot(CV_ssb_N100_Ind25_5yrs_noCKMR[2,,], add=TRUE, las=1, main="", col=2)
boxplot(CV_ssb_N100_Ind25_ckmrmultinom10[2,,], add=TRUE, las=1, main="",col=3)
boxplot(CV_ssb_N100_Ind25_10yrs_noCKMR[2,,], add=TRUE, las=1, main="",col=4)
boxplot(CV_ssb_N100_Ind25_ckmrmultinom20[2,,], add=TRUE, las=1, main="",col=5)
boxplot(CV_ssb_N100_Ind25_20yrs_noCKMR[2,,], add=TRUE, las=1, main="",col=6)
boxplot(CV_ssb_N1000_Ind25_ckmrmultinom5[2,,], ylim=c(0,0.35), las=1, main="Index - 0.25, Flatfish - N1000")
boxplot(CV_ssb_N1000_Ind25_5yrs_noCKMR[2,,], add=TRUE, las=1, main="", col=2)
boxplot(CV_ssb_N1000_Ind25_ckmrmultinom10[2,,], add=TRUE, las=1, main="", col=3)
boxplot(CV_ssb_N1000_Ind25_10yrs_noCKMR[2,,], add=TRUE, las=1, main="", col=4)
boxplot(CV_ssb_N1000_Ind25_ckmrmultinom20[2,,], add=TRUE, las=1, main="", col=5)
boxplot(CV_ssb_N1000_Ind25_20yrs_noCKMR[2,,], add=TRUE, las=1, main="", col=6)
boxplot(CV_ssb_N5000_Ind25_ckmrmultinom5[2,,], ylim=c(0,0.35), las=1, main="Flatfish - N5000")
boxplot(CV_ssb_N5000_Ind25_5yrs_noCKMR[2,,], add=TRUE, las=1, main="", col=2)
boxplot(CV_ssb_N5000_Ind25_ckmrmultinom10[2,,], add=TRUE, las=1, main="", col=3)
boxplot(CV_ssb_N5000_Ind25_10yrs_noCKMR[2,,], add=TRUE, las=1, main="", col=4)
boxplot(CV_ssb_N5000_Ind25_ckmrmultinom20[2,,], add=TRUE, las=1, main="", col=5)
boxplot(CV_ssb_N5000_Ind25_20yrs_noCKMR[2,,], add=TRUE, las=1, main="", col=6)

boxplot(CV_ssb_N100_Ind25_ckmrmultinom5[3,,], ylim=c(0,0.35), las=1, main="Sardine - N100")
boxplot(CV_ssb_N100_Ind25_5yrs_noCKMR[3,,], add=TRUE, las=1, main="", col=2)
boxplot(CV_ssb_N100_Ind25_ckmrmultinom10[3,,], add=TRUE, las=1, main="",col=3)
boxplot(CV_ssb_N100_Ind25_10yrs_noCKMR[3,,], add=TRUE, las=1, main="",col=4)
boxplot(CV_ssb_N100_Ind25_ckmrmultinom20[3,,], add=TRUE, las=1, main="",col=5)
boxplot(CV_ssb_N100_Ind25_20yrs_noCKMR[3,,], add=TRUE, las=1, main="",col=6)
boxplot(CV_ssb_N1000_Ind25_ckmrmultinom5[3,,], ylim=c(0,0.35), las=1, main="Index - 0.25, Sardine - N1000")
boxplot(CV_ssb_N1000_Ind25_5yrs_noCKMR[3,,], add=TRUE, las=1, main="", col=2)
boxplot(CV_ssb_N1000_Ind25_ckmrmultinom10[3,,], add=TRUE, las=1, main="", col=3)
boxplot(CV_ssb_N1000_Ind25_10yrs_noCKMR[3,,], add=TRUE, las=1, main="", col=4)
boxplot(CV_ssb_N1000_Ind25_ckmrmultinom20[3,,], add=TRUE, las=1, main="", col=5)
boxplot(CV_ssb_N1000_Ind25_20yrs_noCKMR[3,,], add=TRUE, las=1, main="", col=6)
boxplot(CV_ssb_N5000_Ind25_ckmrmultinom5[3,,], ylim=c(0,0.35), las=1, main="Sardine - N5000")
boxplot(CV_ssb_N5000_Ind25_5yrs_noCKMR[3,,], add=TRUE, las=1, main="", col=2)
boxplot(CV_ssb_N5000_Ind25_ckmrmultinom10[3,,], add=TRUE, las=1, main="", col=3)
boxplot(CV_ssb_N5000_Ind25_10yrs_noCKMR[3,,], add=TRUE, las=1, main="", col=4)
boxplot(CV_ssb_N5000_Ind25_ckmrmultinom20[3,,], add=TRUE, las=1, main="", col=5)
boxplot(CV_ssb_N5000_Ind25_20yrs_noCKMR[3,,], add=TRUE, las=1, main="", col=6)

#Relative to models with no ckmr
#No Index
par(mfrow=c(3,3), mar=c(3,4,1,1), oma=c(2,2,1,1))
boxplot(CV_ssb_N100_NoIndex_ckmrmultinom5[1,,]/CV_ssb_N100_NoIndex_5yrs_noCKMR[1,,], ylim=c(0.98,1.02), las=1, main="Cod - N100", col=2)
boxplot(CV_ssb_N100_NoIndex_ckmrmultinom10[1,,]/CV_ssb_N100_NoIndex_10yrs_noCKMR[1,,], add=TRUE, las=1, main="", col=3)
boxplot(CV_ssb_N100_NoIndex_ckmrmultinom20[1,,]/CV_ssb_N100_NoIndex_20yrs_noCKMR[1,,], add=TRUE, las=1, main="", col=4)
boxplot(CV_ssb_N1000_NoIndex_ckmrmultinom5[1,,]/CV_ssb_N1000_NoIndex_5yrs_noCKMR[1,,], ylim=c(0.9,1.05), las=1, main="No Index, Cod - N1000", col=2)
boxplot(CV_ssb_N1000_NoIndex_ckmrmultinom10[1,,]/CV_ssb_N1000_NoIndex_10yrs_noCKMR[1,,], add=TRUE, las=1, main="", col=3)
boxplot(CV_ssb_N1000_NoIndex_ckmrmultinom20[1,,]/CV_ssb_N1000_NoIndex_20yrs_noCKMR[1,,], add=TRUE, las=1, main="", col=4)
legend("top",c("5yrs CKMR", "10yrs CKMR", "20yrs CKMR"), pch=15, col=c(2,3,4))
boxplot(CV_ssb_N5000_NoIndex_ckmrmultinom5[1,,]/CV_ssb_N5000_NoIndex_5yrs_noCKMR[1,,], ylim=c(0.75,1.1), las=1, main="Cod - N5000", col=2)
boxplot(CV_ssb_N5000_NoIndex_ckmrmultinom10[1,,]/CV_ssb_N5000_NoIndex_10yrs_noCKMR[1,,], add=TRUE, las=1, main="", col=3)
boxplot(CV_ssb_N5000_NoIndex_ckmrmultinom20[1,,]/CV_ssb_N5000_NoIndex_20yrs_noCKMR[1,,], add=TRUE, las=1, main="", col=4)

boxplot(CV_ssb_N100_NoIndex_ckmrmultinom5[2,,]/CV_ssb_N100_NoIndex_5yrs_noCKMR[2,,], ylim=c(0.85,1.05), las=1, main="Flatfish - N100", ylab="CV of SSB relative to no CKMR Model", col=2)
boxplot(CV_ssb_N100_NoIndex_ckmrmultinom10[2,,]/CV_ssb_N100_NoIndex_10yrs_noCKMR[2,,], add=TRUE, las=1, main="", col=3)
boxplot(CV_ssb_N100_NoIndex_ckmrmultinom20[2,,]/CV_ssb_N100_NoIndex_20yrs_noCKMR[2,,], add=TRUE, las=1, main="", col=4)
boxplot(CV_ssb_N1000_NoIndex_ckmrmultinom5[2,,]/CV_ssb_N1000_NoIndex_5yrs_noCKMR[2,,], ylim=c(0.15,1.05), las=1, main="Flatfish - N1000", col=2)
boxplot(CV_ssb_N1000_NoIndex_ckmrmultinom10[2,,]/CV_ssb_N1000_NoIndex_10yrs_noCKMR[2,,], add=TRUE, las=1, main="", col=3)
boxplot(CV_ssb_N1000_NoIndex_ckmrmultinom20[2,,]/CV_ssb_N1000_NoIndex_20yrs_noCKMR[2,,], add=TRUE, las=1, main="", col=4)
boxplot(CV_ssb_N5000_NoIndex_ckmrmultinom5[2,,]/CV_ssb_N5000_NoIndex_5yrs_noCKMR[2,,], ylim=c(0.05,1.05), las=1, main="Flatfish - N5000", col=2)
boxplot(CV_ssb_N5000_NoIndex_ckmrmultinom10[2,,]/CV_ssb_N5000_NoIndex_10yrs_noCKMR[2,,], add=TRUE, las=1, main="", col=3)
boxplot(CV_ssb_N5000_NoIndex_ckmrmultinom20[2,,]/CV_ssb_N5000_NoIndex_20yrs_noCKMR[2,,], add=TRUE, las=1, main="", col=4)

boxplot(CV_ssb_N100_NoIndex_ckmrmultinom5[3,,]/CV_ssb_N100_NoIndex_5yrs_noCKMR[3,,], ylim=c(0.98,1.02), las=1, main="Sardine - N100", col=2)
boxplot(CV_ssb_N100_NoIndex_ckmrmultinom10[3,,]/CV_ssb_N100_NoIndex_10yrs_noCKMR[3,,], add=TRUE, las=1, main="", col=3)
boxplot(CV_ssb_N100_NoIndex_ckmrmultinom20[3,,]/CV_ssb_N100_NoIndex_20yrs_noCKMR[3,,], add=TRUE, las=1, main="", col=4)
boxplot(CV_ssb_N1000_NoIndex_ckmrmultinom5[3,,]/CV_ssb_N1000_NoIndex_5yrs_noCKMR[3,,], ylim=c(0.85,1.05), las=1, main="Sardine - N1000", col=2)
boxplot(CV_ssb_N1000_NoIndex_ckmrmultinom10[3,,]/CV_ssb_N1000_NoIndex_10yrs_noCKMR[3,,], add=TRUE, las=1, main="", col=3)
boxplot(CV_ssb_N1000_NoIndex_ckmrmultinom20[3,,]/CV_ssb_N1000_NoIndex_20yrs_noCKMR[3,,], add=TRUE, las=1, main="", col=4)
boxplot(CV_ssb_N5000_NoIndex_ckmrmultinom5[3,,]/CV_ssb_N5000_NoIndex_5yrs_noCKMR[3,,], ylim=c(0.25,1.05), las=1, main="Sardine - N5000", col=2)
boxplot(CV_ssb_N5000_NoIndex_ckmrmultinom10[3,,]/CV_ssb_N5000_NoIndex_10yrs_noCKMR[3,,], add=TRUE, las=1, main="", col=3)
boxplot(CV_ssb_N5000_NoIndex_ckmrmultinom20[3,,]/CV_ssb_N5000_NoIndex_20yrs_noCKMR[3,,], add=TRUE, las=1, main="", col=4)

#Index 0.5
par(mfrow=c(3,3), mar=c(3,4,1,1), oma=c(2,2,1,1))
boxplot(CV_ssb_N100_Ind50_ckmrmultinom5[1,,]/CV_ssb_N100_Ind50_5yrs_noCKMR[1,,], ylim=c(0.98,1.02), las=1, main="Cod - N100", col=2)
boxplot(CV_ssb_N100_Ind50_ckmrmultinom10[1,,]/CV_ssb_N100_Ind50_10yrs_noCKMR[1,,], add=TRUE, las=1, main="", col=3)
boxplot(CV_ssb_N100_Ind50_ckmrmultinom20[1,,]/CV_ssb_N100_Ind50_20yrs_noCKMR[1,,], add=TRUE, las=1, main="", col=4)
boxplot(CV_ssb_N1000_Ind50_ckmrmultinom5[1,,]/CV_ssb_N1000_Ind50_5yrs_noCKMR[1,,], ylim=c(0.985,1.01), las=1, main="Index - 0.5, Cod - N1000", col=2)
boxplot(CV_ssb_N1000_Ind50_ckmrmultinom10[1,,]/CV_ssb_N1000_Ind50_10yrs_noCKMR[1,,], add=TRUE, las=1, main="", col=3)
boxplot(CV_ssb_N1000_Ind50_ckmrmultinom20[1,,]/CV_ssb_N1000_Ind50_20yrs_noCKMR[1,,], add=TRUE, las=1, main="", col=4)
legend("top",c("5yrs CKMR", "10yrs CKMR", "20yrs CKMR"), pch=15, col=c(2,3,4))
boxplot(CV_ssb_N5000_Ind50_ckmrmultinom5[1,,]/CV_ssb_N5000_Ind50_5yrs_noCKMR[1,,], ylim=c(0.875,1.02), las=1, main="Cod - N5000", col=2)
boxplot(CV_ssb_N5000_Ind50_ckmrmultinom10[1,,]/CV_ssb_N5000_Ind50_10yrs_noCKMR[1,,], add=TRUE, las=1, main="", col=3)
boxplot(CV_ssb_N5000_Ind50_ckmrmultinom20[1,,]/CV_ssb_N5000_Ind50_20yrs_noCKMR[1,,], add=TRUE, las=1, main="", col=4)

boxplot(CV_ssb_N100_Ind50_ckmrmultinom5[2,,]/CV_ssb_N100_Ind50_5yrs_noCKMR[2,,], ylim=c(0.925,1.05), las=1, main="Flatfish - N100", ylab="CV of SSB relative to no CKMR Model", col=2)
boxplot(CV_ssb_N100_Ind50_ckmrmultinom10[2,,]/CV_ssb_N100_Ind50_10yrs_noCKMR[2,,], add=TRUE, las=1, main="", col=3)
boxplot(CV_ssb_N100_Ind50_ckmrmultinom20[2,,]/CV_ssb_N100_Ind50_20yrs_noCKMR[2,,], add=TRUE, las=1, main="", col=4)
boxplot(CV_ssb_N1000_Ind50_ckmrmultinom5[2,,]/CV_ssb_N1000_Ind50_5yrs_noCKMR[2,,], ylim=c(0.25,1.05), las=1, main="Flatfish - N1000", col=2)
boxplot(CV_ssb_N1000_Ind50_ckmrmultinom10[2,,]/CV_ssb_N1000_Ind50_10yrs_noCKMR[2,,], add=TRUE, las=1, main="", col=3)
boxplot(CV_ssb_N1000_Ind50_ckmrmultinom20[2,,]/CV_ssb_N1000_Ind50_20yrs_noCKMR[2,,], add=TRUE, las=1, main="", col=4)
boxplot(CV_ssb_N5000_Ind50_ckmrmultinom5[2,,]/CV_ssb_N5000_Ind50_5yrs_noCKMR[2,,], ylim=c(0.1,1.05), las=1, main="Flatfish - N5000", col=2)
boxplot(CV_ssb_N5000_Ind50_ckmrmultinom10[2,,]/CV_ssb_N5000_Ind50_10yrs_noCKMR[2,,], add=TRUE, las=1, main="", col=3)
boxplot(CV_ssb_N5000_Ind50_ckmrmultinom20[2,,]/CV_ssb_N5000_Ind50_20yrs_noCKMR[2,,], add=TRUE, las=1, main="", col=4)

boxplot(CV_ssb_N100_Ind50_ckmrmultinom5[3,,]/CV_ssb_N100_Ind50_5yrs_noCKMR[3,,], ylim=c(0.98,1.02), las=1, main="Sardine - N100", col=2)
boxplot(CV_ssb_N100_Ind50_ckmrmultinom10[3,,]/CV_ssb_N100_Ind50_10yrs_noCKMR[3,,], add=TRUE, las=1, main="", col=3)
boxplot(CV_ssb_N100_Ind50_ckmrmultinom20[3,,]/CV_ssb_N100_Ind50_20yrs_noCKMR[3,,], add=TRUE, las=1, main="", col=4)
boxplot(CV_ssb_N1000_Ind50_ckmrmultinom5[3,,]/CV_ssb_N1000_Ind50_5yrs_noCKMR[3,,], ylim=c(0.9,1.1), las=1, main="Sardine - N1000", col=2)
boxplot(CV_ssb_N1000_Ind50_ckmrmultinom10[3,,]/CV_ssb_N1000_Ind50_10yrs_noCKMR[3,,], add=TRUE, las=1, main="", col=3)
boxplot(CV_ssb_N1000_Ind50_ckmrmultinom20[3,,]/CV_ssb_N1000_Ind50_20yrs_noCKMR[3,,], add=TRUE, las=1, main="", col=4)
boxplot(CV_ssb_N5000_Ind50_ckmrmultinom5[3,,]/CV_ssb_N5000_Ind50_5yrs_noCKMR[3,,], ylim=c(0.5,1.05), las=1, main="Sardine - N5000", col=2)
boxplot(CV_ssb_N5000_Ind50_ckmrmultinom10[3,,]/CV_ssb_N5000_Ind50_10yrs_noCKMR[3,,], add=TRUE, las=1, main="", col=3)
boxplot(CV_ssb_N5000_Ind50_ckmrmultinom20[3,,]/CV_ssb_N5000_Ind50_20yrs_noCKMR[3,,], add=TRUE, las=1, main="", col=4)

#Index 0.25
par(mfrow=c(3,3), mar=c(3,4,1,1), oma=c(2,2,1,1))
boxplot(CV_ssb_N100_Ind25_ckmrmultinom5[1,,]/CV_ssb_N100_Ind25_5yrs_noCKMR[1,,], ylim=c(0.98,1.02), las=1, main="Cod - N100", col=2)
boxplot(CV_ssb_N100_Ind25_ckmrmultinom10[1,,]/CV_ssb_N100_Ind25_10yrs_noCKMR[1,,], add=TRUE, las=1, main="", col=3)
boxplot(CV_ssb_N100_Ind25_ckmrmultinom20[1,,]/CV_ssb_N100_Ind25_20yrs_noCKMR[1,,], add=TRUE, las=1, main="", col=4)
boxplot(CV_ssb_N1000_Ind25_ckmrmultinom5[1,,]/CV_ssb_N1000_Ind25_5yrs_noCKMR[1,,], ylim=c(0.985,1.01), las=1, main="Index - 0.25, Cod - N1000", col=2)
boxplot(CV_ssb_N1000_Ind25_ckmrmultinom10[1,,]/CV_ssb_N1000_Ind25_10yrs_noCKMR[1,,], add=TRUE, las=1, main="", col=3)
boxplot(CV_ssb_N1000_Ind25_ckmrmultinom20[1,,]/CV_ssb_N1000_Ind25_20yrs_noCKMR[1,,], add=TRUE, las=1, main="", col=4)
legend("top",c("5yrs CKMR", "10yrs CKMR", "20yrs CKMR"), pch=15, col=c(2,3,4))
boxplot(CV_ssb_N5000_Ind25_ckmrmultinom5[1,,]/CV_ssb_N5000_Ind25_5yrs_noCKMR[1,,], ylim=c(0.8,1.1), las=1, main="Cod - N5000", col=2)
boxplot(CV_ssb_N5000_Ind25_ckmrmultinom10[1,,]/CV_ssb_N5000_Ind25_10yrs_noCKMR[1,,], add=TRUE, las=1, main="", col=3)
boxplot(CV_ssb_N5000_Ind25_ckmrmultinom20[1,,]/CV_ssb_N5000_Ind25_20yrs_noCKMR[1,,], add=TRUE, las=1, main="", col=4)

boxplot(CV_ssb_N100_Ind25_ckmrmultinom5[2,,]/CV_ssb_N100_Ind25_5yrs_noCKMR[2,,], ylim=c(0.95,1.02), las=1, main="Flatfish - N100", ylab="CV of SSB relative to no CKMR Model", col=2)
boxplot(CV_ssb_N100_Ind25_ckmrmultinom10[2,,]/CV_ssb_N100_Ind25_10yrs_noCKMR[2,,], add=TRUE, las=1, main="", col=3)
boxplot(CV_ssb_N100_Ind25_ckmrmultinom20[2,,]/CV_ssb_N100_Ind25_20yrs_noCKMR[2,,], add=TRUE, las=1, main="", col=4)
boxplot(CV_ssb_N1000_Ind25_ckmrmultinom5[2,,]/CV_ssb_N1000_Ind25_5yrs_noCKMR[2,,], ylim=c(0.35,1.05), las=1, main="Flatfish - N1000", col=2)
boxplot(CV_ssb_N1000_Ind25_ckmrmultinom10[2,,]/CV_ssb_N1000_Ind25_10yrs_noCKMR[2,,], add=TRUE, las=1, main="", col=3)
boxplot(CV_ssb_N1000_Ind25_ckmrmultinom20[2,,]/CV_ssb_N1000_Ind25_20yrs_noCKMR[2,,], add=TRUE, las=1, main="", col=4)
boxplot(CV_ssb_N5000_Ind25_ckmrmultinom5[2,,]/CV_ssb_N5000_Ind25_5yrs_noCKMR[2,,], ylim=c(0.15,1.05), las=1, main="Flatfish - N5000", col=2)
boxplot(CV_ssb_N5000_Ind25_ckmrmultinom10[2,,]/CV_ssb_N5000_Ind25_10yrs_noCKMR[2,,], add=TRUE, las=1, main="", col=3)
boxplot(CV_ssb_N5000_Ind25_ckmrmultinom20[2,,]/CV_ssb_N5000_Ind25_20yrs_noCKMR[2,,], add=TRUE, las=1, main="", col=4)

boxplot(CV_ssb_N100_Ind25_ckmrmultinom5[3,,]/CV_ssb_N100_Ind25_5yrs_noCKMR[3,,], ylim=c(0.98,1.02), las=1, main="Sardine - N100", col=2)
boxplot(CV_ssb_N100_Ind25_ckmrmultinom10[3,,]/CV_ssb_N100_Ind25_10yrs_noCKMR[3,,], add=TRUE, las=1, main="", col=3)
boxplot(CV_ssb_N100_Ind25_ckmrmultinom20[3,,]/CV_ssb_N100_Ind25_20yrs_noCKMR[3,,], add=TRUE, las=1, main="", col=4)
boxplot(CV_ssb_N1000_Ind25_ckmrmultinom5[3,,]/CV_ssb_N1000_Ind25_5yrs_noCKMR[3,,], ylim=c(0.95,1.01), las=1, main="Sardine - N1000", col=2)
boxplot(CV_ssb_N1000_Ind25_ckmrmultinom10[3,,]/CV_ssb_N1000_Ind25_10yrs_noCKMR[3,,], add=TRUE, las=1, main="", col=3)
boxplot(CV_ssb_N1000_Ind25_ckmrmultinom20[3,,]/CV_ssb_N1000_Ind25_20yrs_noCKMR[3,,], add=TRUE, las=1, main="", col=4)
boxplot(CV_ssb_N5000_Ind25_ckmrmultinom5[3,,]/CV_ssb_N5000_Ind25_5yrs_noCKMR[3,,], ylim=c(0.5,1.1), las=1, main="Sardine - N5000", col=2)
boxplot(CV_ssb_N5000_Ind25_ckmrmultinom10[3,,]/CV_ssb_N5000_Ind25_10yrs_noCKMR[3,,], add=TRUE, las=1, main="", col=3)
boxplot(CV_ssb_N5000_Ind25_ckmrmultinom20[3,,]/CV_ssb_N5000_Ind25_20yrs_noCKMR[3,,], add=TRUE, las=1, main="", col=4)

##################################################
#R0, Unfished Recruitment (SD of point estimate)
##################################################

#No Index
par(mfcol=c(3,3), mar=c(3,4,1,1), oma=c(2,2,1,1))
boxplot(cbind(SD_R0_N100_NoIndex_5yrs_noCKMR[1,],SD_R0_N100_NoIndex_ckmrmultinom5[1,],SD_R0_N100_NoIndex_10yrs_noCKMR[1,],SD_R0_N100_NoIndex_ckmrmultinom10[1,],SD_R0_N100_NoIndex_20yrs_noCKMR[1,],SD_R0_N100_NoIndex_ckmrmultinom20[1,]), ylim=c(0.09,0.2), las=1, main="Cod - SD log(R0) - N100", xaxt="n")
boxplot(cbind(SD_R0_N100_NoIndex_5yrs_noCKMR[2,],SD_R0_N100_NoIndex_ckmrmultinom5[2,],SD_R0_N100_NoIndex_10yrs_noCKMR[2,],SD_R0_N100_NoIndex_ckmrmultinom10[2,],SD_R0_N100_NoIndex_20yrs_noCKMR[2,],SD_R0_N100_NoIndex_ckmrmultinom20[2,]), ylim=c(0.08,0.2), las=1, main="Flatfish - SD log(R0) - N100", ylab="SD of log(R0)", xaxt="n")
boxplot(cbind(SD_R0_N100_NoIndex_5yrs_noCKMR[3,],SD_R0_N100_NoIndex_ckmrmultinom5[3,],SD_R0_N100_NoIndex_10yrs_noCKMR[3,],SD_R0_N100_NoIndex_ckmrmultinom10[3,],SD_R0_N100_NoIndex_20yrs_noCKMR[3,],SD_R0_N100_NoIndex_ckmrmultinom20[3,]), ylim=c(0.12,0.21), las=1, main="Sardine - SD log(R0) - N100", xaxt="n")
axis(side=1, at=1:6, labels=c("5yrs No CKMR","CKMR 5 Years","10yrs No CKMR","CKMR 10 Years","20yrs No CKMR","CKMR 20 Years"))

boxplot(cbind(SD_R0_N1000_NoIndex_5yrs_noCKMR[1,],SD_R0_N1000_NoIndex_ckmrmultinom5[1,],SD_R0_N1000_NoIndex_10yrs_noCKMR[1,],SD_R0_N1000_NoIndex_ckmrmultinom10[1,],SD_R0_N1000_NoIndex_20yrs_noCKMR[1,],SD_R0_N1000_NoIndex_ckmrmultinom20[1,]), ylim=c(0.09,0.2), las=1, main="Cod - SD log(R0) - N1000", xaxt="n")
boxplot(cbind(SD_R0_N1000_NoIndex_5yrs_noCKMR[2,],SD_R0_N1000_NoIndex_ckmrmultinom5[2,],SD_R0_N1000_NoIndex_10yrs_noCKMR[2,],SD_R0_N1000_NoIndex_ckmrmultinom10[2,],SD_R0_N1000_NoIndex_20yrs_noCKMR[2,],SD_R0_N1000_NoIndex_ckmrmultinom20[2,]), ylim=c(0.08,0.2), las=1, main="Flatfish - SD log(R0) - N1000     NO INDEX", ylab="SD of log(R0)", xaxt="n")
boxplot(cbind(SD_R0_N1000_NoIndex_5yrs_noCKMR[3,],SD_R0_N1000_NoIndex_ckmrmultinom5[3,],SD_R0_N1000_NoIndex_10yrs_noCKMR[3,],SD_R0_N1000_NoIndex_ckmrmultinom10[3,],SD_R0_N1000_NoIndex_20yrs_noCKMR[3,],SD_R0_N1000_NoIndex_ckmrmultinom20[3,]), ylim=c(0.12,0.21), las=1, main="Sardine - SD log(R0) - N1000", xaxt="n")
axis(side=1, at=1:6, labels=c("5yrs No CKMR","CKMR 5 Years","10yrs No CKMR","CKMR 10 Years","20yrs No CKMR","CKMR 20 Years"))

boxplot(cbind(SD_R0_N5000_NoIndex_5yrs_noCKMR[1,],SD_R0_N5000_NoIndex_ckmrmultinom5[1,],SD_R0_N5000_NoIndex_10yrs_noCKMR[1,],SD_R0_N5000_NoIndex_ckmrmultinom10[1,],SD_R0_N5000_NoIndex_20yrs_noCKMR[1,],SD_R0_N5000_NoIndex_ckmrmultinom20[1,]), ylim=c(0.09,0.2), las=1, main="Cod - SD log(R0) - N5000", xaxt="n")
boxplot(cbind(SD_R0_N5000_NoIndex_5yrs_noCKMR[2,],SD_R0_N5000_NoIndex_ckmrmultinom5[2,],SD_R0_N5000_NoIndex_10yrs_noCKMR[2,],SD_R0_N5000_NoIndex_ckmrmultinom10[2,],SD_R0_N5000_NoIndex_20yrs_noCKMR[2,],SD_R0_N5000_NoIndex_ckmrmultinom20[2,]), ylim=c(0.08,0.2), las=1, main="Flatfish - SD log(R0) - N5000", ylab="SD of log(R0)", xaxt="n")
boxplot(cbind(SD_R0_N5000_NoIndex_5yrs_noCKMR[3,],SD_R0_N5000_NoIndex_ckmrmultinom5[3,],SD_R0_N5000_NoIndex_10yrs_noCKMR[3,],SD_R0_N5000_NoIndex_ckmrmultinom10[3,],SD_R0_N5000_NoIndex_20yrs_noCKMR[3,],SD_R0_N5000_NoIndex_ckmrmultinom20[3,]), ylim=c(0.12,0.21), las=1, main="Sardine - SD log(R0) - N5000", xaxt="n")
axis(side=1, at=1:6, labels=c("5yrs No CKMR","CKMR 5 Years","10yrs No CKMR","CKMR 10 Years","20yrs No CKMR","CKMR 20 Years"))

#Index 0.5
par(mfcol=c(3,3), mar=c(3,4,1,1), oma=c(2,2,1,1))
boxplot(cbind(SD_R0_N100_Ind50_5yrs_noCKMR[1,],SD_R0_N100_Ind50_ckmrmultinom5[1,],SD_R0_N100_Ind50_10yrs_noCKMR[1,],SD_R0_N100_Ind50_ckmrmultinom10[1,],SD_R0_N100_Ind50_20yrs_noCKMR[1,],SD_R0_N100_Ind50_ckmrmultinom20[1,]), ylim=c(0.07,0.2), las=1, main="Cod - SD log(R0) - N100", xaxt="n")
boxplot(cbind(SD_R0_N100_Ind50_5yrs_noCKMR[2,],SD_R0_N100_Ind50_ckmrmultinom5[2,],SD_R0_N100_Ind50_10yrs_noCKMR[2,],SD_R0_N100_Ind50_ckmrmultinom10[2,],SD_R0_N100_Ind50_20yrs_noCKMR[2,],SD_R0_N100_Ind50_ckmrmultinom20[2,]), ylim=c(0.08,0.2), las=1, main="Flatfish - SD log(R0) - N100", ylab="SD of log(R0)", xaxt="n")
boxplot(cbind(SD_R0_N100_Ind50_5yrs_noCKMR[3,],SD_R0_N100_Ind50_ckmrmultinom5[3,],SD_R0_N100_Ind50_10yrs_noCKMR[3,],SD_R0_N100_Ind50_ckmrmultinom10[3,],SD_R0_N100_Ind50_20yrs_noCKMR[3,],SD_R0_N100_Ind50_ckmrmultinom20[3,]), ylim=c(0.12,0.25), las=1, main="Sardine - SD log(R0) - N100", xaxt="n")
axis(side=1, at=1:6, labels=c("5yrs No CKMR","CKMR 5 Years","10yrs No CKMR","CKMR 10 Years","20yrs No CKMR","CKMR 20 Years"))

boxplot(cbind(SD_R0_N1000_Ind50_5yrs_noCKMR[1,],SD_R0_N1000_Ind50_ckmrmultinom5[1,],SD_R0_N1000_Ind50_10yrs_noCKMR[1,],SD_R0_N1000_Ind50_ckmrmultinom10[1,],SD_R0_N1000_Ind50_20yrs_noCKMR[1,],SD_R0_N1000_Ind50_ckmrmultinom20[1,]), ylim=c(0.07,0.2), las=1, main="Cod - SD log(R0) - N1000", xaxt="n")
boxplot(cbind(SD_R0_N1000_Ind50_5yrs_noCKMR[2,],SD_R0_N1000_Ind50_ckmrmultinom5[2,],SD_R0_N1000_Ind50_10yrs_noCKMR[2,],SD_R0_N1000_Ind50_ckmrmultinom10[2,],SD_R0_N1000_Ind50_20yrs_noCKMR[2,],SD_R0_N1000_Ind50_ckmrmultinom20[2,]), ylim=c(0.08,0.2), las=1, main="Flatfish - SD log(R0) - N1000    INDEX-0.50", ylab="SD of log(R0)", xaxt="n")
boxplot(cbind(SD_R0_N1000_Ind50_5yrs_noCKMR[3,],SD_R0_N1000_Ind50_ckmrmultinom5[3,],SD_R0_N1000_Ind50_10yrs_noCKMR[3,],SD_R0_N1000_Ind50_ckmrmultinom10[3,],SD_R0_N1000_Ind50_20yrs_noCKMR[3,],SD_R0_N1000_Ind50_ckmrmultinom20[3,]), ylim=c(0.12,0.25), las=1, main="Sardine - SD log(R0) - N1000", xaxt="n")
axis(side=1, at=1:6, labels=c("5yrs No CKMR","CKMR 5 Years","10yrs No CKMR","CKMR 10 Years","20yrs No CKMR","CKMR 20 Years"))

boxplot(cbind(SD_R0_N5000_Ind50_5yrs_noCKMR[1,],SD_R0_N5000_Ind50_ckmrmultinom5[1,],SD_R0_N5000_Ind50_10yrs_noCKMR[1,],SD_R0_N5000_Ind50_ckmrmultinom10[1,],SD_R0_N5000_Ind50_20yrs_noCKMR[1,],SD_R0_N5000_Ind50_ckmrmultinom20[1,]), ylim=c(0.07,0.2), las=1, main="Cod - SD log(R0) - N5000", xaxt="n")
boxplot(cbind(SD_R0_N5000_Ind50_5yrs_noCKMR[2,],SD_R0_N5000_Ind50_ckmrmultinom5[2,],SD_R0_N5000_Ind50_10yrs_noCKMR[2,],SD_R0_N5000_Ind50_ckmrmultinom10[2,],SD_R0_N5000_Ind50_20yrs_noCKMR[2,],SD_R0_N5000_Ind50_ckmrmultinom20[2,]), ylim=c(0.08,0.2), las=1, main="Flatfish - SD log(R0) - N5000", ylab="SD of log(R0)", xaxt="n")
boxplot(cbind(SD_R0_N5000_Ind50_5yrs_noCKMR[3,],SD_R0_N5000_Ind50_ckmrmultinom5[3,],SD_R0_N5000_Ind50_10yrs_noCKMR[3,],SD_R0_N5000_Ind50_ckmrmultinom10[3,],SD_R0_N5000_Ind50_20yrs_noCKMR[3,],SD_R0_N5000_Ind50_ckmrmultinom20[3,]), ylim=c(0.12,0.25), las=1, main="Sardine - SD log(R0) - N5000", xaxt="n")
axis(side=1, at=1:6, labels=c("5yrs No CKMR","CKMR 5 Years","10yrs No CKMR","CKMR 10 Years","20yrs No CKMR","CKMR 20 Years"))

#Index 0.25
par(mfcol=c(3,3), mar=c(3,4,1,1), oma=c(2,2,1,1))
boxplot(cbind(SD_R0_N100_Ind25_5yrs_noCKMR[1,],SD_R0_N100_Ind25_ckmrmultinom5[1,],SD_R0_N100_Ind25_10yrs_noCKMR[1,],SD_R0_N100_Ind25_ckmrmultinom10[1,],SD_R0_N100_Ind25_20yrs_noCKMR[1,],SD_R0_N100_Ind25_ckmrmultinom20[1,]), ylim=c(0.07,0.2), las=1, main="Cod - SD log(R0) - N100", xaxt="n")
boxplot(cbind(SD_R0_N100_Ind25_5yrs_noCKMR[2,],SD_R0_N100_Ind25_ckmrmultinom5[2,],SD_R0_N100_Ind25_10yrs_noCKMR[2,],SD_R0_N100_Ind25_ckmrmultinom10[2,],SD_R0_N100_Ind25_20yrs_noCKMR[2,],SD_R0_N100_Ind25_ckmrmultinom20[2,]), ylim=c(0.08,0.2), las=1, main="Flatfish - SD log(R0) - N100", ylab="SD of log(R0)", xaxt="n")
boxplot(cbind(SD_R0_N100_Ind25_5yrs_noCKMR[3,],SD_R0_N100_Ind25_ckmrmultinom5[3,],SD_R0_N100_Ind25_10yrs_noCKMR[3,],SD_R0_N100_Ind25_ckmrmultinom10[3,],SD_R0_N100_Ind25_20yrs_noCKMR[3,],SD_R0_N100_Ind25_ckmrmultinom20[3,]), ylim=c(0.12,0.25), las=1, main="Sardine - SD log(R0) - N100", xaxt="n")
axis(side=1, at=1:6, labels=c("5yrs No CKMR","CKMR 5 Years","10yrs No CKMR","CKMR 10 Years","20yrs No CKMR","CKMR 20 Years"))

boxplot(cbind(SD_R0_N1000_Ind25_5yrs_noCKMR[1,],SD_R0_N1000_Ind25_ckmrmultinom5[1,],SD_R0_N1000_Ind25_10yrs_noCKMR[1,],SD_R0_N1000_Ind25_ckmrmultinom10[1,],SD_R0_N1000_Ind25_20yrs_noCKMR[1,],SD_R0_N1000_Ind25_ckmrmultinom20[1,]), ylim=c(0.07,0.2), las=1, main="Cod - SD log(R0) - N1000", xaxt="n")
boxplot(cbind(SD_R0_N1000_Ind25_5yrs_noCKMR[2,],SD_R0_N1000_Ind25_ckmrmultinom5[2,],SD_R0_N1000_Ind25_10yrs_noCKMR[2,],SD_R0_N1000_Ind25_ckmrmultinom10[2,],SD_R0_N1000_Ind25_20yrs_noCKMR[2,],SD_R0_N1000_Ind25_ckmrmultinom20[2,]), ylim=c(0.08,0.2), las=1, main="Flatfish - SD log(R0) - N1000    INDEX-0.25", ylab="SD of log(R0)", xaxt="n")
boxplot(cbind(SD_R0_N1000_Ind25_5yrs_noCKMR[3,],SD_R0_N1000_Ind25_ckmrmultinom5[3,],SD_R0_N1000_Ind25_10yrs_noCKMR[3,],SD_R0_N1000_Ind25_ckmrmultinom10[3,],SD_R0_N1000_Ind25_20yrs_noCKMR[3,],SD_R0_N1000_Ind25_ckmrmultinom20[3,]), ylim=c(0.12,0.25), las=1, main="Sardine - SD log(R0) - N1000", xaxt="n")
axis(side=1, at=1:6, labels=c("5yrs No CKMR","CKMR 5 Years","10yrs No CKMR","CKMR 10 Years","20yrs No CKMR","CKMR 20 Years"))

boxplot(cbind(SD_R0_N5000_Ind25_5yrs_noCKMR[1,],SD_R0_N5000_Ind25_ckmrmultinom5[1,],SD_R0_N5000_Ind25_10yrs_noCKMR[1,],SD_R0_N5000_Ind25_ckmrmultinom10[1,],SD_R0_N5000_Ind25_20yrs_noCKMR[1,],SD_R0_N5000_Ind25_ckmrmultinom20[1,]), ylim=c(0.07,0.2), las=1, main="Cod - SD log(R0) - N5000", xaxt="n")
boxplot(cbind(SD_R0_N5000_Ind25_5yrs_noCKMR[2,],SD_R0_N5000_Ind25_ckmrmultinom5[2,],SD_R0_N5000_Ind25_10yrs_noCKMR[2,],SD_R0_N5000_Ind25_ckmrmultinom10[2,],SD_R0_N5000_Ind25_20yrs_noCKMR[2,],SD_R0_N5000_Ind25_ckmrmultinom20[2,]), ylim=c(0.08,0.2), las=1, main="Flatfish - SD log(R0) - N5000", ylab="SD of log(R0)", xaxt="n")
boxplot(cbind(SD_R0_N5000_Ind25_5yrs_noCKMR[3,],SD_R0_N5000_Ind25_ckmrmultinom5[3,],SD_R0_N5000_Ind25_10yrs_noCKMR[3,],SD_R0_N5000_Ind25_ckmrmultinom10[3,],SD_R0_N5000_Ind25_20yrs_noCKMR[3,],SD_R0_N5000_Ind25_ckmrmultinom20[3,]), ylim=c(0.12,0.25), las=1, main="Sardine - SD log(R0) - N5000", xaxt="n")
axis(side=1, at=1:6, labels=c("5yrs No CKMR","CKMR 5 Years","10yrs No CKMR","CKMR 10 Years","20yrs No CKMR","CKMR 20 Years"))

#Relative to NO CKMR
#No Index
par(mfcol=c(3,3), mar=c(3,4,1,1), oma=c(2,2,1,1))
boxplot(cbind(SD_R0_N100_NoIndex_ckmrmultinom5[1,]/SD_R0_N100_NoIndex_5yrs_noCKMR[1,],SD_R0_N100_NoIndex_ckmrmultinom10[1,]/SD_R0_N100_NoIndex_10yrs_noCKMR[1,],SD_R0_N100_NoIndex_ckmrmultinom20[1,]/SD_R0_N100_NoIndex_20yrs_noCKMR[1,]), ylim=c(0.5,1.05), las=1, main="Cod - SD log(R0) - N100", xaxt="n")
boxplot(cbind(SD_R0_N100_NoIndex_ckmrmultinom5[2,]/SD_R0_N100_NoIndex_5yrs_noCKMR[2,],SD_R0_N100_NoIndex_ckmrmultinom10[2,]/SD_R0_N100_NoIndex_10yrs_noCKMR[2,],SD_R0_N100_NoIndex_ckmrmultinom20[2,]/SD_R0_N100_NoIndex_20yrs_noCKMR[2,]), ylim=c(0.5,1.05), las=1, main="Flatfish - SD log(R0) - N100", ylab="SD of log(R0), relative to NO CKMR", xaxt="n")
boxplot(cbind(SD_R0_N100_NoIndex_ckmrmultinom5[3,]/SD_R0_N100_NoIndex_5yrs_noCKMR[3,],SD_R0_N100_NoIndex_ckmrmultinom10[3,]/SD_R0_N100_NoIndex_10yrs_noCKMR[3,],SD_R0_N100_NoIndex_ckmrmultinom20[3,]/SD_R0_N100_NoIndex_20yrs_noCKMR[3,]), ylim=c(0.5,1.05), las=1, main="Sardine - SD log(R0) - N100", xaxt="n")
axis(side=1, at=1:3, labels=c("CKMR 5 Years","CKMR 10 Years","CKMR 20 Years"))

boxplot(cbind(SD_R0_N1000_NoIndex_ckmrmultinom5[1,]/SD_R0_N1000_NoIndex_5yrs_noCKMR[1,],SD_R0_N1000_NoIndex_ckmrmultinom10[1,]/SD_R0_N1000_NoIndex_10yrs_noCKMR[1,],SD_R0_N1000_NoIndex_ckmrmultinom20[1,]/SD_R0_N1000_NoIndex_20yrs_noCKMR[1,]), ylim=c(0.5,1.05), las=1, main="Cod - SD log(R0) - N1000", xaxt="n")
boxplot(cbind(SD_R0_N1000_NoIndex_ckmrmultinom5[2,]/SD_R0_N1000_NoIndex_5yrs_noCKMR[2,],SD_R0_N1000_NoIndex_ckmrmultinom10[2,]/SD_R0_N1000_NoIndex_10yrs_noCKMR[2,],SD_R0_N1000_NoIndex_ckmrmultinom20[2,]/SD_R0_N1000_NoIndex_20yrs_noCKMR[2,]), ylim=c(0.5,1.05), las=1, main="Flatfish - SD log(R0) - N1000     NO INDEX", ylab="", xaxt="n")
boxplot(cbind(SD_R0_N1000_NoIndex_ckmrmultinom5[3,]/SD_R0_N1000_NoIndex_5yrs_noCKMR[3,],SD_R0_N1000_NoIndex_ckmrmultinom10[3,]/SD_R0_N1000_NoIndex_10yrs_noCKMR[3,],SD_R0_N1000_NoIndex_ckmrmultinom20[3,]/SD_R0_N1000_NoIndex_20yrs_noCKMR[3,]), ylim=c(0.5,1.05), las=1, main="Sardine - SD log(R0) - N1000", xaxt="n")
axis(side=1, at=1:3, labels=c("CKMR 5 Years","CKMR 10 Years","CKMR 20 Years"))

boxplot(cbind(SD_R0_N5000_NoIndex_ckmrmultinom5[1,]/SD_R0_N5000_NoIndex_5yrs_noCKMR[1,],SD_R0_N5000_NoIndex_ckmrmultinom10[1,]/SD_R0_N5000_NoIndex_10yrs_noCKMR[1,],SD_R0_N5000_NoIndex_ckmrmultinom20[1,]/SD_R0_N5000_NoIndex_20yrs_noCKMR[1,]), ylim=c(0.5,1.05), las=1, main="Cod - SD log(R0) - N5000", xaxt="n")
boxplot(cbind(SD_R0_N5000_NoIndex_ckmrmultinom5[2,]/SD_R0_N5000_NoIndex_5yrs_noCKMR[2,],SD_R0_N5000_NoIndex_ckmrmultinom10[2,]/SD_R0_N5000_NoIndex_10yrs_noCKMR[2,],SD_R0_N5000_NoIndex_ckmrmultinom20[2,]/SD_R0_N5000_NoIndex_20yrs_noCKMR[2,]), ylim=c(0.5,1.05), las=1, main="Flatfish - SD log(R0) - N5000", ylab="", xaxt="n")
boxplot(cbind(SD_R0_N5000_NoIndex_ckmrmultinom5[3,]/SD_R0_N5000_NoIndex_5yrs_noCKMR[3,],SD_R0_N5000_NoIndex_ckmrmultinom10[3,]/SD_R0_N5000_NoIndex_10yrs_noCKMR[3,],SD_R0_N5000_NoIndex_ckmrmultinom20[3,]/SD_R0_N5000_NoIndex_20yrs_noCKMR[3,]), ylim=c(0.5,1.05), las=1, main="Sardine - SD log(R0) - N5000", xaxt="n")
axis(side=1, at=1:3, labels=c("CKMR 5 Years","CKMR 10 Years","CKMR 20 Years"))

#Index 0.5
par(mfcol=c(3,3), mar=c(3,4,1,1), oma=c(2,2,1,1))
boxplot(cbind(SD_R0_N100_Ind50_ckmrmultinom5[1,]/SD_R0_N100_Ind50_5yrs_noCKMR[1,],SD_R0_N100_Ind50_ckmrmultinom10[1,]/SD_R0_N100_Ind50_10yrs_noCKMR[1,],SD_R0_N100_Ind50_ckmrmultinom20[1,]/SD_R0_N100_Ind50_20yrs_noCKMR[1,]), ylim=c(0.85,1.05), las=1, main="Cod - SD log(R0) - N100", xaxt="n")
boxplot(cbind(SD_R0_N100_Ind50_ckmrmultinom5[2,]/SD_R0_N100_Ind50_5yrs_noCKMR[2,],SD_R0_N100_Ind50_ckmrmultinom10[2,]/SD_R0_N100_Ind50_10yrs_noCKMR[2,],SD_R0_N100_Ind50_ckmrmultinom20[2,]/SD_R0_N100_Ind50_20yrs_noCKMR[2,]), ylim=c(0.5,1.05), las=1, main="Flatfish - SD log(R0) - N100", ylab="SD of log(R0), relative to NO CKMR", xaxt="n")
boxplot(cbind(SD_R0_N100_Ind50_ckmrmultinom5[3,]/SD_R0_N100_Ind50_5yrs_noCKMR[3,],SD_R0_N100_Ind50_ckmrmultinom10[3,]/SD_R0_N100_Ind50_10yrs_noCKMR[3,],SD_R0_N100_Ind50_ckmrmultinom20[3,]/SD_R0_N100_Ind50_20yrs_noCKMR[3,]), ylim=c(0.65,1.05), las=1, main="Sardine - SD log(R0) - N100", xaxt="n")
axis(side=1, at=1:3, labels=c("CKMR 5 Years","CKMR 10 Years","CKMR 20 Years"))

boxplot(cbind(SD_R0_N1000_Ind50_ckmrmultinom5[1,]/SD_R0_N1000_Ind50_5yrs_noCKMR[1,],SD_R0_N1000_Ind50_ckmrmultinom10[1,]/SD_R0_N1000_Ind50_10yrs_noCKMR[1,],SD_R0_N1000_Ind50_ckmrmultinom20[1,]/SD_R0_N1000_Ind50_20yrs_noCKMR[1,]), ylim=c(0.85,1.05), las=1, main="Cod - SD log(R0) - N1000", xaxt="n")
boxplot(cbind(SD_R0_N1000_Ind50_ckmrmultinom5[2,]/SD_R0_N1000_Ind50_5yrs_noCKMR[2,],SD_R0_N1000_Ind50_ckmrmultinom10[2,]/SD_R0_N1000_Ind50_10yrs_noCKMR[2,],SD_R0_N1000_Ind50_ckmrmultinom20[2,]/SD_R0_N1000_Ind50_20yrs_noCKMR[2,]), ylim=c(0.5,1.05), las=1, main="Flatfish - SD log(R0) - N1000     INDEX 0.50", ylab="", xaxt="n")
boxplot(cbind(SD_R0_N1000_Ind50_ckmrmultinom5[3,]/SD_R0_N1000_Ind50_5yrs_noCKMR[3,],SD_R0_N1000_Ind50_ckmrmultinom10[3,]/SD_R0_N1000_Ind50_10yrs_noCKMR[3,],SD_R0_N1000_Ind50_ckmrmultinom20[3,]/SD_R0_N1000_Ind50_20yrs_noCKMR[3,]), ylim=c(0.65,1.05), las=1, main="Sardine - SD log(R0) - N1000", xaxt="n")
axis(side=1, at=1:3, labels=c("CKMR 5 Years","CKMR 10 Years","CKMR 20 Years"))

boxplot(cbind(SD_R0_N5000_Ind50_ckmrmultinom5[1,]/SD_R0_N5000_Ind50_5yrs_noCKMR[1,],SD_R0_N5000_Ind50_ckmrmultinom10[1,]/SD_R0_N5000_Ind50_10yrs_noCKMR[1,],SD_R0_N5000_Ind50_ckmrmultinom20[1,]/SD_R0_N5000_Ind50_20yrs_noCKMR[1,]), ylim=c(0.85,1.05), las=1, main="Cod - SD log(R0) - N5000", xaxt="n")
boxplot(cbind(SD_R0_N5000_Ind50_ckmrmultinom5[2,]/SD_R0_N5000_Ind50_5yrs_noCKMR[2,],SD_R0_N5000_Ind50_ckmrmultinom10[2,]/SD_R0_N5000_Ind50_10yrs_noCKMR[2,],SD_R0_N5000_Ind50_ckmrmultinom20[2,]/SD_R0_N5000_Ind50_20yrs_noCKMR[2,]), ylim=c(0.5,1.05), las=1, main="Flatfish - SD log(R0) - N5000", ylab="", xaxt="n")
boxplot(cbind(SD_R0_N5000_Ind50_ckmrmultinom5[3,]/SD_R0_N5000_Ind50_5yrs_noCKMR[3,],SD_R0_N5000_Ind50_ckmrmultinom10[3,]/SD_R0_N5000_Ind50_10yrs_noCKMR[3,],SD_R0_N5000_Ind50_ckmrmultinom20[3,]/SD_R0_N5000_Ind50_20yrs_noCKMR[3,]), ylim=c(0.65,1.05), las=1, main="Sardine - SD log(R0) - N5000", xaxt="n")
axis(side=1, at=1:3, labels=c("CKMR 5 Years","CKMR 10 Years","CKMR 20 Years"))

#Index 0.25
par(mfcol=c(3,3), mar=c(3,4,1,1), oma=c(2,2,1,1))
boxplot(cbind(SD_R0_N100_Ind25_ckmrmultinom5[1,]/SD_R0_N100_Ind25_5yrs_noCKMR[1,],SD_R0_N100_Ind25_ckmrmultinom10[1,]/SD_R0_N100_Ind25_10yrs_noCKMR[1,],SD_R0_N100_Ind25_ckmrmultinom20[1,]/SD_R0_N100_Ind25_20yrs_noCKMR[1,]), ylim=c(0.85,1.05), las=1, main="Cod - SD log(R0) - N100", xaxt="n")
boxplot(cbind(SD_R0_N100_Ind25_ckmrmultinom5[2,]/SD_R0_N100_Ind25_5yrs_noCKMR[2,],SD_R0_N100_Ind25_ckmrmultinom10[2,]/SD_R0_N100_Ind25_10yrs_noCKMR[2,],SD_R0_N100_Ind25_ckmrmultinom20[2,]/SD_R0_N100_Ind25_20yrs_noCKMR[2,]), ylim=c(0.5,1.05), las=1, main="Flatfish - SD log(R0) - N100", ylab="SD of log(R0), relative to NO CKMR", xaxt="n")
boxplot(cbind(SD_R0_N100_Ind25_ckmrmultinom5[3,]/SD_R0_N100_Ind25_5yrs_noCKMR[3,],SD_R0_N100_Ind25_ckmrmultinom10[3,]/SD_R0_N100_Ind25_10yrs_noCKMR[3,],SD_R0_N100_Ind25_ckmrmultinom20[3,]/SD_R0_N100_Ind25_20yrs_noCKMR[3,]), ylim=c(0.5,1.05), las=1, main="Sardine - SD log(R0) - N100", xaxt="n")
axis(side=1, at=1:3, labels=c("CKMR 5 Years","CKMR 10 Years","CKMR 20 Years"))

boxplot(cbind(SD_R0_N1000_Ind25_ckmrmultinom5[1,]/SD_R0_N1000_Ind25_5yrs_noCKMR[1,],SD_R0_N1000_Ind25_ckmrmultinom10[1,]/SD_R0_N1000_Ind25_10yrs_noCKMR[1,],SD_R0_N1000_Ind25_ckmrmultinom20[1,]/SD_R0_N1000_Ind25_20yrs_noCKMR[1,]), ylim=c(0.85,1.05), las=1, main="Cod - SD log(R0) - N1000", xaxt="n")
boxplot(cbind(SD_R0_N1000_Ind25_ckmrmultinom5[2,]/SD_R0_N1000_Ind25_5yrs_noCKMR[2,],SD_R0_N1000_Ind25_ckmrmultinom10[2,]/SD_R0_N1000_Ind25_10yrs_noCKMR[2,],SD_R0_N1000_Ind25_ckmrmultinom20[2,]/SD_R0_N1000_Ind25_20yrs_noCKMR[2,]), ylim=c(0.5,1.05), las=1, main="Flatfish - SD log(R0) - N1000     INDEX 0.25", ylab="", xaxt="n")
boxplot(cbind(SD_R0_N1000_Ind25_ckmrmultinom5[3,]/SD_R0_N1000_Ind25_5yrs_noCKMR[3,],SD_R0_N1000_Ind25_ckmrmultinom10[3,]/SD_R0_N1000_Ind25_10yrs_noCKMR[3,],SD_R0_N1000_Ind25_ckmrmultinom20[3,]/SD_R0_N1000_Ind25_20yrs_noCKMR[3,]), ylim=c(0.5,1.05), las=1, main="Sardine - SD log(R0) - N1000", xaxt="n")
axis(side=1, at=1:3, labels=c("CKMR 5 Years","CKMR 10 Years","CKMR 20 Years"))

boxplot(cbind(SD_R0_N5000_Ind25_ckmrmultinom5[1,]/SD_R0_N5000_Ind25_5yrs_noCKMR[1,],SD_R0_N5000_Ind25_ckmrmultinom10[1,]/SD_R0_N5000_Ind25_10yrs_noCKMR[1,],SD_R0_N5000_Ind25_ckmrmultinom20[1,]/SD_R0_N5000_Ind25_20yrs_noCKMR[1,]), ylim=c(0.85,1.05), las=1, main="Cod - SD log(R0) - N5000", xaxt="n")
boxplot(cbind(SD_R0_N5000_Ind25_ckmrmultinom5[2,]/SD_R0_N5000_Ind25_5yrs_noCKMR[2,],SD_R0_N5000_Ind25_ckmrmultinom10[2,]/SD_R0_N5000_Ind25_10yrs_noCKMR[2,],SD_R0_N5000_Ind25_ckmrmultinom20[2,]/SD_R0_N5000_Ind25_20yrs_noCKMR[2,]), ylim=c(0.5,1.05), las=1, main="Flatfish - SD log(R0) - N5000", ylab="", xaxt="n")
boxplot(cbind(SD_R0_N5000_Ind25_ckmrmultinom5[3,]/SD_R0_N5000_Ind25_5yrs_noCKMR[3,],SD_R0_N5000_Ind25_ckmrmultinom10[3,]/SD_R0_N5000_Ind25_10yrs_noCKMR[3,],SD_R0_N5000_Ind25_ckmrmultinom20[3,]/SD_R0_N5000_Ind25_20yrs_noCKMR[3,]), ylim=c(0.5,1.05), las=1, main="Sardine - SD log(R0) - N5000", xaxt="n")
axis(side=1, at=1:3, labels=c("CKMR 5 Years","CKMR 10 Years","CKMR 20 Years"))

###########################
#Natural Mortality
###########################

#No Index
par(mfcol=c(3,3), mar=c(3,4,1,1), oma=c(2,2,1,1))
boxplot(cbind(SD_M_N100_NoIndex_5yrs_noCKMR[1,],SD_M_N100_NoIndex_ckmrmultinom5[1,],SD_M_N100_NoIndex_10yrs_noCKMR[1,],SD_M_N100_NoIndex_ckmrmultinom10[1,],SD_M_N100_NoIndex_20yrs_noCKMR[1,],SD_M_N100_NoIndex_ckmrmultinom20[1,]), ylim=c(0.04,0.8), las=1, main="Cod - SD log(M) - N100", xaxt="n")
boxplot(cbind(SD_M_N100_NoIndex_5yrs_noCKMR[2,],SD_M_N100_NoIndex_ckmrmultinom5[2,],SD_M_N100_NoIndex_10yrs_noCKMR[2,],SD_M_N100_NoIndex_ckmrmultinom10[2,],SD_M_N100_NoIndex_20yrs_noCKMR[2,],SD_M_N100_NoIndex_ckmrmultinom20[2,]), ylim=c(0.02,0.12), las=1, main="Flatfish - SD log(M) - N100", ylab="SD of log(M)", xaxt="n")
boxplot(cbind(SD_M_N100_NoIndex_5yrs_noCKMR[3,],SD_M_N100_NoIndex_ckmrmultinom5[3,],SD_M_N100_NoIndex_10yrs_noCKMR[3,],SD_M_N100_NoIndex_ckmrmultinom10[3,],SD_M_N100_NoIndex_20yrs_noCKMR[3,],SD_M_N100_NoIndex_ckmrmultinom20[3,]), ylim=c(0.025,0.12), las=1, main="Sardine - SD log(M) - N100", xaxt="n")
axis(side=1, at=1:6, labels=c("5yrs No CKMR","CKMR 5 Years","10yrs No CKMR","CKMR 10 Years","20yrs No CKMR","CKMR 20 Years"))

boxplot(cbind(SD_M_N1000_NoIndex_5yrs_noCKMR[1,],SD_M_N1000_NoIndex_ckmrmultinom5[1,],SD_M_N1000_NoIndex_10yrs_noCKMR[1,],SD_M_N1000_NoIndex_ckmrmultinom10[1,],SD_M_N1000_NoIndex_20yrs_noCKMR[1,],SD_M_N1000_NoIndex_ckmrmultinom20[1,]), ylim=c(0.04,0.8), las=1, main="Cod - SD log(M) - N1000", xaxt="n")
boxplot(cbind(SD_M_N1000_NoIndex_5yrs_noCKMR[2,],SD_M_N1000_NoIndex_ckmrmultinom5[2,],SD_M_N1000_NoIndex_10yrs_noCKMR[2,],SD_M_N1000_NoIndex_ckmrmultinom10[2,],SD_M_N1000_NoIndex_20yrs_noCKMR[2,],SD_M_N1000_NoIndex_ckmrmultinom20[2,]), ylim=c(0.02,0.12), las=1, main="Flatfish - SD log(M) - N1000    NO INDEX", ylab="SD of log(M)", xaxt="n")
boxplot(cbind(SD_M_N1000_NoIndex_5yrs_noCKMR[3,],SD_M_N1000_NoIndex_ckmrmultinom5[3,],SD_M_N1000_NoIndex_10yrs_noCKMR[3,],SD_M_N1000_NoIndex_ckmrmultinom10[3,],SD_M_N1000_NoIndex_20yrs_noCKMR[3,],SD_M_N1000_NoIndex_ckmrmultinom20[3,]), ylim=c(0.025,0.12), las=1, main="Sardine - SD log(M) - N1000", xaxt="n")
axis(side=1, at=1:6, labels=c("5yrs No CKMR","CKMR 5 Years","10yrs No CKMR","CKMR 10 Years","20yrs No CKMR","CKMR 20 Years"))

boxplot(cbind(SD_M_N5000_NoIndex_5yrs_noCKMR[1,],SD_M_N5000_NoIndex_ckmrmultinom5[1,],SD_M_N5000_NoIndex_10yrs_noCKMR[1,],SD_M_N5000_NoIndex_ckmrmultinom10[1,],SD_M_N5000_NoIndex_20yrs_noCKMR[1,],SD_M_N5000_NoIndex_ckmrmultinom20[1,]), ylim=c(0.04,0.8), las=1, main="Cod - SD log(M) - N5000", xaxt="n")
boxplot(cbind(SD_M_N5000_NoIndex_5yrs_noCKMR[2,],SD_M_N5000_NoIndex_ckmrmultinom5[2,],SD_M_N5000_NoIndex_10yrs_noCKMR[2,],SD_M_N5000_NoIndex_ckmrmultinom10[2,],SD_M_N5000_NoIndex_20yrs_noCKMR[2,],SD_M_N5000_NoIndex_ckmrmultinom20[2,]), ylim=c(0.02,0.12), las=1, main="Flatfish - SD log(M) - N5000", ylab="SD of log(M)", xaxt="n")
boxplot(cbind(SD_M_N5000_NoIndex_5yrs_noCKMR[3,],SD_M_N5000_NoIndex_ckmrmultinom5[3,],SD_M_N5000_NoIndex_10yrs_noCKMR[3,],SD_M_N5000_NoIndex_ckmrmultinom10[3,],SD_M_N5000_NoIndex_20yrs_noCKMR[3,],SD_M_N5000_NoIndex_ckmrmultinom20[3,]), ylim=c(0.025,0.12), las=1, main="Sardine - SD log(M) - N5000", xaxt="n")
axis(side=1, at=1:6, labels=c("5yrs No CKMR","CKMR 5 Years","10yrs No CKMR","CKMR 10 Years","20yrs No CKMR","CKMR 20 Years"))

#Index 0.50
par(mfcol=c(3,3), mar=c(3,4,1,1), oma=c(2,2,1,1))
boxplot(cbind(SD_M_N100_Ind50_5yrs_noCKMR[1,],SD_M_N100_Ind50_ckmrmultinom5[1,],SD_M_N100_Ind50_10yrs_noCKMR[1,],SD_M_N100_Ind50_ckmrmultinom10[1,],SD_M_N100_Ind50_20yrs_noCKMR[1,],SD_M_N100_Ind50_ckmrmultinom20[1,]), ylim=c(0.04,0.07), las=1, main="Cod - SD log(M) - N100", xaxt="n")
boxplot(cbind(SD_M_N100_Ind50_5yrs_noCKMR[2,],SD_M_N100_Ind50_ckmrmultinom5[2,],SD_M_N100_Ind50_10yrs_noCKMR[2,],SD_M_N100_Ind50_ckmrmultinom10[2,],SD_M_N100_Ind50_20yrs_noCKMR[2,],SD_M_N100_Ind50_ckmrmultinom20[2,]), ylim=c(0.019,0.1), las=1, main="Flatfish - SD log(M) - N100", ylab="SD of log(M)", xaxt="n")
boxplot(cbind(SD_M_N100_Ind50_5yrs_noCKMR[3,],SD_M_N100_Ind50_ckmrmultinom5[3,],SD_M_N100_Ind50_10yrs_noCKMR[3,],SD_M_N100_Ind50_ckmrmultinom10[3,],SD_M_N100_Ind50_20yrs_noCKMR[3,],SD_M_N100_Ind50_ckmrmultinom20[3,]), ylim=c(0.025,0.1), las=1, main="Sardine - SD log(M) - N100", xaxt="n")
axis(side=1, at=1:6, labels=c("5yrs No CKMR","CKMR 5 Years","10yrs No CKMR","CKMR 10 Years","20yrs No CKMR","CKMR 20 Years"))

boxplot(cbind(SD_M_N1000_Ind50_5yrs_noCKMR[1,],SD_M_N1000_Ind50_ckmrmultinom5[1,],SD_M_N1000_Ind50_10yrs_noCKMR[1,],SD_M_N1000_Ind50_ckmrmultinom10[1,],SD_M_N1000_Ind50_20yrs_noCKMR[1,],SD_M_N1000_Ind50_ckmrmultinom20[1,]), ylim=c(0.04,0.07), las=1, main="Cod - SD log(M) - N1000", xaxt="n")
boxplot(cbind(SD_M_N1000_Ind50_5yrs_noCKMR[2,],SD_M_N1000_Ind50_ckmrmultinom5[2,],SD_M_N1000_Ind50_10yrs_noCKMR[2,],SD_M_N1000_Ind50_ckmrmultinom10[2,],SD_M_N1000_Ind50_20yrs_noCKMR[2,],SD_M_N1000_Ind50_ckmrmultinom20[2,]), ylim=c(0.019,0.1), las=1, main="Flatfish - SD log(M) - N1000    INDEX-0.50", ylab="SD of log(M)", xaxt="n")
boxplot(cbind(SD_M_N1000_Ind50_5yrs_noCKMR[3,],SD_M_N1000_Ind50_ckmrmultinom5[3,],SD_M_N1000_Ind50_10yrs_noCKMR[3,],SD_M_N1000_Ind50_ckmrmultinom10[3,],SD_M_N1000_Ind50_20yrs_noCKMR[3,],SD_M_N1000_Ind50_ckmrmultinom20[3,]), ylim=c(0.025,0.1), las=1, main="Sardine - SD log(M) - N1000", xaxt="n")
axis(side=1, at=1:6, labels=c("5yrs No CKMR","CKMR 5 Years","10yrs No CKMR","CKMR 10 Years","20yrs No CKMR","CKMR 20 Years"))

boxplot(cbind(SD_M_N5000_Ind50_5yrs_noCKMR[1,],SD_M_N5000_Ind50_ckmrmultinom5[1,],SD_M_N5000_Ind50_10yrs_noCKMR[1,],SD_M_N5000_Ind50_ckmrmultinom10[1,],SD_M_N5000_Ind50_20yrs_noCKMR[1,],SD_M_N5000_Ind50_ckmrmultinom20[1,]), ylim=c(0.04,0.07), las=1, main="Cod - SD log(M) - N5000", xaxt="n")
boxplot(cbind(SD_M_N5000_Ind50_5yrs_noCKMR[2,],SD_M_N5000_Ind50_ckmrmultinom5[2,],SD_M_N5000_Ind50_10yrs_noCKMR[2,],SD_M_N5000_Ind50_ckmrmultinom10[2,],SD_M_N5000_Ind50_20yrs_noCKMR[2,],SD_M_N5000_Ind50_ckmrmultinom20[2,]), ylim=c(0.019,0.1), las=1, main="Flatfish - SD log(M) - N5000", ylab="SD of log(M)", xaxt="n")
boxplot(cbind(SD_M_N5000_Ind50_5yrs_noCKMR[3,],SD_M_N5000_Ind50_ckmrmultinom5[3,],SD_M_N5000_Ind50_10yrs_noCKMR[3,],SD_M_N5000_Ind50_ckmrmultinom10[3,],SD_M_N5000_Ind50_20yrs_noCKMR[3,],SD_M_N5000_Ind50_ckmrmultinom20[3,]), ylim=c(0.025,0.1), las=1, main="Sardine - SD log(M) - N5000", xaxt="n")
axis(side=1, at=1:6, labels=c("5yrs No CKMR","CKMR 5 Years","10yrs No CKMR","CKMR 10 Years","20yrs No CKMR","CKMR 20 Years"))

#Index 0.25
par(mfcol=c(3,3), mar=c(3,4,1,1), oma=c(2,2,1,1))
boxplot(cbind(SD_M_N100_Ind25_5yrs_noCKMR[1,],SD_M_N100_Ind25_ckmrmultinom5[1,],SD_M_N100_Ind25_10yrs_noCKMR[1,],SD_M_N100_Ind25_ckmrmultinom10[1,],SD_M_N100_Ind25_20yrs_noCKMR[1,],SD_M_N100_Ind25_ckmrmultinom20[1,]), ylim=c(0.04,0.06), las=1, main="Cod - SD log(M) - N100", xaxt="n")
boxplot(cbind(SD_M_N100_Ind25_5yrs_noCKMR[2,],SD_M_N100_Ind25_ckmrmultinom5[2,],SD_M_N100_Ind25_10yrs_noCKMR[2,],SD_M_N100_Ind25_ckmrmultinom10[2,],SD_M_N100_Ind25_20yrs_noCKMR[2,],SD_M_N100_Ind25_ckmrmultinom20[2,]), ylim=c(0.019,0.1), las=1, main="Flatfish - SD log(M) - N100", ylab="SD of log(M)", xaxt="n")
boxplot(cbind(SD_M_N100_Ind25_5yrs_noCKMR[3,],SD_M_N100_Ind25_ckmrmultinom5[3,],SD_M_N100_Ind25_10yrs_noCKMR[3,],SD_M_N100_Ind25_ckmrmultinom10[3,],SD_M_N100_Ind25_20yrs_noCKMR[3,],SD_M_N100_Ind25_ckmrmultinom20[3,]), ylim=c(0.025,0.1), las=1, main="Sardine - SD log(M) - N100", xaxt="n")
axis(side=1, at=1:6, labels=c("5yrs No CKMR","CKMR 5 Years","10yrs No CKMR","CKMR 10 Years","20yrs No CKMR","CKMR 20 Years"))

boxplot(cbind(SD_M_N1000_Ind25_5yrs_noCKMR[1,],SD_M_N1000_Ind25_ckmrmultinom5[1,],SD_M_N1000_Ind25_10yrs_noCKMR[1,],SD_M_N1000_Ind25_ckmrmultinom10[1,],SD_M_N1000_Ind25_20yrs_noCKMR[1,],SD_M_N1000_Ind25_ckmrmultinom20[1,]), ylim=c(0.04,0.06), las=1, main="Cod - SD log(M) - N1000", xaxt="n")
boxplot(cbind(SD_M_N1000_Ind25_5yrs_noCKMR[2,],SD_M_N1000_Ind25_ckmrmultinom5[2,],SD_M_N1000_Ind25_10yrs_noCKMR[2,],SD_M_N1000_Ind25_ckmrmultinom10[2,],SD_M_N1000_Ind25_20yrs_noCKMR[2,],SD_M_N1000_Ind25_ckmrmultinom20[2,]), ylim=c(0.019,0.1), las=1, main="Flatfish - SD log(M) - N1000    INDEX-0.25", ylab="SD of log(M)", xaxt="n")
boxplot(cbind(SD_M_N1000_Ind25_5yrs_noCKMR[3,],SD_M_N1000_Ind25_ckmrmultinom5[3,],SD_M_N1000_Ind25_10yrs_noCKMR[3,],SD_M_N1000_Ind25_ckmrmultinom10[3,],SD_M_N1000_Ind25_20yrs_noCKMR[3,],SD_M_N1000_Ind25_ckmrmultinom20[3,]), ylim=c(0.025,0.1), las=1, main="Sardine - SD log(M) - N1000", xaxt="n")
axis(side=1, at=1:6, labels=c("5yrs No CKMR","CKMR 5 Years","10yrs No CKMR","CKMR 10 Years","20yrs No CKMR","CKMR 20 Years"))

boxplot(cbind(SD_M_N5000_Ind25_5yrs_noCKMR[1,],SD_M_N5000_Ind25_ckmrmultinom5[1,],SD_M_N5000_Ind25_10yrs_noCKMR[1,],SD_M_N5000_Ind25_ckmrmultinom10[1,],SD_M_N5000_Ind25_20yrs_noCKMR[1,],SD_M_N5000_Ind25_ckmrmultinom20[1,]), ylim=c(0.04,0.06), las=1, main="Cod - SD log(M) - N5000", xaxt="n")
boxplot(cbind(SD_M_N5000_Ind25_5yrs_noCKMR[2,],SD_M_N5000_Ind25_ckmrmultinom5[2,],SD_M_N5000_Ind25_10yrs_noCKMR[2,],SD_M_N5000_Ind25_ckmrmultinom10[2,],SD_M_N5000_Ind25_20yrs_noCKMR[2,],SD_M_N5000_Ind25_ckmrmultinom20[2,]), ylim=c(0.019,0.1), las=1, main="Flatfish - SD log(M) - N5000", ylab="SD of log(M)", xaxt="n")
boxplot(cbind(SD_M_N5000_Ind25_5yrs_noCKMR[3,],SD_M_N5000_Ind25_ckmrmultinom5[3,],SD_M_N5000_Ind25_10yrs_noCKMR[3,],SD_M_N5000_Ind25_ckmrmultinom10[3,],SD_M_N5000_Ind25_20yrs_noCKMR[3,],SD_M_N5000_Ind25_ckmrmultinom20[3,]), ylim=c(0.025,0.1), las=1, main="Sardine - SD log(M) - N5000", xaxt="n")
axis(side=1, at=1:6, labels=c("5yrs No CKMR","CKMR 5 Years","10yrs No CKMR","CKMR 10 Years","20yrs No CKMR","CKMR 20 Years"))

#Relative to NO CKMR
#No Index
par(mfcol=c(3,3), mar=c(3,4,1,1), oma=c(2,2,1,1))
boxplot(cbind(SD_M_N100_NoIndex_ckmrmultinom5[1,]/SD_M_N100_NoIndex_5yrs_noCKMR[1,],SD_M_N100_NoIndex_ckmrmultinom10[1,]/SD_M_N100_NoIndex_10yrs_noCKMR[1,],SD_M_N100_NoIndex_ckmrmultinom20[1,]/SD_M_N100_NoIndex_20yrs_noCKMR[1,]), ylim=c(0.8,1.05), las=1, main="Cod - SD log(M) - N100", xaxt="n")
boxplot(cbind(SD_M_N100_NoIndex_ckmrmultinom5[2,]/SD_M_N100_NoIndex_5yrs_noCKMR[2,],SD_M_N100_NoIndex_ckmrmultinom10[2,]/SD_M_N100_NoIndex_10yrs_noCKMR[2,],SD_M_N100_NoIndex_ckmrmultinom20[2,]/SD_M_N100_NoIndex_20yrs_noCKMR[2,]), ylim=c(0.1,1.05), las=1, main="Flatfish - SD log(M) - N100", ylab="SD of log(M), relative to NO CKMR", xaxt="n")
boxplot(cbind(SD_M_N100_NoIndex_ckmrmultinom5[3,]/SD_M_N100_NoIndex_5yrs_noCKMR[3,],SD_M_N100_NoIndex_ckmrmultinom10[3,]/SD_M_N100_NoIndex_10yrs_noCKMR[3,],SD_M_N100_NoIndex_ckmrmultinom20[3,]/SD_M_N100_NoIndex_20yrs_noCKMR[3,]), ylim=c(0.2,1.05), las=1, main="Sardine - SD log(M) - N100", xaxt="n")
axis(side=1, at=1:3, labels=c("CKMR 5 Years","CKMR 10 Years","CKMR 20 Years"))

boxplot(cbind(SD_M_N1000_NoIndex_ckmrmultinom5[1,]/SD_M_N1000_NoIndex_5yrs_noCKMR[1,],SD_M_N1000_NoIndex_ckmrmultinom10[1,]/SD_M_N1000_NoIndex_10yrs_noCKMR[1,],SD_M_N1000_NoIndex_ckmrmultinom20[1,]/SD_M_N1000_NoIndex_20yrs_noCKMR[1,]), ylim=c(0.8,1.05), las=1, main="Cod - SD log(M) - N1000", xaxt="n")
boxplot(cbind(SD_M_N1000_NoIndex_ckmrmultinom5[2,]/SD_M_N1000_NoIndex_5yrs_noCKMR[2,],SD_M_N1000_NoIndex_ckmrmultinom10[2,]/SD_M_N1000_NoIndex_10yrs_noCKMR[2,],SD_M_N1000_NoIndex_ckmrmultinom20[2,]/SD_M_N1000_NoIndex_20yrs_noCKMR[2,]), ylim=c(0.1,1.05), las=1, main="Flatfish - SD log(M) - N1000    NO INDEX", ylab="", xaxt="n")
boxplot(cbind(SD_M_N1000_NoIndex_ckmrmultinom5[3,]/SD_M_N1000_NoIndex_5yrs_noCKMR[3,],SD_M_N1000_NoIndex_ckmrmultinom10[3,]/SD_M_N1000_NoIndex_10yrs_noCKMR[3,],SD_M_N1000_NoIndex_ckmrmultinom20[3,]/SD_M_N1000_NoIndex_20yrs_noCKMR[3,]), ylim=c(0.2,1.05), las=1, main="Sardine - SD log(M) - N1000", xaxt="n")
axis(side=1, at=1:3, labels=c("CKMR 5 Years","CKMR 10 Years","CKMR 20 Years"))

boxplot(cbind(SD_M_N5000_NoIndex_ckmrmultinom5[1,]/SD_M_N5000_NoIndex_5yrs_noCKMR[1,],SD_M_N5000_NoIndex_ckmrmultinom10[1,]/SD_M_N5000_NoIndex_10yrs_noCKMR[1,],SD_M_N5000_NoIndex_ckmrmultinom20[1,]/SD_M_N5000_NoIndex_20yrs_noCKMR[1,]), ylim=c(0.8,1.05), las=1, main="Cod - SD log(M) - N5000", xaxt="n")
boxplot(cbind(SD_M_N5000_NoIndex_ckmrmultinom5[2,]/SD_M_N5000_NoIndex_5yrs_noCKMR[2,],SD_M_N5000_NoIndex_ckmrmultinom10[2,]/SD_M_N5000_NoIndex_10yrs_noCKMR[2,],SD_M_N5000_NoIndex_ckmrmultinom20[2,]/SD_M_N5000_NoIndex_20yrs_noCKMR[2,]), ylim=c(0.1,1.05), las=1, main="Flatfish - SD log(M) - N5000", ylab="", xaxt="n")
boxplot(cbind(SD_M_N5000_NoIndex_ckmrmultinom5[3,]/SD_M_N5000_NoIndex_5yrs_noCKMR[3,],SD_M_N5000_NoIndex_ckmrmultinom10[3,]/SD_M_N5000_NoIndex_10yrs_noCKMR[3,],SD_M_N5000_NoIndex_ckmrmultinom20[3,]/SD_M_N5000_NoIndex_20yrs_noCKMR[3,]), ylim=c(0.2,1.05), las=1, main="Sardine - SD log(M) - N5000", xaxt="n")
axis(side=1, at=1:3, labels=c("CKMR 5 Years","CKMR 10 Years","CKMR 20 Years"))

#Index 0.50
par(mfcol=c(3,3), mar=c(3,4,1,1), oma=c(2,2,1,1))
boxplot(cbind(SD_M_N100_Ind50_ckmrmultinom5[1,]/SD_M_N100_Ind50_5yrs_noCKMR[1,],SD_M_N100_Ind50_ckmrmultinom10[1,]/SD_M_N100_Ind50_10yrs_noCKMR[1,],SD_M_N100_Ind50_ckmrmultinom20[1,]/SD_M_N100_Ind50_20yrs_noCKMR[1,]), ylim=c(0.8,1.05), las=1, main="Cod - SD log(M) - N100", xaxt="n")
boxplot(cbind(SD_M_N100_Ind50_ckmrmultinom5[2,]/SD_M_N100_Ind50_5yrs_noCKMR[2,],SD_M_N100_Ind50_ckmrmultinom10[2,]/SD_M_N100_Ind50_10yrs_noCKMR[2,],SD_M_N100_Ind50_ckmrmultinom20[2,]/SD_M_N100_Ind50_20yrs_noCKMR[2,]), ylim=c(0.1,1.05), las=1, main="Flatfish - SD log(M) - N100", ylab="SD of log(M), relative to NO CKMR", xaxt="n")
boxplot(cbind(SD_M_N100_Ind50_ckmrmultinom5[3,]/SD_M_N100_Ind50_5yrs_noCKMR[3,],SD_M_N100_Ind50_ckmrmultinom10[3,]/SD_M_N100_Ind50_10yrs_noCKMR[3,],SD_M_N100_Ind50_ckmrmultinom20[3,]/SD_M_N100_Ind50_20yrs_noCKMR[3,]), ylim=c(0.25,1.05), las=1, main="Sardine - SD log(M) - N100", xaxt="n")
axis(side=1, at=1:3, labels=c("CKMR 5 Years","CKMR 10 Years","CKMR 20 Years"))

boxplot(cbind(SD_M_N1000_Ind50_ckmrmultinom5[1,]/SD_M_N1000_Ind50_5yrs_noCKMR[1,],SD_M_N1000_Ind50_ckmrmultinom10[1,]/SD_M_N1000_Ind50_10yrs_noCKMR[1,],SD_M_N1000_Ind50_ckmrmultinom20[1,]/SD_M_N1000_Ind50_20yrs_noCKMR[1,]), ylim=c(0.8,1.05), las=1, main="Cod - SD log(M) - N1000", xaxt="n")
boxplot(cbind(SD_M_N1000_Ind50_ckmrmultinom5[2,]/SD_M_N1000_Ind50_5yrs_noCKMR[2,],SD_M_N1000_Ind50_ckmrmultinom10[2,]/SD_M_N1000_Ind50_10yrs_noCKMR[2,],SD_M_N1000_Ind50_ckmrmultinom20[2,]/SD_M_N1000_Ind50_20yrs_noCKMR[2,]), ylim=c(0.1,1.05), las=1, main="Flatfish - SD log(M) - N1000    Index-0.50", ylab="", xaxt="n")
boxplot(cbind(SD_M_N1000_Ind50_ckmrmultinom5[3,]/SD_M_N1000_Ind50_5yrs_noCKMR[3,],SD_M_N1000_Ind50_ckmrmultinom10[3,]/SD_M_N1000_Ind50_10yrs_noCKMR[3,],SD_M_N1000_Ind50_ckmrmultinom20[3,]/SD_M_N1000_Ind50_20yrs_noCKMR[3,]), ylim=c(0.25,1.05), las=1, main="Sardine - SD log(M) - N1000", xaxt="n")
axis(side=1, at=1:3, labels=c("CKMR 5 Years","CKMR 10 Years","CKMR 20 Years"))

boxplot(cbind(SD_M_N5000_Ind50_ckmrmultinom5[1,]/SD_M_N5000_Ind50_5yrs_noCKMR[1,],SD_M_N5000_Ind50_ckmrmultinom10[1,]/SD_M_N5000_Ind50_10yrs_noCKMR[1,],SD_M_N5000_Ind50_ckmrmultinom20[1,]/SD_M_N5000_Ind50_20yrs_noCKMR[1,]), ylim=c(0.8,1.05), las=1, main="Cod - SD log(M) - N5000", xaxt="n")
boxplot(cbind(SD_M_N5000_Ind50_ckmrmultinom5[2,]/SD_M_N5000_Ind50_5yrs_noCKMR[2,],SD_M_N5000_Ind50_ckmrmultinom10[2,]/SD_M_N5000_Ind50_10yrs_noCKMR[2,],SD_M_N5000_Ind50_ckmrmultinom20[2,]/SD_M_N5000_Ind50_20yrs_noCKMR[2,]), ylim=c(0.1,1.05), las=1, main="Flatfish - SD log(M) - N5000", ylab="", xaxt="n")
boxplot(cbind(SD_M_N5000_Ind50_ckmrmultinom5[3,]/SD_M_N5000_Ind50_5yrs_noCKMR[3,],SD_M_N5000_Ind50_ckmrmultinom10[3,]/SD_M_N5000_Ind50_10yrs_noCKMR[3,],SD_M_N5000_Ind50_ckmrmultinom20[3,]/SD_M_N5000_Ind50_20yrs_noCKMR[3,]), ylim=c(0.25,1.05), las=1, main="Sardine - SD log(M) - N5000", xaxt="n")
axis(side=1, at=1:3, labels=c("CKMR 5 Years","CKMR 10 Years","CKMR 20 Years"))

#Index 0.25
par(mfcol=c(3,3), mar=c(3,4,1,1), oma=c(2,2,1,1))
boxplot(cbind(SD_M_N100_Ind25_ckmrmultinom5[1,]/SD_M_N100_Ind25_5yrs_noCKMR[1,],SD_M_N100_Ind25_ckmrmultinom10[1,]/SD_M_N100_Ind25_10yrs_noCKMR[1,],SD_M_N100_Ind25_ckmrmultinom20[1,]/SD_M_N100_Ind25_20yrs_noCKMR[1,]), ylim=c(0.85,1.05), las=1, main="Cod - SD log(M) - N100", xaxt="n")
boxplot(cbind(SD_M_N100_Ind25_ckmrmultinom5[2,]/SD_M_N100_Ind25_5yrs_noCKMR[2,],SD_M_N100_Ind25_ckmrmultinom10[2,]/SD_M_N100_Ind25_10yrs_noCKMR[2,],SD_M_N100_Ind25_ckmrmultinom20[2,]/SD_M_N100_Ind25_20yrs_noCKMR[2,]), ylim=c(0.1,1.05), las=1, main="Flatfish - SD log(M) - N100", ylab="SD of log(M), relative to NO CKMR", xaxt="n")
boxplot(cbind(SD_M_N100_Ind25_ckmrmultinom5[3,]/SD_M_N100_Ind25_5yrs_noCKMR[3,],SD_M_N100_Ind25_ckmrmultinom10[3,]/SD_M_N100_Ind25_10yrs_noCKMR[3,],SD_M_N100_Ind25_ckmrmultinom20[3,]/SD_M_N100_Ind25_20yrs_noCKMR[3,]), ylim=c(0.25,1.05), las=1, main="Sardine - SD log(M) - N100", xaxt="n")
axis(side=1, at=1:3, labels=c("CKMR 5 Years","CKMR 10 Years","CKMR 20 Years"))

boxplot(cbind(SD_M_N1000_Ind25_ckmrmultinom5[1,]/SD_M_N1000_Ind25_5yrs_noCKMR[1,],SD_M_N1000_Ind25_ckmrmultinom10[1,]/SD_M_N1000_Ind25_10yrs_noCKMR[1,],SD_M_N1000_Ind25_ckmrmultinom20[1,]/SD_M_N1000_Ind25_20yrs_noCKMR[1,]), ylim=c(0.85,1.05), las=1, main="Cod - SD log(M) - N1000", xaxt="n")
boxplot(cbind(SD_M_N1000_Ind25_ckmrmultinom5[2,]/SD_M_N1000_Ind25_5yrs_noCKMR[2,],SD_M_N1000_Ind25_ckmrmultinom10[2,]/SD_M_N1000_Ind25_10yrs_noCKMR[2,],SD_M_N1000_Ind25_ckmrmultinom20[2,]/SD_M_N1000_Ind25_20yrs_noCKMR[2,]), ylim=c(0.1,1.05), las=1, main="Flatfish - SD log(M) - N1000   Index-0.25", ylab="", xaxt="n")
boxplot(cbind(SD_M_N1000_Ind25_ckmrmultinom5[3,]/SD_M_N1000_Ind25_5yrs_noCKMR[3,],SD_M_N1000_Ind25_ckmrmultinom10[3,]/SD_M_N1000_Ind25_10yrs_noCKMR[3,],SD_M_N1000_Ind25_ckmrmultinom20[3,]/SD_M_N1000_Ind25_20yrs_noCKMR[3,]), ylim=c(0.25,1.05), las=1, main="Sardine - SD log(M) - N1000", xaxt="n")
axis(side=1, at=1:3, labels=c("CKMR 5 Years","CKMR 10 Years","CKMR 20 Years"))

boxplot(cbind(SD_M_N5000_Ind25_ckmrmultinom5[1,]/SD_M_N5000_Ind25_5yrs_noCKMR[1,],SD_M_N5000_Ind25_ckmrmultinom10[1,]/SD_M_N5000_Ind25_10yrs_noCKMR[1,],SD_M_N5000_Ind25_ckmrmultinom20[1,]/SD_M_N5000_Ind25_20yrs_noCKMR[1,]), ylim=c(0.85,1.05), las=1, main="Cod - SD log(M) - N5000", xaxt="n")
boxplot(cbind(SD_M_N5000_Ind25_ckmrmultinom5[2,]/SD_M_N5000_Ind25_5yrs_noCKMR[2,],SD_M_N5000_Ind25_ckmrmultinom10[2,]/SD_M_N5000_Ind25_10yrs_noCKMR[2,],SD_M_N5000_Ind25_ckmrmultinom20[2,]/SD_M_N5000_Ind25_20yrs_noCKMR[2,]), ylim=c(0.1,1.05), las=1, main="Flatfish - SD log(M) - N5000", ylab="", xaxt="n")
boxplot(cbind(SD_M_N5000_Ind25_ckmrmultinom5[3,]/SD_M_N5000_Ind25_5yrs_noCKMR[3,],SD_M_N5000_Ind25_ckmrmultinom10[3,]/SD_M_N5000_Ind25_10yrs_noCKMR[3,],SD_M_N5000_Ind25_ckmrmultinom20[3,]/SD_M_N5000_Ind25_20yrs_noCKMR[3,]), ylim=c(0.25,1.05), las=1, main="Sardine - SD log(M) - N5000", xaxt="n")
axis(side=1, at=1:3, labels=c("CKMR 5 Years","CKMR 10 Years","CKMR 20 Years"))

##########################################
#SD of point estimates between sims
##########################################
#No Index
par(mfcol=c(3,3), mar=c(3,4,1,1), oma=c(2,2,1,1))
plot(sd_RE_ssb_N100_NoIndex_5yrs_noCKMR[1,], pch=16, ylim=c(0,0.35), las=1, ylab="", main="Cod - N100")
points(sd_RE_ssb_N100_NoIndex_10yrs_noCKMR[1,], pch=16, col=2)
points(sd_RE_ssb_N100_NoIndex_20yrs_noCKMR[1,], pch=16, col=3)
points(sd_RE_ssb_N100_NoIndex_ckmrmultinom5[1,], pch=16, col=4)
points(sd_RE_ssb_N100_NoIndex_ckmrmultinom10[1,], pch=16, col=5)
points(sd_RE_ssb_N100_NoIndex_ckmrmultinom20[1,], pch=16, col=6)
plot(sd_RE_ssb_N100_NoIndex_5yrs_noCKMR[2,], pch=16, ylim=c(0,0.35), las=1, ylab="SD SSB RE", main="Flatfish - N100")
points(sd_RE_ssb_N100_NoIndex_10yrs_noCKMR[2,], pch=16, col=2)
points(sd_RE_ssb_N100_NoIndex_20yrs_noCKMR[2,], pch=16, col=3)
points(sd_RE_ssb_N100_NoIndex_ckmrmultinom5[2,], pch=16, col=4)
points(sd_RE_ssb_N100_NoIndex_ckmrmultinom10[2,], pch=16, col=5)
points(sd_RE_ssb_N100_NoIndex_ckmrmultinom20[2,], pch=16, col=6)
plot(sd_RE_ssb_N100_NoIndex_5yrs_noCKMR[3,], pch=16, ylim=c(0,0.5), las=1, ylab="", main="Sardine - N100")
points(sd_RE_ssb_N100_NoIndex_10yrs_noCKMR[3,], pch=16, col=2)
points(sd_RE_ssb_N100_NoIndex_20yrs_noCKMR[3,], pch=16, col=3)
points(sd_RE_ssb_N100_NoIndex_ckmrmultinom5[3,], pch=16, col=4)
points(sd_RE_ssb_N100_NoIndex_ckmrmultinom10[3,], pch=16, col=5)
points(sd_RE_ssb_N100_NoIndex_ckmrmultinom20[3,], pch=16, col=6)

plot(sd_RE_ssb_N1000_NoIndex_5yrs_noCKMR[1,], pch=16, ylim=c(0,0.35), las=1, ylab="", main="No Index,  Cod - N1000")
points(sd_RE_ssb_N1000_NoIndex_10yrs_noCKMR[1,], pch=16, col=2)
points(sd_RE_ssb_N1000_NoIndex_20yrs_noCKMR[1,], pch=16, col=3)
points(sd_RE_ssb_N1000_NoIndex_ckmrmultinom5[1,], pch=16, col=4)
points(sd_RE_ssb_N1000_NoIndex_ckmrmultinom10[1,], pch=16, col=5)
points(sd_RE_ssb_N1000_NoIndex_ckmrmultinom20[1,], pch=16, col=6)
legend("top", c("No CKMR 5yrs","No CKMR 10yrs","No CKMR 20yrs","CKMR 5 years","CKMR 10 years","CKMR 20 years"), col=1:6, pch=16)
plot(sd_RE_ssb_N1000_NoIndex_5yrs_noCKMR[2,], pch=16, ylim=c(0,0.35), las=1, ylab="SD SSB RE", main="Flatfish - N1000")
points(sd_RE_ssb_N1000_NoIndex_10yrs_noCKMR[2,], pch=16, col=2)
points(sd_RE_ssb_N1000_NoIndex_20yrs_noCKMR[2,], pch=16, col=3)
points(sd_RE_ssb_N1000_NoIndex_ckmrmultinom5[2,], pch=16, col=4)
points(sd_RE_ssb_N1000_NoIndex_ckmrmultinom10[2,], pch=16, col=5)
points(sd_RE_ssb_N1000_NoIndex_ckmrmultinom20[2,], pch=16, col=6)
plot(sd_RE_ssb_N1000_NoIndex_5yrs_noCKMR[3,], pch=16, ylim=c(0,0.5), las=1, ylab="", main="Sardine - N1000")
points(sd_RE_ssb_N1000_NoIndex_10yrs_noCKMR[3,], pch=16, col=2)
points(sd_RE_ssb_N1000_NoIndex_10yrs_noCKMR[3,], pch=16, col=3)
points(sd_RE_ssb_N1000_NoIndex_ckmrmultinom5[3,], pch=16, col=4)
points(sd_RE_ssb_N1000_NoIndex_ckmrmultinom10[3,], pch=16, col=5)
points(sd_RE_ssb_N1000_NoIndex_ckmrmultinom20[3,], pch=16, col=6)

plot(sd_RE_ssb_N5000_NoIndex_5yrs_noCKMR[1,], pch=16, ylim=c(0,0.35), las=1, ylab="", main="Cod - N5000")
points(sd_RE_ssb_N5000_NoIndex_10yrs_noCKMR[1,], pch=16, col=2)
points(sd_RE_ssb_N5000_NoIndex_20yrs_noCKMR[1,], pch=16, col=3)
points(sd_RE_ssb_N5000_NoIndex_ckmrmultinom5[1,], pch=16, col=4)
points(sd_RE_ssb_N5000_NoIndex_ckmrmultinom10[1,], pch=16, col=5)
points(sd_RE_ssb_N5000_NoIndex_ckmrmultinom20[1,], pch=16, col=6)
plot(sd_RE_ssb_N5000_NoIndex_5yrs_noCKMR[2,], pch=16, ylim=c(0,0.35), las=1, ylab="SD SSB RE", main="Flatfish - N5000")
points(sd_RE_ssb_N5000_NoIndex_10yrs_noCKMR[2,], pch=16, col=2)
points(sd_RE_ssb_N5000_NoIndex_20yrs_noCKMR[2,], pch=16, col=3)
points(sd_RE_ssb_N5000_NoIndex_ckmrmultinom5[2,], pch=16, col=4)
points(sd_RE_ssb_N5000_NoIndex_ckmrmultinom10[2,], pch=16, col=5)
points(sd_RE_ssb_N5000_NoIndex_ckmrmultinom20[2,], pch=16, col=6)
plot(sd_RE_ssb_N5000_NoIndex_5yrs_noCKMR[3,], pch=16, ylim=c(0,0.5), las=1, ylab="", main="Sardine - N5000")
points(sd_RE_ssb_N5000_NoIndex_10yrs_noCKMR[3,], pch=16, col=2)
points(sd_RE_ssb_N5000_NoIndex_20yrs_noCKMR[3,], pch=16, col=3)
points(sd_RE_ssb_N5000_NoIndex_ckmrmultinom5[3,], pch=16, col=4)
points(sd_RE_ssb_N5000_NoIndex_ckmrmultinom10[3,], pch=16, col=5)
points(sd_RE_ssb_N5000_NoIndex_ckmrmultinom20[3,], pch=16, col=6)

#Index 0.50
par(mfcol=c(3,3), mar=c(3,4,1,1), oma=c(2,2,1,1))
plot(sd_RE_ssb_N100_Ind50_5yrs_noCKMR[1,], pch=16, ylim=c(0,0.3), las=1, ylab="", main="Cod - N100")
points(sd_RE_ssb_N100_Ind50_10yrs_noCKMR[1,], pch=16, col=2)
points(sd_RE_ssb_N100_Ind50_20yrs_noCKMR[1,], pch=16, col=3)
points(sd_RE_ssb_N100_Ind50_ckmrmultinom5[1,], pch=16, col=4)
points(sd_RE_ssb_N100_Ind50_ckmrmultinom10[1,], pch=16, col=5)
points(sd_RE_ssb_N100_Ind50_ckmrmultinom20[1,], pch=16, col=6)
plot(sd_RE_ssb_N100_Ind50_5yrs_noCKMR[2,], pch=16, ylim=c(0,0.35), las=1, ylab="SD SSB RE", main="Flatfish - N100")
points(sd_RE_ssb_N100_Ind50_10yrs_noCKMR[2,], pch=16, col=2)
points(sd_RE_ssb_N100_Ind50_20yrs_noCKMR[2,], pch=16, col=3)
points(sd_RE_ssb_N100_Ind50_ckmrmultinom5[2,], pch=16, col=4)
points(sd_RE_ssb_N100_Ind50_ckmrmultinom10[2,], pch=16, col=5)
points(sd_RE_ssb_N100_Ind50_ckmrmultinom20[2,], pch=16, col=6)
plot(sd_RE_ssb_N100_Ind50_5yrs_noCKMR[3,], pch=16, ylim=c(0,0.5), las=1, ylab="", main="Sardine - N100")
points(sd_RE_ssb_N100_Ind50_10yrs_noCKMR[3,], pch=16, col=2)
points(sd_RE_ssb_N100_Ind50_20yrs_noCKMR[3,], pch=16, col=3)
points(sd_RE_ssb_N100_Ind50_ckmrmultinom5[3,], pch=16, col=4)
points(sd_RE_ssb_N100_Ind50_ckmrmultinom10[3,], pch=16, col=5)
points(sd_RE_ssb_N100_Ind50_ckmrmultinom20[3,], pch=16, col=6)

plot(sd_RE_ssb_N1000_Ind50_5yrs_noCKMR[1,], pch=16, ylim=c(0,0.3), las=1, ylab="", main="Index-0.50,  Cod - N1000")
points(sd_RE_ssb_N1000_Ind50_10yrs_noCKMR[1,], pch=16, col=2)
points(sd_RE_ssb_N1000_Ind50_20yrs_noCKMR[1,], pch=16, col=3)
points(sd_RE_ssb_N1000_Ind50_ckmrmultinom5[1,], pch=16, col=4)
points(sd_RE_ssb_N1000_Ind50_ckmrmultinom10[1,], pch=16, col=5)
points(sd_RE_ssb_N1000_Ind50_ckmrmultinom20[1,], pch=16, col=6)
legend("top", c("No CKMR 5yrs","No CKMR 10yrs","No CKMR 20yrs","CKMR 5 years","CKMR 10 years","CKMR 20 years"), col=1:6, pch=16)
plot(sd_RE_ssb_N1000_Ind50_5yrs_noCKMR[2,], pch=16, ylim=c(0,0.35), las=1, ylab="SD SSB RE", main="Flatfish - N1000")
points(sd_RE_ssb_N1000_Ind50_10yrs_noCKMR[2,], pch=16, col=2)
points(sd_RE_ssb_N1000_Ind50_20yrs_noCKMR[2,], pch=16, col=3)
points(sd_RE_ssb_N1000_Ind50_ckmrmultinom5[2,], pch=16, col=4)
points(sd_RE_ssb_N1000_Ind50_ckmrmultinom10[2,], pch=16, col=5)
points(sd_RE_ssb_N1000_Ind50_ckmrmultinom20[2,], pch=16, col=6)
plot(sd_RE_ssb_N1000_Ind50_5yrs_noCKMR[3,], pch=16, ylim=c(0,0.5), las=1, ylab="", main="Sardine - N1000")
points(sd_RE_ssb_N1000_Ind50_10yrs_noCKMR[3,], pch=16, col=2)
points(sd_RE_ssb_N1000_Ind50_20yrs_noCKMR[3,], pch=16, col=3)
points(sd_RE_ssb_N1000_Ind50_ckmrmultinom5[3,], pch=16, col=4)
points(sd_RE_ssb_N1000_Ind50_ckmrmultinom10[3,], pch=16, col=5)
points(sd_RE_ssb_N1000_Ind50_ckmrmultinom20[3,], pch=16, col=6)

plot(sd_RE_ssb_N5000_Ind50_5yrs_noCKMR[1,], pch=16, ylim=c(0,0.3), las=1, ylab="", main="Cod - N5000")
points(sd_RE_ssb_N5000_Ind50_10yrs_noCKMR[1,], pch=16, col=2)
points(sd_RE_ssb_N5000_Ind50_20yrs_noCKMR[1,], pch=16, col=3)
points(sd_RE_ssb_N5000_Ind50_ckmrmultinom5[1,], pch=16, col=4)
points(sd_RE_ssb_N5000_Ind50_ckmrmultinom10[1,], pch=16, col=5)
points(sd_RE_ssb_N5000_Ind50_ckmrmultinom20[1,], pch=16, col=6)
plot(sd_RE_ssb_N5000_Ind50_5yrs_noCKMR[2,], pch=16, ylim=c(0,0.35), las=1, ylab="SD SSB RE", main="Flatfish - N5000")
points(sd_RE_ssb_N5000_Ind50_10yrs_noCKMR[2,], pch=16, col=2)
points(sd_RE_ssb_N5000_Ind50_20yrs_noCKMR[2,], pch=16, col=3)
points(sd_RE_ssb_N5000_Ind50_ckmrmultinom5[2,], pch=16, col=4)
points(sd_RE_ssb_N5000_Ind50_ckmrmultinom10[2,], pch=16, col=5)
points(sd_RE_ssb_N5000_Ind50_ckmrmultinom20[2,], pch=16, col=6)
plot(sd_RE_ssb_N5000_Ind50_5yrs_noCKMR[3,], pch=16, ylim=c(0,0.5), las=1, ylab="", main="Sardine - N5000")
points(sd_RE_ssb_N5000_Ind50_10yrs_noCKMR[3,], pch=16, col=2)
points(sd_RE_ssb_N5000_Ind50_20yrs_noCKMR[3,], pch=16, col=3)
points(sd_RE_ssb_N5000_Ind50_ckmrmultinom5[3,], pch=16, col=4)
points(sd_RE_ssb_N5000_Ind50_ckmrmultinom10[3,], pch=16, col=5)
points(sd_RE_ssb_N5000_Ind50_ckmrmultinom20[3,], pch=16, col=6)

#Index 0.25
par(mfcol=c(3,3), mar=c(3,4,1,1), oma=c(2,2,1,1))
plot(sd_RE_ssb_N100_Ind25_5yrs_noCKMR[1,], pch=16, ylim=c(0,0.3), las=1, ylab="", main="Cod - N100")
points(sd_RE_ssb_N100_Ind25_10yrs_noCKMR[1,], pch=16, col=2)
points(sd_RE_ssb_N100_Ind25_20yrs_noCKMR[1,], pch=16, col=3)
points(sd_RE_ssb_N100_Ind25_ckmrmultinom5[1,], pch=16, col=4)
points(sd_RE_ssb_N100_Ind25_ckmrmultinom10[1,], pch=16, col=5)
points(sd_RE_ssb_N100_Ind25_ckmrmultinom20[1,], pch=16, col=6)
plot(sd_RE_ssb_N100_Ind25_5yrs_noCKMR[2,], pch=16, ylim=c(0,0.35), las=1, ylab="SD SSB RE", main="Flatfish - N100")
points(sd_RE_ssb_N100_Ind25_10yrs_noCKMR[2,], pch=16, col=2)
points(sd_RE_ssb_N100_Ind25_20yrs_noCKMR[2,], pch=16, col=3)
points(sd_RE_ssb_N100_Ind25_ckmrmultinom5[2,], pch=16, col=4)
points(sd_RE_ssb_N100_Ind25_ckmrmultinom10[2,], pch=16, col=5)
points(sd_RE_ssb_N100_Ind25_ckmrmultinom20[2,], pch=16, col=6)
plot(sd_RE_ssb_N100_Ind25_5yrs_noCKMR[3,], pch=16, ylim=c(0,0.5), las=1, ylab="", main="Sardine - N100")
points(sd_RE_ssb_N100_Ind25_10yrs_noCKMR[3,], pch=16, col=2)
points(sd_RE_ssb_N100_Ind25_20yrs_noCKMR[3,], pch=16, col=3)
points(sd_RE_ssb_N100_Ind25_ckmrmultinom5[3,], pch=16, col=4)
points(sd_RE_ssb_N100_Ind25_ckmrmultinom10[3,], pch=16, col=5)
points(sd_RE_ssb_N100_Ind25_ckmrmultinom20[3,], pch=16, col=6)

plot(sd_RE_ssb_N1000_Ind25_5yrs_noCKMR[1,], pch=16, ylim=c(0,0.3), las=1, ylab="", main="Index-0.25,  Cod - N1000")
points(sd_RE_ssb_N1000_Ind25_10yrs_noCKMR[1,], pch=16, col=2)
points(sd_RE_ssb_N1000_Ind25_20yrs_noCKMR[1,], pch=16, col=3)
points(sd_RE_ssb_N1000_Ind25_ckmrmultinom5[1,], pch=16, col=4)
points(sd_RE_ssb_N1000_Ind25_ckmrmultinom10[1,], pch=16, col=5)
points(sd_RE_ssb_N1000_Ind25_ckmrmultinom20[1,], pch=16, col=6)
legend("top", c("No CKMR 5yrs","No CKMR 10yrs","No CKMR 20yrs","CKMR 5 years","CKMR 10 years","CKMR 20 years"), col=1:6, pch=16)
plot(sd_RE_ssb_N1000_Ind25_5yrs_noCKMR[2,], pch=16, ylim=c(0,0.35), las=1, ylab="SD SSB RE", main="Flatfish - N1000")
points(sd_RE_ssb_N1000_Ind25_10yrs_noCKMR[2,], pch=16, col=2)
points(sd_RE_ssb_N1000_Ind25_20yrs_noCKMR[2,], pch=16, col=3)
points(sd_RE_ssb_N1000_Ind25_ckmrmultinom5[2,], pch=16, col=4)
points(sd_RE_ssb_N1000_Ind25_ckmrmultinom10[2,], pch=16, col=5)
points(sd_RE_ssb_N1000_Ind25_ckmrmultinom20[2,], pch=16, col=6)
plot(sd_RE_ssb_N1000_Ind25_5yrs_noCKMR[3,], pch=16, ylim=c(0,0.5), las=1, ylab="", main="Sardine - N1000")
points(sd_RE_ssb_N1000_Ind25_10yrs_noCKMR[3,], pch=16, col=2)
points(sd_RE_ssb_N1000_Ind25_20yrs_noCKMR[3,], pch=16, col=3)
points(sd_RE_ssb_N1000_Ind25_ckmrmultinom5[3,], pch=16, col=4)
points(sd_RE_ssb_N1000_Ind25_ckmrmultinom10[3,], pch=16, col=5)
points(sd_RE_ssb_N1000_Ind25_ckmrmultinom20[3,], pch=16, col=6)

plot(sd_RE_ssb_N5000_Ind25_5yrs_noCKMR[1,], pch=16, ylim=c(0,0.3), las=1, ylab="", main="Cod - N5000")
points(sd_RE_ssb_N5000_Ind25_10yrs_noCKMR[1,], pch=16, col=2)
points(sd_RE_ssb_N5000_Ind25_20yrs_noCKMR[1,], pch=16, col=3)
points(sd_RE_ssb_N5000_Ind25_ckmrmultinom5[1,], pch=16, col=4)
points(sd_RE_ssb_N5000_Ind25_ckmrmultinom10[1,], pch=16, col=5)
points(sd_RE_ssb_N5000_Ind25_ckmrmultinom20[1,], pch=16, col=6)
plot(sd_RE_ssb_N5000_Ind25_5yrs_noCKMR[2,], pch=16, ylim=c(0,0.35), las=1, ylab="SD SSB RE", main="Flatfish - N5000")
points(sd_RE_ssb_N5000_Ind25_10yrs_noCKMR[2,], pch=16, col=2)
points(sd_RE_ssb_N5000_Ind25_20yrs_noCKMR[2,], pch=16, col=3)
points(sd_RE_ssb_N5000_Ind25_ckmrmultinom5[2,], pch=16, col=4)
points(sd_RE_ssb_N5000_Ind25_ckmrmultinom10[2,], pch=16, col=5)
points(sd_RE_ssb_N5000_Ind25_ckmrmultinom20[2,], pch=16, col=6)
plot(sd_RE_ssb_N5000_Ind25_5yrs_noCKMR[3,], pch=16, ylim=c(0,0.5), las=1, ylab="", main="Sardine - N5000")
points(sd_RE_ssb_N5000_Ind25_10yrs_noCKMR[3,], pch=16, col=2)
points(sd_RE_ssb_N5000_Ind25_20yrs_noCKMR[3,], pch=16, col=3)
points(sd_RE_ssb_N5000_Ind25_ckmrmultinom5[3,], pch=16, col=4)
points(sd_RE_ssb_N5000_Ind25_ckmrmultinom10[3,], pch=16, col=5)
points(sd_RE_ssb_N5000_Ind25_ckmrmultinom20[3,], pch=16, col=6)

#Relative to NO CKMR
#No Index
par(mfcol=c(3,3), mar=c(3,4,1,1), oma=c(2,2,1,1))
plot(sd_RE_ssb_N100_NoIndex_ckmrmultinom5[1,]/sd_RE_ssb_N100_NoIndex_5yrs_noCKMR[1,], pch=16, ylim=c(0.8,1.35), las=1, ylab="", main="Cod - N100")
points(sd_RE_ssb_N100_NoIndex_ckmrmultinom10[1,]/sd_RE_ssb_N100_NoIndex_10yrs_noCKMR[1,], pch=16, col=3)
points(sd_RE_ssb_N100_NoIndex_ckmrmultinom20[1,]/sd_RE_ssb_N100_NoIndex_20yrs_noCKMR[1,], pch=16, col=4)
plot(sd_RE_ssb_N100_NoIndex_ckmrmultinom5[2,]/sd_RE_ssb_N100_NoIndex_5yrs_noCKMR[2,], pch=16, ylim=c(0,1.35), las=1, ylab="SD SSB RE, relative to NO CKMR", main="Flatfish - N100")
points(sd_RE_ssb_N100_NoIndex_ckmrmultinom10[2,]/sd_RE_ssb_N100_NoIndex_10yrs_noCKMR[2,], pch=16, col=3)
points(sd_RE_ssb_N100_NoIndex_ckmrmultinom20[2,]/sd_RE_ssb_N100_NoIndex_20yrs_noCKMR[2,], pch=16, col=4)
plot(sd_RE_ssb_N100_NoIndex_ckmrmultinom5[3,]/sd_RE_ssb_N100_NoIndex_5yrs_noCKMR[3,], pch=16, ylim=c(0.4,1.35), las=1, ylab="", main="Sardine - N100")
points(sd_RE_ssb_N100_NoIndex_ckmrmultinom10[3,]/sd_RE_ssb_N100_NoIndex_10yrs_noCKMR[3,], pch=16, col=3)
points(sd_RE_ssb_N100_NoIndex_ckmrmultinom20[3,]/sd_RE_ssb_N100_NoIndex_20yrs_noCKMR[3,], pch=16, col=4)

plot(sd_RE_ssb_N1000_NoIndex_ckmrmultinom5[1,]/sd_RE_ssb_N1000_NoIndex_5yrs_noCKMR[1,], pch=16, ylim=c(0.8,1.35), las=1, ylab="", main="No Index,  Cod - N1000")
points(sd_RE_ssb_N1000_NoIndex_ckmrmultinom10[1,]/sd_RE_ssb_N1000_NoIndex_10yrs_noCKMR[1,], pch=16, col=3)
points(sd_RE_ssb_N1000_NoIndex_ckmrmultinom20[1,]/sd_RE_ssb_N1000_NoIndex_20yrs_noCKMR[1,], pch=16, col=4)
legend("top", c("CKMR 5 years","CKMR 10 years","CKMR 20 years"), col=c(1,3,4), pch=16)
plot(sd_RE_ssb_N1000_NoIndex_ckmrmultinom5[2,]/sd_RE_ssb_N1000_NoIndex_5yrs_noCKMR[2,], pch=16, ylim=c(0,1.35), las=1, ylab="", main="Flatfish - N1000")
points(sd_RE_ssb_N1000_NoIndex_ckmrmultinom10[2,]/sd_RE_ssb_N1000_NoIndex_10yrs_noCKMR[2,], pch=16, col=3)
points(sd_RE_ssb_N1000_NoIndex_ckmrmultinom20[2,]/sd_RE_ssb_N1000_NoIndex_20yrs_noCKMR[2,], pch=16, col=4)
plot(sd_RE_ssb_N1000_NoIndex_ckmrmultinom5[3,]/sd_RE_ssb_N1000_NoIndex_5yrs_noCKMR[3,], pch=16, ylim=c(0.4,1.35), las=1, ylab="", main="Sardine - N1000")
points(sd_RE_ssb_N1000_NoIndex_ckmrmultinom10[3,]/sd_RE_ssb_N1000_NoIndex_10yrs_noCKMR[3,], pch=16, col=3)
points(sd_RE_ssb_N1000_NoIndex_ckmrmultinom20[3,]/sd_RE_ssb_N1000_NoIndex_20yrs_noCKMR[3,], pch=16, col=4)

plot(sd_RE_ssb_N5000_NoIndex_ckmrmultinom5[1,]/sd_RE_ssb_N5000_NoIndex_5yrs_noCKMR[1,], pch=16, ylim=c(0.8,1.35), las=1, ylab="", main="Cod - N5000")
points(sd_RE_ssb_N5000_NoIndex_ckmrmultinom10[1,]/sd_RE_ssb_N5000_NoIndex_10yrs_noCKMR[1,], pch=16, col=3)
points(sd_RE_ssb_N5000_NoIndex_ckmrmultinom20[1,]/sd_RE_ssb_N5000_NoIndex_20yrs_noCKMR[1,], pch=16, col=4)
plot(sd_RE_ssb_N5000_NoIndex_ckmrmultinom5[2,]/sd_RE_ssb_N5000_NoIndex_5yrs_noCKMR[2,], pch=16, ylim=c(0,1.35), las=1, ylab="", main="Flatfish - N5000")
points(sd_RE_ssb_N5000_NoIndex_ckmrmultinom10[2,]/sd_RE_ssb_N5000_NoIndex_10yrs_noCKMR[2,], pch=16, col=3)
points(sd_RE_ssb_N5000_NoIndex_ckmrmultinom20[2,]/sd_RE_ssb_N5000_NoIndex_20yrs_noCKMR[2,], pch=16, col=4)
plot(sd_RE_ssb_N5000_NoIndex_ckmrmultinom5[3,]/sd_RE_ssb_N5000_NoIndex_5yrs_noCKMR[3,], pch=16, ylim=c(0.4,1.35), las=1, ylab="", main="Sardine - N5000")
points(sd_RE_ssb_N5000_NoIndex_ckmrmultinom10[3,]/sd_RE_ssb_N5000_NoIndex_10yrs_noCKMR[3,], pch=16, col=3)
points(sd_RE_ssb_N5000_NoIndex_ckmrmultinom20[3,]/sd_RE_ssb_N5000_NoIndex_20yrs_noCKMR[3,], pch=16, col=4)

#Index 0.50
par(mfcol=c(3,3), mar=c(3,4,1,1), oma=c(2,2,1,1))
plot(sd_RE_ssb_N100_Ind50_ckmrmultinom5[1,]/sd_RE_ssb_N100_Ind50_5yrs_noCKMR[1,], pch=16, ylim=c(0.8,1.35), las=1, ylab="", main="Cod - N100")
points(sd_RE_ssb_N100_Ind50_ckmrmultinom10[1,]/sd_RE_ssb_N100_Ind50_10yrs_noCKMR[1,], pch=16, col=3)
points(sd_RE_ssb_N100_Ind50_ckmrmultinom20[1,]/sd_RE_ssb_N100_Ind50_20yrs_noCKMR[1,], pch=16, col=4)
plot(sd_RE_ssb_N100_Ind50_ckmrmultinom5[2,]/sd_RE_ssb_N100_Ind50_5yrs_noCKMR[2,], pch=16, ylim=c(0,1.35), las=1, ylab="SD SSB RE, relative to NO CKMR", main="Flatfish - N100")
points(sd_RE_ssb_N100_Ind50_ckmrmultinom10[2,]/sd_RE_ssb_N100_Ind50_10yrs_noCKMR[2,], pch=16, col=3)
points(sd_RE_ssb_N100_Ind50_ckmrmultinom20[2,]/sd_RE_ssb_N100_Ind50_20yrs_noCKMR[2,], pch=16, col=4)
plot(sd_RE_ssb_N100_Ind50_ckmrmultinom5[3,]/sd_RE_ssb_N100_Ind50_5yrs_noCKMR[3,], pch=16, ylim=c(0.4,1.35), las=1, ylab="", main="Sardine - N100")
points(sd_RE_ssb_N100_Ind50_ckmrmultinom10[3,]/sd_RE_ssb_N100_Ind50_10yrs_noCKMR[3,], pch=16, col=3)
points(sd_RE_ssb_N100_Ind50_ckmrmultinom20[3,]/sd_RE_ssb_N100_Ind50_20yrs_noCKMR[3,], pch=16, col=4)

plot(sd_RE_ssb_N1000_Ind50_ckmrmultinom5[1,]/sd_RE_ssb_N1000_Ind50_5yrs_noCKMR[1,], pch=16, ylim=c(0.8,1.35), las=1, ylab="", main="Index 0.50,  Cod - N1000")
points(sd_RE_ssb_N1000_Ind50_ckmrmultinom10[1,]/sd_RE_ssb_N1000_Ind50_10yrs_noCKMR[1,], pch=16, col=3)
points(sd_RE_ssb_N1000_Ind50_ckmrmultinom20[1,]/sd_RE_ssb_N1000_Ind50_20yrs_noCKMR[1,], pch=16, col=4)
legend("top", c("CKMR 5 years","CKMR 10 years","CKMR 20 years"), col=c(1,3,4), pch=16)
plot(sd_RE_ssb_N1000_Ind50_ckmrmultinom5[2,]/sd_RE_ssb_N1000_Ind50_5yrs_noCKMR[2,], pch=16, ylim=c(0,1.35), las=1, ylab="", main="Flatfish - N1000")
points(sd_RE_ssb_N1000_Ind50_ckmrmultinom10[2,]/sd_RE_ssb_N1000_Ind50_10yrs_noCKMR[2,], pch=16, col=3)
points(sd_RE_ssb_N1000_Ind50_ckmrmultinom20[2,]/sd_RE_ssb_N1000_Ind50_20yrs_noCKMR[2,], pch=16, col=4)
plot(sd_RE_ssb_N1000_Ind50_ckmrmultinom5[3,]/sd_RE_ssb_N1000_Ind50_5yrs_noCKMR[3,], pch=16, ylim=c(0.4,1.35), las=1, ylab="", main="Sardine - N1000")
points(sd_RE_ssb_N1000_Ind50_ckmrmultinom10[3,]/sd_RE_ssb_N1000_Ind50_10yrs_noCKMR[3,], pch=16, col=3)
points(sd_RE_ssb_N1000_Ind50_ckmrmultinom20[3,]/sd_RE_ssb_N1000_Ind50_20yrs_noCKMR[3,], pch=16, col=4)

plot(sd_RE_ssb_N5000_Ind50_ckmrmultinom5[1,]/sd_RE_ssb_N5000_Ind50_5yrs_noCKMR[1,], pch=16, ylim=c(0.8,1.35), las=1, ylab="", main="Cod - N5000")
points(sd_RE_ssb_N5000_Ind50_ckmrmultinom10[1,]/sd_RE_ssb_N5000_Ind50_10yrs_noCKMR[1,], pch=16, col=3)
points(sd_RE_ssb_N5000_Ind50_ckmrmultinom20[1,]/sd_RE_ssb_N5000_Ind50_20yrs_noCKMR[1,], pch=16, col=4)
plot(sd_RE_ssb_N5000_Ind50_ckmrmultinom5[2,]/sd_RE_ssb_N5000_Ind50_5yrs_noCKMR[2,], pch=16, ylim=c(0,1.35), las=1, ylab="", main="Flatfish - N5000")
points(sd_RE_ssb_N5000_Ind50_ckmrmultinom10[2,]/sd_RE_ssb_N5000_Ind50_10yrs_noCKMR[2,], pch=16, col=3)
points(sd_RE_ssb_N5000_Ind50_ckmrmultinom20[2,]/sd_RE_ssb_N5000_Ind50_20yrs_noCKMR[2,], pch=16, col=4)
plot(sd_RE_ssb_N5000_Ind50_ckmrmultinom5[3,]/sd_RE_ssb_N5000_Ind50_5yrs_noCKMR[3,], pch=16, ylim=c(0.4,1.35), las=1, ylab="", main="Sardine - N5000")
points(sd_RE_ssb_N5000_Ind50_ckmrmultinom10[3,]/sd_RE_ssb_N5000_Ind50_10yrs_noCKMR[3,], pch=16, col=3)
points(sd_RE_ssb_N5000_Ind50_ckmrmultinom20[3,]/sd_RE_ssb_N5000_Ind50_20yrs_noCKMR[3,], pch=16, col=4)

#Index 0.25
par(mfcol=c(3,3), mar=c(3,4,1,1), oma=c(2,2,1,1))
plot(sd_RE_ssb_N100_Ind25_ckmrmultinom5[1,]/sd_RE_ssb_N100_Ind25_5yrs_noCKMR[1,], pch=16, ylim=c(0.8,1.35), las=1, ylab="", main="Cod - N100")
points(sd_RE_ssb_N100_Ind25_ckmrmultinom10[1,]/sd_RE_ssb_N100_Ind25_10yrs_noCKMR[1,], pch=16, col=3)
points(sd_RE_ssb_N100_Ind25_ckmrmultinom20[1,]/sd_RE_ssb_N100_Ind25_20yrs_noCKMR[1,], pch=16, col=4)
plot(sd_RE_ssb_N100_Ind25_ckmrmultinom5[2,]/sd_RE_ssb_N100_Ind25_5yrs_noCKMR[2,], pch=16, ylim=c(0,1.35), las=1, ylab="SD SSB RE, relative to NO CKMR", main="Flatfish - N100")
points(sd_RE_ssb_N100_Ind25_ckmrmultinom10[2,]/sd_RE_ssb_N100_Ind25_10yrs_noCKMR[2,], pch=16, col=3)
points(sd_RE_ssb_N100_Ind25_ckmrmultinom20[2,]/sd_RE_ssb_N100_Ind25_20yrs_noCKMR[2,], pch=16, col=4)
plot(sd_RE_ssb_N100_Ind25_ckmrmultinom5[3,]/sd_RE_ssb_N100_Ind25_5yrs_noCKMR[3,], pch=16, ylim=c(0.4,1.35), las=1, ylab="", main="Sardine - N100")
points(sd_RE_ssb_N100_Ind25_ckmrmultinom10[3,]/sd_RE_ssb_N100_Ind25_10yrs_noCKMR[3,], pch=16, col=3)
points(sd_RE_ssb_N100_Ind25_ckmrmultinom20[3,]/sd_RE_ssb_N100_Ind25_20yrs_noCKMR[3,], pch=16, col=4)

plot(sd_RE_ssb_N1000_Ind25_ckmrmultinom5[1,]/sd_RE_ssb_N1000_Ind25_5yrs_noCKMR[1,], pch=16, ylim=c(0.8,1.35), las=1, ylab="", main="Index 0.25,  Cod - N1000")
points(sd_RE_ssb_N1000_Ind25_ckmrmultinom10[1,]/sd_RE_ssb_N1000_Ind25_10yrs_noCKMR[1,], pch=16, col=3)
points(sd_RE_ssb_N1000_Ind25_ckmrmultinom20[1,]/sd_RE_ssb_N1000_Ind25_20yrs_noCKMR[1,], pch=16, col=4)
legend("top", c("CKMR 5 years","CKMR 10 years","CKMR 20 years"), col=c(1,3,4), pch=16)
plot(sd_RE_ssb_N1000_Ind25_ckmrmultinom5[2,]/sd_RE_ssb_N1000_Ind25_5yrs_noCKMR[2,], pch=16, ylim=c(0,1.35), las=1, ylab="", main="Flatfish - N1000")
points(sd_RE_ssb_N1000_Ind25_ckmrmultinom10[2,]/sd_RE_ssb_N1000_Ind25_10yrs_noCKMR[2,], pch=16, col=3)
points(sd_RE_ssb_N1000_Ind25_ckmrmultinom20[2,]/sd_RE_ssb_N1000_Ind25_20yrs_noCKMR[2,], pch=16, col=4)
plot(sd_RE_ssb_N1000_Ind25_ckmrmultinom5[3,]/sd_RE_ssb_N1000_Ind25_5yrs_noCKMR[3,], pch=16, ylim=c(0.4,1.35), las=1, ylab="", main="Sardine - N1000")
points(sd_RE_ssb_N1000_Ind25_ckmrmultinom10[3,]/sd_RE_ssb_N1000_Ind25_10yrs_noCKMR[3,], pch=16, col=3)
points(sd_RE_ssb_N1000_Ind25_ckmrmultinom20[3,]/sd_RE_ssb_N1000_Ind25_20yrs_noCKMR[3,], pch=16, col=4)

plot(sd_RE_ssb_N5000_Ind25_ckmrmultinom5[1,]/sd_RE_ssb_N5000_Ind25_5yrs_noCKMR[1,], pch=16, ylim=c(0.8,1.35), las=1, ylab="", main="Cod - N5000")
points(sd_RE_ssb_N5000_Ind25_ckmrmultinom10[1,]/sd_RE_ssb_N5000_Ind25_10yrs_noCKMR[1,], pch=16, col=3)
points(sd_RE_ssb_N5000_Ind25_ckmrmultinom20[1,]/sd_RE_ssb_N5000_Ind25_20yrs_noCKMR[1,], pch=16, col=4)
plot(sd_RE_ssb_N5000_Ind25_ckmrmultinom5[2,]/sd_RE_ssb_N5000_Ind25_5yrs_noCKMR[2,], pch=16, ylim=c(0,1.35), las=1, ylab="", main="Flatfish - N5000")
points(sd_RE_ssb_N5000_Ind25_ckmrmultinom10[2,]/sd_RE_ssb_N5000_Ind25_10yrs_noCKMR[2,], pch=16, col=3)
points(sd_RE_ssb_N5000_Ind25_ckmrmultinom20[2,]/sd_RE_ssb_N5000_Ind25_20yrs_noCKMR[2,], pch=16, col=4)
plot(sd_RE_ssb_N5000_Ind25_ckmrmultinom5[3,]/sd_RE_ssb_N5000_Ind25_5yrs_noCKMR[3,], pch=16, ylim=c(0.4,1.35), las=1, ylab="", main="Sardine - N5000")
points(sd_RE_ssb_N5000_Ind25_ckmrmultinom10[3,]/sd_RE_ssb_N5000_Ind25_10yrs_noCKMR[3,], pch=16, col=3)
points(sd_RE_ssb_N5000_Ind25_ckmrmultinom20[3,]/sd_RE_ssb_N5000_Ind25_20yrs_noCKMR[3,], pch=16, col=4)

##############
#SD ARE
##############
#No Index
par(mfcol=c(3,3), mar=c(3,4,1,1), oma=c(2,2,1,1))
plot(sd_ARE_ssb_N100_NoIndex_5yrs_noCKMR[1,], pch=16, ylim=c(0,0.09), las=1, ylab="", main="Cod - N100")
points(sd_ARE_ssb_N100_NoIndex_10yrs_noCKMR[1,], pch=16, col=2)
points(sd_ARE_ssb_N100_NoIndex_20yrs_noCKMR[1,], pch=16, col=3)
points(sd_ARE_ssb_N100_NoIndex_ckmrmultinom5[1,], pch=16, col=4)
points(sd_ARE_ssb_N100_NoIndex_ckmrmultinom10[1,], pch=16, col=5)
points(sd_ARE_ssb_N100_NoIndex_ckmrmultinom20[1,], pch=16, col=6)
plot(sd_ARE_ssb_N100_NoIndex_5yrs_noCKMR[2,], pch=16, ylim=c(0,0.10), las=1, ylab="SD SSB ARE", main="No Index, Flatfish - N100")
points(sd_ARE_ssb_N100_NoIndex_10yrs_noCKMR[2,], pch=16, col=2)
points(sd_ARE_ssb_N100_NoIndex_20yrs_noCKMR[2,], pch=16, col=3)
points(sd_ARE_ssb_N100_NoIndex_ckmrmultinom5[2,], pch=16, col=4)
points(sd_ARE_ssb_N100_NoIndex_ckmrmultinom10[2,], pch=16, col=5)
points(sd_ARE_ssb_N100_NoIndex_ckmrmultinom20[2,], pch=16, col=6)
plot(sd_ARE_ssb_N100_NoIndex_5yrs_noCKMR[3,], pch=16, ylim=c(0,0.15), las=1, ylab="", main="Sardine - N100")
points(sd_ARE_ssb_N100_NoIndex_10yrs_noCKMR[3,], pch=16, col=2)
points(sd_ARE_ssb_N100_NoIndex_20yrs_noCKMR[3,], pch=16, col=3)
points(sd_ARE_ssb_N100_NoIndex_ckmrmultinom5[3,], pch=16, col=4)
points(sd_ARE_ssb_N100_NoIndex_ckmrmultinom10[3,], pch=16, col=5)
points(sd_ARE_ssb_N100_NoIndex_ckmrmultinom20[3,], pch=16, col=6)

plot(sd_ARE_ssb_N1000_NoIndex_5yrs_noCKMR[1,], pch=16, ylim=c(0,0.09), las=1, ylab="", main="Cod - N1000")
points(sd_ARE_ssb_N1000_NoIndex_10yrs_noCKMR[1,], pch=16, col=2)
points(sd_ARE_ssb_N1000_NoIndex_20yrs_noCKMR[1,], pch=16, col=3)
points(sd_ARE_ssb_N1000_NoIndex_ckmrmultinom5[1,], pch=16, col=4)
points(sd_ARE_ssb_N1000_NoIndex_ckmrmultinom10[1,], pch=16, col=5)
points(sd_ARE_ssb_N1000_NoIndex_ckmrmultinom20[1,], pch=16, col=6)
legend("top", c("No CKMR 5yrs","No CKMR 10yrs","No CKMR 20yrs","CKMR 5 years","CKMR 10 years","CKMR 20 years"), col=1:6, pch=16)
plot(sd_ARE_ssb_N1000_NoIndex_5yrs_noCKMR[2,], pch=16, ylim=c(0,0.10), las=1, ylab="SD SSB ARE", main="Flatfish - N1000")
points(sd_ARE_ssb_N1000_NoIndex_10yrs_noCKMR[2,], pch=16, col=2)
points(sd_ARE_ssb_N1000_NoIndex_20yrs_noCKMR[2,], pch=16, col=3)
points(sd_ARE_ssb_N1000_NoIndex_ckmrmultinom5[2,], pch=16, col=4)
points(sd_ARE_ssb_N1000_NoIndex_ckmrmultinom10[2,], pch=16, col=5)
points(sd_ARE_ssb_N1000_NoIndex_ckmrmultinom20[2,], pch=16, col=6)
plot(sd_ARE_ssb_N1000_NoIndex_5yrs_noCKMR[3,], pch=16, ylim=c(0,0.15), las=1, ylab="", main="Sardine - N1000")
points(sd_ARE_ssb_N1000_NoIndex_10yrs_noCKMR[3,], pch=16, col=2)
points(sd_ARE_ssb_N1000_NoIndex_20yrs_noCKMR[3,], pch=16, col=3)
points(sd_ARE_ssb_N1000_NoIndex_ckmrmultinom5[3,], pch=16, col=4)
points(sd_ARE_ssb_N1000_NoIndex_ckmrmultinom10[3,], pch=16, col=5)
points(sd_ARE_ssb_N1000_NoIndex_ckmrmultinom20[3,], pch=16, col=6)

plot(sd_ARE_ssb_N5000_NoIndex_5yrs_noCKMR[1,], pch=16, ylim=c(0,0.09), las=1, ylab="", main="Cod - N5000")
points(sd_ARE_ssb_N5000_NoIndex_10yrs_noCKMR[1,], pch=16, col=2)
points(sd_ARE_ssb_N5000_NoIndex_20yrs_noCKMR[1,], pch=16, col=3)
points(sd_ARE_ssb_N5000_NoIndex_ckmrmultinom5[1,], pch=16, col=4)
points(sd_ARE_ssb_N5000_NoIndex_ckmrmultinom10[1,], pch=16, col=5)
points(sd_ARE_ssb_N5000_NoIndex_ckmrmultinom20[1,], pch=16, col=6)
plot(sd_ARE_ssb_N5000_NoIndex_5yrs_noCKMR[2,], pch=16, ylim=c(0,0.10), las=1, ylab="SD SSB ARE", main="Flatfish - N5000")
points(sd_ARE_ssb_N5000_NoIndex_10yrs_noCKMR[2,], pch=16, col=2)
points(sd_ARE_ssb_N5000_NoIndex_20yrs_noCKMR[2,], pch=16, col=3)
points(sd_ARE_ssb_N5000_NoIndex_ckmrmultinom5[2,], pch=16, col=4)
points(sd_ARE_ssb_N5000_NoIndex_ckmrmultinom10[2,], pch=16, col=5)
points(sd_ARE_ssb_N5000_NoIndex_ckmrmultinom20[2,], pch=16, col=6)
plot(sd_ARE_ssb_N5000_NoIndex_5yrs_noCKMR[3,], pch=16, ylim=c(0,0.15), las=1, ylab="", main="Sardine - N5000")
points(sd_ARE_ssb_N5000_NoIndex_10yrs_noCKMR[3,], pch=16, col=2)
points(sd_ARE_ssb_N5000_NoIndex_20yrs_noCKMR[3,], pch=16, col=3)
points(sd_ARE_ssb_N5000_NoIndex_ckmrmultinom5[3,], pch=16, col=4)
points(sd_ARE_ssb_N5000_NoIndex_ckmrmultinom10[3,], pch=16, col=5)
points(sd_ARE_ssb_N5000_NoIndex_ckmrmultinom20[3,], pch=16, col=6)

#Index 0.50
par(mfcol=c(3,3), mar=c(3,4,1,1), oma=c(2,2,1,1))
plot(sd_ARE_ssb_N100_Ind50_5yrs_noCKMR[1,], pch=16, ylim=c(0,0.09), las=1, ylab="", main="Cod - N100")
points(sd_ARE_ssb_N100_Ind50_10yrs_noCKMR[1,], pch=16, col=2)
points(sd_ARE_ssb_N100_Ind50_20yrs_noCKMR[1,], pch=16, col=3)
points(sd_ARE_ssb_N100_Ind50_ckmrmultinom5[1,], pch=16, col=4)
points(sd_ARE_ssb_N100_Ind50_ckmrmultinom10[1,], pch=16, col=5)
points(sd_ARE_ssb_N100_Ind50_ckmrmultinom20[1,], pch=16, col=6)
plot(sd_ARE_ssb_N100_Ind50_5yrs_noCKMR[2,], pch=16, ylim=c(0,0.10), las=1, ylab="SD SSB ARE", main="Index 0.5, Flatfish - N100")
points(sd_ARE_ssb_N100_Ind50_10yrs_noCKMR[2,], pch=16, col=2)
points(sd_ARE_ssb_N100_Ind50_20yrs_noCKMR[2,], pch=16, col=3)
points(sd_ARE_ssb_N100_Ind50_ckmrmultinom5[2,], pch=16, col=4)
points(sd_ARE_ssb_N100_Ind50_ckmrmultinom10[2,], pch=16, col=5)
points(sd_ARE_ssb_N100_Ind50_ckmrmultinom20[2,], pch=16, col=6)
plot(sd_ARE_ssb_N100_Ind50_5yrs_noCKMR[3,], pch=16, ylim=c(0,0.15), las=1, ylab="", main="Sardine - N100")
points(sd_ARE_ssb_N100_Ind50_10yrs_noCKMR[3,], pch=16, col=2)
points(sd_ARE_ssb_N100_Ind50_20yrs_noCKMR[3,], pch=16, col=3)
points(sd_ARE_ssb_N100_Ind50_ckmrmultinom5[3,], pch=16, col=4)
points(sd_ARE_ssb_N100_Ind50_ckmrmultinom10[3,], pch=16, col=5)
points(sd_ARE_ssb_N100_Ind50_ckmrmultinom20[3,], pch=16, col=6)

plot(sd_ARE_ssb_N1000_Ind50_5yrs_noCKMR[1,], pch=16, ylim=c(0,0.09), las=1, ylab="", main="Cod - N1000")
points(sd_ARE_ssb_N1000_Ind50_10yrs_noCKMR[1,], pch=16, col=2)
points(sd_ARE_ssb_N1000_Ind50_20yrs_noCKMR[1,], pch=16, col=3)
points(sd_ARE_ssb_N1000_Ind50_ckmrmultinom5[1,], pch=16, col=4)
points(sd_ARE_ssb_N1000_Ind50_ckmrmultinom10[1,], pch=16, col=5)
points(sd_ARE_ssb_N1000_Ind50_ckmrmultinom20[1,], pch=16, col=6)
legend("top", c("No CKMR 5yrs","No CKMR 10yrs","No CKMR 20yrs","CKMR 5 years","CKMR 10 years","CKMR 20 years"), col=1:6, pch=16)
plot(sd_ARE_ssb_N1000_Ind50_5yrs_noCKMR[2,], pch=16, ylim=c(0,0.10), las=1, ylab="SD SSB ARE", main="Flatfish - N1000")
points(sd_ARE_ssb_N1000_Ind50_10yrs_noCKMR[2,], pch=16, col=2)
points(sd_ARE_ssb_N1000_Ind50_20yrs_noCKMR[2,], pch=16, col=3)
points(sd_ARE_ssb_N1000_Ind50_ckmrmultinom5[2,], pch=16, col=4)
points(sd_ARE_ssb_N1000_Ind50_ckmrmultinom10[2,], pch=16, col=5)
points(sd_ARE_ssb_N1000_Ind50_ckmrmultinom20[2,], pch=16, col=6)
plot(sd_ARE_ssb_N1000_Ind50_5yrs_noCKMR[3,], pch=16, ylim=c(0,0.15), las=1, ylab="", main="Sardine - N1000")
points(sd_ARE_ssb_N1000_Ind50_10yrs_noCKMR[3,], pch=16, col=2)
points(sd_ARE_ssb_N1000_Ind50_20yrs_noCKMR[3,], pch=16, col=3)
points(sd_ARE_ssb_N1000_Ind50_ckmrmultinom5[3,], pch=16, col=4)
points(sd_ARE_ssb_N1000_Ind50_ckmrmultinom10[3,], pch=16, col=5)
points(sd_ARE_ssb_N1000_Ind50_ckmrmultinom20[3,], pch=16, col=6)

plot(sd_ARE_ssb_N5000_Ind50_5yrs_noCKMR[1,], pch=16, ylim=c(0,0.09), las=1, ylab="", main="Cod - N5000")
points(sd_ARE_ssb_N5000_Ind50_10yrs_noCKMR[1,], pch=16, col=2)
points(sd_ARE_ssb_N5000_Ind50_20yrs_noCKMR[1,], pch=16, col=3)
points(sd_ARE_ssb_N5000_Ind50_ckmrmultinom5[1,], pch=16, col=4)
points(sd_ARE_ssb_N5000_Ind50_ckmrmultinom10[1,], pch=16, col=5)
points(sd_ARE_ssb_N5000_Ind50_ckmrmultinom20[1,], pch=16, col=6)
plot(sd_ARE_ssb_N5000_Ind50_5yrs_noCKMR[2,], pch=16, ylim=c(0,0.10), las=1, ylab="SD SSB ARE", main="Flatfish - N5000")
points(sd_ARE_ssb_N5000_Ind50_10yrs_noCKMR[2,], pch=16, col=2)
points(sd_ARE_ssb_N5000_Ind50_20yrs_noCKMR[2,], pch=16, col=3)
points(sd_ARE_ssb_N5000_Ind50_ckmrmultinom5[2,], pch=16, col=4)
points(sd_ARE_ssb_N5000_Ind50_ckmrmultinom10[2,], pch=16, col=5)
points(sd_ARE_ssb_N5000_Ind50_ckmrmultinom20[2,], pch=16, col=6)
plot(sd_ARE_ssb_N5000_Ind50_5yrs_noCKMR[3,], pch=16, ylim=c(0,0.15), las=1, ylab="", main="Sardine - N5000")
points(sd_ARE_ssb_N5000_Ind50_10yrs_noCKMR[3,], pch=16, col=2)
points(sd_ARE_ssb_N5000_Ind50_20yrs_noCKMR[3,], pch=16, col=3)
points(sd_ARE_ssb_N5000_Ind50_ckmrmultinom5[3,], pch=16, col=4)
points(sd_ARE_ssb_N5000_Ind50_ckmrmultinom10[3,], pch=16, col=5)
points(sd_ARE_ssb_N5000_Ind50_ckmrmultinom20[3,], pch=16, col=6)

#Index 0.25
par(mfcol=c(3,3), mar=c(3,4,1,1), oma=c(2,2,1,1))
plot(sd_ARE_ssb_N100_Ind25_5yrs_noCKMR[1,], pch=16, ylim=c(0,0.15), las=1, ylab="", main="Cod - N100")
points(sd_ARE_ssb_N100_Ind25_10yrs_noCKMR[1,], pch=16, col=2)
points(sd_ARE_ssb_N100_Ind25_20yrs_noCKMR[1,], pch=16, col=3)
points(sd_ARE_ssb_N100_Ind25_ckmrmultinom5[1,], pch=16, col=4)
points(sd_ARE_ssb_N100_Ind25_ckmrmultinom10[1,], pch=16, col=5)
points(sd_ARE_ssb_N100_Ind25_ckmrmultinom20[1,], pch=16, col=6)
plot(sd_ARE_ssb_N100_Ind25_5yrs_noCKMR[2,], pch=16, ylim=c(0,0.15), las=1, ylab="SD SSB ARE", main="Index 0.25, Flatfish - N100")
points(sd_ARE_ssb_N100_Ind25_10yrs_noCKMR[2,], pch=16, col=2)
points(sd_ARE_ssb_N100_Ind25_20yrs_noCKMR[2,], pch=16, col=3)
points(sd_ARE_ssb_N100_Ind25_ckmrmultinom5[2,], pch=16, col=4)
points(sd_ARE_ssb_N100_Ind25_ckmrmultinom10[2,], pch=16, col=5)
points(sd_ARE_ssb_N100_Ind25_ckmrmultinom20[2,], pch=16, col=6)
plot(sd_ARE_ssb_N100_Ind25_5yrs_noCKMR[3,], pch=16, ylim=c(0,0.25), las=1, ylab="", main="Sardine - N100")
points(sd_ARE_ssb_N100_Ind25_10yrs_noCKMR[3,], pch=16, col=2)
points(sd_ARE_ssb_N100_Ind25_20yrs_noCKMR[3,], pch=16, col=3)
points(sd_ARE_ssb_N100_Ind25_ckmrmultinom5[3,], pch=16, col=4)
points(sd_ARE_ssb_N100_Ind25_ckmrmultinom10[3,], pch=16, col=5)
points(sd_ARE_ssb_N100_Ind25_ckmrmultinom20[3,], pch=16, col=6)

plot(sd_ARE_ssb_N1000_Ind25_5yrs_noCKMR[1,], pch=16, ylim=c(0,0.15), las=1, ylab="", main="Cod - N1000")
points(sd_ARE_ssb_N1000_Ind25_10yrs_noCKMR[1,], pch=16, col=2)
points(sd_ARE_ssb_N1000_Ind25_20yrs_noCKMR[1,], pch=16, col=3)
points(sd_ARE_ssb_N1000_Ind25_ckmrmultinom5[1,], pch=16, col=4)
points(sd_ARE_ssb_N1000_Ind25_ckmrmultinom10[1,], pch=16, col=5)
points(sd_ARE_ssb_N1000_Ind25_ckmrmultinom20[1,], pch=16, col=6)
legend("top", c("No CKMR 5yrs","No CKMR 10yrs","No CKMR 20yrs","CKMR 5 years","CKMR 10 years","CKMR 20 years"), col=1:6, pch=16)
plot(sd_ARE_ssb_N1000_Ind25_5yrs_noCKMR[2,], pch=16, ylim=c(0,0.15), las=1, ylab="SD SSB ARE", main="Flatfish - N1000")
points(sd_ARE_ssb_N1000_Ind25_10yrs_noCKMR[2,], pch=16, col=2)
points(sd_ARE_ssb_N1000_Ind25_20yrs_noCKMR[2,], pch=16, col=3)
points(sd_ARE_ssb_N1000_Ind25_ckmrmultinom5[2,], pch=16, col=4)
points(sd_ARE_ssb_N1000_Ind25_ckmrmultinom10[2,], pch=16, col=5)
points(sd_ARE_ssb_N1000_Ind25_ckmrmultinom20[2,], pch=16, col=6)
plot(sd_ARE_ssb_N1000_Ind25_5yrs_noCKMR[3,], pch=16, ylim=c(0,0.25), las=1, ylab="", main="Sardine - N1000")
points(sd_ARE_ssb_N1000_Ind25_10yrs_noCKMR[3,], pch=16, col=2)
points(sd_ARE_ssb_N1000_Ind25_20yrs_noCKMR[3,], pch=16, col=3)
points(sd_ARE_ssb_N1000_Ind25_ckmrmultinom5[3,], pch=16, col=4)
points(sd_ARE_ssb_N1000_Ind25_ckmrmultinom10[3,], pch=16, col=5)
points(sd_ARE_ssb_N1000_Ind25_ckmrmultinom20[3,], pch=16, col=6)

plot(sd_ARE_ssb_N5000_Ind25_5yrs_noCKMR[1,], pch=16, ylim=c(0,0.15), las=1, ylab="", main="Cod - N5000")
points(sd_ARE_ssb_N5000_Ind25_10yrs_noCKMR[1,], pch=16, col=2)
points(sd_ARE_ssb_N5000_Ind25_20yrs_noCKMR[1,], pch=16, col=3)
points(sd_ARE_ssb_N5000_Ind25_ckmrmultinom5[1,], pch=16, col=4)
points(sd_ARE_ssb_N5000_Ind25_ckmrmultinom10[1,], pch=16, col=5)
points(sd_ARE_ssb_N5000_Ind25_ckmrmultinom20[1,], pch=16, col=6)
plot(sd_ARE_ssb_N5000_Ind25_5yrs_noCKMR[2,], pch=16, ylim=c(0,0.15), las=1, ylab="SD SSB ARE", main="Flatfish - N5000")
points(sd_ARE_ssb_N5000_Ind25_10yrs_noCKMR[2,], pch=16, col=2)
points(sd_ARE_ssb_N5000_Ind25_20yrs_noCKMR[2,], pch=16, col=3)
points(sd_ARE_ssb_N5000_Ind25_ckmrmultinom5[2,], pch=16, col=4)
points(sd_ARE_ssb_N5000_Ind25_ckmrmultinom10[2,], pch=16, col=5)
points(sd_ARE_ssb_N5000_Ind25_ckmrmultinom20[2,], pch=16, col=6)
plot(sd_ARE_ssb_N5000_Ind25_5yrs_noCKMR[3,], pch=16, ylim=c(0,0.25), las=1, ylab="", main="Sardine - N5000")
points(sd_ARE_ssb_N5000_Ind25_10yrs_noCKMR[3,], pch=16, col=2)
points(sd_ARE_ssb_N5000_Ind25_20yrs_noCKMR[3,], pch=16, col=3)
points(sd_ARE_ssb_N5000_Ind25_ckmrmultinom5[3,], pch=16, col=4)
points(sd_ARE_ssb_N5000_Ind25_ckmrmultinom10[3,], pch=16, col=5)
points(sd_ARE_ssb_N5000_Ind25_ckmrmultinom20[3,], pch=16, col=6)

#Relative to NO CKMR
#No Index
par(mfcol=c(3,3), mar=c(3,4,1,1), oma=c(2,2,1,1))
plot(sd_ARE_ssb_N100_NoIndex_ckmrmultinom5[1,]/sd_ARE_ssb_N100_NoIndex_5yrs_noCKMR[1,], pch=16, ylim=c(0.75,1.25), las=1, ylab="", main="Cod - N100")
points(sd_ARE_ssb_N100_NoIndex_ckmrmultinom10[1,]/sd_ARE_ssb_N100_NoIndex_10yrs_noCKMR[1,], pch=16, col=3)
points(sd_ARE_ssb_N100_NoIndex_ckmrmultinom20[1,]/sd_ARE_ssb_N100_NoIndex_20yrs_noCKMR[1,], pch=16, col=4)
plot(sd_ARE_ssb_N100_NoIndex_ckmrmultinom5[2,]/sd_ARE_ssb_N100_NoIndex_5yrs_noCKMR[2,], pch=16, ylim=c(0,1.25), las=1, ylab="SD SSB ARE, ARElative to NO CKMR", main="Flatfish - N100")
points(sd_ARE_ssb_N100_NoIndex_ckmrmultinom10[2,]/sd_ARE_ssb_N100_NoIndex_10yrs_noCKMR[2,], pch=16, col=3)
points(sd_ARE_ssb_N100_NoIndex_ckmrmultinom20[2,]/sd_ARE_ssb_N100_NoIndex_20yrs_noCKMR[2,], pch=16, col=4)
plot(sd_ARE_ssb_N100_NoIndex_ckmrmultinom5[3,]/sd_ARE_ssb_N100_NoIndex_5yrs_noCKMR[3,], pch=16, ylim=c(0.3,1.25), las=1, ylab="", main="Sardine - N100")
points(sd_ARE_ssb_N100_NoIndex_ckmrmultinom10[3,]/sd_ARE_ssb_N100_NoIndex_10yrs_noCKMR[3,], pch=16, col=3)
points(sd_ARE_ssb_N100_NoIndex_ckmrmultinom20[3,]/sd_ARE_ssb_N100_NoIndex_20yrs_noCKMR[3,], pch=16, col=4)

plot(sd_ARE_ssb_N1000_NoIndex_ckmrmultinom5[1,]/sd_ARE_ssb_N1000_NoIndex_5yrs_noCKMR[1,], pch=16, ylim=c(0.75,1.25), las=1, ylab="", main="No Index,  Cod - N1000")
points(sd_ARE_ssb_N1000_NoIndex_ckmrmultinom10[1,]/sd_ARE_ssb_N1000_NoIndex_10yrs_noCKMR[1,], pch=16, col=3)
points(sd_ARE_ssb_N1000_NoIndex_ckmrmultinom20[1,]/sd_ARE_ssb_N1000_NoIndex_20yrs_noCKMR[1,], pch=16, col=4)
legend("top", c("CKMR 5 years","CKMR 10 years","CKMR 20 years"), col=c(1,3,4), pch=16)
plot(sd_ARE_ssb_N1000_NoIndex_ckmrmultinom5[2,]/sd_ARE_ssb_N1000_NoIndex_5yrs_noCKMR[2,], pch=16, ylim=c(0,1.25), las=1, ylab="", main="Flatfish - N1000")
points(sd_ARE_ssb_N1000_NoIndex_ckmrmultinom10[2,]/sd_ARE_ssb_N1000_NoIndex_10yrs_noCKMR[2,], pch=16, col=3)
points(sd_ARE_ssb_N1000_NoIndex_ckmrmultinom20[2,]/sd_ARE_ssb_N1000_NoIndex_20yrs_noCKMR[2,], pch=16, col=4)
plot(sd_ARE_ssb_N1000_NoIndex_ckmrmultinom5[3,]/sd_ARE_ssb_N1000_NoIndex_5yrs_noCKMR[3,], pch=16, ylim=c(0.3,1.25), las=1, ylab="", main="Sardine - N1000")
points(sd_ARE_ssb_N1000_NoIndex_ckmrmultinom10[3,]/sd_ARE_ssb_N1000_NoIndex_10yrs_noCKMR[3,], pch=16, col=3)
points(sd_ARE_ssb_N1000_NoIndex_ckmrmultinom20[3,]/sd_ARE_ssb_N1000_NoIndex_20yrs_noCKMR[3,], pch=16, col=4)

plot(sd_ARE_ssb_N5000_NoIndex_ckmrmultinom5[1,]/sd_ARE_ssb_N5000_NoIndex_5yrs_noCKMR[1,], pch=16, ylim=c(0.75,1.25), las=1, ylab="", main="Cod - N5000")
points(sd_ARE_ssb_N5000_NoIndex_ckmrmultinom10[1,]/sd_ARE_ssb_N5000_NoIndex_10yrs_noCKMR[1,], pch=16, col=3)
points(sd_ARE_ssb_N5000_NoIndex_ckmrmultinom20[1,]/sd_ARE_ssb_N5000_NoIndex_20yrs_noCKMR[1,], pch=16, col=4)
plot(sd_ARE_ssb_N5000_NoIndex_ckmrmultinom5[2,]/sd_ARE_ssb_N5000_NoIndex_5yrs_noCKMR[2,], pch=16, ylim=c(0,1.25), las=1, ylab="", main="Flatfish - N5000")
points(sd_ARE_ssb_N5000_NoIndex_ckmrmultinom10[2,]/sd_ARE_ssb_N5000_NoIndex_10yrs_noCKMR[2,], pch=16, col=3)
points(sd_ARE_ssb_N5000_NoIndex_ckmrmultinom20[2,]/sd_ARE_ssb_N5000_NoIndex_20yrs_noCKMR[2,], pch=16, col=4)
plot(sd_ARE_ssb_N5000_NoIndex_ckmrmultinom5[3,]/sd_ARE_ssb_N5000_NoIndex_5yrs_noCKMR[3,], pch=16, ylim=c(0.3,1.25), las=1, ylab="", main="Sardine - N5000")
points(sd_ARE_ssb_N5000_NoIndex_ckmrmultinom10[3,]/sd_ARE_ssb_N5000_NoIndex_10yrs_noCKMR[3,], pch=16, col=3)
points(sd_ARE_ssb_N5000_NoIndex_ckmrmultinom20[3,]/sd_ARE_ssb_N5000_NoIndex_20yrs_noCKMR[3,], pch=16, col=4)

#Index 0.50
par(mfcol=c(3,3), mar=c(3,4,1,1), oma=c(2,2,1,1))
plot(sd_ARE_ssb_N100_Ind50_ckmrmultinom5[1,]/sd_ARE_ssb_N100_Ind50_5yrs_noCKMR[1,], pch=16, ylim=c(0.75,1.25), las=1, ylab="", main="Cod - N100")
points(sd_ARE_ssb_N100_Ind50_ckmrmultinom10[1,]/sd_ARE_ssb_N100_Ind50_10yrs_noCKMR[1,], pch=16, col=3)
points(sd_ARE_ssb_N100_Ind50_ckmrmultinom20[1,]/sd_ARE_ssb_N100_Ind50_20yrs_noCKMR[1,], pch=16, col=4)
plot(sd_ARE_ssb_N100_Ind50_ckmrmultinom5[2,]/sd_ARE_ssb_N100_Ind50_5yrs_noCKMR[2,], pch=16, ylim=c(0,1.25), las=1, ylab="SD SSB ARE, ARElative to NO CKMR", main="Flatfish - N100")
points(sd_ARE_ssb_N100_Ind50_ckmrmultinom10[2,]/sd_ARE_ssb_N100_Ind50_10yrs_noCKMR[2,], pch=16, col=3)
points(sd_ARE_ssb_N100_Ind50_ckmrmultinom20[2,]/sd_ARE_ssb_N100_Ind50_20yrs_noCKMR[2,], pch=16, col=4)
plot(sd_ARE_ssb_N100_Ind50_ckmrmultinom5[3,]/sd_ARE_ssb_N100_Ind50_5yrs_noCKMR[3,], pch=16, ylim=c(0.3,1.25), las=1, ylab="", main="Sardine - N100")
points(sd_ARE_ssb_N100_Ind50_ckmrmultinom10[3,]/sd_ARE_ssb_N100_Ind50_10yrs_noCKMR[3,], pch=16, col=3)
points(sd_ARE_ssb_N100_Ind50_ckmrmultinom20[3,]/sd_ARE_ssb_N100_Ind50_20yrs_noCKMR[3,], pch=16, col=4)

plot(sd_ARE_ssb_N1000_Ind50_ckmrmultinom5[1,]/sd_ARE_ssb_N1000_Ind50_5yrs_noCKMR[1,], pch=16, ylim=c(0.75,1.25), las=1, ylab="", main="Index 0.5,  Cod - N1000")
points(sd_ARE_ssb_N1000_Ind50_ckmrmultinom10[1,]/sd_ARE_ssb_N1000_Ind50_10yrs_noCKMR[1,], pch=16, col=3)
points(sd_ARE_ssb_N1000_Ind50_ckmrmultinom20[1,]/sd_ARE_ssb_N1000_Ind50_20yrs_noCKMR[1,], pch=16, col=4)
legend("top", c("CKMR 5 years","CKMR 10 years","CKMR 20 years"), col=c(1,3,4), pch=16)
plot(sd_ARE_ssb_N1000_Ind50_ckmrmultinom5[2,]/sd_ARE_ssb_N1000_Ind50_5yrs_noCKMR[2,], pch=16, ylim=c(0,1.25), las=1, ylab="", main="Flatfish - N1000")
points(sd_ARE_ssb_N1000_Ind50_ckmrmultinom10[2,]/sd_ARE_ssb_N1000_Ind50_10yrs_noCKMR[2,], pch=16, col=3)
points(sd_ARE_ssb_N1000_Ind50_ckmrmultinom20[2,]/sd_ARE_ssb_N1000_Ind50_20yrs_noCKMR[2,], pch=16, col=4)
plot(sd_ARE_ssb_N1000_Ind50_ckmrmultinom5[3,]/sd_ARE_ssb_N1000_Ind50_5yrs_noCKMR[3,], pch=16, ylim=c(0.3,1.25), las=1, ylab="", main="Sardine - N1000")
points(sd_ARE_ssb_N1000_Ind50_ckmrmultinom10[3,]/sd_ARE_ssb_N1000_Ind50_10yrs_noCKMR[3,], pch=16, col=3)
points(sd_ARE_ssb_N1000_Ind50_ckmrmultinom20[3,]/sd_ARE_ssb_N1000_Ind50_20yrs_noCKMR[3,], pch=16, col=4)

plot(sd_ARE_ssb_N5000_Ind50_ckmrmultinom5[1,]/sd_ARE_ssb_N5000_Ind50_5yrs_noCKMR[1,], pch=16, ylim=c(0.75,1.25), las=1, ylab="", main="Cod - N5000")
points(sd_ARE_ssb_N5000_Ind50_ckmrmultinom10[1,]/sd_ARE_ssb_N5000_Ind50_10yrs_noCKMR[1,], pch=16, col=3)
points(sd_ARE_ssb_N5000_Ind50_ckmrmultinom20[1,]/sd_ARE_ssb_N5000_Ind50_20yrs_noCKMR[1,], pch=16, col=4)
plot(sd_ARE_ssb_N5000_Ind50_ckmrmultinom5[2,]/sd_ARE_ssb_N5000_Ind50_5yrs_noCKMR[2,], pch=16, ylim=c(0,1.25), las=1, ylab="", main="Flatfish - N5000")
points(sd_ARE_ssb_N5000_Ind50_ckmrmultinom10[2,]/sd_ARE_ssb_N5000_Ind50_10yrs_noCKMR[2,], pch=16, col=3)
points(sd_ARE_ssb_N5000_Ind50_ckmrmultinom20[2,]/sd_ARE_ssb_N5000_Ind50_20yrs_noCKMR[2,], pch=16, col=4)
plot(sd_ARE_ssb_N5000_Ind50_ckmrmultinom5[3,]/sd_ARE_ssb_N5000_Ind50_5yrs_noCKMR[3,], pch=16, ylim=c(0.3,1.25), las=1, ylab="", main="Sardine - N5000")
points(sd_ARE_ssb_N5000_Ind50_ckmrmultinom10[3,]/sd_ARE_ssb_N5000_Ind50_10yrs_noCKMR[3,], pch=16, col=3)
points(sd_ARE_ssb_N5000_Ind50_ckmrmultinom20[3,]/sd_ARE_ssb_N5000_Ind50_20yrs_noCKMR[3,], pch=16, col=4)

#Index 0.25
par(mfcol=c(3,3), mar=c(3,4,1,1), oma=c(2,2,1,1))
plot(sd_ARE_ssb_N100_Ind25_ckmrmultinom5[1,]/sd_ARE_ssb_N100_Ind25_5yrs_noCKMR[1,], pch=16, ylim=c(0.75,1.25), las=1, ylab="", main="Cod - N100")
points(sd_ARE_ssb_N100_Ind25_ckmrmultinom10[1,]/sd_ARE_ssb_N100_Ind25_10yrs_noCKMR[1,], pch=16, col=3)
points(sd_ARE_ssb_N100_Ind25_ckmrmultinom20[1,]/sd_ARE_ssb_N100_Ind25_20yrs_noCKMR[1,], pch=16, col=4)
plot(sd_ARE_ssb_N100_Ind25_ckmrmultinom5[2,]/sd_ARE_ssb_N100_Ind25_5yrs_noCKMR[2,], pch=16, ylim=c(0,1.25), las=1, ylab="SD SSB ARE, ARElative to NO CKMR", main="Flatfish - N100")
points(sd_ARE_ssb_N100_Ind25_ckmrmultinom10[2,]/sd_ARE_ssb_N100_Ind25_10yrs_noCKMR[2,], pch=16, col=3)
points(sd_ARE_ssb_N100_Ind25_ckmrmultinom20[2,]/sd_ARE_ssb_N100_Ind25_20yrs_noCKMR[2,], pch=16, col=4)
plot(sd_ARE_ssb_N100_Ind25_ckmrmultinom5[3,]/sd_ARE_ssb_N100_Ind25_5yrs_noCKMR[3,], pch=16, ylim=c(0.3,1.25), las=1, ylab="", main="Sardine - N100")
points(sd_ARE_ssb_N100_Ind25_ckmrmultinom10[3,]/sd_ARE_ssb_N100_Ind25_10yrs_noCKMR[3,], pch=16, col=3)
points(sd_ARE_ssb_N100_Ind25_ckmrmultinom20[3,]/sd_ARE_ssb_N100_Ind25_20yrs_noCKMR[3,], pch=16, col=4)

plot(sd_ARE_ssb_N1000_Ind25_ckmrmultinom5[1,]/sd_ARE_ssb_N1000_Ind25_5yrs_noCKMR[1,], pch=16, ylim=c(0.75,1.25), las=1, ylab="", main="Index 0.25,  Cod - N1000")
points(sd_ARE_ssb_N1000_Ind25_ckmrmultinom10[1,]/sd_ARE_ssb_N1000_Ind25_10yrs_noCKMR[1,], pch=16, col=3)
points(sd_ARE_ssb_N1000_Ind25_ckmrmultinom20[1,]/sd_ARE_ssb_N1000_Ind25_20yrs_noCKMR[1,], pch=16, col=4)
legend("top", c("CKMR 5 years","CKMR 10 years","CKMR 20 years"), col=c(1,3,4), pch=16)
plot(sd_ARE_ssb_N1000_Ind25_ckmrmultinom5[2,]/sd_ARE_ssb_N1000_Ind25_5yrs_noCKMR[2,], pch=16, ylim=c(0,1.25), las=1, ylab="", main="Flatfish - N1000")
points(sd_ARE_ssb_N1000_Ind25_ckmrmultinom10[2,]/sd_ARE_ssb_N1000_Ind25_10yrs_noCKMR[2,], pch=16, col=3)
points(sd_ARE_ssb_N1000_Ind25_ckmrmultinom20[2,]/sd_ARE_ssb_N1000_Ind25_20yrs_noCKMR[2,], pch=16, col=4)
plot(sd_ARE_ssb_N1000_Ind25_ckmrmultinom5[3,]/sd_ARE_ssb_N1000_Ind25_5yrs_noCKMR[3,], pch=16, ylim=c(0.3,1.25), las=1, ylab="", main="Sardine - N1000")
points(sd_ARE_ssb_N1000_Ind25_ckmrmultinom10[3,]/sd_ARE_ssb_N1000_Ind25_10yrs_noCKMR[3,], pch=16, col=3)
points(sd_ARE_ssb_N1000_Ind25_ckmrmultinom20[3,]/sd_ARE_ssb_N1000_Ind25_20yrs_noCKMR[3,], pch=16, col=4)

plot(sd_ARE_ssb_N5000_Ind25_ckmrmultinom5[1,]/sd_ARE_ssb_N5000_Ind25_5yrs_noCKMR[1,], pch=16, ylim=c(0.75,1.25), las=1, ylab="", main="Cod - N5000")
points(sd_ARE_ssb_N5000_Ind25_ckmrmultinom10[1,]/sd_ARE_ssb_N5000_Ind25_10yrs_noCKMR[1,], pch=16, col=3)
points(sd_ARE_ssb_N5000_Ind25_ckmrmultinom20[1,]/sd_ARE_ssb_N5000_Ind25_20yrs_noCKMR[1,], pch=16, col=4)
plot(sd_ARE_ssb_N5000_Ind25_ckmrmultinom5[2,]/sd_ARE_ssb_N5000_Ind25_5yrs_noCKMR[2,], pch=16, ylim=c(0,1.25), las=1, ylab="", main="Flatfish - N5000")
points(sd_ARE_ssb_N5000_Ind25_ckmrmultinom10[2,]/sd_ARE_ssb_N5000_Ind25_10yrs_noCKMR[2,], pch=16, col=3)
points(sd_ARE_ssb_N5000_Ind25_ckmrmultinom20[2,]/sd_ARE_ssb_N5000_Ind25_20yrs_noCKMR[2,], pch=16, col=4)
plot(sd_ARE_ssb_N5000_Ind25_ckmrmultinom5[3,]/sd_ARE_ssb_N5000_Ind25_5yrs_noCKMR[3,], pch=16, ylim=c(0.3,1.25), las=1, ylab="", main="Sardine - N5000")
points(sd_ARE_ssb_N5000_Ind25_ckmrmultinom10[3,]/sd_ARE_ssb_N5000_Ind25_10yrs_noCKMR[3,], pch=16, col=3)
points(sd_ARE_ssb_N5000_Ind25_ckmrmultinom20[3,]/sd_ARE_ssb_N5000_Ind25_20yrs_noCKMR[3,], pch=16, col=4)

########################################
#R0 sd of relative error between sims 
########################################

#No Index
par(mfrow=c(2,3), mar=c(3,4,1,1), oma=c(2,2,1,1))
plot(1:3,sd_RE_R0_N100_NoIndex_5yrs_noCKMR, ylim=c(0,0.2), las=1, ylab="SD RE log(R0)", xaxt="n", pch=16, main="N100", xlab="",xlim=c(0.5,3.5))
points(1:3,sd_RE_R0_N100_NoIndex_10yrs_noCKMR, pch=16, col=2)
points(1:3,sd_RE_R0_N100_NoIndex_20yrs_noCKMR, pch=16, col=3)
points(1:3,sd_RE_R0_N100_NoIndex_ckmrmultinom5, pch=16, col=4)
points(1:3,sd_RE_R0_N100_NoIndex_ckmrmultinom10, pch=16, col=5)
points(1:3,sd_RE_R0_N100_NoIndex_ckmrmultinom20, pch=16, col=6)
plot(1:3,sd_RE_R0_N1000_NoIndex_5yrs_noCKMR, ylim=c(0,0.2), las=1, ylab="", xaxt="n", pch=16, main="No Index,  N1000", xlab="",xlim=c(0.5,3.5))
legend("top", c("No CKMR 5yrs","No CKMR 10yrs","CKMR 5yrs", "CKMR 10yrs"), col=c(1,4,2,3), pch=16)
points(1:3,sd_RE_R0_N1000_NoIndex_10yrs_noCKMR, pch=16, col=2)
points(1:3,sd_RE_R0_N1000_NoIndex_20yrs_noCKMR, pch=16, col=3)
points(1:3,sd_RE_R0_N1000_NoIndex_ckmrmultinom5, pch=16, col=4)
points(1:3,sd_RE_R0_N1000_NoIndex_ckmrmultinom10, pch=16, col=5)
points(1:3,sd_RE_R0_N1000_NoIndex_ckmrmultinom20, pch=16, col=6)
plot(1:3,sd_RE_R0_N5000_NoIndex_5yrs_noCKMR, ylim=c(0,0.2), las=1, ylab="SD RE log(R0)", xaxt="n", pch=16, main="N5000", xlab="",xlim=c(0.5,3.5))
points(1:3,sd_RE_R0_N5000_NoIndex_10yrs_noCKMR, pch=16, col=2)
points(1:3,sd_RE_R0_N5000_NoIndex_20yrs_noCKMR, pch=16, col=3)
points(1:3,sd_RE_R0_N5000_NoIndex_ckmrmultinom5, pch=16, col=4)
points(1:3,sd_RE_R0_N5000_NoIndex_ckmrmultinom10, pch=16, col=5)
points(1:3,sd_RE_R0_N5000_NoIndex_ckmrmultinom20, pch=16, col=6)
plot(1:3,sd_ARE_R0_N100_NoIndex_5yrs_noCKMR, ylim=c(0,0.2), las=1, ylab="SD ARE log(R0)", xaxt="n", pch=16, main="N100", xlab="",xlim=c(0.5,3.5))
points(1:3,sd_ARE_R0_N100_NoIndex_10yrs_noCKMR, pch=16, col=2)
points(1:3,sd_ARE_R0_N100_NoIndex_20yrs_noCKMR, pch=16, col=3)
points(1:3,sd_ARE_R0_N100_NoIndex_ckmrmultinom5, pch=16, col=4)
points(1:3,sd_ARE_R0_N100_NoIndex_ckmrmultinom10, pch=16, col=5)
points(1:3,sd_ARE_R0_N100_NoIndex_ckmrmultinom20, pch=16, col=6)
axis(side=1, at=1:3, labels=c("Cod", "Flatfish", "Sardine"))
plot(1:3,sd_ARE_R0_N1000_NoIndex_5yrs_noCKMR, ylim=c(0,0.2), las=1, ylab="", xaxt="n", pch=16, main="N1000", xlab="",xlim=c(0.5,3.5))
points(1:3,sd_ARE_R0_N1000_NoIndex_10yrs_noCKMR, pch=16, col=2)
points(1:3,sd_ARE_R0_N1000_NoIndex_20yrs_noCKMR, pch=16, col=3)
points(1:3,sd_ARE_R0_N1000_NoIndex_ckmrmultinom5, pch=16, col=4)
points(1:3,sd_ARE_R0_N1000_NoIndex_ckmrmultinom10, pch=16, col=5)
points(1:3,sd_ARE_R0_N1000_NoIndex_ckmrmultinom20, pch=16, col=6)
axis(side=1, at=1:3, labels=c("Cod", "Flatfish", "Sardine"))
plot(1:3,sd_ARE_R0_N5000_NoIndex_5yrs_noCKMR, ylim=c(0,0.2), las=1, ylab="SD ARE log(R0)", xaxt="n", pch=16, main="N5000", xlab="",xlim=c(0.5,3.5))
points(1:3,sd_ARE_R0_N5000_NoIndex_10yrs_noCKMR, pch=16, col=2)
points(1:3,sd_ARE_R0_N5000_NoIndex_20yrs_noCKMR, pch=16, col=3)
points(1:3,sd_ARE_R0_N5000_NoIndex_ckmrmultinom5, pch=16, col=4)
points(1:3,sd_ARE_R0_N5000_NoIndex_ckmrmultinom10, pch=16, col=5)
points(1:3,sd_ARE_R0_N5000_NoIndex_ckmrmultinom20, pch=16, col=6)
axis(side=1, at=1:3, labels=c("Cod", "Flatfish", "Sardine"))

#Index 0.50
par(mfrow=c(2,3), mar=c(3,4,1,1), oma=c(2,2,1,1))
plot(1:3,sd_RE_R0_N100_Ind50_5yrs_noCKMR, ylim=c(0,0.2), las=1, ylab="SD RE log(R0)", xaxt="n", pch=16, main="N100", xlab="",xlim=c(0.5,3.5))
points(1:3,sd_RE_R0_N100_Ind50_10yrs_noCKMR, pch=16, col=2)
points(1:3,sd_RE_R0_N100_Ind50_20yrs_noCKMR, pch=16, col=3)
points(1:3,sd_RE_R0_N100_Ind50_ckmrmultinom5, pch=16, col=4)
points(1:3,sd_RE_R0_N100_Ind50_ckmrmultinom10, pch=16, col=5)
points(1:3,sd_RE_R0_N100_Ind50_ckmrmultinom20, pch=16, col=6)
plot(1:3,sd_RE_R0_N1000_Ind50_5yrs_noCKMR, ylim=c(0,0.2), las=1, ylab="", xaxt="n", pch=16, main="Index 0.50,  N1000", xlab="",xlim=c(0.5,3.5))
legend("top", c("No CKMR 5yrs","No CKMR 10yrs","CKMR 5yrs", "CKMR 10yrs"), col=c(1,4,2,3), pch=16)
points(1:3,sd_RE_R0_N1000_Ind50_10yrs_noCKMR, pch=16, col=2)
points(1:3,sd_RE_R0_N1000_Ind50_20yrs_noCKMR, pch=16, col=3)
points(1:3,sd_RE_R0_N1000_Ind50_ckmrmultinom5, pch=16, col=4)
points(1:3,sd_RE_R0_N1000_Ind50_ckmrmultinom10, pch=16, col=5)
points(1:3,sd_RE_R0_N1000_Ind50_ckmrmultinom20, pch=16, col=6)
plot(1:3,sd_RE_R0_N5000_Ind50_5yrs_noCKMR, ylim=c(0,0.2), las=1, ylab="SD RE log(R0)", xaxt="n", pch=16, main="N5000", xlab="",xlim=c(0.5,3.5))
points(1:3,sd_RE_R0_N5000_Ind50_10yrs_noCKMR, pch=16, col=2)
points(1:3,sd_RE_R0_N5000_Ind50_20yrs_noCKMR, pch=16, col=3)
points(1:3,sd_RE_R0_N5000_Ind50_ckmrmultinom5, pch=16, col=4)
points(1:3,sd_RE_R0_N5000_Ind50_ckmrmultinom10, pch=16, col=5)
points(1:3,sd_RE_R0_N5000_Ind50_ckmrmultinom20, pch=16, col=6)
plot(1:3,sd_ARE_R0_N100_Ind50_5yrs_noCKMR, ylim=c(0,0.2), las=1, ylab="SD ARE log(R0)", xaxt="n", pch=16, main="N100", xlab="",xlim=c(0.5,3.5))
points(1:3,sd_ARE_R0_N100_Ind50_10yrs_noCKMR, pch=16, col=2)
points(1:3,sd_ARE_R0_N100_Ind50_20yrs_noCKMR, pch=16, col=3)
points(1:3,sd_ARE_R0_N100_Ind50_ckmrmultinom5, pch=16, col=4)
points(1:3,sd_ARE_R0_N100_Ind50_ckmrmultinom10, pch=16, col=5)
points(1:3,sd_ARE_R0_N100_Ind50_ckmrmultinom20, pch=16, col=6)
axis(side=1, at=1:3, labels=c("Cod", "Flatfish", "Sardine"))
plot(1:3,sd_ARE_R0_N1000_Ind50_5yrs_noCKMR, ylim=c(0,0.2), las=1, ylab="", xaxt="n", pch=16, main="N1000", xlab="",xlim=c(0.5,3.5))
points(1:3,sd_ARE_R0_N1000_Ind50_10yrs_noCKMR, pch=16, col=2)
points(1:3,sd_ARE_R0_N1000_Ind50_20yrs_noCKMR, pch=16, col=3)
points(1:3,sd_ARE_R0_N1000_Ind50_ckmrmultinom5, pch=16, col=4)
points(1:3,sd_ARE_R0_N1000_Ind50_ckmrmultinom10, pch=16, col=5)
points(1:3,sd_ARE_R0_N1000_Ind50_ckmrmultinom20, pch=16, col=6)
axis(side=1, at=1:3, labels=c("Cod", "Flatfish", "Sardine"))
plot(1:3,sd_ARE_R0_N5000_Ind50_5yrs_noCKMR, ylim=c(0,0.2), las=1, ylab="SD ARE log(R0)", xaxt="n", pch=16, main="N5000", xlab="",xlim=c(0.5,3.5))
points(1:3,sd_ARE_R0_N5000_Ind50_10yrs_noCKMR, pch=16, col=2)
points(1:3,sd_ARE_R0_N5000_Ind50_20yrs_noCKMR, pch=16, col=3)
points(1:3,sd_ARE_R0_N5000_Ind50_ckmrmultinom5, pch=16, col=4)
points(1:3,sd_ARE_R0_N5000_Ind50_ckmrmultinom10, pch=16, col=5)
points(1:3,sd_ARE_R0_N5000_Ind50_ckmrmultinom20, pch=16, col=6)
axis(side=1, at=1:3, labels=c("Cod", "Flatfish", "Sardine"))

#Index 0.25
par(mfrow=c(2,3), mar=c(3,4,1,1), oma=c(2,2,1,1))
plot(1:3,sd_RE_R0_N100_Ind25_5yrs_noCKMR, ylim=c(0,0.2), las=1, ylab="SD RE log(R0)", xaxt="n", pch=16, main="N100", xlab="",xlim=c(0.5,3.5))
points(1:3,sd_RE_R0_N100_Ind25_10yrs_noCKMR, pch=16, col=2)
points(1:3,sd_RE_R0_N100_Ind25_20yrs_noCKMR, pch=16, col=3)
points(1:3,sd_RE_R0_N100_Ind25_ckmrmultinom5, pch=16, col=4)
points(1:3,sd_RE_R0_N100_Ind25_ckmrmultinom10, pch=16, col=5)
points(1:3,sd_RE_R0_N100_Ind25_ckmrmultinom20, pch=16, col=6)
plot(1:3,sd_RE_R0_N1000_Ind25_5yrs_noCKMR, ylim=c(0,0.2), las=1, ylab="", xaxt="n", pch=16, main="Index 0.25,  N1000", xlab="",xlim=c(0.5,3.5))
legend("top", c("No CKMR 5yrs","No CKMR 10yrs","CKMR 5yrs", "CKMR 10yrs"), col=c(1,4,2,3), pch=16)
points(1:3,sd_RE_R0_N1000_Ind25_10yrs_noCKMR, pch=16, col=2)
points(1:3,sd_RE_R0_N1000_Ind25_20yrs_noCKMR, pch=16, col=3)
points(1:3,sd_RE_R0_N1000_Ind25_ckmrmultinom5, pch=16, col=4)
points(1:3,sd_RE_R0_N1000_Ind25_ckmrmultinom10, pch=16, col=5)
points(1:3,sd_RE_R0_N1000_Ind25_ckmrmultinom20, pch=16, col=6)
plot(1:3,sd_RE_R0_N5000_Ind25_5yrs_noCKMR, ylim=c(0,0.2), las=1, ylab="SD RE log(R0)", xaxt="n", pch=16, main="N5000", xlab="",xlim=c(0.5,3.5))
points(1:3,sd_RE_R0_N5000_Ind25_10yrs_noCKMR, pch=16, col=2)
points(1:3,sd_RE_R0_N5000_Ind25_20yrs_noCKMR, pch=16, col=3)
points(1:3,sd_RE_R0_N5000_Ind25_ckmrmultinom5, pch=16, col=4)
points(1:3,sd_RE_R0_N5000_Ind25_ckmrmultinom10, pch=16, col=5)
points(1:3,sd_RE_R0_N5000_Ind25_ckmrmultinom20, pch=16, col=6)
plot(1:3,sd_ARE_R0_N100_Ind25_5yrs_noCKMR, ylim=c(0,0.2), las=1, ylab="SD ARE log(R0)", xaxt="n", pch=16, main="N100", xlab="",xlim=c(0.5,3.5))
points(1:3,sd_ARE_R0_N100_Ind25_10yrs_noCKMR, pch=16, col=2)
points(1:3,sd_ARE_R0_N100_Ind25_20yrs_noCKMR, pch=16, col=3)
points(1:3,sd_ARE_R0_N100_Ind25_ckmrmultinom5, pch=16, col=4)
points(1:3,sd_ARE_R0_N100_Ind25_ckmrmultinom10, pch=16, col=5)
points(1:3,sd_ARE_R0_N100_Ind25_ckmrmultinom20, pch=16, col=6)
axis(side=1, at=1:3, labels=c("Cod", "Flatfish", "Sardine"))
plot(1:3,sd_ARE_R0_N1000_Ind25_5yrs_noCKMR, ylim=c(0,0.2), las=1, ylab="", xaxt="n", pch=16, main="N1000", xlab="",xlim=c(0.5,3.5))
points(1:3,sd_ARE_R0_N1000_Ind25_10yrs_noCKMR, pch=16, col=2)
points(1:3,sd_ARE_R0_N1000_Ind25_20yrs_noCKMR, pch=16, col=3)
points(1:3,sd_ARE_R0_N1000_Ind25_ckmrmultinom5, pch=16, col=4)
points(1:3,sd_ARE_R0_N1000_Ind25_ckmrmultinom10, pch=16, col=5)
points(1:3,sd_ARE_R0_N1000_Ind25_ckmrmultinom20, pch=16, col=6)
axis(side=1, at=1:3, labels=c("Cod", "Flatfish", "Sardine"))
plot(1:3,sd_ARE_R0_N5000_Ind25_5yrs_noCKMR, ylim=c(0,0.2), las=1, ylab="SD ARE log(R0)", xaxt="n", pch=16, main="N5000", xlab="",xlim=c(0.5,3.5))
points(1:3,sd_ARE_R0_N5000_Ind25_10yrs_noCKMR, pch=16, col=2)
points(1:3,sd_ARE_R0_N5000_Ind25_20yrs_noCKMR, pch=16, col=3)
points(1:3,sd_ARE_R0_N5000_Ind25_ckmrmultinom5, pch=16, col=4)
points(1:3,sd_ARE_R0_N5000_Ind25_ckmrmultinom10, pch=16, col=5)
points(1:3,sd_ARE_R0_N5000_Ind25_ckmrmultinom20, pch=16, col=6)
axis(side=1, at=1:3, labels=c("Cod", "Flatfish", "Sardine"))

#Relative to no CKMR
#No Index
par(mfrow=c(2,3), mar=c(3,4,1,1), oma=c(2,2,1,1))
plot(1:3,sd_RE_R0_N100_NoIndex_ckmrmultinom5/sd_RE_R0_N100_NoIndex_5yrs_noCKMR, ylim=c(0.6,1.05), las=1, ylab="SD RE log(R0), relative to NO CKMR", xaxt="n", pch=16, main="N100", xlab="",xlim=c(0.5,3.5))
points(1:3,sd_RE_R0_N100_NoIndex_ckmrmultinom10/sd_RE_R0_N100_NoIndex_10yrs_noCKMR, pch=16, col=3)
points(1:3,sd_RE_R0_N100_NoIndex_ckmrmultinom20/sd_RE_R0_N100_NoIndex_20yrs_noCKMR, pch=16, col=4)
plot(1:3,sd_RE_R0_N1000_NoIndex_ckmrmultinom5/sd_RE_R0_N1000_NoIndex_5yrs_noCKMR, ylim=c(0.6,1.05), las=1, ylab="", xaxt="n", pch=16, main="No Index,  N1000", xlab="",xlim=c(0.5,3.5))
legend("top", c("CKMR 5yrs", "CKMR 10yrs","CKMR 20yrs"), col=c(1,3,4), pch=16)
points(1:3,sd_RE_R0_N1000_NoIndex_ckmrmultinom10/sd_RE_R0_N1000_NoIndex_10yrs_noCKMR, pch=16, col=3)
points(1:3,sd_RE_R0_N1000_NoIndex_ckmrmultinom20/sd_RE_R0_N1000_NoIndex_20yrs_noCKMR, pch=16, col=4)
plot(1:3,sd_RE_R0_N5000_NoIndex_ckmrmultinom5/sd_RE_R0_N5000_NoIndex_5yrs_noCKMR, ylim=c(0.6,1.05), las=1, ylab="SD RE log(R0)", xaxt="n", pch=16, main="N5000", xlab="",xlim=c(0.5,3.5))
points(1:3,sd_RE_R0_N5000_NoIndex_ckmrmultinom10/sd_RE_R0_N5000_NoIndex_10yrs_noCKMR, pch=16, col=3)
points(1:3,sd_RE_R0_N5000_NoIndex_ckmrmultinom20/sd_RE_R0_N5000_NoIndex_20yrs_noCKMR, pch=16, col=4)
plot(1:3,sd_ARE_R0_N100_NoIndex_ckmrmultinom5/sd_ARE_R0_N100_NoIndex_5yrs_noCKMR, ylim=c(0.6,1.05), las=1, ylab="SD ARE log(R0), relative to NO CKMR", xaxt="n", pch=16, main="N100", xlab="",xlim=c(0.5,3.5))
points(1:3,sd_ARE_R0_N100_NoIndex_ckmrmultinom10/sd_ARE_R0_N100_NoIndex_10yrs_noCKMR, pch=16, col=3)
points(1:3,sd_ARE_R0_N100_NoIndex_ckmrmultinom20/sd_ARE_R0_N100_NoIndex_20yrs_noCKMR, pch=16, col=4)
axis(side=1, at=1:3, labels=c("Cod", "Flatfish", "Sardine"))
plot(1:3,sd_ARE_R0_N1000_NoIndex_ckmrmultinom5/sd_ARE_R0_N1000_NoIndex_5yrs_noCKMR, ylim=c(0.6,1.05), las=1, ylab="", xaxt="n", pch=16, main="N1000", xlab="",xlim=c(0.5,3.5))
points(1:3,sd_ARE_R0_N1000_NoIndex_ckmrmultinom10/sd_ARE_R0_N1000_NoIndex_10yrs_noCKMR, pch=16, col=3)
points(1:3,sd_ARE_R0_N1000_NoIndex_ckmrmultinom20/sd_ARE_R0_N1000_NoIndex_20yrs_noCKMR, pch=16, col=4)
axis(side=1, at=1:3, labels=c("Cod", "Flatfish", "Sardine"))
plot(1:3,sd_ARE_R0_N5000_NoIndex_ckmrmultinom5/sd_ARE_R0_N5000_NoIndex_5yrs_noCKMR, ylim=c(0.6,1.05), las=1, ylab="SD ARE log(R0)", xaxt="n", pch=16, main="N5000", xlab="",xlim=c(0.5,3.5))
points(1:3,sd_ARE_R0_N5000_NoIndex_ckmrmultinom10/sd_ARE_R0_N5000_NoIndex_10yrs_noCKMR, pch=16, col=3)
points(1:3,sd_ARE_R0_N5000_NoIndex_ckmrmultinom20/sd_ARE_R0_N5000_NoIndex_20yrs_noCKMR, pch=16, col=4)
axis(side=1, at=1:3, labels=c("Cod", "Flatfish", "Sardine"))

#Index 0.50
par(mfrow=c(2,3), mar=c(3,4,1,1), oma=c(2,2,1,1))
plot(1:3,sd_RE_R0_N100_Ind50_ckmrmultinom5/sd_RE_R0_N100_Ind50_5yrs_noCKMR, ylim=c(0.6,1.05), las=1, ylab="SD RE log(R0), relative to NO CKMR", xaxt="n", pch=16, main="N100", xlab="",xlim=c(0.5,3.5))
points(1:3,sd_RE_R0_N100_Ind50_ckmrmultinom10/sd_RE_R0_N100_Ind50_10yrs_noCKMR, pch=16, col=3)
points(1:3,sd_RE_R0_N100_Ind50_ckmrmultinom20/sd_RE_R0_N100_Ind50_20yrs_noCKMR, pch=16, col=4)
plot(1:3,sd_RE_R0_N1000_Ind50_ckmrmultinom5/sd_RE_R0_N1000_Ind50_5yrs_noCKMR, ylim=c(0.6,1.05), las=1, ylab="", xaxt="n", pch=16, main="Index 0.5,  N1000", xlab="",xlim=c(0.5,3.5))
legend("top", c("CKMR 5yrs", "CKMR 10yrs","CKMR 20yrs"), col=c(1,3,4), pch=16)
points(1:3,sd_RE_R0_N1000_Ind50_ckmrmultinom10/sd_RE_R0_N1000_Ind50_10yrs_noCKMR, pch=16, col=3)
points(1:3,sd_RE_R0_N1000_Ind50_ckmrmultinom20/sd_RE_R0_N1000_Ind50_20yrs_noCKMR, pch=16, col=4)
plot(1:3,sd_RE_R0_N5000_Ind50_ckmrmultinom5/sd_RE_R0_N5000_Ind50_5yrs_noCKMR, ylim=c(0.6,1.05), las=1, ylab="SD RE log(R0)", xaxt="n", pch=16, main="N5000", xlab="",xlim=c(0.5,3.5))
points(1:3,sd_RE_R0_N5000_Ind50_ckmrmultinom10/sd_RE_R0_N5000_Ind50_10yrs_noCKMR, pch=16, col=3)
points(1:3,sd_RE_R0_N5000_Ind50_ckmrmultinom20/sd_RE_R0_N5000_Ind50_20yrs_noCKMR, pch=16, col=4)
plot(1:3,sd_ARE_R0_N100_Ind50_ckmrmultinom5/sd_ARE_R0_N100_Ind50_5yrs_noCKMR, ylim=c(0.6,1.05), las=1, ylab="SD ARE log(R0), relative to NO CKMR", xaxt="n", pch=16, main="N100", xlab="",xlim=c(0.5,3.5))
points(1:3,sd_ARE_R0_N100_Ind50_ckmrmultinom10/sd_ARE_R0_N100_Ind50_10yrs_noCKMR, pch=16, col=3)
points(1:3,sd_ARE_R0_N100_Ind50_ckmrmultinom20/sd_ARE_R0_N100_Ind50_20yrs_noCKMR, pch=16, col=4)
axis(side=1, at=1:3, labels=c("Cod", "Flatfish", "Sardine"))
plot(1:3,sd_ARE_R0_N1000_Ind50_ckmrmultinom5/sd_ARE_R0_N1000_Ind50_5yrs_noCKMR, ylim=c(0.6,1.05), las=1, ylab="", xaxt="n", pch=16, main="N1000", xlab="",xlim=c(0.5,3.5))
points(1:3,sd_ARE_R0_N1000_Ind50_ckmrmultinom10/sd_ARE_R0_N1000_Ind50_10yrs_noCKMR, pch=16, col=3)
points(1:3,sd_ARE_R0_N1000_Ind50_ckmrmultinom20/sd_ARE_R0_N1000_Ind50_20yrs_noCKMR, pch=16, col=4)
axis(side=1, at=1:3, labels=c("Cod", "Flatfish", "Sardine"))
plot(1:3,sd_ARE_R0_N5000_Ind50_ckmrmultinom5/sd_ARE_R0_N5000_Ind50_5yrs_noCKMR, ylim=c(0.6,1.05), las=1, ylab="SD ARE log(R0)", xaxt="n", pch=16, main="N5000", xlab="",xlim=c(0.5,3.5))
points(1:3,sd_ARE_R0_N5000_Ind50_ckmrmultinom10/sd_ARE_R0_N5000_Ind50_10yrs_noCKMR, pch=16, col=3)
points(1:3,sd_ARE_R0_N5000_Ind50_ckmrmultinom20/sd_ARE_R0_N5000_Ind50_20yrs_noCKMR, pch=16, col=4)
axis(side=1, at=1:3, labels=c("Cod", "Flatfish", "Sardine"))

#Index 0.25
par(mfrow=c(2,3), mar=c(3,4,1,1), oma=c(2,2,1,1))
plot(1:3,sd_RE_R0_N100_Ind25_ckmrmultinom5/sd_RE_R0_N100_Ind25_5yrs_noCKMR, ylim=c(0.6,1.05), las=1, ylab="SD RE log(R0), relative to NO CKMR", xaxt="n", pch=16, main="N100", xlab="",xlim=c(0.5,3.5))
points(1:3,sd_RE_R0_N100_Ind25_ckmrmultinom10/sd_RE_R0_N100_Ind25_10yrs_noCKMR, pch=16, col=3)
points(1:3,sd_RE_R0_N100_Ind25_ckmrmultinom20/sd_RE_R0_N100_Ind25_20yrs_noCKMR, pch=16, col=4)
plot(1:3,sd_RE_R0_N1000_Ind25_ckmrmultinom5/sd_RE_R0_N1000_Ind25_5yrs_noCKMR, ylim=c(0.6,1.05), las=1, ylab="", xaxt="n", pch=16, main="Index 0.25,  N1000", xlab="",xlim=c(0.5,3.5))
legend("top", c("CKMR 5yrs", "CKMR 10yrs","CKMR 20yrs"), col=c(1,3,4), pch=16)
points(1:3,sd_RE_R0_N1000_Ind25_ckmrmultinom10/sd_RE_R0_N1000_Ind25_10yrs_noCKMR, pch=16, col=3)
points(1:3,sd_RE_R0_N1000_Ind25_ckmrmultinom20/sd_RE_R0_N1000_Ind25_20yrs_noCKMR, pch=16, col=4)
plot(1:3,sd_RE_R0_N5000_Ind25_ckmrmultinom5/sd_RE_R0_N5000_Ind25_5yrs_noCKMR, ylim=c(0.6,1.05), las=1, ylab="SD RE log(R0)", xaxt="n", pch=16, main="N5000", xlab="",xlim=c(0.5,3.5))
points(1:3,sd_RE_R0_N5000_Ind25_ckmrmultinom10/sd_RE_R0_N5000_Ind25_10yrs_noCKMR, pch=16, col=3)
points(1:3,sd_RE_R0_N5000_Ind25_ckmrmultinom20/sd_RE_R0_N5000_Ind25_20yrs_noCKMR, pch=16, col=4)
plot(1:3,sd_ARE_R0_N100_Ind25_ckmrmultinom5/sd_ARE_R0_N100_Ind25_5yrs_noCKMR, ylim=c(0.6,1.05), las=1, ylab="SD ARE log(R0), relative to NO CKMR", xaxt="n", pch=16, main="N100", xlab="",xlim=c(0.5,3.5))
points(1:3,sd_ARE_R0_N100_Ind25_ckmrmultinom10/sd_ARE_R0_N100_Ind25_10yrs_noCKMR, pch=16, col=3)
points(1:3,sd_ARE_R0_N100_Ind25_ckmrmultinom20/sd_ARE_R0_N100_Ind25_20yrs_noCKMR, pch=16, col=4)
axis(side=1, at=1:3, labels=c("Cod", "Flatfish", "Sardine"))
plot(1:3,sd_ARE_R0_N1000_Ind25_ckmrmultinom5/sd_ARE_R0_N1000_Ind25_5yrs_noCKMR, ylim=c(0.6,1.05), las=1, ylab="", xaxt="n", pch=16, main="N1000", xlab="",xlim=c(0.5,3.5))
points(1:3,sd_ARE_R0_N1000_Ind25_ckmrmultinom10/sd_ARE_R0_N1000_Ind25_10yrs_noCKMR, pch=16, col=3)
points(1:3,sd_ARE_R0_N1000_Ind25_ckmrmultinom20/sd_ARE_R0_N1000_Ind25_20yrs_noCKMR, pch=16, col=4)
axis(side=1, at=1:3, labels=c("Cod", "Flatfish", "Sardine"))
plot(1:3,sd_ARE_R0_N5000_Ind25_ckmrmultinom5/sd_ARE_R0_N5000_Ind25_5yrs_noCKMR, ylim=c(0.6,1.05), las=1, ylab="SD ARE log(R0)", xaxt="n", pch=16, main="N5000", xlab="",xlim=c(0.5,3.5))
points(1:3,sd_ARE_R0_N5000_Ind25_ckmrmultinom10/sd_ARE_R0_N5000_Ind25_10yrs_noCKMR, pch=16, col=3)
points(1:3,sd_ARE_R0_N5000_Ind25_ckmrmultinom20/sd_ARE_R0_N5000_Ind25_20yrs_noCKMR, pch=16, col=4)
axis(side=1, at=1:3, labels=c("Cod", "Flatfish", "Sardine"))

#M sd of relative error between sims 
#No Index
par(mfrow=c(2,3), mar=c(3,4,1,1), oma=c(2,2,1,1))
plot(1:3,sd_RE_M_N100_NoIndex_5yrs_noCKMR, ylim=c(0,0.05), las=1, ylab="SD RE log(M)", xaxt="n", pch=16, main="N100", xlab="",xlim=c(0.5,3.5))
points(1:3,sd_RE_M_N100_NoIndex_10yrs_noCKMR, pch=16, col=2)
points(1:3,sd_RE_M_N100_NoIndex_20yrs_noCKMR, pch=16, col=3)
points(1:3,sd_RE_M_N100_NoIndex_ckmrmultinom5, pch=16, col=4)
points(1:3,sd_RE_M_N100_NoIndex_ckmrmultinom10, pch=16, col=5)
points(1:3,sd_RE_M_N100_NoIndex_ckmrmultinom20, pch=16, col=6)
axis(side=1,at=1:3, labels=c("Cod", "Flatfish", "Sardine"))
plot(1:3,sd_RE_M_N1000_NoIndex_5yrs_noCKMR, ylim=c(0,0.05), las=1, ylab="", xaxt="n", pch=16, main="No Index   N1000", xlab="",xlim=c(0.5,3.5))
legend("bottom", c("No CKMR 5yrs","No CKMR 10yrs","No CKMR 20yrs","CKMR 5yrs", "CKMR 10yrs", "CKMR 20yrs"), col=c(1:6), pch=16)
points(1:3,sd_RE_M_N1000_NoIndex_10yrs_noCKMR, pch=16, col=2)
points(1:3,sd_RE_M_N1000_NoIndex_20yrs_noCKMR, pch=16, col=3)
points(1:3,sd_RE_M_N1000_NoIndex_ckmrmultinom5, pch=16, col=4)
points(1:3,sd_RE_M_N1000_NoIndex_ckmrmultinom10, pch=16, col=5)
points(1:3,sd_RE_M_N1000_NoIndex_ckmrmultinom20, pch=16, col=6)
axis(side=1,at=1:3, labels=c("Cod", "Flatfish", "Sardine"))
plot(1:3,sd_RE_M_N5000_NoIndex_5yrs_noCKMR, ylim=c(0,0.05), las=1, ylab="SD RE log(M)", xaxt="n", pch=16, main="N5000", xlab="",xlim=c(0.5,3.5))
points(1:3,sd_RE_M_N5000_NoIndex_10yrs_noCKMR, pch=16, col=2)
points(1:3,sd_RE_M_N5000_NoIndex_20yrs_noCKMR, pch=16, col=3)
points(1:3,sd_RE_M_N5000_NoIndex_ckmrmultinom5, pch=16, col=4)
points(1:3,sd_RE_M_N5000_NoIndex_ckmrmultinom10, pch=16, col=5)
points(1:3,sd_RE_M_N5000_NoIndex_ckmrmultinom20, pch=16, col=6)
axis(side=1,at=1:3, labels=c("Cod", "Flatfish", "Sardine"))
plot(1:3,sd_ARE_M_N100_NoIndex_5yrs_noCKMR, ylim=c(0,0.05), las=1, ylab="SD ARE log(M)", xaxt="n", pch=16, main="N100", xlab="",xlim=c(0.5,3.5))
points(1:3,sd_ARE_M_N100_NoIndex_10yrs_noCKMR, pch=16, col=2)
points(1:3,sd_ARE_M_N100_NoIndex_20yrs_noCKMR, pch=16, col=3)
points(1:3,sd_ARE_M_N100_NoIndex_ckmrmultinom5, pch=16, col=4)
points(1:3,sd_ARE_M_N100_NoIndex_ckmrmultinom10, pch=16, col=5)
points(1:3,sd_ARE_M_N100_NoIndex_ckmrmultinom20, pch=16, col=6)
axis(side=1,at=1:3, labels=c("Cod", "Flatfish", "Sardine"))
plot(1:3,sd_ARE_M_N1000_NoIndex_5yrs_noCKMR, ylim=c(0,0.05), las=1, ylab="", xaxt="n", pch=16, main="N1000", xlab="",xlim=c(0.5,3.5))
points(1:3,sd_ARE_M_N1000_NoIndex_10yrs_noCKMR, pch=16, col=2)
points(1:3,sd_ARE_M_N1000_NoIndex_20yrs_noCKMR, pch=16, col=3)
points(1:3,sd_ARE_M_N1000_NoIndex_ckmrmultinom5, pch=16, col=4)
points(1:3,sd_ARE_M_N1000_NoIndex_ckmrmultinom10, pch=16, col=5)
points(1:3,sd_ARE_M_N1000_NoIndex_ckmrmultinom20, pch=16, col=6)
axis(side=1,at=1:3, labels=c("Cod", "Flatfish", "Sardine"))
plot(1:3,sd_ARE_M_N5000_NoIndex_5yrs_noCKMR, ylim=c(0,0.05), las=1, ylab="SD ARE log(M)", xaxt="n", pch=16, main="N5000", xlab="",xlim=c(0.5,3.5))
points(1:3,sd_ARE_M_N5000_NoIndex_10yrs_noCKMR, pch=16, col=2)
points(1:3,sd_ARE_M_N5000_NoIndex_20yrs_noCKMR, pch=16, col=3)
points(1:3,sd_ARE_M_N5000_NoIndex_ckmrmultinom5, pch=16, col=4)
points(1:3,sd_ARE_M_N5000_NoIndex_ckmrmultinom10, pch=16, col=5)
points(1:3,sd_ARE_M_N5000_NoIndex_ckmrmultinom20, pch=16, col=6)
axis(side=1,at=1:3, labels=c("Cod", "Flatfish", "Sardine"))

#Index 0.50
par(mfrow=c(2,3), mar=c(3,4,1,1), oma=c(2,2,1,1))
plot(1:3,sd_RE_M_N100_Ind50_5yrs_noCKMR, ylim=c(0,0.05), las=1, ylab="SD RE log(M)", xaxt="n", pch=16, main="N100", xlab="",xlim=c(0.5,3.5))
points(1:3,sd_RE_M_N100_Ind50_10yrs_noCKMR, pch=16, col=2)
points(1:3,sd_RE_M_N100_Ind50_20yrs_noCKMR, pch=16, col=3)
points(1:3,sd_RE_M_N100_Ind50_ckmrmultinom5, pch=16, col=4)
points(1:3,sd_RE_M_N100_Ind50_ckmrmultinom10, pch=16, col=5)
points(1:3,sd_RE_M_N100_Ind50_ckmrmultinom20, pch=16, col=6)
axis(side=1,at=1:3, labels=c("Cod", "Flatfish", "Sardine"))
plot(1:3,sd_RE_M_N1000_Ind50_5yrs_noCKMR, ylim=c(0,0.05), las=1, ylab="", xaxt="n", pch=16, main="Index 0.5, N1000", xlab="",xlim=c(0.5,3.5))
legend("bottom", c("No CKMR 5yrs","No CKMR 10yrs","No CKMR 20yrs","CKMR 5yrs", "CKMR 10yrs", "CKMR 20yrs"), col=c(1:6), pch=16)
points(1:3,sd_RE_M_N1000_Ind50_10yrs_noCKMR, pch=16, col=2)
points(1:3,sd_RE_M_N1000_Ind50_20yrs_noCKMR, pch=16, col=3)
points(1:3,sd_RE_M_N1000_Ind50_ckmrmultinom5, pch=16, col=4)
points(1:3,sd_RE_M_N1000_Ind50_ckmrmultinom10, pch=16, col=5)
points(1:3,sd_RE_M_N1000_Ind50_ckmrmultinom20, pch=16, col=6)
axis(side=1,at=1:3, labels=c("Cod", "Flatfish", "Sardine"))
plot(1:3,sd_RE_M_N5000_Ind50_5yrs_noCKMR, ylim=c(0,0.05), las=1, ylab="SD RE log(M)", xaxt="n", pch=16, main="N5000", xlab="",xlim=c(0.5,3.5))
points(1:3,sd_RE_M_N5000_Ind50_10yrs_noCKMR, pch=16, col=2)
points(1:3,sd_RE_M_N5000_Ind50_20yrs_noCKMR, pch=16, col=3)
points(1:3,sd_RE_M_N5000_Ind50_ckmrmultinom5, pch=16, col=4)
points(1:3,sd_RE_M_N5000_Ind50_ckmrmultinom10, pch=16, col=5)
points(1:3,sd_RE_M_N5000_Ind50_ckmrmultinom20, pch=16, col=6)
axis(side=1,at=1:3, labels=c("Cod", "Flatfish", "Sardine"))
plot(1:3,sd_ARE_M_N100_Ind50_5yrs_noCKMR, ylim=c(0,0.05), las=1, ylab="SD ARE log(M)", xaxt="n", pch=16, main="N100", xlab="",xlim=c(0.5,3.5))
points(1:3,sd_ARE_M_N100_Ind50_10yrs_noCKMR, pch=16, col=2)
points(1:3,sd_ARE_M_N100_Ind50_20yrs_noCKMR, pch=16, col=3)
points(1:3,sd_ARE_M_N100_Ind50_ckmrmultinom5, pch=16, col=4)
points(1:3,sd_ARE_M_N100_Ind50_ckmrmultinom10, pch=16, col=5)
points(1:3,sd_ARE_M_N100_Ind50_ckmrmultinom20, pch=16, col=6)
axis(side=1,at=1:3, labels=c("Cod", "Flatfish", "Sardine"))
plot(1:3,sd_ARE_M_N1000_Ind50_5yrs_noCKMR, ylim=c(0,0.05), las=1, ylab="", xaxt="n", pch=16, main="N1000", xlab="",xlim=c(0.5,3.5))
points(1:3,sd_ARE_M_N1000_Ind50_10yrs_noCKMR, pch=16, col=2)
points(1:3,sd_ARE_M_N1000_Ind50_20yrs_noCKMR, pch=16, col=3)
points(1:3,sd_ARE_M_N1000_Ind50_ckmrmultinom5, pch=16, col=4)
points(1:3,sd_ARE_M_N1000_Ind50_ckmrmultinom10, pch=16, col=5)
points(1:3,sd_ARE_M_N1000_Ind50_ckmrmultinom20, pch=16, col=6)
axis(side=1,at=1:3, labels=c("Cod", "Flatfish", "Sardine"))
plot(1:3,sd_ARE_M_N5000_Ind50_5yrs_noCKMR, ylim=c(0,0.05), las=1, ylab="SD ARE log(M)", xaxt="n", pch=16, main="N5000", xlab="",xlim=c(0.5,3.5))
points(1:3,sd_ARE_M_N5000_Ind50_10yrs_noCKMR, pch=16, col=2)
points(1:3,sd_ARE_M_N5000_Ind50_20yrs_noCKMR, pch=16, col=3)
points(1:3,sd_ARE_M_N5000_Ind50_ckmrmultinom5, pch=16, col=4)
points(1:3,sd_ARE_M_N5000_Ind50_ckmrmultinom10, pch=16, col=5)
points(1:3,sd_ARE_M_N5000_Ind50_ckmrmultinom20, pch=16, col=6)
axis(side=1,at=1:3, labels=c("Cod", "Flatfish", "Sardine"))

#Index 0.25
par(mfrow=c(2,3), mar=c(3,4,1,1), oma=c(2,2,1,1))
plot(1:3,sd_RE_M_N100_Ind25_5yrs_noCKMR, ylim=c(0,0.05), las=1, ylab="SD RE log(M)", xaxt="n", pch=16, main="N100", xlab="",xlim=c(0.5,3.5))
points(1:3,sd_RE_M_N100_Ind25_10yrs_noCKMR, pch=16, col=2)
points(1:3,sd_RE_M_N100_Ind25_20yrs_noCKMR, pch=16, col=3)
points(1:3,sd_RE_M_N100_Ind25_ckmrmultinom5, pch=16, col=4)
points(1:3,sd_RE_M_N100_Ind25_ckmrmultinom10, pch=16, col=5)
points(1:3,sd_RE_M_N100_Ind25_ckmrmultinom20, pch=16, col=6)
axis(side=1,at=1:3, labels=c("Cod", "Flatfish", "Sardine"))
plot(1:3,sd_RE_M_N1000_Ind25_5yrs_noCKMR, ylim=c(0,0.05), las=1, ylab="", xaxt="n", pch=16, main="Index 0.25, N1000", xlab="",xlim=c(0.5,3.5))
legend("bottom", c("No CKMR 5yrs","No CKMR 10yrs","No CKMR 20yrs","CKMR 5yrs", "CKMR 10yrs", "CKMR 20yrs"), col=c(1:6), pch=16)
points(1:3,sd_RE_M_N1000_Ind25_10yrs_noCKMR, pch=16, col=2)
points(1:3,sd_RE_M_N1000_Ind25_20yrs_noCKMR, pch=16, col=3)
points(1:3,sd_RE_M_N1000_Ind25_ckmrmultinom5, pch=16, col=4)
points(1:3,sd_RE_M_N1000_Ind25_ckmrmultinom10, pch=16, col=5)
points(1:3,sd_RE_M_N1000_Ind25_ckmrmultinom20, pch=16, col=6)
axis(side=1,at=1:3, labels=c("Cod", "Flatfish", "Sardine"))
plot(1:3,sd_RE_M_N5000_Ind25_5yrs_noCKMR, ylim=c(0,0.05), las=1, ylab="SD RE log(M)", xaxt="n", pch=16, main="N5000", xlab="",xlim=c(0.5,3.5))
points(1:3,sd_RE_M_N5000_Ind25_10yrs_noCKMR, pch=16, col=2)
points(1:3,sd_RE_M_N5000_Ind25_20yrs_noCKMR, pch=16, col=3)
points(1:3,sd_RE_M_N5000_Ind25_ckmrmultinom5, pch=16, col=4)
points(1:3,sd_RE_M_N5000_Ind25_ckmrmultinom10, pch=16, col=5)
points(1:3,sd_RE_M_N5000_Ind25_ckmrmultinom20, pch=16, col=6)
axis(side=1,at=1:3, labels=c("Cod", "Flatfish", "Sardine"))
plot(1:3,sd_ARE_M_N100_Ind25_5yrs_noCKMR, ylim=c(0,0.05), las=1, ylab="SD ARE log(M)", xaxt="n", pch=16, main="N100", xlab="",xlim=c(0.5,3.5))
points(1:3,sd_ARE_M_N100_Ind25_10yrs_noCKMR, pch=16, col=2)
points(1:3,sd_ARE_M_N100_Ind25_20yrs_noCKMR, pch=16, col=3)
points(1:3,sd_ARE_M_N100_Ind25_ckmrmultinom5, pch=16, col=4)
points(1:3,sd_ARE_M_N100_Ind25_ckmrmultinom10, pch=16, col=5)
points(1:3,sd_ARE_M_N100_Ind25_ckmrmultinom20, pch=16, col=6)
axis(side=1,at=1:3, labels=c("Cod", "Flatfish", "Sardine"))
plot(1:3,sd_ARE_M_N1000_Ind25_5yrs_noCKMR, ylim=c(0,0.05), las=1, ylab="", xaxt="n", pch=16, main="N1000", xlab="",xlim=c(0.5,3.5))
points(1:3,sd_ARE_M_N1000_Ind25_10yrs_noCKMR, pch=16, col=2)
points(1:3,sd_ARE_M_N1000_Ind25_20yrs_noCKMR, pch=16, col=3)
points(1:3,sd_ARE_M_N1000_Ind25_ckmrmultinom5, pch=16, col=4)
points(1:3,sd_ARE_M_N1000_Ind25_ckmrmultinom10, pch=16, col=5)
points(1:3,sd_ARE_M_N1000_Ind25_ckmrmultinom20, pch=16, col=6)
axis(side=1,at=1:3, labels=c("Cod", "Flatfish", "Sardine"))
plot(1:3,sd_ARE_M_N5000_Ind25_5yrs_noCKMR, ylim=c(0,0.05), las=1, ylab="SD ARE log(M)", xaxt="n", pch=16, main="N5000", xlab="",xlim=c(0.5,3.5))
points(1:3,sd_ARE_M_N5000_Ind25_10yrs_noCKMR, pch=16, col=2)
points(1:3,sd_ARE_M_N5000_Ind25_20yrs_noCKMR, pch=16, col=3)
points(1:3,sd_ARE_M_N5000_Ind25_ckmrmultinom5, pch=16, col=4)
points(1:3,sd_ARE_M_N5000_Ind25_ckmrmultinom10, pch=16, col=5)
points(1:3,sd_ARE_M_N5000_Ind25_ckmrmultinom20, pch=16, col=6)
axis(side=1,at=1:3, labels=c("Cod", "Flatfish", "Sardine"))

#Relative to no CKMR
#No Index
par(mfrow=c(2,3), mar=c(3,4,1,1), oma=c(2,2,1,1))
plot(1:3,sd_RE_M_N100_NoIndex_ckmrmultinom5/sd_RE_M_N100_NoIndex_5yrs_noCKMR, ylim=c(0.4,1.05), las=1, ylab="SD RE log(M), relative to NO CKMR", xaxt="n", pch=16, main="N100", xlab="",xlim=c(0.5,3.5))
points(1:3,sd_RE_M_N100_NoIndex_ckmrmultinom10/sd_RE_M_N100_NoIndex_10yrs_noCKMR, pch=16, col=3)
points(1:3,sd_RE_M_N100_NoIndex_ckmrmultinom20/sd_RE_M_N100_NoIndex_20yrs_noCKMR, pch=16, col=4)
plot(1:3,sd_RE_M_N1000_NoIndex_ckmrmultinom5/sd_RE_M_N1000_NoIndex_5yrs_noCKMR, ylim=c(0.4,1.05), las=1, ylab="", xaxt="n", pch=16, main="No Index,  N1000", xlab="",xlim=c(0.5,3.5))
legend("top", c("CKMR 5yrs", "CKMR 10yrs", "CKMR 20yrs"), col=c(1,3,4), pch=16)
points(1:3,sd_RE_M_N1000_NoIndex_ckmrmultinom10/sd_RE_M_N1000_NoIndex_10yrs_noCKMR, pch=16, col=3)
points(1:3,sd_RE_M_N1000_NoIndex_ckmrmultinom20/sd_RE_M_N1000_NoIndex_20yrs_noCKMR, pch=16, col=4)
plot(1:3,sd_RE_M_N5000_NoIndex_ckmrmultinom5/sd_RE_M_N5000_NoIndex_5yrs_noCKMR, ylim=c(0.4,1.05), las=1, ylab="SD RE log(M)", xaxt="n", pch=16, main="N5000", xlab="",xlim=c(0.5,3.5))
points(1:3,sd_RE_M_N5000_NoIndex_ckmrmultinom10/sd_RE_M_N5000_NoIndex_10yrs_noCKMR, pch=16, col=3)
points(1:3,sd_RE_M_N5000_NoIndex_ckmrmultinom20/sd_RE_M_N5000_NoIndex_20yrs_noCKMR, pch=16, col=4)
plot(1:3,sd_ARE_M_N100_NoIndex_ckmrmultinom5/sd_ARE_M_N100_NoIndex_5yrs_noCKMR, ylim=c(0.4,1.05), las=1, ylab="SD ARE log(M), relative to NO CKMR", xaxt="n", pch=16, main="N100", xlab="",xlim=c(0.5,3.5))
points(1:3,sd_ARE_M_N100_NoIndex_ckmrmultinom10/sd_ARE_M_N100_NoIndex_10yrs_noCKMR, pch=16, col=3)
points(1:3,sd_ARE_M_N100_NoIndex_ckmrmultinom20/sd_ARE_M_N100_NoIndex_20yrs_noCKMR, pch=16, col=4)
axis(side=1, at=1:3, labels=c("Cod", "Flatfish", "Sardine"))
plot(1:3,sd_ARE_M_N1000_NoIndex_ckmrmultinom5/sd_ARE_M_N1000_NoIndex_5yrs_noCKMR, ylim=c(0.4,1.05), las=1, ylab="", xaxt="n", pch=16, main="N1000", xlab="",xlim=c(0.5,3.5))
points(1:3,sd_ARE_M_N1000_NoIndex_ckmrmultinom10/sd_ARE_M_N1000_NoIndex_10yrs_noCKMR, pch=16, col=3)
points(1:3,sd_ARE_M_N1000_NoIndex_ckmrmultinom20/sd_ARE_M_N1000_NoIndex_20yrs_noCKMR, pch=16, col=4)
axis(side=1, at=1:3, labels=c("Cod", "Flatfish", "Sardine"))
plot(1:3,sd_ARE_M_N5000_NoIndex_ckmrmultinom5/sd_ARE_M_N5000_NoIndex_5yrs_noCKMR, ylim=c(0.4,1.05), las=1, ylab="SD ARE log(M)", xaxt="n", pch=16, main="N5000", xlab="",xlim=c(0.5,3.5))
points(1:3,sd_ARE_M_N5000_NoIndex_ckmrmultinom10/sd_ARE_M_N5000_NoIndex_10yrs_noCKMR, pch=16, col=3)
points(1:3,sd_ARE_M_N5000_NoIndex_ckmrmultinom20/sd_ARE_M_N5000_NoIndex_20yrs_noCKMR, pch=16, col=4)
axis(side=1, at=1:3, labels=c("Cod", "Flatfish", "Sardine"))

#Index 0.50
par(mfrow=c(2,3), mar=c(3,4,1,1), oma=c(2,2,1,1))
plot(1:3,sd_RE_M_N100_Ind50_ckmrmultinom5/sd_RE_M_N100_Ind50_5yrs_noCKMR, ylim=c(0.4,1.05), las=1, ylab="SD RE log(M), relative to NO CKMR", xaxt="n", pch=16, main="N100", xlab="",xlim=c(0.5,3.5))
points(1:3,sd_RE_M_N100_Ind50_ckmrmultinom10/sd_RE_M_N100_Ind50_10yrs_noCKMR, pch=16, col=3)
points(1:3,sd_RE_M_N100_Ind50_ckmrmultinom20/sd_RE_M_N100_Ind50_20yrs_noCKMR, pch=16, col=4)
plot(1:3,sd_RE_M_N1000_Ind50_ckmrmultinom5/sd_RE_M_N1000_Ind50_5yrs_noCKMR, ylim=c(0.4,1.05), las=1, ylab="", xaxt="n", pch=16, main="Index 0.50,  N1000", xlab="",xlim=c(0.5,3.5))
legend("top", c("CKMR 5yrs", "CKMR 10yrs", "CKMR 20yrs"), col=c(1,3,4), pch=16)
points(1:3,sd_RE_M_N1000_Ind50_ckmrmultinom10/sd_RE_M_N1000_Ind50_10yrs_noCKMR, pch=16, col=3)
points(1:3,sd_RE_M_N1000_Ind50_ckmrmultinom20/sd_RE_M_N1000_Ind50_20yrs_noCKMR, pch=16, col=4)
plot(1:3,sd_RE_M_N5000_Ind50_ckmrmultinom5/sd_RE_M_N5000_Ind50_5yrs_noCKMR, ylim=c(0.4,1.05), las=1, ylab="SD RE log(M)", xaxt="n", pch=16, main="N5000", xlab="",xlim=c(0.5,3.5))
points(1:3,sd_RE_M_N5000_Ind50_ckmrmultinom10/sd_RE_M_N5000_Ind50_10yrs_noCKMR, pch=16, col=3)
points(1:3,sd_RE_M_N5000_Ind50_ckmrmultinom20/sd_RE_M_N5000_Ind50_20yrs_noCKMR, pch=16, col=4)
plot(1:3,sd_ARE_M_N100_Ind50_ckmrmultinom5/sd_ARE_M_N100_Ind50_5yrs_noCKMR, ylim=c(0.4,1.05), las=1, ylab="SD ARE log(M), relative to NO CKMR", xaxt="n", pch=16, main="N100", xlab="",xlim=c(0.5,3.5))
points(1:3,sd_ARE_M_N100_Ind50_ckmrmultinom10/sd_ARE_M_N100_Ind50_10yrs_noCKMR, pch=16, col=3)
points(1:3,sd_ARE_M_N100_Ind50_ckmrmultinom20/sd_ARE_M_N100_Ind50_20yrs_noCKMR, pch=16, col=4)
axis(side=1, at=1:3, labels=c("Cod", "Flatfish", "Sardine"))
plot(1:3,sd_ARE_M_N1000_Ind50_ckmrmultinom5/sd_ARE_M_N1000_Ind50_5yrs_noCKMR, ylim=c(0.4,1.05), las=1, ylab="", xaxt="n", pch=16, main="N1000", xlab="",xlim=c(0.5,3.5))
points(1:3,sd_ARE_M_N1000_Ind50_ckmrmultinom10/sd_ARE_M_N1000_Ind50_10yrs_noCKMR, pch=16, col=3)
points(1:3,sd_ARE_M_N1000_Ind50_ckmrmultinom20/sd_ARE_M_N1000_Ind50_20yrs_noCKMR, pch=16, col=4)
axis(side=1, at=1:3, labels=c("Cod", "Flatfish", "Sardine"))
plot(1:3,sd_ARE_M_N5000_Ind50_ckmrmultinom5/sd_ARE_M_N5000_Ind50_5yrs_noCKMR, ylim=c(0.4,1.05), las=1, ylab="SD ARE log(M)", xaxt="n", pch=16, main="N5000", xlab="",xlim=c(0.5,3.5))
points(1:3,sd_ARE_M_N5000_Ind50_ckmrmultinom10/sd_ARE_M_N5000_Ind50_10yrs_noCKMR, pch=16, col=3)
points(1:3,sd_ARE_M_N5000_Ind50_ckmrmultinom20/sd_ARE_M_N5000_Ind50_20yrs_noCKMR, pch=16, col=4)
axis(side=1, at=1:3, labels=c("Cod", "Flatfish", "Sardine"))

#Index 0.25
par(mfrow=c(2,3), mar=c(3,4,1,1), oma=c(2,2,1,1))
plot(1:3,sd_RE_M_N100_Ind25_ckmrmultinom5/sd_RE_M_N100_Ind25_5yrs_noCKMR, ylim=c(0.4,1.05), las=1, ylab="SD RE log(M), relative to NO CKMR", xaxt="n", pch=16, main="N100", xlab="",xlim=c(0.5,3.5))
points(1:3,sd_RE_M_N100_Ind25_ckmrmultinom10/sd_RE_M_N100_Ind25_10yrs_noCKMR, pch=16, col=3)
points(1:3,sd_RE_M_N100_Ind25_ckmrmultinom20/sd_RE_M_N100_Ind25_20yrs_noCKMR, pch=16, col=4)
plot(1:3,sd_RE_M_N1000_Ind25_ckmrmultinom5/sd_RE_M_N1000_Ind25_5yrs_noCKMR, ylim=c(0.4,1.05), las=1, ylab="", xaxt="n", pch=16, main="Index 0.25,  N1000", xlab="",xlim=c(0.5,3.5))
legend("top", c("CKMR 5yrs", "CKMR 10yrs", "CKMR 20yrs"), col=c(1,3,4), pch=16)
points(1:3,sd_RE_M_N1000_Ind25_ckmrmultinom10/sd_RE_M_N1000_Ind25_10yrs_noCKMR, pch=16, col=3)
points(1:3,sd_RE_M_N1000_Ind25_ckmrmultinom20/sd_RE_M_N1000_Ind25_20yrs_noCKMR, pch=16, col=4)
plot(1:3,sd_RE_M_N5000_Ind25_ckmrmultinom5/sd_RE_M_N5000_Ind25_5yrs_noCKMR, ylim=c(0.4,1.05), las=1, ylab="SD RE log(M)", xaxt="n", pch=16, main="N5000", xlab="",xlim=c(0.5,3.5))
points(1:3,sd_RE_M_N5000_Ind25_ckmrmultinom10/sd_RE_M_N5000_Ind25_10yrs_noCKMR, pch=16, col=3)
points(1:3,sd_RE_M_N5000_Ind25_ckmrmultinom20/sd_RE_M_N5000_Ind25_20yrs_noCKMR, pch=16, col=4)
plot(1:3,sd_ARE_M_N100_Ind25_ckmrmultinom5/sd_ARE_M_N100_Ind25_5yrs_noCKMR, ylim=c(0.4,1.05), las=1, ylab="SD ARE log(M), relative to NO CKMR", xaxt="n", pch=16, main="N100", xlab="",xlim=c(0.5,3.5))
points(1:3,sd_ARE_M_N100_Ind25_ckmrmultinom10/sd_ARE_M_N100_Ind25_10yrs_noCKMR, pch=16, col=3)
points(1:3,sd_ARE_M_N100_Ind25_ckmrmultinom20/sd_ARE_M_N100_Ind25_20yrs_noCKMR, pch=16, col=4)
axis(side=1, at=1:3, labels=c("Cod", "Flatfish", "Sardine"))
plot(1:3,sd_ARE_M_N1000_Ind25_ckmrmultinom5/sd_ARE_M_N1000_Ind25_5yrs_noCKMR, ylim=c(0.4,1.05), las=1, ylab="", xaxt="n", pch=16, main="N1000", xlab="",xlim=c(0.5,3.5))
points(1:3,sd_ARE_M_N1000_Ind25_ckmrmultinom10/sd_ARE_M_N1000_Ind25_10yrs_noCKMR, pch=16, col=3)
points(1:3,sd_ARE_M_N1000_Ind25_ckmrmultinom20/sd_ARE_M_N1000_Ind25_20yrs_noCKMR, pch=16, col=4)
axis(side=1, at=1:3, labels=c("Cod", "Flatfish", "Sardine"))
plot(1:3,sd_ARE_M_N5000_Ind25_ckmrmultinom5/sd_ARE_M_N5000_Ind25_5yrs_noCKMR, ylim=c(0.4,1.05), las=1, ylab="SD ARE log(M)", xaxt="n", pch=16, main="N5000", xlab="",xlim=c(0.5,3.5))
points(1:3,sd_ARE_M_N5000_Ind25_ckmrmultinom10/sd_ARE_M_N5000_Ind25_10yrs_noCKMR, pch=16, col=3)
points(1:3,sd_ARE_M_N5000_Ind25_ckmrmultinom20/sd_ARE_M_N5000_Ind25_20yrs_noCKMR, pch=16, col=4)
axis(side=1, at=1:3, labels=c("Cod", "Flatfish", "Sardine"))

